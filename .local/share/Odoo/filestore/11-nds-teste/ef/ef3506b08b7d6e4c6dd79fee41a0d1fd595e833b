
/* /scrummer/static/src/js/libs/external/materialize.js defined in bundle 'scrummer.assets' */
if(typeof(jQuery)==='undefined'){var jQuery;if(typeof(require)==='function'){jQuery=$=require('jquery');}else{jQuery=$;}};jQuery.easing['jswing']=jQuery.easing['swing'];jQuery.extend(jQuery.easing,{def:'easeOutQuad',swing:function(x,t,b,c,d){return jQuery.easing[jQuery.easing.def](x,t,b,c,d);},easeInQuad:function(x,t,b,c,d){return c*(t/=d)*t+b;},easeOutQuad:function(x,t,b,c,d){return-c*(t/=d)*(t-2)+b;},easeInOutQuad:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t+b;return-c/2*((--t)*(t-2)-1)+b;},easeInCubic:function(x,t,b,c,d){return c*(t/=d)*t*t+b;},easeOutCubic:function(x,t,b,c,d){return c*((t=t/d-1)*t*t+1)+b;},easeInOutCubic:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t+b;return c/2*((t-=2)*t*t+2)+b;},easeInQuart:function(x,t,b,c,d){return c*(t/=d)*t*t*t+b;},easeOutQuart:function(x,t,b,c,d){return-c*((t=t/d-1)*t*t*t-1)+b;},easeInOutQuart:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t*t+b;return-c/2*((t-=2)*t*t*t-2)+b;},easeInQuint:function(x,t,b,c,d){return c*(t/=d)*t*t*t*t+b;},easeOutQuint:function(x,t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b;},easeInOutQuint:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t*t*t+b;return c/2*((t-=2)*t*t*t*t+2)+b;},easeInSine:function(x,t,b,c,d){return-c*Math.cos(t/d*(Math.PI/2))+c+b;},easeOutSine:function(x,t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b;},easeInOutSine:function(x,t,b,c,d){return-c/2*(Math.cos(Math.PI*t/d)-1)+b;},easeInExpo:function(x,t,b,c,d){return(t==0)?b:c*Math.pow(2,10*(t/d-1))+b;},easeOutExpo:function(x,t,b,c,d){return(t==d)?b+c:c*(-Math.pow(2,-10*t/d)+1)+b;},easeInOutExpo:function(x,t,b,c,d){if(t==0)return b;if(t==d)return b+c;if((t/=d/2)<1)return c/2*Math.pow(2,10*(t-1))+b;return c/2*(-Math.pow(2,-10*--t)+2)+b;},easeInCirc:function(x,t,b,c,d){return-c*(Math.sqrt(1-(t/=d)*t)-1)+b;},easeOutCirc:function(x,t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b;},easeInOutCirc:function(x,t,b,c,d){if((t/=d/2)<1)return-c/2*(Math.sqrt(1-t*t)-1)+b;return c/2*(Math.sqrt(1-(t-=2)*t)+1)+b;},easeInElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d)==1)return b+c;if(!p)p=d*.3;if(a<Math.abs(c)){a=c;var s=p/4;}
else var s=p/(2*Math.PI)*Math.asin(c/a);return-(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b;},easeOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d)==1)return b+c;if(!p)p=d*.3;if(a<Math.abs(c)){a=c;var s=p/4;}
else var s=p/(2*Math.PI)*Math.asin(c/a);return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b;},easeInOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d/2)==2)return b+c;if(!p)p=d*(.3*1.5);if(a<Math.abs(c)){a=c;var s=p/4;}
else var s=p/(2*Math.PI)*Math.asin(c/a);if(t<1)return-.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b;return a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*.5+c+b;},easeInBack:function(x,t,b,c,d,s){if(s==undefined)s=1.70158;return c*(t/=d)*t*((s+1)*t-s)+b;},easeOutBack:function(x,t,b,c,d,s){if(s==undefined)s=1.70158;return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b;},easeInOutBack:function(x,t,b,c,d,s){if(s==undefined)s=1.70158;if((t/=d/2)<1)return c/2*(t*t*(((s*=(1.525))+1)*t-s))+b;return c/2*((t-=2)*t*(((s*=(1.525))+1)*t+s)+2)+b;},easeInBounce:function(x,t,b,c,d){return c-jQuery.easing.easeOutBounce(x,d-t,0,c,d)+b;},easeOutBounce:function(x,t,b,c,d){if((t/=d)<(1/2.75)){return c*(7.5625*t*t)+b;}else if(t<(2/2.75)){return c*(7.5625*(t-=(1.5/2.75))*t+.75)+b;}else if(t<(2.5/2.75)){return c*(7.5625*(t-=(2.25/2.75))*t+.9375)+b;}else{return c*(7.5625*(t-=(2.625/2.75))*t+.984375)+b;}},easeInOutBounce:function(x,t,b,c,d){if(t<d/2)return jQuery.easing.easeInBounce(x,t*2,0,c,d)*.5+b;return jQuery.easing.easeOutBounce(x,t*2-d,0,c,d)*.5+c*.5+b;}});;jQuery.extend(jQuery.easing,{easeInOutMaterial:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t+b;return c/4*((t-=2)*t*t+2)+b;}});;jQuery.Velocity?console.log("Velocity is already loaded. You may be needlessly importing Velocity again; note that Materialize includes Velocity."):(!function(e){function t(e){var t=e.length,a=r.type(e);return"function"===a||r.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===a||0===t||"number"==typeof t&&t>0&&t-1 in e}
if(!e.jQuery){var r=function(e,t){return new r.fn.init(e,t)};r.isWindow=function(e){return null!=e&&e==e.window},r.type=function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?n[i.call(e)]||"object":typeof e},r.isArray=Array.isArray||function(e){return"array"===r.type(e)},r.isPlainObject=function(e){var t;if(!e||"object"!==r.type(e)||e.nodeType||r.isWindow(e))return!1;try{if(e.constructor&&!o.call(e,"constructor")&&!o.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(a){return!1}
for(t in e);return void 0===t||o.call(e,t)},r.each=function(e,r,a){var n,o=0,i=e.length,s=t(e);if(a){if(s)for(;i>o&&(n=r.apply(e[o],a),n!==!1);o++);else for(o in e)if(n=r.apply(e[o],a),n===!1)break}else if(s)for(;i>o&&(n=r.call(e[o],o,e[o]),n!==!1);o++);else for(o in e)if(n=r.call(e[o],o,e[o]),n===!1)break;return e},r.data=function(e,t,n){if(void 0===n){var o=e[r.expando],i=o&&a[o];if(void 0===t)return i;if(i&&t in i)return i[t]}else if(void 0!==t){var o=e[r.expando]||(e[r.expando]=++r.uuid);return a[o]=a[o]||{},a[o][t]=n,n}},r.removeData=function(e,t){var n=e[r.expando],o=n&&a[n];o&&r.each(t,function(e,t){delete o[t]})},r.extend=function(){var e,t,a,n,o,i,s=arguments[0]||{},l=1,u=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[l]||{},l++),"object"!=typeof s&&"function"!==r.type(s)&&(s={}),l===u&&(s=this,l--);u>l;l++)if(null!=(o=arguments[l]))for(n in o)e=s[n],a=o[n],s!==a&&(c&&a&&(r.isPlainObject(a)||(t=r.isArray(a)))?(t?(t=!1,i=e&&r.isArray(e)?e:[]):i=e&&r.isPlainObject(e)?e:{},s[n]=r.extend(c,i,a)):void 0!==a&&(s[n]=a));return s},r.queue=function(e,a,n){function o(e,r){var a=r||[];return null!=e&&(t(Object(e))?!function(e,t){for(var r=+t.length,a=0,n=e.length;r>a;)e[n++]=t[a++];if(r!==r)for(;void 0!==t[a];)e[n++]=t[a++];return e.length=n,e}(a,"string"==typeof e?[e]:e):[].push.call(a,e)),a}
if(e){a=(a||"fx")+"queue";var i=r.data(e,a);return n?(!i||r.isArray(n)?i=r.data(e,a,o(n)):i.push(n),i):i||[]}},r.dequeue=function(e,t){r.each(e.nodeType?[e]:e,function(e,a){t=t||"fx";var n=r.queue(a,t),o=n.shift();"inprogress"===o&&(o=n.shift()),o&&("fx"===t&&n.unshift("inprogress"),o.call(a,function(){r.dequeue(a,t)}))})},r.fn=r.prototype={init:function(e){if(e.nodeType)return this[0]=e,this;throw new Error("Not a DOM node.")},offset:function(){var t=this[0].getBoundingClientRect?this[0].getBoundingClientRect():{top:0,left:0};return{top:t.top+(e.pageYOffset||document.scrollTop||0)-(document.clientTop||0),left:t.left+(e.pageXOffset||document.scrollLeft||0)-(document.clientLeft||0)}},position:function(){function e(){for(var e=this.offsetParent||document;e&&"html"===!e.nodeType.toLowerCase&&"static"===e.style.position;)e=e.offsetParent;return e||document}
var t=this[0],e=e.apply(t),a=this.offset(),n=/^(?:body|html)$/i.test(e.nodeName)?{top:0,left:0}:r(e).offset();return a.top-=parseFloat(t.style.marginTop)||0,a.left-=parseFloat(t.style.marginLeft)||0,e.style&&(n.top+=parseFloat(e.style.borderTopWidth)||0,n.left+=parseFloat(e.style.borderLeftWidth)||0),{top:a.top-n.top,left:a.left-n.left}}};var a={};r.expando="velocity"+(new Date).getTime(),r.uuid=0;for(var n={},o=n.hasOwnProperty,i=n.toString,s="Boolean Number String Function Array Date RegExp Object Error".split(" "),l=0;l<s.length;l++)n["[object "+s[l]+"]"]=s[l].toLowerCase();r.fn.init.prototype=r.fn,e.Velocity={Utilities:r}}}(window),function(e){"object"==typeof module&&"object"==typeof module.exports?module.exports=e():"function"==typeof define&&define.amd?define(e):e()}(function(){return function(e,t,r,a){function n(e){for(var t=-1,r=e?e.length:0,a=[];++t<r;){var n=e[t];n&&a.push(n)}
return a}
function o(e){return m.isWrapped(e)?e=[].slice.call(e):m.isNode(e)&&(e=[e]),e}
function i(e){var t=f.data(e,"velocity");return null===t?a:t}
function s(e){return function(t){return Math.round(t*e)*(1/e)}}
function l(e,r,a,n){function o(e,t){return 1-3*t+3*e}
function i(e,t){return 3*t-6*e}
function s(e){return 3*e}
function l(e,t,r){return((o(t,r)*e+i(t,r))*e+s(t))*e}
function u(e,t,r){return 3*o(t,r)*e*e+2*i(t,r)*e+s(t)}
function c(t,r){for(var n=0;m>n;++n){var o=u(r,e,a);if(0===o)return r;var i=l(r,e,a)-t;r-=i/o}
return r}
function p(){for(var t=0;b>t;++t)w[t]=l(t*x,e,a)}
function f(t,r,n){var o,i,s=0;do i=r+(n-r)/2,o=l(i,e,a)-t,o>0?n=i:r=i;while(Math.abs(o)>h&&++s<v);return i}
function d(t){for(var r=0,n=1,o=b-1;n!=o&&w[n]<=t;++n)r+=x;--n;var i=(t-w[n])/(w[n+1]-w[n]),s=r+i*x,l=u(s,e,a);return l>=y?c(t,s):0==l?s:f(t,r,r+x)}
function g(){V=!0,(e!=r||a!=n)&&p()}
var m=4,y=.001,h=1e-7,v=10,b=11,x=1/(b-1),S="Float32Array"in t;if(4!==arguments.length)return!1;for(var P=0;4>P;++P)if("number"!=typeof arguments[P]||isNaN(arguments[P])||!isFinite(arguments[P]))return!1;e=Math.min(e,1),a=Math.min(a,1),e=Math.max(e,0),a=Math.max(a,0);var w=S?new Float32Array(b):new Array(b),V=!1,C=function(t){return V||g(),e===r&&a===n?t:0===t?0:1===t?1:l(d(t),r,n)};C.getControlPoints=function(){return[{x:e,y:r},{x:a,y:n}]};var T="generateBezier("+[e,r,a,n]+")";return C.toString=function(){return T},C}
function u(e,t){var r=e;return m.isString(e)?b.Easings[e]||(r=!1):r=m.isArray(e)&&1===e.length?s.apply(null,e):m.isArray(e)&&2===e.length?x.apply(null,e.concat([t])):m.isArray(e)&&4===e.length?l.apply(null,e):!1,r===!1&&(r=b.Easings[b.defaults.easing]?b.defaults.easing:v),r}
function c(e){if(e){var t=(new Date).getTime(),r=b.State.calls.length;r>1e4&&(b.State.calls=n(b.State.calls));for(var o=0;r>o;o++)if(b.State.calls[o]){var s=b.State.calls[o],l=s[0],u=s[2],d=s[3],g=!!d,y=null;d||(d=b.State.calls[o][3]=t-16);for(var h=Math.min((t-d)/u.duration,1),v=0,x=l.length;x>v;v++){var P=l[v],V=P.element;if(i(V)){var C=!1;if(u.display!==a&&null!==u.display&&"none"!==u.display){if("flex"===u.display){var T=["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex"];f.each(T,function(e,t){S.setPropertyValue(V,"display",t)})}
S.setPropertyValue(V,"display",u.display)}
u.visibility!==a&&"hidden"!==u.visibility&&S.setPropertyValue(V,"visibility",u.visibility);for(var k in P)if("element"!==k){var A,F=P[k],j=m.isString(F.easing)?b.Easings[F.easing]:F.easing;if(1===h)A=F.endValue;else{var E=F.endValue-F.startValue;if(A=F.startValue+E*j(h,u,E),!g&&A===F.currentValue)continue}
if(F.currentValue=A,"tween"===k)y=A;else{if(S.Hooks.registered[k]){var H=S.Hooks.getRoot(k),N=i(V).rootPropertyValueCache[H];N&&(F.rootPropertyValue=N)}
var L=S.setPropertyValue(V,k,F.currentValue+(0===parseFloat(A)?"":F.unitType),F.rootPropertyValue,F.scrollData);S.Hooks.registered[k]&&(i(V).rootPropertyValueCache[H]=S.Normalizations.registered[H]?S.Normalizations.registered[H]("extract",null,L[1]):L[1]),"transform"===L[0]&&(C=!0)}}
u.mobileHA&&i(V).transformCache.translate3d===a&&(i(V).transformCache.translate3d="(0px, 0px, 0px)",C=!0),C&&S.flushTransformCache(V)}}
u.display!==a&&"none"!==u.display&&(b.State.calls[o][2].display=!1),u.visibility!==a&&"hidden"!==u.visibility&&(b.State.calls[o][2].visibility=!1),u.progress&&u.progress.call(s[1],s[1],h,Math.max(0,d+u.duration-t),d,y),1===h&&p(o)}}
b.State.isTicking&&w(c)}
function p(e,t){if(!b.State.calls[e])return!1;for(var r=b.State.calls[e][0],n=b.State.calls[e][1],o=b.State.calls[e][2],s=b.State.calls[e][4],l=!1,u=0,c=r.length;c>u;u++){var p=r[u].element;if(t||o.loop||("none"===o.display&&S.setPropertyValue(p,"display",o.display),"hidden"===o.visibility&&S.setPropertyValue(p,"visibility",o.visibility)),o.loop!==!0&&(f.queue(p)[1]===a||!/\.velocityQueueEntryFlag/i.test(f.queue(p)[1]))&&i(p)){i(p).isAnimating=!1,i(p).rootPropertyValueCache={};var d=!1;f.each(S.Lists.transforms3D,function(e,t){var r=/^scale/.test(t)?1:0,n=i(p).transformCache[t];i(p).transformCache[t]!==a&&new RegExp("^\\("+r+"[^.]").test(n)&&(d=!0,delete i(p).transformCache[t])}),o.mobileHA&&(d=!0,delete i(p).transformCache.translate3d),d&&S.flushTransformCache(p),S.Values.removeClass(p,"velocity-animating")}
if(!t&&o.complete&&!o.loop&&u===c-1)try{o.complete.call(n,n)}catch(g){setTimeout(function(){throw g},1)}
s&&o.loop!==!0&&s(n),i(p)&&o.loop===!0&&!t&&(f.each(i(p).tweensContainer,function(e,t){/^rotate/.test(e)&&360===parseFloat(t.endValue)&&(t.endValue=0,t.startValue=360),/^backgroundPosition/.test(e)&&100===parseFloat(t.endValue)&&"%"===t.unitType&&(t.endValue=0,t.startValue=100)}),b(p,"reverse",{loop:!0,delay:o.delay})),o.queue!==!1&&f.dequeue(p,o.queue)}
b.State.calls[e]=!1;for(var m=0,y=b.State.calls.length;y>m;m++)if(b.State.calls[m]!==!1){l=!0;break}
l===!1&&(b.State.isTicking=!1,delete b.State.calls,b.State.calls=[])}
var f,d=function(){if(r.documentMode)return r.documentMode;for(var e=7;e>4;e--){var t=r.createElement("div");if(t.innerHTML="<!--[if IE "+e+"]><span></span><![endif]-->",t.getElementsByTagName("span").length)return t=null,e}
return a}(),g=function(){var e=0;return t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||function(t){var r,a=(new Date).getTime();return r=Math.max(0,16-(a-e)),e=a+r,setTimeout(function(){t(a+r)},r)}}(),m={isString:function(e){return"string"==typeof e},isArray:Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)},isNode:function(e){return e&&e.nodeType},isNodeList:function(e){return"object"==typeof e&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(Object.prototype.toString.call(e))&&e.length!==a&&(0===e.length||"object"==typeof e[0]&&e[0].nodeType>0)},isWrapped:function(e){return e&&(e.jquery||t.Zepto&&t.Zepto.zepto.isZ(e))},isSVG:function(e){return t.SVGElement&&e instanceof t.SVGElement},isEmptyObject:function(e){for(var t in e)return!1;return!0}},y=!1;if(e.fn&&e.fn.jquery?(f=e,y=!0):f=t.Velocity.Utilities,8>=d&&!y)throw new Error("Velocity: IE8 and below require jQuery to be loaded before Velocity.");if(7>=d)return void(jQuery.fn.velocity=jQuery.fn.animate);var h=400,v="swing",b={State:{isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),isAndroid:/Android/i.test(navigator.userAgent),isGingerbread:/Android 2\.3\.[3-7]/i.test(navigator.userAgent),isChrome:t.chrome,isFirefox:/Firefox/i.test(navigator.userAgent),prefixElement:r.createElement("div"),prefixMatches:{},scrollAnchor:null,scrollPropertyLeft:null,scrollPropertyTop:null,isTicking:!1,calls:[]},CSS:{},Utilities:f,Redirects:{},Easings:{},Promise:t.Promise,defaults:{queue:"",duration:h,easing:v,begin:a,complete:a,progress:a,display:a,visibility:a,loop:!1,delay:!1,mobileHA:!0,_cacheValues:!0},init:function(e){f.data(e,"velocity",{isSVG:m.isSVG(e),isAnimating:!1,computedStyle:null,tweensContainer:null,rootPropertyValueCache:{},transformCache:{}})},hook:null,mock:!1,version:{major:1,minor:2,patch:2},debug:!1};t.pageYOffset!==a?(b.State.scrollAnchor=t,b.State.scrollPropertyLeft="pageXOffset",b.State.scrollPropertyTop="pageYOffset"):(b.State.scrollAnchor=r.documentElement||r.body.parentNode||r.body,b.State.scrollPropertyLeft="scrollLeft",b.State.scrollPropertyTop="scrollTop");var x=function(){function e(e){return-e.tension*e.x-e.friction*e.v}
function t(t,r,a){var n={x:t.x+a.dx*r,v:t.v+a.dv*r,tension:t.tension,friction:t.friction};return{dx:n.v,dv:e(n)}}
function r(r,a){var n={dx:r.v,dv:e(r)},o=t(r,.5*a,n),i=t(r,.5*a,o),s=t(r,a,i),l=1/6*(n.dx+2*(o.dx+i.dx)+s.dx),u=1/6*(n.dv+2*(o.dv+i.dv)+s.dv);return r.x=r.x+l*a,r.v=r.v+u*a,r}
return function a(e,t,n){var o,i,s,l={x:-1,v:0,tension:null,friction:null},u=[0],c=0,p=1e-4,f=.016;for(e=parseFloat(e)||500,t=parseFloat(t)||20,n=n||null,l.tension=e,l.friction=t,o=null!==n,o?(c=a(e,t),i=c/n*f):i=f;s=r(s||l,i),u.push(1+s.x),c+=16,Math.abs(s.x)>p&&Math.abs(s.v)>p;);return o?function(e){return u[e*(u.length-1)|0]}:c}}();b.Easings={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},spring:function(e){return 1-Math.cos(4.5*e*Math.PI)*Math.exp(6*-e)}},f.each([["ease",[.25,.1,.25,1]],["ease-in",[.42,0,1,1]],["ease-out",[0,0,.58,1]],["ease-in-out",[.42,0,.58,1]],["easeInSine",[.47,0,.745,.715]],["easeOutSine",[.39,.575,.565,1]],["easeInOutSine",[.445,.05,.55,.95]],["easeInQuad",[.55,.085,.68,.53]],["easeOutQuad",[.25,.46,.45,.94]],["easeInOutQuad",[.455,.03,.515,.955]],["easeInCubic",[.55,.055,.675,.19]],["easeOutCubic",[.215,.61,.355,1]],["easeInOutCubic",[.645,.045,.355,1]],["easeInQuart",[.895,.03,.685,.22]],["easeOutQuart",[.165,.84,.44,1]],["easeInOutQuart",[.77,0,.175,1]],["easeInQuint",[.755,.05,.855,.06]],["easeOutQuint",[.23,1,.32,1]],["easeInOutQuint",[.86,0,.07,1]],["easeInExpo",[.95,.05,.795,.035]],["easeOutExpo",[.19,1,.22,1]],["easeInOutExpo",[1,0,0,1]],["easeInCirc",[.6,.04,.98,.335]],["easeOutCirc",[.075,.82,.165,1]],["easeInOutCirc",[.785,.135,.15,.86]]],function(e,t){b.Easings[t[0]]=l.apply(null,t[1])});var S=b.CSS={RegEx:{isHex:/^#([A-f\d]{3}){1,2}$/i,valueUnwrap:/^[A-z]+\((.*)\)$/i,wrappedValueAlreadyExtracted:/[0-9.]+ [0-9.]+ [0-9.]+( [0-9.]+)?/,valueSplit:/([A-z]+\(.+\))|(([A-z0-9#-.]+?)(?=\s|$))/gi},Lists:{colors:["fill","stroke","stopColor","color","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","outlineColor"],transformsBase:["translateX","translateY","scale","scaleX","scaleY","skewX","skewY","rotateZ"],transforms3D:["transformPerspective","translateZ","scaleZ","rotateX","rotateY"]},Hooks:{templates:{textShadow:["Color X Y Blur","black 0px 0px 0px"],boxShadow:["Color X Y Blur Spread","black 0px 0px 0px 0px"],clip:["Top Right Bottom Left","0px 0px 0px 0px"],backgroundPosition:["X Y","0% 0%"],transformOrigin:["X Y Z","50% 50% 0px"],perspectiveOrigin:["X Y","50% 50%"]},registered:{},register:function(){for(var e=0;e<S.Lists.colors.length;e++){var t="color"===S.Lists.colors[e]?"0 0 0 1":"255 255 255 1";S.Hooks.templates[S.Lists.colors[e]]=["Red Green Blue Alpha",t]}
var r,a,n;if(d)for(r in S.Hooks.templates){a=S.Hooks.templates[r],n=a[0].split(" ");var o=a[1].match(S.RegEx.valueSplit);"Color"===n[0]&&(n.push(n.shift()),o.push(o.shift()),S.Hooks.templates[r]=[n.join(" "),o.join(" ")])}
for(r in S.Hooks.templates){a=S.Hooks.templates[r],n=a[0].split(" ");for(var e in n){var i=r+n[e],s=e;S.Hooks.registered[i]=[r,s]}}},getRoot:function(e){var t=S.Hooks.registered[e];return t?t[0]:e},cleanRootPropertyValue:function(e,t){return S.RegEx.valueUnwrap.test(t)&&(t=t.match(S.RegEx.valueUnwrap)[1]),S.Values.isCSSNullValue(t)&&(t=S.Hooks.templates[e][1]),t},extractValue:function(e,t){var r=S.Hooks.registered[e];if(r){var a=r[0],n=r[1];return t=S.Hooks.cleanRootPropertyValue(a,t),t.toString().match(S.RegEx.valueSplit)[n]}
return t},injectValue:function(e,t,r){var a=S.Hooks.registered[e];if(a){var n,o,i=a[0],s=a[1];return r=S.Hooks.cleanRootPropertyValue(i,r),n=r.toString().match(S.RegEx.valueSplit),n[s]=t,o=n.join(" ")}
return r}},Normalizations:{registered:{clip:function(e,t,r){switch(e){case"name":return"clip";case"extract":var a;return S.RegEx.wrappedValueAlreadyExtracted.test(r)?a=r:(a=r.toString().match(S.RegEx.valueUnwrap),a=a?a[1].replace(/,(\s+)?/g," "):r),a;case"inject":return"rect("+r+")"}},blur:function(e,t,r){switch(e){case"name":return b.State.isFirefox?"filter":"-webkit-filter";case"extract":var a=parseFloat(r);if(!a&&0!==a){var n=r.toString().match(/blur\(([0-9]+[A-z]+)\)/i);a=n?n[1]:0}
return a;case"inject":return parseFloat(r)?"blur("+r+")":"none"}},opacity:function(e,t,r){if(8>=d)switch(e){case"name":return"filter";case"extract":var a=r.toString().match(/alpha\(opacity=(.*)\)/i);return r=a?a[1]/100:1;case"inject":return t.style.zoom=1,parseFloat(r)>=1?"":"alpha(opacity="+parseInt(100*parseFloat(r),10)+")"}else switch(e){case"name":return"opacity";case"extract":return r;case"inject":return r}}},register:function(){9>=d||b.State.isGingerbread||(S.Lists.transformsBase=S.Lists.transformsBase.concat(S.Lists.transforms3D));for(var e=0;e<S.Lists.transformsBase.length;e++)!function(){var t=S.Lists.transformsBase[e];S.Normalizations.registered[t]=function(e,r,n){switch(e){case"name":return"transform";case"extract":return i(r)===a||i(r).transformCache[t]===a?/^scale/i.test(t)?1:0:i(r).transformCache[t].replace(/[()]/g,"");case"inject":var o=!1;switch(t.substr(0,t.length-1)){case"translate":o=!/(%|px|em|rem|vw|vh|\d)$/i.test(n);break;case"scal":case"scale":b.State.isAndroid&&i(r).transformCache[t]===a&&1>n&&(n=1),o=!/(\d)$/i.test(n);break;case"skew":o=!/(deg|\d)$/i.test(n);break;case"rotate":o=!/(deg|\d)$/i.test(n)}
return o||(i(r).transformCache[t]="("+n+")"),i(r).transformCache[t]}}}();for(var e=0;e<S.Lists.colors.length;e++)!function(){var t=S.Lists.colors[e];S.Normalizations.registered[t]=function(e,r,n){switch(e){case"name":return t;case"extract":var o;if(S.RegEx.wrappedValueAlreadyExtracted.test(n))o=n;else{var i,s={black:"rgb(0, 0, 0)",blue:"rgb(0, 0, 255)",gray:"rgb(128, 128, 128)",green:"rgb(0, 128, 0)",red:"rgb(255, 0, 0)",white:"rgb(255, 255, 255)"};/^[A-z]+$/i.test(n)?i=s[n]!==a?s[n]:s.black:S.RegEx.isHex.test(n)?i="rgb("+S.Values.hexToRgb(n).join(" ")+")":/^rgba?\(/i.test(n)||(i=s.black),o=(i||n).toString().match(S.RegEx.valueUnwrap)[1].replace(/,(\s+)?/g," ")}
return 8>=d||3!==o.split(" ").length||(o+=" 1"),o;case"inject":return 8>=d?4===n.split(" ").length&&(n=n.split(/\s+/).slice(0,3).join(" ")):3===n.split(" ").length&&(n+=" 1"),(8>=d?"rgb":"rgba")+"("+n.replace(/\s+/g,",").replace(/\.(\d)+(?=,)/g,"")+")"}}}()}},Names:{camelCase:function(e){return e.replace(/-(\w)/g,function(e,t){return t.toUpperCase()})},SVGAttribute:function(e){var t="width|height|x|y|cx|cy|r|rx|ry|x1|x2|y1|y2";return(d||b.State.isAndroid&&!b.State.isChrome)&&(t+="|transform"),new RegExp("^("+t+")$","i").test(e)},prefixCheck:function(e){if(b.State.prefixMatches[e])return[b.State.prefixMatches[e],!0];for(var t=["","Webkit","Moz","ms","O"],r=0,a=t.length;a>r;r++){var n;if(n=0===r?e:t[r]+e.replace(/^\w/,function(e){return e.toUpperCase()}),m.isString(b.State.prefixElement.style[n]))return b.State.prefixMatches[e]=n,[n,!0]}
return[e,!1]}},Values:{hexToRgb:function(e){var t,r=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;return e=e.replace(r,function(e,t,r,a){return t+t+r+r+a+a}),t=a.exec(e),t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:[0,0,0]},isCSSNullValue:function(e){return 0==e||/^(none|auto|transparent|(rgba\(0, ?0, ?0, ?0\)))$/i.test(e)},getUnitType:function(e){return/^(rotate|skew)/i.test(e)?"deg":/(^(scale|scaleX|scaleY|scaleZ|alpha|flexGrow|flexHeight|zIndex|fontWeight)$)|((opacity|red|green|blue|alpha)$)/i.test(e)?"":"px"},getDisplayType:function(e){var t=e&&e.tagName.toString().toLowerCase();return/^(b|big|i|small|tt|abbr|acronym|cite|code|dfn|em|kbd|strong|samp|var|a|bdo|br|img|map|object|q|script|span|sub|sup|button|input|label|select|textarea)$/i.test(t)?"inline":/^(li)$/i.test(t)?"list-item":/^(tr)$/i.test(t)?"table-row":/^(table)$/i.test(t)?"table":/^(tbody)$/i.test(t)?"table-row-group":"block"},addClass:function(e,t){e.classList?e.classList.add(t):e.className+=(e.className.length?" ":"")+t},removeClass:function(e,t){e.classList?e.classList.remove(t):e.className=e.className.toString().replace(new RegExp("(^|\\s)"+t.split(" ").join("|")+"(\\s|$)","gi")," ")}},getPropertyValue:function(e,r,n,o){function s(e,r){function n(){u&&S.setPropertyValue(e,"display","none")}
var l=0;if(8>=d)l=f.css(e,r);else{var u=!1;if(/^(width|height)$/.test(r)&&0===S.getPropertyValue(e,"display")&&(u=!0,S.setPropertyValue(e,"display",S.Values.getDisplayType(e))),!o){if("height"===r&&"border-box"!==S.getPropertyValue(e,"boxSizing").toString().toLowerCase()){var c=e.offsetHeight-(parseFloat(S.getPropertyValue(e,"borderTopWidth"))||0)-(parseFloat(S.getPropertyValue(e,"borderBottomWidth"))||0)-(parseFloat(S.getPropertyValue(e,"paddingTop"))||0)-(parseFloat(S.getPropertyValue(e,"paddingBottom"))||0);return n(),c}
if("width"===r&&"border-box"!==S.getPropertyValue(e,"boxSizing").toString().toLowerCase()){var p=e.offsetWidth-(parseFloat(S.getPropertyValue(e,"borderLeftWidth"))||0)-(parseFloat(S.getPropertyValue(e,"borderRightWidth"))||0)-(parseFloat(S.getPropertyValue(e,"paddingLeft"))||0)-(parseFloat(S.getPropertyValue(e,"paddingRight"))||0);return n(),p}}
var g;g=i(e)===a?t.getComputedStyle(e,null):i(e).computedStyle?i(e).computedStyle:i(e).computedStyle=t.getComputedStyle(e,null),"borderColor"===r&&(r="borderTopColor"),l=9===d&&"filter"===r?g.getPropertyValue(r):g[r],(""===l||null===l)&&(l=e.style[r]),n()}
if("auto"===l&&/^(top|right|bottom|left)$/i.test(r)){var m=s(e,"position");("fixed"===m||"absolute"===m&&/top|left/i.test(r))&&(l=f(e).position()[r]+"px")}
return l}
var l;if(S.Hooks.registered[r]){var u=r,c=S.Hooks.getRoot(u);n===a&&(n=S.getPropertyValue(e,S.Names.prefixCheck(c)[0])),S.Normalizations.registered[c]&&(n=S.Normalizations.registered[c]("extract",e,n)),l=S.Hooks.extractValue(u,n)}else if(S.Normalizations.registered[r]){var p,g;p=S.Normalizations.registered[r]("name",e),"transform"!==p&&(g=s(e,S.Names.prefixCheck(p)[0]),S.Values.isCSSNullValue(g)&&S.Hooks.templates[r]&&(g=S.Hooks.templates[r][1])),l=S.Normalizations.registered[r]("extract",e,g)}
if(!/^[\d-]/.test(l))if(i(e)&&i(e).isSVG&&S.Names.SVGAttribute(r))if(/^(height|width)$/i.test(r))try{l=e.getBBox()[r]}catch(m){l=0}else l=e.getAttribute(r);else l=s(e,S.Names.prefixCheck(r)[0]);return S.Values.isCSSNullValue(l)&&(l=0),b.debug>=2&&console.log("Get "+r+": "+l),l},setPropertyValue:function(e,r,a,n,o){var s=r;if("scroll"===r)o.container?o.container["scroll"+o.direction]=a:"Left"===o.direction?t.scrollTo(a,o.alternateValue):t.scrollTo(o.alternateValue,a);else if(S.Normalizations.registered[r]&&"transform"===S.Normalizations.registered[r]("name",e))S.Normalizations.registered[r]("inject",e,a),s="transform",a=i(e).transformCache[r];else{if(S.Hooks.registered[r]){var l=r,u=S.Hooks.getRoot(r);n=n||S.getPropertyValue(e,u),a=S.Hooks.injectValue(l,a,n),r=u}
if(S.Normalizations.registered[r]&&(a=S.Normalizations.registered[r]("inject",e,a),r=S.Normalizations.registered[r]("name",e)),s=S.Names.prefixCheck(r)[0],8>=d)try{e.style[s]=a}catch(c){b.debug&&console.log("Browser does not support ["+a+"] for ["+s+"]")}else i(e)&&i(e).isSVG&&S.Names.SVGAttribute(r)?e.setAttribute(r,a):e.style[s]=a;b.debug>=2&&console.log("Set "+r+" ("+s+"): "+a)}
return[s,a]},flushTransformCache:function(e){function t(t){return parseFloat(S.getPropertyValue(e,t))}
var r="";if((d||b.State.isAndroid&&!b.State.isChrome)&&i(e).isSVG){var a={translate:[t("translateX"),t("translateY")],skewX:[t("skewX")],skewY:[t("skewY")],scale:1!==t("scale")?[t("scale"),t("scale")]:[t("scaleX"),t("scaleY")],rotate:[t("rotateZ"),0,0]};f.each(i(e).transformCache,function(e){/^translate/i.test(e)?e="translate":/^scale/i.test(e)?e="scale":/^rotate/i.test(e)&&(e="rotate"),a[e]&&(r+=e+"("+a[e].join(" ")+") ",delete a[e])})}else{var n,o;f.each(i(e).transformCache,function(t){return n=i(e).transformCache[t],"transformPerspective"===t?(o=n,!0):(9===d&&"rotateZ"===t&&(t="rotate"),void(r+=t+n+" "))}),o&&(r="perspective"+o+" "+r)}
S.setPropertyValue(e,"transform",r)}};S.Hooks.register(),S.Normalizations.register(),b.hook=function(e,t,r){var n=a;return e=o(e),f.each(e,function(e,o){if(i(o)===a&&b.init(o),r===a)n===a&&(n=b.CSS.getPropertyValue(o,t));else{var s=b.CSS.setPropertyValue(o,t,r);"transform"===s[0]&&b.CSS.flushTransformCache(o),n=s}}),n};var P=function(){function e(){return s?k.promise||null:l}
function n(){function e(e){function p(e,t){var r=a,n=a,i=a;return m.isArray(e)?(r=e[0],!m.isArray(e[1])&&/^[\d-]/.test(e[1])||m.isFunction(e[1])||S.RegEx.isHex.test(e[1])?i=e[1]:(m.isString(e[1])&&!S.RegEx.isHex.test(e[1])||m.isArray(e[1]))&&(n=t?e[1]:u(e[1],s.duration),e[2]!==a&&(i=e[2]))):r=e,t||(n=n||s.easing),m.isFunction(r)&&(r=r.call(o,V,w)),m.isFunction(i)&&(i=i.call(o,V,w)),[r||0,n,i]}
function d(e,t){var r,a;return a=(t||"0").toString().toLowerCase().replace(/[%A-z]+$/,function(e){return r=e,""}),r||(r=S.Values.getUnitType(e)),[a,r]}
function h(){var e={myParent:o.parentNode||r.body,position:S.getPropertyValue(o,"position"),fontSize:S.getPropertyValue(o,"fontSize")},a=e.position===L.lastPosition&&e.myParent===L.lastParent,n=e.fontSize===L.lastFontSize;L.lastParent=e.myParent,L.lastPosition=e.position,L.lastFontSize=e.fontSize;var s=100,l={};if(n&&a)l.emToPx=L.lastEmToPx,l.percentToPxWidth=L.lastPercentToPxWidth,l.percentToPxHeight=L.lastPercentToPxHeight;else{var u=i(o).isSVG?r.createElementNS("http://www.w3.org/2000/svg","rect"):r.createElement("div");b.init(u),e.myParent.appendChild(u),f.each(["overflow","overflowX","overflowY"],function(e,t){b.CSS.setPropertyValue(u,t,"hidden")}),b.CSS.setPropertyValue(u,"position",e.position),b.CSS.setPropertyValue(u,"fontSize",e.fontSize),b.CSS.setPropertyValue(u,"boxSizing","content-box"),f.each(["minWidth","maxWidth","width","minHeight","maxHeight","height"],function(e,t){b.CSS.setPropertyValue(u,t,s+"%")}),b.CSS.setPropertyValue(u,"paddingLeft",s+"em"),l.percentToPxWidth=L.lastPercentToPxWidth=(parseFloat(S.getPropertyValue(u,"width",null,!0))||1)/s,l.percentToPxHeight=L.lastPercentToPxHeight=(parseFloat(S.getPropertyValue(u,"height",null,!0))||1)/s,l.emToPx=L.lastEmToPx=(parseFloat(S.getPropertyValue(u,"paddingLeft"))||1)/s,e.myParent.removeChild(u)}
return null===L.remToPx&&(L.remToPx=parseFloat(S.getPropertyValue(r.body,"fontSize"))||16),null===L.vwToPx&&(L.vwToPx=parseFloat(t.innerWidth)/100,L.vhToPx=parseFloat(t.innerHeight)/100),l.remToPx=L.remToPx,l.vwToPx=L.vwToPx,l.vhToPx=L.vhToPx,b.debug>=1&&console.log("Unit ratios: "+JSON.stringify(l),o),l}
if(s.begin&&0===V)try{s.begin.call(g,g)}catch(x){setTimeout(function(){throw x},1)}
if("scroll"===A){var P,C,T,F=/^x$/i.test(s.axis)?"Left":"Top",j=parseFloat(s.offset)||0;s.container?m.isWrapped(s.container)||m.isNode(s.container)?(s.container=s.container[0]||s.container,P=s.container["scroll"+F],T=P+f(o).position()[F.toLowerCase()]+j):s.container=null:(P=b.State.scrollAnchor[b.State["scrollProperty"+F]],C=b.State.scrollAnchor[b.State["scrollProperty"+("Left"===F?"Top":"Left")]],T=f(o).offset()[F.toLowerCase()]+j),l={scroll:{rootPropertyValue:!1,startValue:P,currentValue:P,endValue:T,unitType:"",easing:s.easing,scrollData:{container:s.container,direction:F,alternateValue:C}},element:o},b.debug&&console.log("tweensContainer (scroll): ",l.scroll,o)}else if("reverse"===A){if(!i(o).tweensContainer)return void f.dequeue(o,s.queue);"none"===i(o).opts.display&&(i(o).opts.display="auto"),"hidden"===i(o).opts.visibility&&(i(o).opts.visibility="visible"),i(o).opts.loop=!1,i(o).opts.begin=null,i(o).opts.complete=null,v.easing||delete s.easing,v.duration||delete s.duration,s=f.extend({},i(o).opts,s);var E=f.extend(!0,{},i(o).tweensContainer);for(var H in E)if("element"!==H){var N=E[H].startValue;E[H].startValue=E[H].currentValue=E[H].endValue,E[H].endValue=N,m.isEmptyObject(v)||(E[H].easing=s.easing),b.debug&&console.log("reverse tweensContainer ("+H+"): "+JSON.stringify(E[H]),o)}
l=E}else if("start"===A){var E;i(o).tweensContainer&&i(o).isAnimating===!0&&(E=i(o).tweensContainer),f.each(y,function(e,t){if(RegExp("^"+S.Lists.colors.join("$|^")+"$").test(e)){var r=p(t,!0),n=r[0],o=r[1],i=r[2];if(S.RegEx.isHex.test(n)){for(var s=["Red","Green","Blue"],l=S.Values.hexToRgb(n),u=i?S.Values.hexToRgb(i):a,c=0;c<s.length;c++){var f=[l[c]];o&&f.push(o),u!==a&&f.push(u[c]),y[e+s[c]]=f}
delete y[e]}}});for(var z in y){var O=p(y[z]),q=O[0],$=O[1],M=O[2];z=S.Names.camelCase(z);var I=S.Hooks.getRoot(z),B=!1;if(i(o).isSVG||"tween"===I||S.Names.prefixCheck(I)[1]!==!1||S.Normalizations.registered[I]!==a){(s.display!==a&&null!==s.display&&"none"!==s.display||s.visibility!==a&&"hidden"!==s.visibility)&&/opacity|filter/.test(z)&&!M&&0!==q&&(M=0),s._cacheValues&&E&&E[z]?(M===a&&(M=E[z].endValue+E[z].unitType),B=i(o).rootPropertyValueCache[I]):S.Hooks.registered[z]?M===a?(B=S.getPropertyValue(o,I),M=S.getPropertyValue(o,z,B)):B=S.Hooks.templates[I][1]:M===a&&(M=S.getPropertyValue(o,z));var W,G,Y,D=!1;if(W=d(z,M),M=W[0],Y=W[1],W=d(z,q),q=W[0].replace(/^([+-\/*])=/,function(e,t){return D=t,""}),G=W[1],M=parseFloat(M)||0,q=parseFloat(q)||0,"%"===G&&(/^(fontSize|lineHeight)$/.test(z)?(q/=100,G="em"):/^scale/.test(z)?(q/=100,G=""):/(Red|Green|Blue)$/i.test(z)&&(q=q/100*255,G="")),/[\/*]/.test(D))G=Y;else if(Y!==G&&0!==M)if(0===q)G=Y;else{n=n||h();var Q=/margin|padding|left|right|width|text|word|letter/i.test(z)||/X$/.test(z)||"x"===z?"x":"y";switch(Y){case"%":M*="x"===Q?n.percentToPxWidth:n.percentToPxHeight;break;case"px":break;default:M*=n[Y+"ToPx"]}
switch(G){case"%":M*=1/("x"===Q?n.percentToPxWidth:n.percentToPxHeight);break;case"px":break;default:M*=1/n[G+"ToPx"]}}
switch(D){case"+":q=M+q;break;case"-":q=M-q;break;case"*":q=M*q;break;case"/":q=M/q}
l[z]={rootPropertyValue:B,startValue:M,currentValue:M,endValue:q,unitType:G,easing:$},b.debug&&console.log("tweensContainer ("+z+"): "+JSON.stringify(l[z]),o)}else b.debug&&console.log("Skipping ["+I+"] due to a lack of browser support.")}
l.element=o}
l.element&&(S.Values.addClass(o,"velocity-animating"),R.push(l),""===s.queue&&(i(o).tweensContainer=l,i(o).opts=s),i(o).isAnimating=!0,V===w-1?(b.State.calls.push([R,g,s,null,k.resolver]),b.State.isTicking===!1&&(b.State.isTicking=!0,c())):V++)}
var n,o=this,s=f.extend({},b.defaults,v),l={};switch(i(o)===a&&b.init(o),parseFloat(s.delay)&&s.queue!==!1&&f.queue(o,s.queue,function(e){b.velocityQueueEntryFlag=!0,i(o).delayTimer={setTimeout:setTimeout(e,parseFloat(s.delay)),next:e}}),s.duration.toString().toLowerCase()){case"fast":s.duration=200;break;case"normal":s.duration=h;break;case"slow":s.duration=600;break;default:s.duration=parseFloat(s.duration)||1}
b.mock!==!1&&(b.mock===!0?s.duration=s.delay=1:(s.duration*=parseFloat(b.mock)||1,s.delay*=parseFloat(b.mock)||1)),s.easing=u(s.easing,s.duration),s.begin&&!m.isFunction(s.begin)&&(s.begin=null),s.progress&&!m.isFunction(s.progress)&&(s.progress=null),s.complete&&!m.isFunction(s.complete)&&(s.complete=null),s.display!==a&&null!==s.display&&(s.display=s.display.toString().toLowerCase(),"auto"===s.display&&(s.display=b.CSS.Values.getDisplayType(o))),s.visibility!==a&&null!==s.visibility&&(s.visibility=s.visibility.toString().toLowerCase()),s.mobileHA=s.mobileHA&&b.State.isMobile&&!b.State.isGingerbread,s.queue===!1?s.delay?setTimeout(e,s.delay):e():f.queue(o,s.queue,function(t,r){return r===!0?(k.promise&&k.resolver(g),!0):(b.velocityQueueEntryFlag=!0,void e(t))}),""!==s.queue&&"fx"!==s.queue||"inprogress"===f.queue(o)[0]||f.dequeue(o)}
var s,l,d,g,y,v,x=arguments[0]&&(arguments[0].p||f.isPlainObject(arguments[0].properties)&&!arguments[0].properties.names||m.isString(arguments[0].properties));if(m.isWrapped(this)?(s=!1,d=0,g=this,l=this):(s=!0,d=1,g=x?arguments[0].elements||arguments[0].e:arguments[0]),g=o(g)){x?(y=arguments[0].properties||arguments[0].p,v=arguments[0].options||arguments[0].o):(y=arguments[d],v=arguments[d+1]);var w=g.length,V=0;if(!/^(stop|finish)$/i.test(y)&&!f.isPlainObject(v)){var C=d+1;v={};for(var T=C;T<arguments.length;T++)m.isArray(arguments[T])||!/^(fast|normal|slow)$/i.test(arguments[T])&&!/^\d/.test(arguments[T])?m.isString(arguments[T])||m.isArray(arguments[T])?v.easing=arguments[T]:m.isFunction(arguments[T])&&(v.complete=arguments[T]):v.duration=arguments[T]}
var k={promise:null,resolver:null,rejecter:null};s&&b.Promise&&(k.promise=new b.Promise(function(e,t){k.resolver=e,k.rejecter=t}));var A;switch(y){case"scroll":A="scroll";break;case"reverse":A="reverse";break;case"finish":case"stop":f.each(g,function(e,t){i(t)&&i(t).delayTimer&&(clearTimeout(i(t).delayTimer.setTimeout),i(t).delayTimer.next&&i(t).delayTimer.next(),delete i(t).delayTimer)});var F=[];return f.each(b.State.calls,function(e,t){t&&f.each(t[1],function(r,n){var o=v===a?"":v;return o===!0||t[2].queue===o||v===a&&t[2].queue===!1?void f.each(g,function(r,a){a===n&&((v===!0||m.isString(v))&&(f.each(f.queue(a,m.isString(v)?v:""),function(e,t){m.isFunction(t)&&t(null,!0)}),f.queue(a,m.isString(v)?v:"",[])),"stop"===y?(i(a)&&i(a).tweensContainer&&o!==!1&&f.each(i(a).tweensContainer,function(e,t){t.endValue=t.currentValue}),F.push(e)):"finish"===y&&(t[2].duration=1))}):!0})}),"stop"===y&&(f.each(F,function(e,t){p(t,!0)}),k.promise&&k.resolver(g)),e();default:if(!f.isPlainObject(y)||m.isEmptyObject(y)){if(m.isString(y)&&b.Redirects[y]){var j=f.extend({},v),E=j.duration,H=j.delay||0;return j.backwards===!0&&(g=f.extend(!0,[],g).reverse()),f.each(g,function(e,t){parseFloat(j.stagger)?j.delay=H+parseFloat(j.stagger)*e:m.isFunction(j.stagger)&&(j.delay=H+j.stagger.call(t,e,w)),j.drag&&(j.duration=parseFloat(E)||(/^(callout|transition)/.test(y)?1e3:h),j.duration=Math.max(j.duration*(j.backwards?1-e/w:(e+1)/w),.75*j.duration,200)),b.Redirects[y].call(t,t,j||{},e,w,g,k.promise?k:a)}),e()}
var N="Velocity: First argument ("+y+") was not a property map, a known action, or a registered redirect. Aborting.";return k.promise?k.rejecter(new Error(N)):console.log(N),e()}
A="start"}
var L={lastParent:null,lastPosition:null,lastFontSize:null,lastPercentToPxWidth:null,lastPercentToPxHeight:null,lastEmToPx:null,remToPx:null,vwToPx:null,vhToPx:null},R=[];f.each(g,function(e,t){m.isNode(t)&&n.call(t)});var z,j=f.extend({},b.defaults,v);if(j.loop=parseInt(j.loop),z=2*j.loop-1,j.loop)for(var O=0;z>O;O++){var q={delay:j.delay,progress:j.progress};O===z-1&&(q.display=j.display,q.visibility=j.visibility,q.complete=j.complete),P(g,"reverse",q)}
return e()}};b=f.extend(P,b),b.animate=P;var w=t.requestAnimationFrame||g;return b.State.isMobile||r.hidden===a||r.addEventListener("visibilitychange",function(){r.hidden?(w=function(e){return setTimeout(function(){e(!0)},16)},c()):w=t.requestAnimationFrame||g}),e.Velocity=b,e!==t&&(e.fn.velocity=P,e.fn.velocity.defaults=b.defaults),f.each(["Down","Up"],function(e,t){b.Redirects["slide"+t]=function(e,r,n,o,i,s){var l=f.extend({},r),u=l.begin,c=l.complete,p={height:"",marginTop:"",marginBottom:"",paddingTop:"",paddingBottom:""},d={};l.display===a&&(l.display="Down"===t?"inline"===b.CSS.Values.getDisplayType(e)?"inline-block":"block":"none"),l.begin=function(){u&&u.call(i,i);for(var r in p){d[r]=e.style[r];var a=b.CSS.getPropertyValue(e,r);p[r]="Down"===t?[a,0]:[0,a]}
d.overflow=e.style.overflow,e.style.overflow="hidden"},l.complete=function(){for(var t in d)e.style[t]=d[t];c&&c.call(i,i),s&&s.resolver(i)},b(e,p,l)}}),f.each(["In","Out"],function(e,t){b.Redirects["fade"+t]=function(e,r,n,o,i,s){var l=f.extend({},r),u={opacity:"In"===t?1:0},c=l.complete;l.complete=n!==o-1?l.begin=null:function(){c&&c.call(i,i),s&&s.resolver(i)},l.display===a&&(l.display="In"===t?"auto":"none"),b(this,u,l)}}),b}(window.jQuery||window.Zepto||window,window,document)}));;!function(a,b,c,d){"use strict";function k(a,b,c){return setTimeout(q(a,c),b)}
function l(a,b,c){return Array.isArray(a)?(m(a,c[b],c),!0):!1}
function m(a,b,c){var e;if(a)if(a.forEach)a.forEach(b,c);else if(a.length!==d)for(e=0;e<a.length;)b.call(c,a[e],e,a),e++;else for(e in a)a.hasOwnProperty(e)&&b.call(c,a[e],e,a)}
function n(a,b,c){for(var e=Object.keys(b),f=0;f<e.length;)(!c||c&&a[e[f]]===d)&&(a[e[f]]=b[e[f]]),f++;return a}
function o(a,b){return n(a,b,!0)}
function p(a,b,c){var e,d=b.prototype;e=a.prototype=Object.create(d),e.constructor=a,e._super=d,c&&n(e,c)}
function q(a,b){return function(){return a.apply(b,arguments)}}
function r(a,b){return typeof a==g?a.apply(b?b[0]||d:d,b):a}
function s(a,b){return a===d?b:a}
function t(a,b,c){m(x(b),function(b){a.addEventListener(b,c,!1)})}
function u(a,b,c){m(x(b),function(b){a.removeEventListener(b,c,!1)})}
function v(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}
return!1}
function w(a,b){return a.indexOf(b)>-1}
function x(a){return a.trim().split(/\s+/g)}
function y(a,b,c){if(a.indexOf&&!c)return a.indexOf(b);for(var d=0;d<a.length;){if(c&&a[d][c]==b||!c&&a[d]===b)return d;d++}
return-1}
function z(a){return Array.prototype.slice.call(a,0)}
function A(a,b,c){for(var d=[],e=[],f=0;f<a.length;){var g=b?a[f][b]:a[f];y(e,g)<0&&d.push(a[f]),e[f]=g,f++}
return c&&(d=b?d.sort(function(a,c){return a[b]>c[b]}):d.sort()),d}
function B(a,b){for(var c,f,g=b[0].toUpperCase()+b.slice(1),h=0;h<e.length;){if(c=e[h],f=c?c+g:b,f in a)return f;h++}
return d}
function D(){return C++}
function E(a){var b=a.ownerDocument;return b.defaultView||b.parentWindow}
function ab(a,b){var c=this;this.manager=a,this.callback=b,this.element=a.element,this.target=a.options.inputTarget,this.domHandler=function(b){r(a.options.enable,[a])&&c.handler(b)},this.init()}
function bb(a){var b,c=a.options.inputClass;return b=c?c:H?wb:I?Eb:G?Gb:rb,new b(a,cb)}
function cb(a,b,c){var d=c.pointers.length,e=c.changedPointers.length,f=b&O&&0===d-e,g=b&(Q|R)&&0===d-e;c.isFirst=!!f,c.isFinal=!!g,f&&(a.session={}),c.eventType=b,db(a,c),a.emit("hammer.input",c),a.recognize(c),a.session.prevInput=c}
function db(a,b){var c=a.session,d=b.pointers,e=d.length;c.firstInput||(c.firstInput=gb(b)),e>1&&!c.firstMultiple?c.firstMultiple=gb(b):1===e&&(c.firstMultiple=!1);var f=c.firstInput,g=c.firstMultiple,h=g?g.center:f.center,i=b.center=hb(d);b.timeStamp=j(),b.deltaTime=b.timeStamp-f.timeStamp,b.angle=lb(h,i),b.distance=kb(h,i),eb(c,b),b.offsetDirection=jb(b.deltaX,b.deltaY),b.scale=g?nb(g.pointers,d):1,b.rotation=g?mb(g.pointers,d):0,fb(c,b);var k=a.element;v(b.srcEvent.target,k)&&(k=b.srcEvent.target),b.target=k}
function eb(a,b){var c=b.center,d=a.offsetDelta||{},e=a.prevDelta||{},f=a.prevInput||{};(b.eventType===O||f.eventType===Q)&&(e=a.prevDelta={x:f.deltaX||0,y:f.deltaY||0},d=a.offsetDelta={x:c.x,y:c.y}),b.deltaX=e.x+(c.x-d.x),b.deltaY=e.y+(c.y-d.y)}
function fb(a,b){var f,g,h,j,c=a.lastInterval||b,e=b.timeStamp-c.timeStamp;if(b.eventType!=R&&(e>N||c.velocity===d)){var k=c.deltaX-b.deltaX,l=c.deltaY-b.deltaY,m=ib(e,k,l);g=m.x,h=m.y,f=i(m.x)>i(m.y)?m.x:m.y,j=jb(k,l),a.lastInterval=b}else f=c.velocity,g=c.velocityX,h=c.velocityY,j=c.direction;b.velocity=f,b.velocityX=g,b.velocityY=h,b.direction=j}
function gb(a){for(var b=[],c=0;c<a.pointers.length;)b[c]={clientX:h(a.pointers[c].clientX),clientY:h(a.pointers[c].clientY)},c++;return{timeStamp:j(),pointers:b,center:hb(b),deltaX:a.deltaX,deltaY:a.deltaY}}
function hb(a){var b=a.length;if(1===b)return{x:h(a[0].clientX),y:h(a[0].clientY)};for(var c=0,d=0,e=0;b>e;)c+=a[e].clientX,d+=a[e].clientY,e++;return{x:h(c/b),y:h(d/b)}}
function ib(a,b,c){return{x:b/a||0,y:c/a||0}}
function jb(a,b){return a===b?S:i(a)>=i(b)?a>0?T:U:b>0?V:W}
function kb(a,b,c){c||(c=$);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return Math.sqrt(d*d+e*e)}
function lb(a,b,c){c||(c=$);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return 180*Math.atan2(e,d)/Math.PI}
function mb(a,b){return lb(b[1],b[0],_)-lb(a[1],a[0],_)}
function nb(a,b){return kb(b[0],b[1],_)/kb(a[0],a[1],_)}
function rb(){this.evEl=pb,this.evWin=qb,this.allow=!0,this.pressed=!1,ab.apply(this,arguments)}
function wb(){this.evEl=ub,this.evWin=vb,ab.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}
function Ab(){this.evTarget=yb,this.evWin=zb,this.started=!1,ab.apply(this,arguments)}
function Bb(a,b){var c=z(a.touches),d=z(a.changedTouches);return b&(Q|R)&&(c=A(c.concat(d),"identifier",!0)),[c,d]}
function Eb(){this.evTarget=Db,this.targetIds={},ab.apply(this,arguments)}
function Fb(a,b){var c=z(a.touches),d=this.targetIds;if(b&(O|P)&&1===c.length)return d[c[0].identifier]=!0,[c,c];var e,f,g=z(a.changedTouches),h=[],i=this.target;if(f=c.filter(function(a){return v(a.target,i)}),b===O)for(e=0;e<f.length;)d[f[e].identifier]=!0,e++;for(e=0;e<g.length;)d[g[e].identifier]&&h.push(g[e]),b&(Q|R)&&delete d[g[e].identifier],e++;return h.length?[A(f.concat(h),"identifier",!0),h]:void 0}
function Gb(){ab.apply(this,arguments);var a=q(this.handler,this);this.touch=new Eb(this.manager,a),this.mouse=new rb(this.manager,a)}
function Pb(a,b){this.manager=a,this.set(b)}
function Qb(a){if(w(a,Mb))return Mb;var b=w(a,Nb),c=w(a,Ob);return b&&c?Nb+" "+Ob:b||c?b?Nb:Ob:w(a,Lb)?Lb:Kb}
function Yb(a){this.id=D(),this.manager=null,this.options=o(a||{},this.defaults),this.options.enable=s(this.options.enable,!0),this.state=Rb,this.simultaneous={},this.requireFail=[]}
function Zb(a){return a&Wb?"cancel":a&Ub?"end":a&Tb?"move":a&Sb?"start":""}
function $b(a){return a==W?"down":a==V?"up":a==T?"left":a==U?"right":""}
function _b(a,b){var c=b.manager;return c?c.get(a):a}
function ac(){Yb.apply(this,arguments)}
function bc(){ac.apply(this,arguments),this.pX=null,this.pY=null}
function cc(){ac.apply(this,arguments)}
function dc(){Yb.apply(this,arguments),this._timer=null,this._input=null}
function ec(){ac.apply(this,arguments)}
function fc(){ac.apply(this,arguments)}
function gc(){Yb.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}
function hc(a,b){return b=b||{},b.recognizers=s(b.recognizers,hc.defaults.preset),new kc(a,b)}
function kc(a,b){b=b||{},this.options=o(b,hc.defaults),this.options.inputTarget=this.options.inputTarget||a,this.handlers={},this.session={},this.recognizers=[],this.element=a,this.input=bb(this),this.touchAction=new Pb(this,this.options.touchAction),lc(this,!0),m(b.recognizers,function(a){var b=this.add(new a[0](a[1]));a[2]&&b.recognizeWith(a[2]),a[3]&&b.requireFailure(a[3])},this)}
function lc(a,b){var c=a.element;m(a.options.cssProps,function(a,d){c.style[B(c.style,d)]=b?a:""})}
function mc(a,c){var d=b.createEvent("Event");d.initEvent(a,!0,!0),d.gesture=c,c.target.dispatchEvent(d)}
var e=["","webkit","moz","MS","ms","o"],f=b.createElement("div"),g="function",h=Math.round,i=Math.abs,j=Date.now,C=1,F=/mobile|tablet|ip(ad|hone|od)|android/i,G="ontouchstart"in a,H=B(a,"PointerEvent")!==d,I=G&&F.test(navigator.userAgent),J="touch",K="pen",L="mouse",M="kinect",N=25,O=1,P=2,Q=4,R=8,S=1,T=2,U=4,V=8,W=16,X=T|U,Y=V|W,Z=X|Y,$=["x","y"],_=["clientX","clientY"];ab.prototype={handler:function(){},init:function(){this.evEl&&t(this.element,this.evEl,this.domHandler),this.evTarget&&t(this.target,this.evTarget,this.domHandler),this.evWin&&t(E(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&u(this.element,this.evEl,this.domHandler),this.evTarget&&u(this.target,this.evTarget,this.domHandler),this.evWin&&u(E(this.element),this.evWin,this.domHandler)}};var ob={mousedown:O,mousemove:P,mouseup:Q},pb="mousedown",qb="mousemove mouseup";p(rb,ab,{handler:function(a){var b=ob[a.type];b&O&&0===a.button&&(this.pressed=!0),b&P&&1!==a.which&&(b=Q),this.pressed&&this.allow&&(b&Q&&(this.pressed=!1),this.callback(this.manager,b,{pointers:[a],changedPointers:[a],pointerType:L,srcEvent:a}))}});var sb={pointerdown:O,pointermove:P,pointerup:Q,pointercancel:R,pointerout:R},tb={2:J,3:K,4:L,5:M},ub="pointerdown",vb="pointermove pointerup pointercancel";a.MSPointerEvent&&(ub="MSPointerDown",vb="MSPointerMove MSPointerUp MSPointerCancel"),p(wb,ab,{handler:function(a){var b=this.store,c=!1,d=a.type.toLowerCase().replace("ms",""),e=sb[d],f=tb[a.pointerType]||a.pointerType,g=f==J,h=y(b,a.pointerId,"pointerId");e&O&&(0===a.button||g)?0>h&&(b.push(a),h=b.length-1):e&(Q|R)&&(c=!0),0>h||(b[h]=a,this.callback(this.manager,e,{pointers:b,changedPointers:[a],pointerType:f,srcEvent:a}),c&&b.splice(h,1))}});var xb={touchstart:O,touchmove:P,touchend:Q,touchcancel:R},yb="touchstart",zb="touchstart touchmove touchend touchcancel";p(Ab,ab,{handler:function(a){var b=xb[a.type];if(b===O&&(this.started=!0),this.started){var c=Bb.call(this,a,b);b&(Q|R)&&0===c[0].length-c[1].length&&(this.started=!1),this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:J,srcEvent:a})}}});var Cb={touchstart:O,touchmove:P,touchend:Q,touchcancel:R},Db="touchstart touchmove touchend touchcancel";p(Eb,ab,{handler:function(a){var b=Cb[a.type],c=Fb.call(this,a,b);c&&this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:J,srcEvent:a})}}),p(Gb,ab,{handler:function(a,b,c){var d=c.pointerType==J,e=c.pointerType==L;if(d)this.mouse.allow=!1;else if(e&&!this.mouse.allow)return;b&(Q|R)&&(this.mouse.allow=!0),this.callback(a,b,c)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Hb=B(f.style,"touchAction"),Ib=Hb!==d,Jb="compute",Kb="auto",Lb="manipulation",Mb="none",Nb="pan-x",Ob="pan-y";Pb.prototype={set:function(a){a==Jb&&(a=this.compute()),Ib&&(this.manager.element.style[Hb]=a),this.actions=a.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var a=[];return m(this.manager.recognizers,function(b){r(b.options.enable,[b])&&(a=a.concat(b.getTouchAction()))}),Qb(a.join(" "))},preventDefaults:function(a){if(!Ib){var b=a.srcEvent,c=a.offsetDirection;if(this.manager.session.prevented)return b.preventDefault(),void 0;var d=this.actions,e=w(d,Mb),f=w(d,Ob),g=w(d,Nb);return e||f&&c&X||g&&c&Y?this.preventSrc(b):void 0}},preventSrc:function(a){this.manager.session.prevented=!0,a.preventDefault()}};var Rb=1,Sb=2,Tb=4,Ub=8,Vb=Ub,Wb=16,Xb=32;Yb.prototype={defaults:{},set:function(a){return n(this.options,a),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(a){if(l(a,"recognizeWith",this))return this;var b=this.simultaneous;return a=_b(a,this),b[a.id]||(b[a.id]=a,a.recognizeWith(this)),this},dropRecognizeWith:function(a){return l(a,"dropRecognizeWith",this)?this:(a=_b(a,this),delete this.simultaneous[a.id],this)},requireFailure:function(a){if(l(a,"requireFailure",this))return this;var b=this.requireFail;return a=_b(a,this),-1===y(b,a)&&(b.push(a),a.requireFailure(this)),this},dropRequireFailure:function(a){if(l(a,"dropRequireFailure",this))return this;a=_b(a,this);var b=y(this.requireFail,a);return b>-1&&this.requireFail.splice(b,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(a){return!!this.simultaneous[a.id]},emit:function(a){function d(d){b.manager.emit(b.options.event+(d?Zb(c):""),a)}
var b=this,c=this.state;Ub>c&&d(!0),d(),c>=Ub&&d(!0)},tryEmit:function(a){return this.canEmit()?this.emit(a):(this.state=Xb,void 0)},canEmit:function(){for(var a=0;a<this.requireFail.length;){if(!(this.requireFail[a].state&(Xb|Rb)))return!1;a++}
return!0},recognize:function(a){var b=n({},a);return r(this.options.enable,[this,b])?(this.state&(Vb|Wb|Xb)&&(this.state=Rb),this.state=this.process(b),this.state&(Sb|Tb|Ub|Wb)&&this.tryEmit(b),void 0):(this.reset(),this.state=Xb,void 0)},process:function(){},getTouchAction:function(){},reset:function(){}},p(ac,Yb,{defaults:{pointers:1},attrTest:function(a){var b=this.options.pointers;return 0===b||a.pointers.length===b},process:function(a){var b=this.state,c=a.eventType,d=b&(Sb|Tb),e=this.attrTest(a);return d&&(c&R||!e)?b|Wb:d||e?c&Q?b|Ub:b&Sb?b|Tb:Sb:Xb}}),p(bc,ac,{defaults:{event:"pan",threshold:10,pointers:1,direction:Z},getTouchAction:function(){var a=this.options.direction,b=[];return a&X&&b.push(Ob),a&Y&&b.push(Nb),b},directionTest:function(a){var b=this.options,c=!0,d=a.distance,e=a.direction,f=a.deltaX,g=a.deltaY;return e&b.direction||(b.direction&X?(e=0===f?S:0>f?T:U,c=f!=this.pX,d=Math.abs(a.deltaX)):(e=0===g?S:0>g?V:W,c=g!=this.pY,d=Math.abs(a.deltaY))),a.direction=e,c&&d>b.threshold&&e&b.direction},attrTest:function(a){return ac.prototype.attrTest.call(this,a)&&(this.state&Sb||!(this.state&Sb)&&this.directionTest(a))},emit:function(a){this.pX=a.deltaX,this.pY=a.deltaY;var b=$b(a.direction);b&&this.manager.emit(this.options.event+b,a),this._super.emit.call(this,a)}}),p(cc,ac,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Mb]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||this.state&Sb)},emit:function(a){if(this._super.emit.call(this,a),1!==a.scale){var b=a.scale<1?"in":"out";this.manager.emit(this.options.event+b,a)}}}),p(dc,Yb,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[Kb]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,e=a.deltaTime>b.time;if(this._input=a,!d||!c||a.eventType&(Q|R)&&!e)this.reset();else if(a.eventType&O)this.reset(),this._timer=k(function(){this.state=Vb,this.tryEmit()},b.time,this);else if(a.eventType&Q)return Vb;return Xb},reset:function(){clearTimeout(this._timer)},emit:function(a){this.state===Vb&&(a&&a.eventType&Q?this.manager.emit(this.options.event+"up",a):(this._input.timeStamp=j(),this.manager.emit(this.options.event,this._input)))}}),p(ec,ac,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Mb]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||this.state&Sb)}}),p(fc,ac,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:X|Y,pointers:1},getTouchAction:function(){return bc.prototype.getTouchAction.call(this)},attrTest:function(a){var c,b=this.options.direction;return b&(X|Y)?c=a.velocity:b&X?c=a.velocityX:b&Y&&(c=a.velocityY),this._super.attrTest.call(this,a)&&b&a.direction&&a.distance>this.options.threshold&&i(c)>this.options.velocity&&a.eventType&Q},emit:function(a){var b=$b(a.direction);b&&this.manager.emit(this.options.event+b,a),this.manager.emit(this.options.event,a)}}),p(gc,Yb,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[Lb]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,e=a.deltaTime<b.time;if(this.reset(),a.eventType&O&&0===this.count)return this.failTimeout();if(d&&e&&c){if(a.eventType!=Q)return this.failTimeout();var f=this.pTime?a.timeStamp-this.pTime<b.interval:!0,g=!this.pCenter||kb(this.pCenter,a.center)<b.posThreshold;this.pTime=a.timeStamp,this.pCenter=a.center,g&&f?this.count+=1:this.count=1,this._input=a;var h=this.count%b.taps;if(0===h)return this.hasRequireFailures()?(this._timer=k(function(){this.state=Vb,this.tryEmit()},b.interval,this),Sb):Vb}
return Xb},failTimeout:function(){return this._timer=k(function(){this.state=Xb},this.options.interval,this),Xb},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Vb&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),hc.VERSION="2.0.4",hc.defaults={domEvents:!1,touchAction:Jb,enable:!0,inputTarget:null,inputClass:null,preset:[[ec,{enable:!1}],[cc,{enable:!1},["rotate"]],[fc,{direction:X}],[bc,{direction:X},["swipe"]],[gc],[gc,{event:"doubletap",taps:2},["tap"]],[dc]],cssProps:{userSelect:"default",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var ic=1,jc=2;kc.prototype={set:function(a){return n(this.options,a),a.touchAction&&this.touchAction.update(),a.inputTarget&&(this.input.destroy(),this.input.target=a.inputTarget,this.input.init()),this},stop:function(a){this.session.stopped=a?jc:ic},recognize:function(a){var b=this.session;if(!b.stopped){this.touchAction.preventDefaults(a);var c,d=this.recognizers,e=b.curRecognizer;(!e||e&&e.state&Vb)&&(e=b.curRecognizer=null);for(var f=0;f<d.length;)c=d[f],b.stopped===jc||e&&c!=e&&!c.canRecognizeWith(e)?c.reset():c.recognize(a),!e&&c.state&(Sb|Tb|Ub)&&(e=b.curRecognizer=c),f++}},get:function(a){if(a instanceof Yb)return a;for(var b=this.recognizers,c=0;c<b.length;c++)if(b[c].options.event==a)return b[c];return null},add:function(a){if(l(a,"add",this))return this;var b=this.get(a.options.event);return b&&this.remove(b),this.recognizers.push(a),a.manager=this,this.touchAction.update(),a},remove:function(a){if(l(a,"remove",this))return this;var b=this.recognizers;return a=this.get(a),b.splice(y(b,a),1),this.touchAction.update(),this},on:function(a,b){var c=this.handlers;return m(x(a),function(a){c[a]=c[a]||[],c[a].push(b)}),this},off:function(a,b){var c=this.handlers;return m(x(a),function(a){b?c[a].splice(y(c[a],b),1):delete c[a]}),this},emit:function(a,b){this.options.domEvents&&mc(a,b);var c=this.handlers[a]&&this.handlers[a].slice();if(c&&c.length){b.type=a,b.preventDefault=function(){b.srcEvent.preventDefault()};for(var d=0;d<c.length;)c[d](b),d++}},destroy:function(){this.element&&lc(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},n(hc,{INPUT_START:O,INPUT_MOVE:P,INPUT_END:Q,INPUT_CANCEL:R,STATE_POSSIBLE:Rb,STATE_BEGAN:Sb,STATE_CHANGED:Tb,STATE_ENDED:Ub,STATE_RECOGNIZED:Vb,STATE_CANCELLED:Wb,STATE_FAILED:Xb,DIRECTION_NONE:S,DIRECTION_LEFT:T,DIRECTION_RIGHT:U,DIRECTION_UP:V,DIRECTION_DOWN:W,DIRECTION_HORIZONTAL:X,DIRECTION_VERTICAL:Y,DIRECTION_ALL:Z,Manager:kc,Input:ab,TouchAction:Pb,TouchInput:Eb,MouseInput:rb,PointerEventInput:wb,TouchMouseInput:Gb,SingleTouchInput:Ab,Recognizer:Yb,AttrRecognizer:ac,Tap:gc,Pan:bc,Swipe:fc,Pinch:cc,Rotate:ec,Press:dc,on:t,off:u,each:m,merge:o,extend:n,inherit:p,bindFn:q,prefixed:B}),typeof define==g&&define.amd?define(function(){return hc}):"undefined"!=typeof module&&module.exports?module.exports=hc:a[c]=hc}(window,document,"Hammer");;(function(factory){if(typeof define==='function'&&define.amd){define(['jquery','hammerjs'],factory);}else if(typeof exports==='object'){factory(require('jquery'),require('hammerjs'));}else{factory(jQuery,Hammer);}}(function($,Hammer){function hammerify(el,options){var $el=$(el);if(!$el.data("hammer")){$el.data("hammer",new Hammer($el[0],options));}}
$.fn.hammer=function(options){return this.each(function(){hammerify(this,options);});};Hammer.Manager.prototype.emit=(function(originalEmit){return function(type,data){originalEmit.call(this,type,data);$(this.element).trigger({type:type,gesture:data});};})(Hammer.Manager.prototype.emit);}));;(function(window){if(window.Package){Materialize={};}else{window.Materialize={};}})(window);(function(window){var lastTime=0,vendors=['webkit','moz'],requestAnimationFrame=window.requestAnimationFrame,cancelAnimationFrame=window.cancelAnimationFrame,i=vendors.length;while(--i>=0&&!requestAnimationFrame){requestAnimationFrame=window[vendors[i]+'RequestAnimationFrame'];cancelAnimationFrame=window[vendors[i]+'CancelRequestAnimationFrame'];}
if(!requestAnimationFrame||!cancelAnimationFrame){requestAnimationFrame=function(callback){var now=+Date.now(),nextTime=Math.max(lastTime+16,now);return setTimeout(function(){callback(lastTime=nextTime);},nextTime-now);};cancelAnimationFrame=clearTimeout;}
window.requestAnimationFrame=requestAnimationFrame;window.cancelAnimationFrame=cancelAnimationFrame;}(window));Materialize.guid=(function(){function s4(){return Math.floor((1+Math.random())*0x10000).toString(16).substring(1);}
return function(){return s4()+s4()+'-'+s4()+'-'+s4()+'-'+
s4()+'-'+s4()+s4()+s4();};})();Materialize.escapeHash=function(hash){return hash.replace(/(:|\.|\[|\]|,|=)/g,"\\$1");};Materialize.elementOrParentIsFixed=function(element){var $element=$(element);var $checkElements=$element.add($element.parents());var isFixed=false;$checkElements.each(function(){if($(this).css("position")==="fixed"){isFixed=true;return false;}});return isFixed;};var Vel;if(jQuery){Vel=jQuery.Velocity;}else if($){Vel=$.Velocity;}else{Vel=Velocity;};(function($){$.fn.collapsible=function(options){var defaults={accordion:undefined,onOpen:undefined,onClose:undefined};options=$.extend(defaults,options);return this.each(function(){var $this=$(this);var $panel_headers=$(this).find('> li > .collapsible-header');var collapsible_type=$this.data("collapsible");$this.off('click.collapse','> li > .collapsible-header');$panel_headers.off('click.collapse');function accordionOpen(object){$panel_headers=$this.find('> li > .collapsible-header');if(object.hasClass('active')){object.parent().addClass('active');}
else{object.parent().removeClass('active');}
if(object.parent().hasClass('active')){object.siblings('.collapsible-body').stop(true,false).slideDown({duration:350,easing:"easeOutQuart",queue:false,complete:function(){$(this).css('height','');}});}
else{object.siblings('.collapsible-body').stop(true,false).slideUp({duration:350,easing:"easeOutQuart",queue:false,complete:function(){$(this).css('height','');}});}
$panel_headers.not(object).removeClass('active').parent().removeClass('active');$panel_headers.not(object).parent().children('.collapsible-body').stop(true,false).each(function(){if($(this).is(':visible')){$(this).slideUp({duration:350,easing:"easeOutQuart",queue:false,complete:function(){$(this).css('height','');execCallbacks($(this).siblings('.collapsible-header'));}});}});}
function expandableOpen(object){if(object.hasClass('active')){object.parent().addClass('active');}
else{object.parent().removeClass('active');}
if(object.parent().hasClass('active')){object.siblings('.collapsible-body').stop(true,false).slideDown({duration:350,easing:"easeOutQuart",queue:false,complete:function(){$(this).css('height','');}});}
else{object.siblings('.collapsible-body').stop(true,false).slideUp({duration:350,easing:"easeOutQuart",queue:false,complete:function(){$(this).css('height','');}});}}
function collapsibleOpen(object){if(options.accordion||collapsible_type==="accordion"||collapsible_type===undefined){accordionOpen(object);}else{expandableOpen(object);}
execCallbacks(object);}
function execCallbacks(object){if(object.hasClass('active')){if(typeof(options.onOpen)==="function"){options.onOpen.call(this,object.parent());}}else{if(typeof(options.onClose)==="function"){options.onClose.call(this,object.parent());}}}
function isChildrenOfPanelHeader(object){var panelHeader=getPanelHeader(object);return panelHeader.length>0;}
function getPanelHeader(object){return object.closest('li > .collapsible-header');}
$this.on('click.collapse','> li > .collapsible-header',function(e){var element=$(e.target);if(isChildrenOfPanelHeader(element)){element=getPanelHeader(element);}
element.toggleClass('active');collapsibleOpen(element);});if(options.accordion||collapsible_type==="accordion"||collapsible_type===undefined){collapsibleOpen($panel_headers.filter('.active').first());}else{$panel_headers.filter('.active').each(function(){collapsibleOpen($(this));});}});};$(document).ready(function(){$('.collapsible').collapsible();});}(jQuery));;(function($){$.fn.scrollTo=function(elem){$(this).scrollTop($(this).scrollTop()-$(this).offset().top+$(elem).offset().top);return this;};$.fn.dropdown=function(options){var defaults={inDuration:300,outDuration:225,constrain_width:true,hover:false,gutter:0,belowOrigin:false,alignment:'left',stopPropagation:false};if(options==="open"){this.each(function(){$(this).trigger('open');});return false;}
if(options==="close"){this.each(function(){$(this).trigger('close');});return false;}
this.each(function(){var origin=$(this);var curr_options=$.extend({},defaults,options);var isFocused=false;var activates=$("#"+origin.attr('data-activates'));function updateOptions(){if(origin.data('induration')!==undefined)
curr_options.inDuration=origin.data('induration');if(origin.data('outduration')!==undefined)
curr_options.outDuration=origin.data('outduration');if(origin.data('constrainwidth')!==undefined)
curr_options.constrain_width=origin.data('constrainwidth');if(origin.data('hover')!==undefined)
curr_options.hover=origin.data('hover');if(origin.data('gutter')!==undefined)
curr_options.gutter=origin.data('gutter');if(origin.data('beloworigin')!==undefined)
curr_options.belowOrigin=origin.data('beloworigin');if(origin.data('alignment')!==undefined)
curr_options.alignment=origin.data('alignment');if(origin.data('stoppropagation')!==undefined)
curr_options.stopPropagation=origin.data('stoppropagation');}
updateOptions();origin.after(activates);function placeDropdown(eventType){if(eventType==='focus'){isFocused=true;}
updateOptions();activates.addClass('active');origin.addClass('active');if(curr_options.constrain_width===true){activates.css('width',origin.outerWidth());}else{activates.css('white-space','nowrap');}
var windowHeight=window.innerHeight;var originHeight=origin.innerHeight();var offsetLeft=origin.offset().left;var offsetTop=origin.offset().top-$(window).scrollTop();var currAlignment=curr_options.alignment;var gutterSpacing=0;var leftPosition=0;var verticalOffset=0;if(curr_options.belowOrigin===true){verticalOffset=originHeight;}
var scrollYOffset=0;var scrollXOffset=0;var wrapper=origin.parent();if(!wrapper.is('body')){if(wrapper[0].scrollHeight>wrapper[0].clientHeight){scrollYOffset=wrapper[0].scrollTop;}
if(wrapper[0].scrollWidth>wrapper[0].clientWidth){scrollXOffset=wrapper[0].scrollLeft;}}
if(offsetLeft+activates.innerWidth()>$(window).width()){currAlignment='right';}else if(offsetLeft-activates.innerWidth()+origin.innerWidth()<0){currAlignment='left';}
if(offsetTop+activates.innerHeight()>windowHeight){if(offsetTop+originHeight-activates.innerHeight()<0){var adjustedHeight=windowHeight-offsetTop-verticalOffset;activates.css('max-height',adjustedHeight);}else{if(!verticalOffset){verticalOffset+=originHeight;}
verticalOffset-=activates.innerHeight();}}
if(currAlignment==='left'){gutterSpacing=curr_options.gutter;leftPosition=origin.position().left+gutterSpacing;}
else if(currAlignment==='right'){var offsetRight=origin.position().left+origin.outerWidth()-activates.outerWidth();gutterSpacing=-curr_options.gutter;leftPosition=offsetRight+gutterSpacing;}
activates.css({position:'absolute',top:origin.position().top+verticalOffset+scrollYOffset,left:leftPosition+scrollXOffset});activates.stop(true,true).css('opacity',0).slideDown({queue:false,duration:curr_options.inDuration,easing:'easeOutCubic',complete:function(){$(this).css('height','');}}).animate({opacity:1},{queue:false,duration:curr_options.inDuration,easing:'easeOutSine'});}
function hideDropdown(){isFocused=false;activates.fadeOut(curr_options.outDuration);activates.removeClass('active');origin.removeClass('active');setTimeout(function(){activates.css('max-height','');},curr_options.outDuration);}
if(curr_options.hover){var open=false;origin.unbind('click.'+origin.attr('id'));origin.on('mouseenter',function(e){if(open===false){placeDropdown();open=true;}});origin.on('mouseleave',function(e){var toEl=e.toElement||e.relatedTarget;if(!$(toEl).closest('.dropdown-content').is(activates)){activates.stop(true,true);hideDropdown();open=false;}});activates.on('mouseleave',function(e){var toEl=e.toElement||e.relatedTarget;if(!$(toEl).closest('.dropdown-button').is(origin)){activates.stop(true,true);hideDropdown();open=false;}});}else{origin.unbind('click.'+origin.attr('id'));origin.bind('click.'+origin.attr('id'),function(e){if(!isFocused){if(origin[0]==e.currentTarget&&!origin.hasClass('active')&&($(e.target).closest('.dropdown-content').length===0)){e.preventDefault();if(curr_options.stopPropagation){e.stopPropagation();}
placeDropdown('click');}
else if(origin.hasClass('active')){hideDropdown();$(document).unbind('click.'+activates.attr('id')+' touchstart.'+activates.attr('id'));}
if(activates.hasClass('active')){$(document).bind('click.'+activates.attr('id')+' touchstart.'+activates.attr('id'),function(e){if(!activates.is(e.target)&&!origin.is(e.target)&&(!origin.find(e.target).length)){hideDropdown();$(document).unbind('click.'+activates.attr('id')+' touchstart.'+activates.attr('id'));}});}}});}
origin.on('open',function(e,eventType){placeDropdown(eventType);});origin.on('close',hideDropdown);});};$(document).ready(function(){$('.dropdown-button').dropdown();});}(jQuery));;(function($){var _stack=0,_lastID=0,_generateID=function(){_lastID++;return'materialize-modal-overlay-'+_lastID;};var methods={init:function(options){var defaults={opacity:0.5,in_duration:350,out_duration:250,ready:undefined,complete:undefined,dismissible:true,starting_top:'4%',ending_top:'10%'};options=$.extend(defaults,options);return this.each(function(){var $modal=$(this);var modal_id=$(this).attr("id")||'#'+$(this).data('target');var closeModal=function(){var overlayID=$modal.data('overlay-id');var $overlay=$('#'+overlayID);$modal.removeClass('open');$('body').css({overflow:'',width:''});$modal.find('.modal-close').off('click.close');$(document).off('keyup.modal'+overlayID);$overlay.velocity({opacity:0},{duration:options.out_duration,queue:false,ease:"easeOutQuart"});var exitVelocityOptions={duration:options.out_duration,queue:false,ease:"easeOutCubic",complete:function(){$(this).css({display:"none"});if(typeof(options.complete)==="function"){options.complete.call(this,$modal);}
$overlay.remove();_stack--;}};if($modal.hasClass('bottom-sheet')){$modal.velocity({bottom:"-100%",opacity:0},exitVelocityOptions);}
else{$modal.velocity({top:options.starting_top,opacity:0,scaleX:0.7},exitVelocityOptions);}};var openModal=function($trigger){var $body=$('body');var oldWidth=$body.innerWidth();$body.css('overflow','hidden');$body.width(oldWidth);if($modal.hasClass('open')){return;}
var overlayID=_generateID();var $overlay=$('<div class="modal-overlay"></div>');lStack=(++_stack);$overlay.attr('id',overlayID).css('z-index',1000+lStack*2);$modal.data('overlay-id',overlayID).css('z-index',1000+lStack*2+1);$modal.addClass('open');$("body").append($overlay);if(options.dismissible){$overlay.click(function(){closeModal();});$(document).on('keyup.modal'+overlayID,function(e){if(e.keyCode===27){closeModal();}});}
$modal.find(".modal-close").on('click.close',function(e){closeModal();});$overlay.css({display:"block",opacity:0});$modal.css({display:"block",opacity:0});$overlay.velocity({opacity:options.opacity},{duration:options.in_duration,queue:false,ease:"easeOutCubic"});$modal.data('associated-overlay',$overlay[0]);var enterVelocityOptions={duration:options.in_duration,queue:false,ease:"easeOutCubic",complete:function(){if(typeof(options.ready)==="function"){options.ready.call(this,$modal,$trigger);}}};if($modal.hasClass('bottom-sheet')){$modal.velocity({bottom:"0",opacity:1},enterVelocityOptions);}
else{$.Velocity.hook($modal,"scaleX",0.7);$modal.css({top:options.starting_top});$modal.velocity({top:options.ending_top,opacity:1,scaleX:'1'},enterVelocityOptions);}};$(document).off('click.modalTrigger','a[href="#'+modal_id+'"], [data-target="'+modal_id+'"]');$(this).off('openModal');$(this).off('closeModal');$(document).on('click.modalTrigger','a[href="#'+modal_id+'"], [data-target="'+modal_id+'"]',function(e){options.starting_top=($(this).offset().top-$(window).scrollTop())/1.15;openModal($(this));e.preventDefault();});$(this).on('openModal',function(){var modal_id=$(this).attr("href")||'#'+$(this).data('target');openModal();});$(this).on('closeModal',function(e){e.stopPropagation();closeModal();});});},open:function(){$(this).trigger('openModal');},close:function(){$(this).trigger('closeModal');}};$.fn.materialModal=function(methodOrOptions){if(methods[methodOrOptions]){return methods[methodOrOptions].apply(this,Array.prototype.slice.call(arguments,1));}else if(typeof methodOrOptions==='object'||!methodOrOptions){return methods.init.apply(this,arguments);}else{$.error('Method '+methodOrOptions+' does not exist on jQuery.modal');}};})(jQuery);;(function($){$.fn.materialbox=function(){return this.each(function(){if($(this).hasClass('initialized')){return;}
$(this).addClass('initialized');var overlayActive=false;var doneAnimating=true;var inDuration=275;var outDuration=200;var origin=$(this);var placeholder=$('<div></div>').addClass('material-placeholder');var originalWidth=0;var originalHeight=0;var ancestorsChanged;var ancestor;origin.wrap(placeholder);origin.on('click',function(){var placeholder=origin.parent('.material-placeholder');var windowWidth=window.innerWidth;var windowHeight=window.innerHeight;var originalWidth=origin.width();var originalHeight=origin.height();if(doneAnimating===false){returnToOriginal();return false;}
else if(overlayActive&&doneAnimating===true){returnToOriginal();return false;}
doneAnimating=false;origin.addClass('active');overlayActive=true;placeholder.css({width:placeholder[0].getBoundingClientRect().width,height:placeholder[0].getBoundingClientRect().height,position:'relative',top:0,left:0});ancestorsChanged=undefined;ancestor=placeholder[0].parentNode;var count=0;while(ancestor!==null&&!$(ancestor).is(document)){var curr=$(ancestor);if(curr.css('overflow')!=='visible'){curr.css('overflow','visible');if(ancestorsChanged===undefined){ancestorsChanged=curr;}
else{ancestorsChanged=ancestorsChanged.add(curr);}}
ancestor=ancestor.parentNode;}
origin.css({position:'absolute','z-index':1000}).data('width',originalWidth).data('height',originalHeight);var overlay=$('<div id="materialbox-overlay"></div>').css({opacity:0}).click(function(){if(doneAnimating===true)
returnToOriginal();});origin.before(overlay);overlay.velocity({opacity:1},{duration:inDuration,queue:false,easing:'easeOutQuad'});if(origin.data('caption')!==""){var $photo_caption=$('<div class="materialbox-caption"></div>');$photo_caption.text(origin.data('caption'));$('body').append($photo_caption);$photo_caption.css({"display":"inline"});$photo_caption.velocity({opacity:1},{duration:inDuration,queue:false,easing:'easeOutQuad'});}
var ratio=0;var widthPercent=originalWidth/windowWidth;var heightPercent=originalHeight/windowHeight;var newWidth=0;var newHeight=0;if(widthPercent>heightPercent){ratio=originalHeight/originalWidth;newWidth=windowWidth*0.9;newHeight=windowWidth*0.9*ratio;}
else{ratio=originalWidth/originalHeight;newWidth=(windowHeight*0.9)*ratio;newHeight=windowHeight*0.9;}
if(origin.hasClass('responsive-img')){origin.velocity({'max-width':newWidth,'width':originalWidth},{duration:0,queue:false,complete:function(){origin.css({left:0,top:0}).velocity({height:newHeight,width:newWidth,left:$(document).scrollLeft()+windowWidth/2-origin.parent('.material-placeholder').offset().left-newWidth/2,top:$(document).scrollTop()+windowHeight/2-origin.parent('.material-placeholder').offset().top-newHeight/2},{duration:inDuration,queue:false,easing:'easeOutQuad',complete:function(){doneAnimating=true;}});}});}
else{origin.css('left',0).css('top',0).velocity({height:newHeight,width:newWidth,left:$(document).scrollLeft()+windowWidth/2-origin.parent('.material-placeholder').offset().left-newWidth/2,top:$(document).scrollTop()+windowHeight/2-origin.parent('.material-placeholder').offset().top-newHeight/2},{duration:inDuration,queue:false,easing:'easeOutQuad',complete:function(){doneAnimating=true;}});}});$(window).scroll(function(){if(overlayActive){returnToOriginal();}});$(document).keyup(function(e){if(e.keyCode===27&&doneAnimating===true){if(overlayActive){returnToOriginal();}}});function returnToOriginal(){doneAnimating=false;var placeholder=origin.parent('.material-placeholder');var windowWidth=window.innerWidth;var windowHeight=window.innerHeight;var originalWidth=origin.data('width');var originalHeight=origin.data('height');origin.velocity("stop",true);$('#materialbox-overlay').velocity("stop",true);$('.materialbox-caption').velocity("stop",true);$('#materialbox-overlay').velocity({opacity:0},{duration:outDuration,queue:false,easing:'easeOutQuad',complete:function(){overlayActive=false;$(this).remove();}});origin.velocity({width:originalWidth,height:originalHeight,left:0,top:0},{duration:outDuration,queue:false,easing:'easeOutQuad'});$('.materialbox-caption').velocity({opacity:0},{duration:outDuration,queue:false,easing:'easeOutQuad',complete:function(){placeholder.css({height:'',width:'',position:'',top:'',left:''});origin.css({height:'',top:'',left:'',width:'','max-width':'',position:'','z-index':''});origin.removeClass('active');doneAnimating=true;$(this).remove();if(ancestorsChanged){ancestorsChanged.css('overflow','');}}});}});};$(document).ready(function(){$('.materialboxed').materialbox();});}(jQuery));;(function($){$.fn.parallax=function(){var window_width=$(window).width();return this.each(function(i){var $this=$(this);$this.addClass('parallax');function updateParallax(initial){var container_height;if(window_width<601){container_height=($this.height()>0)?$this.height():$this.children("img").height();}
else{container_height=($this.height()>0)?$this.height():500;}
var $img=$this.children("img").first();var img_height=$img.height();var parallax_dist=img_height-container_height;var bottom=$this.offset().top+container_height;var top=$this.offset().top;var scrollTop=$(window).scrollTop();var windowHeight=window.innerHeight;var windowBottom=scrollTop+windowHeight;var percentScrolled=(windowBottom-top)/(container_height+windowHeight);var parallax=Math.round((parallax_dist*percentScrolled));if(initial){$img.css('display','block');}
if((bottom>scrollTop)&&(top<(scrollTop+windowHeight))){$img.css('transform',"translate3D(-50%,"+parallax+"px, 0)");}}
$this.children("img").one("load",function(){updateParallax(true);}).each(function(){if(this.complete)$(this).trigger("load");});$(window).scroll(function(){window_width=$(window).width();updateParallax(false);});$(window).resize(function(){window_width=$(window).width();updateParallax(false);});});};}(jQuery));;(function($){var methods={init:function(options){var defaults={onShow:null};options=$.extend(defaults,options);return this.each(function(){var $this=$(this),window_width=$(window).width();var $active,$content,$links=$this.find('li.tab a'),$tabs_width=$this.width(),$tab_width=Math.max($tabs_width,$this[0].scrollWidth)/$links.length,$index=0;var calcRightPos=function(el){return $tabs_width-el.position().left-el.outerWidth()-$this.scrollLeft();};var calcLeftPos=function(el){return el.position().left+$this.scrollLeft();};$active=$($links.filter('[href="'+location.hash+'"]'));if($active.length===0){$active=$(this).find('li.tab a.active').first();}
if($active.length===0){$active=$(this).find('li.tab a').first();}
$active.addClass('active');$index=$links.index($active);if($index<0){$index=0;}
if($active[0]!==undefined){$content=$($active[0].hash);}
$this.append('<div class="indicator"></div>');var $indicator=$this.find('.indicator');if($this.is(":visible")){setTimeout(function(){$indicator.css({"right":calcRightPos($active)});$indicator.css({"left":calcLeftPos($active)});},0);}
$(window).resize(function(){$tabs_width=$this.width();$tab_width=Math.max($tabs_width,$this[0].scrollWidth)/$links.length;if($index<0){$index=0;}
if($tab_width!==0&&$tabs_width!==0){$indicator.css({"right":calcRightPos($active)});$indicator.css({"left":calcLeftPos($active)});}});$links.not($active).each(function(){$(Materialize.escapeHash(this.hash)).hide();});$this.on('click','a',function(e){if($(this).parent().hasClass('disabled')){e.preventDefault();return;}
if(!!$(this).attr("target")){return;}
$tabs_width=$this.width();$tab_width=Math.max($tabs_width,$this[0].scrollWidth)/$links.length;$active.removeClass('active');if($content!==undefined){$content.hide();}
$active=$(this);$content=$(Materialize.escapeHash(this.hash));$links=$this.find('li.tab a');var activeRect=$active.position();$active.addClass('active');var $prev_index=$index;$index=$links.index($(this));if($index<0){$index=0;}
if($content!==undefined){$content.show();if(typeof(options.onShow)==="function"){options.onShow.call(this,$content);}}
if(($index-$prev_index)>=0){$indicator.velocity({"right":calcRightPos($active)},{duration:300,queue:false,easing:'easeOutQuad'});$indicator.velocity({"left":calcLeftPos($active)},{duration:300,queue:false,easing:'easeOutQuad',delay:90});}else{$indicator.velocity({"left":calcLeftPos($active)},{duration:300,queue:false,easing:'easeOutQuad'});$indicator.velocity({"right":calcRightPos($active)},{duration:300,queue:false,easing:'easeOutQuad',delay:90});}
e.preventDefault();});});},select_tab:function(id){this.find('a[href="#'+id+'"]').trigger('click');}};$.fn.tabs=function(methodOrOptions){if(methods[methodOrOptions]){return methods[methodOrOptions].apply(this,Array.prototype.slice.call(arguments,1));}else if(typeof methodOrOptions==='object'||!methodOrOptions){return methods.init.apply(this,arguments);}else{$.error('Method '+methodOrOptions+' does not exist on jQuery.tabs');}};$(document).ready(function(){$('ul.tabs').tabs();});}(jQuery));;(function($){$.fn.tooltip=function(options){var timeout=null,margin=5;var defaults={delay:350,tooltip:'',position:'bottom',html:false};if(options==="remove"){this.each(function(){$('#'+$(this).attr('data-tooltip-id')).remove();$(this).off('mouseenter.tooltip mouseleave.tooltip');});return false;}
options=$.extend(defaults,options);return this.each(function(){var tooltipId=Materialize.guid();var origin=$(this);if(origin.attr('data-tooltip-id')){$('#'+origin.attr('data-tooltip-id')).remove();}
origin.attr('data-tooltip-id',tooltipId);var allowHtml,tooltipDelay,tooltipPosition,tooltipText,tooltipEl,backdrop;var setAttributes=function(){allowHtml=origin.attr('data-html')?origin.attr('data-html')==='true':options.html;tooltipDelay=origin.attr('data-delay');tooltipDelay=(tooltipDelay===undefined||tooltipDelay==='')?options.delay:tooltipDelay;tooltipPosition=origin.attr('data-position');tooltipPosition=(tooltipPosition===undefined||tooltipPosition==='')?options.position:tooltipPosition;tooltipText=origin.attr('data-tooltip');tooltipText=(tooltipText===undefined||tooltipText==='')?options.tooltip:tooltipText;};setAttributes();var renderTooltipEl=function(){var tooltip=$('<div class="material-tooltip"></div>');if(allowHtml){tooltipText=$('<span></span>').html(tooltipText);}else{tooltipText=$('<span></span>').text(tooltipText);}
tooltip.append(tooltipText).appendTo($('body')).attr('id',tooltipId);backdrop=$('<div class="backdrop"></div>');backdrop.appendTo(tooltip);return tooltip;};tooltipEl=renderTooltipEl();origin.off('mouseenter.tooltip mouseleave.tooltip');var started=false,timeoutRef;origin.on({'mouseenter.tooltip':function(e){var showTooltip=function(){setAttributes();started=true;tooltipEl.velocity('stop');backdrop.velocity('stop');tooltipEl.css({display:'block',left:'0px',top:'0px'});var originWidth=origin.outerWidth();var originHeight=origin.outerHeight();var tooltipHeight=tooltipEl.outerHeight();var tooltipWidth=tooltipEl.outerWidth();var tooltipVerticalMovement='0px';var tooltipHorizontalMovement='0px';var scaleXFactor=8;var scaleYFactor=8;var targetTop,targetLeft,newCoordinates;if(tooltipPosition==="top"){targetTop=origin.offset().top-tooltipHeight-margin;targetLeft=origin.offset().left+originWidth/2-tooltipWidth/2;newCoordinates=repositionWithinScreen(targetLeft,targetTop,tooltipWidth,tooltipHeight);tooltipVerticalMovement='-10px';backdrop.css({bottom:0,left:0,borderRadius:'14px 14px 0 0',transformOrigin:'50% 100%',marginTop:tooltipHeight,marginLeft:(tooltipWidth/2)-(backdrop.width()/2)});}
else if(tooltipPosition==="left"){targetTop=origin.offset().top+originHeight/2-tooltipHeight/2;targetLeft=origin.offset().left-tooltipWidth-margin;newCoordinates=repositionWithinScreen(targetLeft,targetTop,tooltipWidth,tooltipHeight);tooltipHorizontalMovement='-10px';backdrop.css({top:'-7px',right:0,width:'14px',height:'14px',borderRadius:'14px 0 0 14px',transformOrigin:'95% 50%',marginTop:tooltipHeight/2,marginLeft:tooltipWidth});}
else if(tooltipPosition==="right"){targetTop=origin.offset().top+originHeight/2-tooltipHeight/2;targetLeft=origin.offset().left+originWidth+margin;newCoordinates=repositionWithinScreen(targetLeft,targetTop,tooltipWidth,tooltipHeight);tooltipHorizontalMovement='+10px';backdrop.css({top:'-7px',left:0,width:'14px',height:'14px',borderRadius:'0 14px 14px 0',transformOrigin:'5% 50%',marginTop:tooltipHeight/2,marginLeft:'0px'});}
else{targetTop=origin.offset().top+origin.outerHeight()+margin;targetLeft=origin.offset().left+originWidth/2-tooltipWidth/2;newCoordinates=repositionWithinScreen(targetLeft,targetTop,tooltipWidth,tooltipHeight);tooltipVerticalMovement='+10px';backdrop.css({top:0,left:0,marginLeft:(tooltipWidth/2)-(backdrop.width()/2)});}
tooltipEl.css({top:newCoordinates.y,left:newCoordinates.x});scaleXFactor=Math.SQRT2*tooltipWidth/parseInt(backdrop.css('width'));scaleYFactor=Math.SQRT2*tooltipHeight/parseInt(backdrop.css('height'));tooltipEl.velocity({marginTop:tooltipVerticalMovement,marginLeft:tooltipHorizontalMovement},{duration:350,queue:false}).velocity({opacity:1},{duration:300,delay:50,queue:false});backdrop.css({display:'block'}).velocity({opacity:1},{duration:55,delay:0,queue:false}).velocity({scaleX:scaleXFactor,scaleY:scaleYFactor},{duration:300,delay:0,queue:false,easing:'easeInOutQuad'});};timeoutRef=setTimeout(showTooltip,tooltipDelay);},'mouseleave.tooltip':function(){started=false;clearTimeout(timeoutRef);setTimeout(function(){if(started!==true){tooltipEl.velocity({opacity:0,marginTop:0,marginLeft:0},{duration:225,queue:false});backdrop.velocity({opacity:0,scaleX:1,scaleY:1},{duration:225,queue:false,complete:function(){backdrop.css('display','none');tooltipEl.css('display','none');started=false;}});}},225);}});});};var repositionWithinScreen=function(x,y,width,height){var newX=x;var newY=y;if(newX<0){newX=4;}else if(newX+width>window.innerWidth){newX-=newX+width-window.innerWidth;}
if(newY<0){newY=4;}else if(newY+height>window.innerHeight+$(window).scrollTop){newY-=newY+height-window.innerHeight;}
return{x:newX,y:newY};};$(document).ready(function(){$('.tooltipped').tooltip();});}(jQuery));;(function(window,factory){'use strict';if(typeof define==='function'&&define.amd){define([],function(){return factory.apply(window);});}
else if(typeof exports==='object'){module.exports=factory.call(window);}
else{window.Waves=factory.call(window);}})(typeof global==='object'?global:this,function(){'use strict';var Waves=Waves||{};var $$=document.querySelectorAll.bind(document);var toString=Object.prototype.toString;var isTouchAvailable='ontouchstart'in window;function isWindow(obj){return obj!==null&&obj===obj.window;}
function getWindow(elem){return isWindow(elem)?elem:elem.nodeType===9&&elem.defaultView;}
function isObject(value){var type=typeof value;return type==='function'||type==='object'&&!!value;}
function isDOMNode(obj){return isObject(obj)&&obj.nodeType>0;}
function getWavesElements(nodes){var stringRepr=toString.call(nodes);if(stringRepr==='[object String]'){return $$(nodes);}else if(isObject(nodes)&&/^\[object (Array|HTMLCollection|NodeList|Object)\]$/.test(stringRepr)&&nodes.hasOwnProperty('length')){return nodes;}else if(isDOMNode(nodes)){return[nodes];}
return[];}
function offset(elem){var docElem,win,box={top:0,left:0},doc=elem&&elem.ownerDocument;docElem=doc.documentElement;if(typeof elem.getBoundingClientRect!==typeof undefined){box=elem.getBoundingClientRect();}
win=getWindow(doc);return{top:box.top+win.pageYOffset-docElem.clientTop,left:box.left+win.pageXOffset-docElem.clientLeft};}
function convertStyle(styleObj){var style='';for(var prop in styleObj){if(styleObj.hasOwnProperty(prop)){style+=(prop+':'+styleObj[prop]+';');}}
return style;}
var Effect={duration:750,delay:200,show:function(e,element,velocity){if(e.button===2){return false;}
element=element||this;var ripple=document.createElement('div');ripple.className='waves-ripple waves-rippling';element.appendChild(ripple);var pos=offset(element);var relativeY=0;var relativeX=0;if('touches'in e&&e.touches.length){relativeY=(e.touches[0].pageY-pos.top);relativeX=(e.touches[0].pageX-pos.left);}
else{relativeY=(e.pageY-pos.top);relativeX=(e.pageX-pos.left);}
relativeX=relativeX>=0?relativeX:0;relativeY=relativeY>=0?relativeY:0;var scale='scale('+((element.clientWidth/100)*3)+')';var translate='translate(0,0)';if(velocity){translate='translate('+(velocity.x)+'px, '+(velocity.y)+'px)';}
ripple.setAttribute('data-hold',Date.now());ripple.setAttribute('data-x',relativeX);ripple.setAttribute('data-y',relativeY);ripple.setAttribute('data-scale',scale);ripple.setAttribute('data-translate',translate);var rippleStyle={top:relativeY+'px',left:relativeX+'px'};ripple.classList.add('waves-notransition');ripple.setAttribute('style',convertStyle(rippleStyle));ripple.classList.remove('waves-notransition');rippleStyle['-webkit-transform']=scale+' '+translate;rippleStyle['-moz-transform']=scale+' '+translate;rippleStyle['-ms-transform']=scale+' '+translate;rippleStyle['-o-transform']=scale+' '+translate;rippleStyle.transform=scale+' '+translate;rippleStyle.opacity='1';var duration=e.type==='mousemove'?2500:Effect.duration;rippleStyle['-webkit-transition-duration']=duration+'ms';rippleStyle['-moz-transition-duration']=duration+'ms';rippleStyle['-o-transition-duration']=duration+'ms';rippleStyle['transition-duration']=duration+'ms';ripple.setAttribute('style',convertStyle(rippleStyle));},hide:function(e,element){element=element||this;var ripples=element.getElementsByClassName('waves-rippling');for(var i=0,len=ripples.length;i<len;i++){removeRipple(e,element,ripples[i]);}}};var TagWrapper={input:function(element){var parent=element.parentNode;if(parent.tagName.toLowerCase()==='i'&&parent.classList.contains('waves-effect')){return;}
var wrapper=document.createElement('i');wrapper.className=element.className+' waves-input-wrapper';element.className='waves-button-input';parent.replaceChild(wrapper,element);wrapper.appendChild(element);var elementStyle=window.getComputedStyle(element,null);var color=elementStyle.color;var backgroundColor=elementStyle.backgroundColor;wrapper.setAttribute('style','color:'+color+';background:'+backgroundColor);element.setAttribute('style','background-color:rgba(0,0,0,0);');},img:function(element){var parent=element.parentNode;if(parent.tagName.toLowerCase()==='i'&&parent.classList.contains('waves-effect')){return;}
var wrapper=document.createElement('i');parent.replaceChild(wrapper,element);wrapper.appendChild(element);}};function removeRipple(e,el,ripple){if(!ripple){return;}
ripple.classList.remove('waves-rippling');var relativeX=ripple.getAttribute('data-x');var relativeY=ripple.getAttribute('data-y');var scale=ripple.getAttribute('data-scale');var translate=ripple.getAttribute('data-translate');var diff=Date.now()-Number(ripple.getAttribute('data-hold'));var delay=350-diff;if(delay<0){delay=0;}
if(e.type==='mousemove'){delay=150;}
var duration=e.type==='mousemove'?2500:Effect.duration;setTimeout(function(){var style={top:relativeY+'px',left:relativeX+'px',opacity:'0','-webkit-transition-duration':duration+'ms','-moz-transition-duration':duration+'ms','-o-transition-duration':duration+'ms','transition-duration':duration+'ms','-webkit-transform':scale+' '+translate,'-moz-transform':scale+' '+translate,'-ms-transform':scale+' '+translate,'-o-transform':scale+' '+translate,'transform':scale+' '+translate};ripple.setAttribute('style',convertStyle(style));setTimeout(function(){try{el.removeChild(ripple);}catch(e){return false;}},duration);},delay);}
var TouchHandler={touches:0,allowEvent:function(e){var allow=true;if(/^(mousedown|mousemove)$/.test(e.type)&&TouchHandler.touches){allow=false;}
return allow;},registerEvent:function(e){var eType=e.type;if(eType==='touchstart'){TouchHandler.touches+=1;}else if(/^(touchend|touchcancel)$/.test(eType)){setTimeout(function(){if(TouchHandler.touches){TouchHandler.touches-=1;}},500);}}};function getWavesEffectElement(e){if(TouchHandler.allowEvent(e)===false){return null;}
var element=null;var target=e.target||e.srcElement;while(target.parentElement!==null){if(target.classList.contains('waves-effect')&&(!(target instanceof SVGElement))){element=target;break;}
target=target.parentElement;}
return element;}
function showEffect(e){var element=getWavesEffectElement(e);if(element!==null){if(element.disabled||element.getAttribute('disabled')||element.classList.contains('disabled')){return;}
TouchHandler.registerEvent(e);if(e.type==='touchstart'&&Effect.delay){var hidden=false;var timer=setTimeout(function(){timer=null;Effect.show(e,element);},Effect.delay);var hideEffect=function(hideEvent){if(timer){clearTimeout(timer);timer=null;Effect.show(e,element);}
if(!hidden){hidden=true;Effect.hide(hideEvent,element);}};var touchMove=function(moveEvent){if(timer){clearTimeout(timer);timer=null;}
hideEffect(moveEvent);};element.addEventListener('touchmove',touchMove,false);element.addEventListener('touchend',hideEffect,false);element.addEventListener('touchcancel',hideEffect,false);}else{Effect.show(e,element);if(isTouchAvailable){element.addEventListener('touchend',Effect.hide,false);element.addEventListener('touchcancel',Effect.hide,false);}
element.addEventListener('mouseup',Effect.hide,false);element.addEventListener('mouseleave',Effect.hide,false);}}}
Waves.init=function(options){var body=document.body;options=options||{};if('duration'in options){Effect.duration=options.duration;}
if('delay'in options){Effect.delay=options.delay;}
if(isTouchAvailable){body.addEventListener('touchstart',showEffect,false);body.addEventListener('touchcancel',TouchHandler.registerEvent,false);body.addEventListener('touchend',TouchHandler.registerEvent,false);}
body.addEventListener('mousedown',showEffect,false);};Waves.attach=function(elements,classes){elements=getWavesElements(elements);if(toString.call(classes)==='[object Array]'){classes=classes.join(' ');}
classes=classes?' '+classes:'';var element,tagName;for(var i=0,len=elements.length;i<len;i++){element=elements[i];tagName=element.tagName.toLowerCase();if(['input','img'].indexOf(tagName)!==-1){TagWrapper[tagName](element);element=element.parentElement;}
if(element.className.indexOf('waves-effect')===-1){element.className+=' waves-effect'+classes;}}};Waves.ripple=function(elements,options){elements=getWavesElements(elements);var elementsLen=elements.length;options=options||{};options.wait=options.wait||0;options.position=options.position||null;if(elementsLen){var element,pos,off,centre={},i=0;var mousedown={type:'mousedown',button:1};var hideRipple=function(mouseup,element){return function(){Effect.hide(mouseup,element);};};for(;i<elementsLen;i++){element=elements[i];pos=options.position||{x:element.clientWidth/2,y:element.clientHeight/2};off=offset(element);centre.x=off.left+pos.x;centre.y=off.top+pos.y;mousedown.pageX=centre.x;mousedown.pageY=centre.y;Effect.show(mousedown,element);if(options.wait>=0&&options.wait!==null){var mouseup={type:'mouseup',button:1};setTimeout(hideRipple(mouseup,element),options.wait);}}}};Waves.calm=function(elements){elements=getWavesElements(elements);var mouseup={type:'mouseup',button:1};for(var i=0,len=elements.length;i<len;i++){Effect.hide(mouseup,elements[i]);}};Waves.displayEffect=function(options){console.error('Waves.displayEffect() has been deprecated and will be removed in future version. Please use Waves.init() to initialize Waves effect');Waves.init(options);};window.Waves=Waves;return Waves;});;Materialize.toast=function(message,displayLength,className,completeCallback){className=className||"";var container=document.getElementById('toast-container');if(container===null){container=document.createElement('div');container.id='toast-container';document.body.appendChild(container);}
var newToast=createToast(message);if(message){container.appendChild(newToast);}
newToast.style.top='35px';newToast.style.opacity=0;Vel(newToast,{"top":"0px",opacity:1},{duration:300,easing:'easeOutCubic',queue:false});var timeLeft=displayLength;var counterInterval;if(timeLeft!=null){counterInterval=setInterval(function(){if(newToast.parentNode===null)
window.clearInterval(counterInterval);if(!newToast.classList.contains('panning')){timeLeft-=20;}
if(timeLeft<=0){Vel(newToast,{"opacity":0,marginTop:'-40px'},{duration:375,easing:'easeOutExpo',queue:false,complete:function(){if(typeof(completeCallback)==="function")
completeCallback();this[0].parentNode.removeChild(this[0]);}});window.clearInterval(counterInterval);}},20);}
function createToast(html){var toast=document.createElement('div');toast.classList.add('toast');if(className){var classes=className.split(' ');for(var i=0,count=classes.length;i<count;i++){toast.classList.add(classes[i]);}}
if(typeof HTMLElement==="object"?html instanceof HTMLElement:html&&typeof html==="object"&&html!==null&&html.nodeType===1&&typeof html.nodeName==="string"){toast.appendChild(html);}
else if(html instanceof jQuery){toast.appendChild(html[0]);}
else{toast.innerHTML=html;}
var hammerHandler=new Hammer(toast,{prevent_default:false});hammerHandler.on('pan',function(e){var deltaX=e.deltaX;var activationDistance=80;if(!toast.classList.contains('panning')){toast.classList.add('panning');}
var opacityPercent=1-Math.abs(deltaX/activationDistance);if(opacityPercent<0)
opacityPercent=0;Vel(toast,{left:deltaX,opacity:opacityPercent},{duration:50,queue:false,easing:'easeOutQuad'});});hammerHandler.on('panend',function(e){var deltaX=e.deltaX;var activationDistance=80;if(Math.abs(deltaX)>activationDistance){Vel(toast,{marginTop:'-40px'},{duration:375,easing:'easeOutExpo',queue:false,complete:function(){if(typeof(completeCallback)==="function"){completeCallback();}
toast.parentNode.removeChild(toast);}});}else{toast.classList.remove('panning');Vel(toast,{left:0,opacity:1},{duration:300,easing:'easeOutExpo',queue:false});}});return toast;}};;(function($){var methods={init:function(options){var defaults={menuWidth:300,edge:'left',closeOnClick:false,draggable:true};options=$.extend(defaults,options);$(this).each(function(){var $this=$(this);var menu_id=$("#"+$this.attr('data-activates'));if(options.menuWidth!=300){menu_id.css('width',options.menuWidth);}
var $dragTarget;if(options.draggable){$dragTarget=$('<div class="drag-target"></div>').attr('data-sidenav',$this.attr('data-activates'));$('body').append($dragTarget);}else{$dragTarget=$();}
if(options.edge=='left'){menu_id.css('transform','translateX(-100%)');$dragTarget.css({'left':0});}
else{menu_id.addClass('right-aligned').css('transform','translateX(100%)');$dragTarget.css({'right':0});}
if(menu_id.hasClass('fixed')){if(window.innerWidth>992){menu_id.css('transform','translateX(0)');}}
if(menu_id.hasClass('fixed')){$(window).resize(function(){if(window.innerWidth>992){if($('#sidenav-overlay').length!==0&&menuOut){removeMenu(true);}
else{menu_id.css('transform','translateX(0%)');}}
else if(menuOut===false){if(options.edge==='left'){menu_id.css('transform','translateX(-100%)');}else{menu_id.css('transform','translateX(100%)');}}});}
if(options.closeOnClick===true){menu_id.on("click.itemclick","a:not(.collapsible-header)",function(){removeMenu();});}
var removeMenu=function(restoreNav){panning=false;menuOut=false;$('body').css({overflow:'',width:''});$('#sidenav-overlay').velocity({opacity:0},{duration:200,queue:false,easing:'easeOutQuad',complete:function(){$(this).remove();}});if(options.edge==='left'){$dragTarget.css({width:'',right:'',left:'0'});menu_id.velocity({'translateX':'-100%'},{duration:200,queue:false,easing:'easeOutCubic',complete:function(){if(restoreNav===true){menu_id.removeAttr('style');menu_id.css('width',options.menuWidth);}}});}
else{$dragTarget.css({width:'',right:'0',left:''});menu_id.velocity({'translateX':'100%'},{duration:200,queue:false,easing:'easeOutCubic',complete:function(){if(restoreNav===true){menu_id.removeAttr('style');menu_id.css('width',options.menuWidth);}}});}};var panning=false;var menuOut=false;if(options.draggable){$dragTarget.on('click',function(){if(menuOut){removeMenu();}});$dragTarget.hammer({prevent_default:false}).bind('pan',function(e){if(e.gesture.pointerType=="touch"){var direction=e.gesture.direction;var x=e.gesture.center.x;var y=e.gesture.center.y;var velocityX=e.gesture.velocityX;var $body=$('body');var $overlay=$('#sidenav-overlay');var oldWidth=$body.innerWidth();$body.css('overflow','hidden');$body.width(oldWidth);if($overlay.length===0){$overlay=$('<div id="sidenav-overlay"></div>');$overlay.css('opacity',0).click(function(){removeMenu();});$('body').append($overlay);}
if(options.edge==='left'){if(x>options.menuWidth){x=options.menuWidth;}
else if(x<0){x=0;}}
if(options.edge==='left'){if(x<(options.menuWidth/2)){menuOut=false;}
else if(x>=(options.menuWidth/2)){menuOut=true;}
menu_id.css('transform','translateX('+(x-options.menuWidth)+'px)');}
else{if(x<(window.innerWidth-options.menuWidth/2)){menuOut=true;}
else if(x>=(window.innerWidth-options.menuWidth/2)){menuOut=false;}
var rightPos=(x-options.menuWidth/2);if(rightPos<0){rightPos=0;}
menu_id.css('transform','translateX('+rightPos+'px)');}
var overlayPerc;if(options.edge==='left'){overlayPerc=x/options.menuWidth;$overlay.velocity({opacity:overlayPerc},{duration:10,queue:false,easing:'easeOutQuad'});}
else{overlayPerc=Math.abs((x-window.innerWidth)/options.menuWidth);$overlay.velocity({opacity:overlayPerc},{duration:10,queue:false,easing:'easeOutQuad'});}}}).bind('panend',function(e){if(e.gesture.pointerType=="touch"){var $overlay=$('<div id="sidenav-overlay"></div>');var velocityX=e.gesture.velocityX;var x=e.gesture.center.x;var leftPos=x-options.menuWidth;var rightPos=x-options.menuWidth/2;if(leftPos>0){leftPos=0;}
if(rightPos<0){rightPos=0;}
panning=false;if(options.edge==='left'){if((menuOut&&velocityX<=0.3)||velocityX<-0.5){if(leftPos!==0){menu_id.velocity({'translateX':[0,leftPos]},{duration:300,queue:false,easing:'easeOutQuad'});}
$overlay.velocity({opacity:1},{duration:50,queue:false,easing:'easeOutQuad'});$dragTarget.css({width:'50%',right:0,left:''});menuOut=true;}
else if(!menuOut||velocityX>0.3){$('body').css({overflow:'',width:''});menu_id.velocity({'translateX':[-1*options.menuWidth-10,leftPos]},{duration:200,queue:false,easing:'easeOutQuad'});$overlay.velocity({opacity:0},{duration:200,queue:false,easing:'easeOutQuad',complete:function(){$(this).remove();}});$dragTarget.css({width:'10px',right:'',left:0});}}
else{if((menuOut&&velocityX>=-0.3)||velocityX>0.5){if(rightPos!==0){menu_id.velocity({'translateX':[0,rightPos]},{duration:300,queue:false,easing:'easeOutQuad'});}
$overlay.velocity({opacity:1},{duration:50,queue:false,easing:'easeOutQuad'});$dragTarget.css({width:'50%',right:'',left:0});menuOut=true;}
else if(!menuOut||velocityX<-0.3){$('body').css({overflow:'',width:''});menu_id.velocity({'translateX':[options.menuWidth+10,rightPos]},{duration:200,queue:false,easing:'easeOutQuad'});$overlay.velocity({opacity:0},{duration:200,queue:false,easing:'easeOutQuad',complete:function(){$(this).remove();}});$dragTarget.css({width:'10px',right:0,left:''});}}}});}
$this.click(function(){if(menuOut===true){menuOut=false;panning=false;removeMenu();}
else{var $body=$('body');var $overlay=$('<div id="sidenav-overlay"></div>');var oldWidth=$body.innerWidth();$body.css('overflow','hidden');$body.width(oldWidth);$('body').append($dragTarget);if(options.edge==='left'){$dragTarget.css({width:'50%',right:0,left:''});menu_id.velocity({'translateX':[0,-1*options.menuWidth]},{duration:300,queue:false,easing:'easeOutQuad'});}
else{$dragTarget.css({width:'50%',right:'',left:0});menu_id.velocity({'translateX':[0,options.menuWidth]},{duration:300,queue:false,easing:'easeOutQuad'});}
$overlay.css('opacity',0).click(function(){menuOut=false;panning=false;removeMenu();$overlay.velocity({opacity:0},{duration:300,queue:false,easing:'easeOutQuad',complete:function(){$(this).remove();}});});$('body').append($overlay);$overlay.velocity({opacity:1},{duration:300,queue:false,easing:'easeOutQuad',complete:function(){menuOut=true;panning=false;}});}
return false;});});},destroy:function(){var $overlay=$('#sidenav-overlay');var $dragTarget=$('.drag-target[data-sidenav="'+$(this).attr('data-activates')+'"]');$overlay.trigger('click');$dragTarget.remove();$(this).off('click');$overlay.remove();},show:function(){this.trigger('click');},hide:function(){$('#sidenav-overlay').trigger('click');}};$.fn.sideNav=function(methodOrOptions){if(methods[methodOrOptions]){return methods[methodOrOptions].apply(this,Array.prototype.slice.call(arguments,1));}else if(typeof methodOrOptions==='object'||!methodOrOptions){return methods.init.apply(this,arguments);}else{$.error('Method '+methodOrOptions+' does not exist on jQuery.sideNav');}};}(jQuery));;(function($){var jWindow=$(window);var elements=[];var elementsInView=[];var isSpying=false;var ticks=0;var unique_id=1;var offset={top:0,right:0,bottom:0,left:0,}
function findElements(top,right,bottom,left){var hits=$();$.each(elements,function(i,element){if(element.height()>0){var elTop=element.offset().top,elLeft=element.offset().left,elRight=elLeft+element.width(),elBottom=elTop+element.height();var isIntersect=!(elLeft>right||elRight<left||elTop>bottom||elBottom<top);if(isIntersect){hits.push(element);}}});return hits;}
function onScroll(scrollOffset){++ticks;var top=jWindow.scrollTop(),left=jWindow.scrollLeft(),right=left+jWindow.width(),bottom=top+jWindow.height();var intersections=findElements(top+offset.top+scrollOffset||200,right+offset.right,bottom+offset.bottom,left+offset.left);$.each(intersections,function(i,element){var lastTick=element.data('scrollSpy:ticks');if(typeof lastTick!='number'){element.triggerHandler('scrollSpy:enter');}
element.data('scrollSpy:ticks',ticks);});$.each(elementsInView,function(i,element){var lastTick=element.data('scrollSpy:ticks');if(typeof lastTick=='number'&&lastTick!==ticks){element.triggerHandler('scrollSpy:exit');element.data('scrollSpy:ticks',null);}});elementsInView=intersections;}
function onWinSize(){jWindow.trigger('scrollSpy:winSize');}
var getTime=(Date.now||function(){return new Date().getTime();});function throttle(func,wait,options){var context,args,result;var timeout=null;var previous=0;options||(options={});var later=function(){previous=options.leading===false?0:getTime();timeout=null;result=func.apply(context,args);context=args=null;};return function(){var now=getTime();if(!previous&&options.leading===false)previous=now;var remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0){clearTimeout(timeout);timeout=null;previous=now;result=func.apply(context,args);context=args=null;}else if(!timeout&&options.trailing!==false){timeout=setTimeout(later,remaining);}
return result;};};$.scrollSpy=function(selector,options){var defaults={throttle:100,scrollOffset:200};options=$.extend(defaults,options);var visible=[];selector=$(selector);selector.each(function(i,element){elements.push($(element));$(element).data("scrollSpy:id",i);$('a[href="#'+$(element).attr('id')+'"]').click(function(e){e.preventDefault();var offset=$(Materialize.escapeHash(this.hash)).offset().top+1;$('html, body').animate({scrollTop:offset-options.scrollOffset},{duration:400,queue:false,easing:'easeOutCubic'});});});offset.top=options.offsetTop||0;offset.right=options.offsetRight||0;offset.bottom=options.offsetBottom||0;offset.left=options.offsetLeft||0;var throttledScroll=throttle(function(){onScroll(options.scrollOffset);},options.throttle||100);var readyScroll=function(){$(document).ready(throttledScroll);};if(!isSpying){jWindow.on('scroll',readyScroll);jWindow.on('resize',readyScroll);isSpying=true;}
setTimeout(readyScroll,0);selector.on('scrollSpy:enter',function(){visible=$.grep(visible,function(value){return value.height()!=0;});var $this=$(this);if(visible[0]){$('a[href="#'+visible[0].attr('id')+'"]').removeClass('active');if($this.data('scrollSpy:id')<visible[0].data('scrollSpy:id')){visible.unshift($(this));}
else{visible.push($(this));}}
else{visible.push($(this));}
$('a[href="#'+visible[0].attr('id')+'"]').addClass('active');});selector.on('scrollSpy:exit',function(){visible=$.grep(visible,function(value){return value.height()!=0;});if(visible[0]){$('a[href="#'+visible[0].attr('id')+'"]').removeClass('active');var $this=$(this);visible=$.grep(visible,function(value){return value.attr('id')!=$this.attr('id');});if(visible[0]){$('a[href="#'+visible[0].attr('id')+'"]').addClass('active');}}});return selector;};$.winSizeSpy=function(options){$.winSizeSpy=function(){return jWindow;};options=options||{throttle:100};return jWindow.on('resize',throttle(onWinSize,options.throttle||100));};$.fn.scrollSpy=function(options){return $.scrollSpy($(this),options);};})(jQuery);;(function($){$(document).ready(function(){Materialize.updateTextFields=function(){var input_selector='input[type=text], input[type=password], input[type=email], input[type=url], input[type=tel], input[type=number], input[type=search], textarea';$(input_selector).each(function(index,element){if($(element).val().length>0||element.autofocus||$(this).attr('placeholder')!==undefined||$(element)[0].validity.badInput===true){$(this).siblings('label').addClass('active');}
else{$(this).siblings('label').removeClass('active');}});};var input_selector='input[type=text], input[type=password], input[type=email], input[type=url], input[type=tel], input[type=number], input[type=search], textarea';$(document).on('change',input_selector,function(){if($(this).val().length!==0||$(this).attr('placeholder')!==undefined){$(this).siblings('label').addClass('active');}
validate_field($(this));});$(document).ready(function(){Materialize.updateTextFields();});$(document).on('reset',function(e){var formReset=$(e.target);if(formReset.is('form')){formReset.find(input_selector).removeClass('valid').removeClass('invalid');formReset.find(input_selector).each(function(){if($(this).attr('value')===''){$(this).siblings('label').removeClass('active');}});formReset.find('select.initialized').each(function(){var reset_text=formReset.find('option[selected]').text();formReset.siblings('input.select-dropdown').val(reset_text);});}});$(document).on('focus',input_selector,function(){$(this).siblings('label, .prefix').addClass('active');});$(document).on('blur',input_selector,function(){var $inputElement=$(this);var selector=".prefix";if($inputElement.val().length===0&&$inputElement[0].validity.badInput!==true&&$inputElement.attr('placeholder')===undefined){selector+=", label";}
$inputElement.siblings(selector).removeClass('active');validate_field($inputElement);});window.validate_field=function(object){var hasLength=object.attr('length')!==undefined;var lenAttr=parseInt(object.attr('length'));var len=object.val().length;if(object.val().length===0&&object[0].validity.badInput===false){if(object.hasClass('validate')){object.removeClass('valid');object.removeClass('invalid');}}
else{if(object.hasClass('validate')){if((object.is(':valid')&&hasLength&&(len<=lenAttr))||(object.is(':valid')&&!hasLength)){object.removeClass('invalid');object.addClass('valid');}
else{object.removeClass('valid');object.addClass('invalid');}}}};var radio_checkbox='input[type=radio], input[type=checkbox]';$(document).on('keyup.radio',radio_checkbox,function(e){if(e.which===9){$(this).addClass('tabbed');var $this=$(this);$this.one('blur',function(e){$(this).removeClass('tabbed');});return;}});var hiddenDiv=$('.hiddendiv').first();if(!hiddenDiv.length){hiddenDiv=$('<div class="hiddendiv common"></div>');$('body').append(hiddenDiv);}
var text_area_selector='.materialize-textarea';function textareaAutoResize($textarea){var fontFamily=$textarea.css('font-family');var fontSize=$textarea.css('font-size');var lineHeight=$textarea.css('line-height');if(fontSize){hiddenDiv.css('font-size',fontSize);}
if(fontFamily){hiddenDiv.css('font-family',fontFamily);}
if(lineHeight){hiddenDiv.css('line-height',lineHeight);}
if($textarea.attr('wrap')==="off"){hiddenDiv.css('overflow-wrap',"normal").css('white-space',"pre");}
hiddenDiv.text($textarea.val()+'\n');var content=hiddenDiv.html().replace(/\n/g,'<br>');hiddenDiv.html(content);if($textarea.is(':visible')){hiddenDiv.css('width',$textarea.width());}
else{hiddenDiv.css('width',$(window).width()/2);}
$textarea.css('height',hiddenDiv.height());}
$(text_area_selector).each(function(){var $textarea=$(this);if($textarea.val().length){textareaAutoResize($textarea);}});$('body').on('keyup keydown autoresize',text_area_selector,function(){textareaAutoResize($(this));});$(document).on('change','.file-field input[type="file"]',function(){var file_field=$(this).closest('.file-field');var path_input=file_field.find('input.file-path');var files=$(this)[0].files;var file_names=[];for(var i=0;i<files.length;i++){file_names.push(files[i].name);}
path_input.val(file_names.join(", "));path_input.trigger('change');});var range_type='input[type=range]';var range_mousedown=false;var left;$(range_type).each(function(){var thumb=$('<span class="thumb"><span class="value"></span></span>');$(this).after(thumb);});var range_wrapper='.range-field';$(document).on('change',range_type,function(e){var thumb=$(this).siblings('.thumb');thumb.find('.value').html($(this).val());});$(document).on('input mousedown touchstart',range_type,function(e){var thumb=$(this).siblings('.thumb');var width=$(this).outerWidth();if(thumb.length<=0){thumb=$('<span class="thumb"><span class="value"></span></span>');$(this).after(thumb);}
thumb.find('.value').html($(this).val());range_mousedown=true;$(this).addClass('active');if(!thumb.hasClass('active')){thumb.velocity({height:"30px",width:"30px",top:"-20px",marginLeft:"-15px"},{duration:300,easing:'easeOutExpo'});}
if(e.type!=='input'){if(e.pageX===undefined||e.pageX===null){left=e.originalEvent.touches[0].pageX-$(this).offset().left;}
else{left=e.pageX-$(this).offset().left;}
if(left<0){left=0;}
else if(left>width){left=width;}
thumb.addClass('active').css('left',left);}
thumb.find('.value').html($(this).val());});$(document).on('mouseup touchend',range_wrapper,function(){range_mousedown=false;$(this).removeClass('active');});$(document).on('mousemove touchmove',range_wrapper,function(e){var thumb=$(this).children('.thumb');var left;if(range_mousedown){if(!thumb.hasClass('active')){thumb.velocity({height:'30px',width:'30px',top:'-20px',marginLeft:'-15px'},{duration:300,easing:'easeOutExpo'});}
if(e.pageX===undefined||e.pageX===null){left=e.originalEvent.touches[0].pageX-$(this).offset().left;}
else{left=e.pageX-$(this).offset().left;}
var width=$(this).outerWidth();if(left<0){left=0;}
else if(left>width){left=width;}
thumb.addClass('active').css('left',left);thumb.find('.value').html(thumb.siblings(range_type).val());}});$(document).on('mouseout touchleave',range_wrapper,function(){if(!range_mousedown){var thumb=$(this).children('.thumb');if(thumb.hasClass('active')){thumb.velocity({height:'0',width:'0',top:'10px',marginLeft:'-6px'},{duration:100});}
thumb.removeClass('active');}});$.fn.autocomplete=function(options){var defaults={data:{}};options=$.extend(defaults,options);return this.each(function(){var $input=$(this);var data=options.data,$inputDiv=$input.closest('.input-field');if(!$.isEmptyObject(data)){var $autocomplete=$('<ul class="autocomplete-content dropdown-content"></ul>');if($inputDiv.length){$inputDiv.append($autocomplete);}else{$input.after($autocomplete);}
var highlight=function(string,$el){var img=$el.find('img');var matchStart=$el.text().toLowerCase().indexOf(""+string.toLowerCase()+""),matchEnd=matchStart+string.length-1,beforeMatch=$el.text().slice(0,matchStart),matchText=$el.text().slice(matchStart,matchEnd+1),afterMatch=$el.text().slice(matchEnd+1);$el.html("<span>"+beforeMatch+"<span class='highlight'>"+matchText+"</span>"+afterMatch+"</span>");if(img.length){$el.prepend(img);}};$input.on('keyup',function(e){if(e.which===13){$autocomplete.find('li').first().click();return;}
var val=$input.val().toLowerCase();$autocomplete.empty();if(val!==''){for(var key in data){if(data.hasOwnProperty(key)&&key.toLowerCase().indexOf(val)!==-1&&key.toLowerCase()!==val){var autocompleteOption=$('<li></li>');if(!!data[key]){autocompleteOption.append('<img src="'+data[key]+'" class="right circle"><span>'+key+'</span>');}else{autocompleteOption.append('<span>'+key+'</span>');}
$autocomplete.append(autocompleteOption);highlight(val,autocompleteOption);}}}});$autocomplete.on('click','li',function(){$input.val($(this).text().trim());$input.trigger('change');$autocomplete.empty();});}});};});$.fn.material_select=function(callback){$(this).each(function(){var $select=$(this);if($select.hasClass('browser-default')){return;}
var multiple=$select.attr('multiple')?true:false,lastID=$select.data('select-id');if(lastID){$select.parent().find('span.caret').remove();$select.parent().find('input').remove();$select.unwrap();$('ul#select-options-'+lastID).remove();}
if(callback==='destroy'){$select.data('select-id',null).removeClass('initialized');return;}
var uniqueID=Materialize.guid();$select.data('select-id',uniqueID);var wrapper=$('<div class="select-wrapper"></div>');wrapper.addClass($select.attr('class'));var options=$('<ul id="select-options-'+uniqueID+'" class="dropdown-content select-dropdown '+(multiple?'multiple-select-dropdown':'')+'"></ul>'),selectChildren=$select.children('option, optgroup'),valuesSelected=[],optionsHover=false;var label=$select.find('option:selected').html()||$select.find('option:first').html()||"";var appendOptionWithIcon=function(select,option,type){var disabledClass=(option.is(':disabled'))?'disabled ':'';var optgroupClass=(type==='optgroup-option')?'optgroup-option ':'';var icon_url=option.data('icon');var classes=option.attr('class');if(!!icon_url){var classString='';if(!!classes)classString=' class="'+classes+'"';if(type==='multiple'){options.append($('<li class="'+disabledClass+'"><img alt="" src="'+icon_url+'"'+classString+'><span><input type="checkbox"'+disabledClass+'/><label></label>'+option.html()+'</span></li>'));}else{options.append($('<li class="'+disabledClass+optgroupClass+'"><img alt="" src="'+icon_url+'"'+classString+'><span>'+option.html()+'</span></li>'));}
return true;}
var mdi=option.data('mdi');var iconColor=option.data('iconColor');if(!!mdi){var classString=(!!classes)?' class="mdi mdi-'+mdi+' '+classes+'"':' class="mdi mdi-'+mdi+'"';var styleString='style="'+(mdi.startsWith("custom-")?'background-color':'color')+':'+iconColor+'"';if(type==='multiple'){options.append($('<li class="'+disabledClass+'"><span><input type="checkbox"'+disabledClass+'/><label></label> <i'+classString+styleString+'/> '+option.html()+'</span></li>'));}else{options.append($('<li class="'+disabledClass+optgroupClass+'"><span><i'+classString+styleString+'/> '+option.html()+'</span></li>'));}
return true;}
if
(type==='multiple'){options.append($('<li class="'+disabledClass+'"><span><input type="checkbox"'+disabledClass+'/><label></label>'+option.html()+'</span></li>'));}
else{options.append($('<li class="'+disabledClass+optgroupClass+'"><span>'+option.html()+'</span></li>'));}};if(selectChildren.length){selectChildren.each(function(){if($(this).is('option')){if(multiple){appendOptionWithIcon($select,$(this),'multiple');}else{appendOptionWithIcon($select,$(this));}}else if($(this).is('optgroup')){var selectOptions=$(this).children('option');options.append($('<li class="optgroup"><span>'+$(this).attr('label')+'</span></li>'));selectOptions.each(function(){appendOptionWithIcon($select,$(this),'optgroup-option');});}});}
options.find('li:not(.optgroup)').each(function(i){$(this).click(function(e){if(!$(this).hasClass('disabled')&&!$(this).hasClass('optgroup')){var selected=true;if(multiple){$('input[type="checkbox"]',this).prop('checked',function(i,v){return!v;});selected=toggleEntryFromArray(valuesSelected,$(this).index(),$select);$newSelect.trigger('focus');}else{options.find('li').removeClass('active');$(this).toggleClass('active');$newSelect.val($(this).text());}
activateOption(options,$(this));$select.find('option').eq(i).prop('selected',selected);$select.trigger('change');if(typeof callback!=='undefined')callback();}
e.stopPropagation();});});$select.wrap(wrapper);var dropdownIcon=$('<span class="caret">&#9660;</span>');if($select.is(':disabled'))
dropdownIcon.addClass('disabled');var sanitizedLabelHtml=label.replace(/"/g,'&quot;');var $newSelect=$('<input type="text" class="select-dropdown" readonly="true" '+(($select.is(':disabled'))?'disabled':'')+' data-activates="select-options-'+uniqueID+'" value="'+sanitizedLabelHtml+'"/>');$select.before($newSelect);$newSelect.before(dropdownIcon);$newSelect.after(options);if(!$select.is(':disabled')){$newSelect.dropdown({'hover':false,'closeOnClick':false});}
if($select.attr('tabindex')){$($newSelect[0]).attr('tabindex',$select.attr('tabindex'));}
$select.addClass('initialized');$newSelect.on({'focus':function(){if($('ul.select-dropdown').not(options[0]).is(':visible')){$('input.select-dropdown').trigger('close');}
if(!options.is(':visible')){$(this).trigger('open',['focus']);var label=$(this).val();var selectedOption=options.find('li').filter(function(){return $(this).text().toLowerCase()===label.toLowerCase();})[0];activateOption(options,selectedOption);}},'click':function(e){e.stopPropagation();}});$newSelect.on('blur',function(){if(!multiple){$(this).trigger('close');}
options.find('li.selected').removeClass('selected');});options.hover(function(){optionsHover=true;},function(){optionsHover=false;});$(window).on({'click':function(){multiple&&(optionsHover||$newSelect.trigger('close'));}});if(multiple){$select.find("option:selected:not(:disabled)").each(function(){var index=$(this).index();toggleEntryFromArray(valuesSelected,index,$select);options.find("li").eq(index).find(":checkbox").prop("checked",true);});}
var activateOption=function(collection,newOption){if(newOption){collection.find('li.selected').removeClass('selected');var option=$(newOption);option.addClass('selected');options.scrollTo(option);}};var filterQuery=[],onKeyDown=function(e){if(e.which==9){$newSelect.trigger('close');return;}
if(e.which==40&&!options.is(':visible')){$newSelect.trigger('open');return;}
if(e.which==13&&!options.is(':visible')){return;}
e.preventDefault();var letter=String.fromCharCode(e.which).toLowerCase(),nonLetters=[9,13,27,38,40];if(letter&&(nonLetters.indexOf(e.which)===-1)){filterQuery.push(letter);var string=filterQuery.join(''),newOption=options.find('li').filter(function(){return $(this).text().toLowerCase().indexOf(string)===0;})[0];if(newOption){activateOption(options,newOption);}}
if(e.which==13){var activeOption=options.find('li.selected:not(.disabled)')[0];if(activeOption){$(activeOption).trigger('click');if(!multiple){$newSelect.trigger('close');}}}
if(e.which==40){if(options.find('li.selected').length){newOption=options.find('li.selected').next('li:not(.disabled)')[0];}else{newOption=options.find('li:not(.disabled)')[0];}
activateOption(options,newOption);}
if(e.which==27){$newSelect.trigger('close');}
if(e.which==38){newOption=options.find('li.selected').prev('li:not(.disabled)')[0];if(newOption)
activateOption(options,newOption);}
setTimeout(function(){filterQuery=[];},1000);};$newSelect.on('keydown',onKeyDown);});function toggleEntryFromArray(entriesArray,entryIndex,select){var index=entriesArray.indexOf(entryIndex),notAdded=index===-1;if(notAdded){entriesArray.push(entryIndex);}else{entriesArray.splice(index,1);}
select.siblings('ul.dropdown-content').find('li').eq(entryIndex).toggleClass('active');select.find('option').eq(entryIndex).prop('selected',notAdded);setValueToInput(entriesArray,select);return notAdded;}
function setValueToInput(entriesArray,select){var value='';for(var i=0,count=entriesArray.length;i<count;i++){var text=select.find('option').eq(entriesArray[i]).text();i===0?value+=text:value+=', '+text;}
if(value===''){value=select.find('option:disabled').eq(0).text();}
select.siblings('input.select-dropdown').val(value);}};}(jQuery));;(function($){var methods={init:function(options){var defaults={indicators:true,height:400,transition:500,interval:6000};options=$.extend(defaults,options);return this.each(function(){var $this=$(this);var $slider=$this.find('ul.slides').first();var $slides=$slider.find('> li');var $active_index=$slider.find('.active').index();var $active,$indicators,$interval;if($active_index!=-1){$active=$slides.eq($active_index);}
function captionTransition(caption,duration){if(caption.hasClass("center-align")){caption.velocity({opacity:0,translateY:-100},{duration:duration,queue:false});}
else if(caption.hasClass("right-align")){caption.velocity({opacity:0,translateX:100},{duration:duration,queue:false});}
else if(caption.hasClass("left-align")){caption.velocity({opacity:0,translateX:-100},{duration:duration,queue:false});}}
function moveToSlide(index){if(index>=$slides.length)index=0;else if(index<0)index=$slides.length-1;$active_index=$slider.find('.active').index();if($active_index!=index){$active=$slides.eq($active_index);$caption=$active.find('.caption');$active.removeClass('active');$active.velocity({opacity:0},{duration:options.transition,queue:false,easing:'easeOutQuad',complete:function(){$slides.not('.active').velocity({opacity:0,translateX:0,translateY:0},{duration:0,queue:false});}});captionTransition($caption,options.transition);if(options.indicators){$indicators.eq($active_index).removeClass('active');}
$slides.eq(index).velocity({opacity:1},{duration:options.transition,queue:false,easing:'easeOutQuad'});$slides.eq(index).find('.caption').velocity({opacity:1,translateX:0,translateY:0},{duration:options.transition,delay:options.transition,queue:false,easing:'easeOutQuad'});$slides.eq(index).addClass('active');if(options.indicators){$indicators.eq(index).addClass('active');}}}
if(!$this.hasClass('fullscreen')){if(options.indicators){$this.height(options.height+40);}
else{$this.height(options.height);}
$slider.height(options.height);}
$slides.find('.caption').each(function(){captionTransition($(this),0);});$slides.find('img').each(function(){var placeholderBase64='data:image/gif;base64,R0lGODlhAQABAIABAP///wAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';if($(this).attr('src')!==placeholderBase64){$(this).css('background-image','url('+$(this).attr('src')+')');$(this).attr('src',placeholderBase64);}});if(options.indicators){$indicators=$('<ul class="indicators"></ul>');$slides.each(function(index){var $indicator=$('<li class="indicator-item"></li>');$indicator.click(function(){var $parent=$slider.parent();var curr_index=$parent.find($(this)).index();moveToSlide(curr_index);clearInterval($interval);$interval=setInterval(function(){$active_index=$slider.find('.active').index();if($slides.length==$active_index+1)$active_index=0;else $active_index+=1;moveToSlide($active_index);},options.transition+options.interval);});$indicators.append($indicator);});$this.append($indicators);$indicators=$this.find('ul.indicators').find('li.indicator-item');}
if($active){$active.show();}
else{$slides.first().addClass('active').velocity({opacity:1},{duration:options.transition,queue:false,easing:'easeOutQuad'});$active_index=0;$active=$slides.eq($active_index);if(options.indicators){$indicators.eq($active_index).addClass('active');}}
$active.find('img').each(function(){$active.find('.caption').velocity({opacity:1,translateX:0,translateY:0},{duration:options.transition,queue:false,easing:'easeOutQuad'});});$interval=setInterval(function(){$active_index=$slider.find('.active').index();moveToSlide($active_index+1);},options.transition+options.interval);var panning=false;var swipeLeft=false;var swipeRight=false;$this.hammer({prevent_default:false}).bind('pan',function(e){if(e.gesture.pointerType==="touch"){clearInterval($interval);var direction=e.gesture.direction;var x=e.gesture.deltaX;var velocityX=e.gesture.velocityX;$curr_slide=$slider.find('.active');$curr_slide.velocity({translateX:x},{duration:50,queue:false,easing:'easeOutQuad'});if(direction===4&&(x>($this.innerWidth()/2)||velocityX<-0.65)){swipeRight=true;}
else if(direction===2&&(x<(-1*$this.innerWidth()/2)||velocityX>0.65)){swipeLeft=true;}
var next_slide;if(swipeLeft){next_slide=$curr_slide.next();if(next_slide.length===0){next_slide=$slides.first();}
next_slide.velocity({opacity:1},{duration:300,queue:false,easing:'easeOutQuad'});}
if(swipeRight){next_slide=$curr_slide.prev();if(next_slide.length===0){next_slide=$slides.last();}
next_slide.velocity({opacity:1},{duration:300,queue:false,easing:'easeOutQuad'});}}}).bind('panend',function(e){if(e.gesture.pointerType==="touch"){$curr_slide=$slider.find('.active');panning=false;curr_index=$slider.find('.active').index();if(!swipeRight&&!swipeLeft||$slides.length<=1){$curr_slide.velocity({translateX:0},{duration:300,queue:false,easing:'easeOutQuad'});}
else if(swipeLeft){moveToSlide(curr_index+1);$curr_slide.velocity({translateX:-1*$this.innerWidth()},{duration:300,queue:false,easing:'easeOutQuad',complete:function(){$curr_slide.velocity({opacity:0,translateX:0},{duration:0,queue:false});}});}
else if(swipeRight){moveToSlide(curr_index-1);$curr_slide.velocity({translateX:$this.innerWidth()},{duration:300,queue:false,easing:'easeOutQuad',complete:function(){$curr_slide.velocity({opacity:0,translateX:0},{duration:0,queue:false});}});}
swipeLeft=false;swipeRight=false;clearInterval($interval);$interval=setInterval(function(){$active_index=$slider.find('.active').index();if($slides.length==$active_index+1)$active_index=0;else $active_index+=1;moveToSlide($active_index);},options.transition+options.interval);}});$this.on('sliderPause',function(){clearInterval($interval);});$this.on('sliderStart',function(){clearInterval($interval);$interval=setInterval(function(){$active_index=$slider.find('.active').index();if($slides.length==$active_index+1)$active_index=0;else $active_index+=1;moveToSlide($active_index);},options.transition+options.interval);});$this.on('sliderNext',function(){$active_index=$slider.find('.active').index();moveToSlide($active_index+1);});$this.on('sliderPrev',function(){$active_index=$slider.find('.active').index();moveToSlide($active_index-1);});});},pause:function(){$(this).trigger('sliderPause');},start:function(){$(this).trigger('sliderStart');},next:function(){$(this).trigger('sliderNext');},prev:function(){$(this).trigger('sliderPrev');}};$.fn.slider=function(methodOrOptions){if(methods[methodOrOptions]){return methods[methodOrOptions].apply(this,Array.prototype.slice.call(arguments,1));}else if(typeof methodOrOptions==='object'||!methodOrOptions){return methods.init.apply(this,arguments);}else{$.error('Method '+methodOrOptions+' does not exist on jQuery.tooltip');}};}(jQuery));;(function($){$(document).ready(function(){$(document).on('click.card','.card',function(e){if($(this).find('> .card-reveal').length){if($(e.target).is($('.card-reveal .card-title'))||$(e.target).is($('.card-reveal .card-title i'))){$(this).find('.card-reveal').velocity({translateY:0},{duration:225,queue:false,easing:'easeInOutQuad',complete:function(){$(this).css({display:'none'});}});}
else if($(e.target).is($('.card .activator'))||$(e.target).is($('.card .activator i'))){$(e.target).closest('.card').css('overflow','hidden');$(this).find('.card-reveal').css({display:'block'}).velocity("stop",false).velocity({translateY:'-100%'},{duration:300,queue:false,easing:'easeInOutQuad'});}}});});}(jQuery));;(function($){var chipsHandleEvents=false;var materialChipsDefaults={data:[],placeholder:'',secondaryPlaceholder:'',};$(document).ready(function(){$(document).on('click','.chip .close',function(e){var $chips=$(this).closest('.chips');if($chips.attr('data-initialized')){return;}
$(this).closest('.chip').remove();});});$.fn.material_chip=function(options){var self=this;this.$el=$(this);this.$document=$(document);this.SELS={CHIPS:'.chips',CHIP:'.chip',INPUT:'input',DELETE:'.material-icons',SELECTED_CHIP:'.selected',};if('data'===options){return this.$el.data('chips');}
var curr_options=$.extend({},materialChipsDefaults,options);this.init=function(){var i=0;var chips;self.$el.each(function(){var $chips=$(this);var chipId=Materialize.guid();if(!curr_options.data||!(curr_options.data instanceof Array)){curr_options.data=[];}
$chips.data('chips',curr_options.data);$chips.attr('data-index',i);$chips.attr('data-initialized',true);if(!$chips.hasClass(self.SELS.CHIPS)){$chips.addClass('chips');}
self.chips($chips,chipId);i++;});};this.handleEvents=function(){var SELS=self.SELS;self.$document.off('click.chips-focus',SELS.CHIPS).on('click.chips-focus',SELS.CHIPS,function(e){$(e.target).find(SELS.INPUT).focus();});self.$document.off('click.chips-select',SELS.CHIP).on('click.chips-select',SELS.CHIP,function(e){$(SELS.CHIP).removeClass('selected');$(this).toggleClass('selected');});self.$document.off('keydown.chips').on('keydown.chips',function(e){if($(e.target).is('input, textarea')){return;}
var $chip=self.$document.find(SELS.CHIP+SELS.SELECTED_CHIP);var $chips=$chip.closest(SELS.CHIPS);var length=$chip.siblings(SELS.CHIP).length;var index;if(!$chip.length){return;}
if(e.which===8||e.which===46){e.preventDefault();index=$chip.index();self.deleteChip(index,$chips);var selectIndex=null;if((index+1)<length){selectIndex=index;}else if(index===length||(index+1)===length){selectIndex=length-1;}
if(selectIndex<0)selectIndex=null;if(null!==selectIndex){self.selectChip(selectIndex,$chips);}
if(!length)$chips.find('input').focus();}else if(e.which===37){index=$chip.index()-1;if(index<0){return;}
$(SELS.CHIP).removeClass('selected');self.selectChip(index,$chips);}else if(e.which===39){index=$chip.index()+1;$(SELS.CHIP).removeClass('selected');if(index>length){$chips.find('input').focus();return;}
self.selectChip(index,$chips);}});self.$document.off('focusin.chips',SELS.CHIPS+' '+SELS.INPUT).on('focusin.chips',SELS.CHIPS+' '+SELS.INPUT,function(e){var $currChips=$(e.target).closest(SELS.CHIPS);$currChips.addClass('focus');$currChips.siblings('label, .prefix').addClass('active');$(SELS.CHIP).removeClass('selected');});self.$document.off('focusout.chips',SELS.CHIPS+' '+SELS.INPUT).on('focusout.chips',SELS.CHIPS+' '+SELS.INPUT,function(e){var $currChips=$(e.target).closest(SELS.CHIPS);$currChips.removeClass('focus');if(!$currChips.data('chips').length){$currChips.siblings('label').removeClass('active');}
$currChips.siblings('.prefix').removeClass('active');});self.$document.off('keydown.chips-add',SELS.CHIPS+' '+SELS.INPUT).on('keydown.chips-add',SELS.CHIPS+' '+SELS.INPUT,function(e){var $target=$(e.target);var $chips=$target.closest(SELS.CHIPS);var chipsLength=$chips.children(SELS.CHIP).length;if(13===e.which){e.preventDefault();self.addChip({tag:$target.val()},$chips);$target.val('');return;}
if((8===e.keyCode||37===e.keyCode)&&''===$target.val()&&chipsLength){self.selectChip(chipsLength-1,$chips);$target.blur();return;}});self.$document.off('click.chips-delete',SELS.CHIPS+' '+SELS.DELETE).on('click.chips-delete',SELS.CHIPS+' '+SELS.DELETE,function(e){var $target=$(e.target);var $chips=$target.closest(SELS.CHIPS);var $chip=$target.closest(SELS.CHIP);e.stopPropagation();self.deleteChip($chip.index(),$chips);$chips.find('input').focus();});};this.chips=function($chips,chipId){var html='';$chips.data('chips').forEach(function(elem){html+=self.renderChip(elem);});html+='<input id="'+chipId+'" class="input" placeholder="">';$chips.html(html);self.setPlaceholder($chips);var label=$chips.next('label');if(label.length){label.attr('for',chipId);if($chips.data('chips').length){label.addClass('active');}}};this.renderChip=function(elem){if(!elem.tag)return;var html='<div class="chip">'+elem.tag;if(elem.image){html+=' <img src="'+elem.image+'"> ';}
html+='<i class="material-icons close">close</i>';html+='</div>';return html;};this.setPlaceholder=function($chips){if($chips.data('chips').length&&curr_options.placeholder){$chips.find('input').prop('placeholder',curr_options.placeholder);}else if(!$chips.data('chips').length&&curr_options.secondaryPlaceholder){$chips.find('input').prop('placeholder',curr_options.secondaryPlaceholder);}};this.isValid=function($chips,elem){var chips=$chips.data('chips');var exists=false;for(var i=0;i<chips.length;i++){if(chips[i].tag===elem.tag){exists=true;return;}}
return''!==elem.tag&&!exists;};this.addChip=function(elem,$chips){if(!self.isValid($chips,elem)){return;}
var chipHtml=self.renderChip(elem);var newData=[];var oldData=$chips.data('chips');for(var i=0;i<oldData.length;i++){newData.push(oldData[i]);}
newData.push(elem);$chips.data('chips',newData);$(chipHtml).insertBefore($chips.find('input'));$chips.trigger('chip.add',elem);self.setPlaceholder($chips);};this.deleteChip=function(chipIndex,$chips){var chip=$chips.data('chips')[chipIndex];$chips.find('.chip').eq(chipIndex).remove();var newData=[];var oldData=$chips.data('chips');for(var i=0;i<oldData.length;i++){if(i!==chipIndex){newData.push(oldData[i]);}}
$chips.data('chips',newData);$chips.trigger('chip.delete',chip);self.setPlaceholder($chips);};this.selectChip=function(chipIndex,$chips){var $chip=$chips.find('.chip').eq(chipIndex);if($chip&&false===$chip.hasClass('selected')){$chip.addClass('selected');$chips.trigger('chip.select',$chips.data('chips')[chipIndex]);}};this.getChipsElement=function(index,$chips){return $chips.eq(index);};this.init();if(!chipsHandleEvents){this.handleEvents();chipsHandleEvents=true;}};}(jQuery));;(function($){$.fn.pushpin=function(options){var defaults={top:0,bottom:Infinity,offset:0};if(options==="remove"){this.each(function(){if(id=$(this).data('pushpin-id')){$(window).off('scroll.'+id);$(this).removeData('pushpin-id').removeClass('pin-top pinned pin-bottom').removeAttr('style');}});return false;}
options=$.extend(defaults,options);$index=0;return this.each(function(){var $uniqueId=Materialize.guid(),$this=$(this),$original_offset=$(this).offset().top;function removePinClasses(object){object.removeClass('pin-top');object.removeClass('pinned');object.removeClass('pin-bottom');}
function updateElements(objects,scrolled){objects.each(function(){if(options.top<=scrolled&&options.bottom>=scrolled&&!$(this).hasClass('pinned')){removePinClasses($(this));$(this).css('top',options.offset);$(this).addClass('pinned');}
if(scrolled<options.top&&!$(this).hasClass('pin-top')){removePinClasses($(this));$(this).css('top',0);$(this).addClass('pin-top');}
if(scrolled>options.bottom&&!$(this).hasClass('pin-bottom')){removePinClasses($(this));$(this).addClass('pin-bottom');$(this).css('top',options.bottom-$original_offset);}});}
$(this).data('pushpin-id',$uniqueId);updateElements($this,$(window).scrollTop());$(window).on('scroll.'+$uniqueId,function(){var $scrolled=$(window).scrollTop()+options.offset;updateElements($this,$scrolled);});});};}(jQuery));;(function($){$(document).ready(function(){$.fn.reverse=[].reverse;$(document).on('mouseenter.fixedActionBtn','.fixed-action-btn:not(.click-to-toggle):not(.toolbar)',function(e){var $this=$(this);openFABMenu($this);});$(document).on('mouseleave.fixedActionBtn','.fixed-action-btn:not(.click-to-toggle):not(.toolbar)',function(e){var $this=$(this);closeFABMenu($this);});$(document).on('click.fabClickToggle','.fixed-action-btn.click-to-toggle > a',function(e){var $this=$(this);var $menu=$this.parent();if($menu.hasClass('active')){closeFABMenu($menu);}else{openFABMenu($menu);}});$(document).on('click.fabToolbar','.fixed-action-btn.toolbar > a',function(e){var $this=$(this);var $menu=$this.parent();FABtoToolbar($menu);});});$.fn.extend({openFAB:function(){openFABMenu($(this));},closeFAB:function(){closeFABMenu($(this));},openToolbar:function(){FABtoToolbar($(this));},closeToolbar:function(){toolbarToFAB($(this));}});var openFABMenu=function(btn){var $this=btn;if($this.hasClass('active')===false){var horizontal=$this.hasClass('horizontal');var offsetY,offsetX;if(horizontal===true){offsetX=40;}else{offsetY=40;}
$this.addClass('active');$this.find('ul .btn-floating').velocity({scaleY:".4",scaleX:".4",translateY:offsetY+'px',translateX:offsetX+'px'},{duration:0});var time=0;$this.find('ul .btn-floating').reverse().each(function(){$(this).velocity({opacity:"1",scaleX:"1",scaleY:"1",translateY:"0",translateX:'0'},{duration:80,delay:time});time+=40;});}};var closeFABMenu=function(btn){var $this=btn;var horizontal=$this.hasClass('horizontal');var offsetY,offsetX;if(horizontal===true){offsetX=40;}else{offsetY=40;}
$this.removeClass('active');var time=0;$this.find('ul .btn-floating').velocity("stop",true);$this.find('ul .btn-floating').velocity({opacity:"0",scaleX:".4",scaleY:".4",translateY:offsetY+'px',translateX:offsetX+'px'},{duration:80});};var FABtoToolbar=function(btn){if(btn.attr('data-open')==="true"){return;}
var offsetX,offsetY,scaleFactor;var windowWidth=window.innerWidth;var windowHeight=window.innerHeight;var btnRect=btn[0].getBoundingClientRect();var anchor=btn.find('> a').first();var menu=btn.find('> ul').first();var backdrop=$('<div class="fab-backdrop"></div>');var fabColor=anchor.css('background-color');anchor.append(backdrop);offsetX=btnRect.left-(windowWidth/2)+(btnRect.width/2);offsetY=windowHeight-btnRect.bottom;scaleFactor=windowWidth/backdrop.width();btn.attr('data-origin-bottom',btnRect.bottom);btn.attr('data-origin-left',btnRect.left);btn.attr('data-origin-width',btnRect.width);btn.addClass('active');btn.attr('data-open',true);btn.css({'text-align':'center',width:'100%',bottom:0,left:0,transform:'translateX('+offsetX+'px)',transition:'none'});anchor.css({transform:'translateY('+-offsetY+'px)',transition:'none'});backdrop.css({'background-color':fabColor});setTimeout(function(){btn.css({transform:'',transition:'transform .2s cubic-bezier(0.550, 0.085, 0.680, 0.530), background-color 0s linear .2s'});anchor.css({overflow:'visible',transform:'',transition:'transform .2s'});setTimeout(function(){btn.css({overflow:'hidden','background-color':fabColor});backdrop.css({transform:'scale('+scaleFactor+')',transition:'transform .2s cubic-bezier(0.550, 0.055, 0.675, 0.190)'});menu.find('> li > a').css({opacity:1});$(window).on('scroll.fabToolbarClose',function(){toolbarToFAB(btn);$(window).off('scroll.fabToolbarClose');$(document).off('click.fabToolbarClose');});$(document).on('click.fabToolbarClose',function(e){if(!$(e.target).closest(menu).length){toolbarToFAB(btn);$(window).off('scroll.fabToolbarClose');$(document).off('click.fabToolbarClose');}});},100);},0);};var toolbarToFAB=function(btn){if(btn.attr('data-open')!=="true"){return;}
var offsetX,offsetY,scaleFactor;var windowWidth=window.innerWidth;var windowHeight=window.innerHeight;var btnWidth=btn.attr('data-origin-width');var btnBottom=btn.attr('data-origin-bottom');var btnLeft=btn.attr('data-origin-left');var anchor=btn.find('> .btn-floating').first();var menu=btn.find('> ul').first();var backdrop=btn.find('.fab-backdrop');var fabColor=anchor.css('background-color');offsetX=btnLeft-(windowWidth/2)+(btnWidth/2);offsetY=windowHeight-btnBottom;scaleFactor=windowWidth/backdrop.width();btn.removeClass('active');btn.attr('data-open',false);btn.css({'background-color':'transparent',transition:'none'});anchor.css({transition:'none'});backdrop.css({transform:'scale(0)','background-color':fabColor});menu.find('> li > a').css({opacity:''});setTimeout(function(){backdrop.remove();btn.css({'text-align':'',width:'',bottom:'',left:'',overflow:'','background-color':'',transform:'translate3d('+-offsetX+'px,0,0)'});anchor.css({overflow:'',transform:'translate3d(0,'+offsetY+'px,0)'});setTimeout(function(){btn.css({transform:'translate3d(0,0,0)',transition:'transform .2s'});anchor.css({transform:'translate3d(0,0,0)',transition:'transform .2s cubic-bezier(0.550, 0.055, 0.675, 0.190)'});},20);},200);};}(jQuery));;(function($){Materialize.fadeInImage=function(selectorOrEl){var element;if(typeof(selectorOrEl)==='string'){element=$(selectorOrEl);}else if(typeof(selectorOrEl)==='object'){element=selectorOrEl;}else{return;}
element.css({opacity:0});$(element).velocity({opacity:1},{duration:650,queue:false,easing:'easeOutSine'});$(element).velocity({opacity:1},{duration:1300,queue:false,easing:'swing',step:function(now,fx){fx.start=100;var grayscale_setting=now/100;var brightness_setting=150-(100-now)/1.75;if(brightness_setting<100){brightness_setting=100;}
if(now>=0){$(this).css({"-webkit-filter":"grayscale("+grayscale_setting+")"+"brightness("+brightness_setting+"%)","filter":"grayscale("+grayscale_setting+")"+"brightness("+brightness_setting+"%)"});}}});};Materialize.showStaggeredList=function(selectorOrEl){var element;if(typeof(selectorOrEl)==='string'){element=$(selectorOrEl);}else if(typeof(selectorOrEl)==='object'){element=selectorOrEl;}else{return;}
var time=0;element.find('li').velocity({translateX:"-100px"},{duration:0});element.find('li').each(function(){$(this).velocity({opacity:"1",translateX:"0"},{duration:800,delay:time,easing:[60,10]});time+=120;});};$(document).ready(function(){var swipeLeft=false;var swipeRight=false;$('.dismissable').each(function(){$(this).hammer({prevent_default:false}).bind('pan',function(e){if(e.gesture.pointerType==="touch"){var $this=$(this);var direction=e.gesture.direction;var x=e.gesture.deltaX;var velocityX=e.gesture.velocityX;$this.velocity({translateX:x},{duration:50,queue:false,easing:'easeOutQuad'});if(direction===4&&(x>($this.innerWidth()/2)||velocityX<-0.75)){swipeLeft=true;}
if(direction===2&&(x<(-1*$this.innerWidth()/2)||velocityX>0.75)){swipeRight=true;}}}).bind('panend',function(e){if(Math.abs(e.gesture.deltaX)<($(this).innerWidth()/2)){swipeRight=false;swipeLeft=false;}
if(e.gesture.pointerType==="touch"){var $this=$(this);if(swipeLeft||swipeRight){var fullWidth;if(swipeLeft){fullWidth=$this.innerWidth();}
else{fullWidth=-1*$this.innerWidth();}
$this.velocity({translateX:fullWidth,},{duration:100,queue:false,easing:'easeOutQuad',complete:function(){$this.css('border','none');$this.velocity({height:0,padding:0,},{duration:200,queue:false,easing:'easeOutQuad',complete:function(){$this.remove();}});}});}
else{$this.velocity({translateX:0,},{duration:100,queue:false,easing:'easeOutQuad'});}
swipeLeft=false;swipeRight=false;}});});});}(jQuery));;(function($){Materialize.scrollFire=function(options){var didScroll=false;window.addEventListener("scroll",function(){didScroll=true;});setInterval(function(){if(didScroll){didScroll=false;var windowScroll=window.pageYOffset+window.innerHeight;for(var i=0;i<options.length;i++){var value=options[i];var selector=value.selector,offset=value.offset,callback=value.callback;var currentElement=document.querySelector(selector);if(currentElement!==null){var elementOffset=currentElement.getBoundingClientRect().top+window.pageYOffset;if(windowScroll>(elementOffset+offset)){if(value.done!==true){if(typeof(callback)==='function'){callback.call(this,currentElement);}else if(typeof(callback)==='string'){var callbackFunc=new Function(callback);callbackFunc(currentElement);}
value.done=true;}}}}}},100);};})(jQuery);;(function(factory){if(typeof define=='function'&&define.amd)
define('picker',['jquery'],factory)
else if(typeof exports=='object')
module.exports=factory(require('jquery'))
else this.Picker=factory(jQuery)}(function($){var $window=$(window)
var $document=$(document)
var $html=$(document.documentElement)
function PickerConstructor(ELEMENT,NAME,COMPONENT,OPTIONS){if(!ELEMENT)return PickerConstructor
var
IS_DEFAULT_THEME=false,STATE={id:ELEMENT.id||'P'+Math.abs(~~(Math.random()*new Date()))},SETTINGS=COMPONENT?$.extend(true,{},COMPONENT.defaults,OPTIONS):OPTIONS||{},CLASSES=$.extend({},PickerConstructor.klasses(),SETTINGS.klass),$ELEMENT=$(ELEMENT),PickerInstance=function(){return this.start()},P=PickerInstance.prototype={constructor:PickerInstance,$node:$ELEMENT,start:function(){if(STATE&&STATE.start)return P
STATE.methods={}
STATE.start=true
STATE.open=false
STATE.type=ELEMENT.type
ELEMENT.autofocus=ELEMENT==getActiveElement()
ELEMENT.readOnly=!SETTINGS.editable
ELEMENT.id=ELEMENT.id||STATE.id
if(ELEMENT.type!='text'){ELEMENT.type='text'}
P.component=new COMPONENT(P,SETTINGS)
P.$root=$(PickerConstructor._.node('div',createWrappedComponent(),CLASSES.picker,'id="'+ELEMENT.id+'_root" tabindex="0"'))
prepareElementRoot()
if(SETTINGS.formatSubmit){prepareElementHidden()}
prepareElement()
if(SETTINGS.container)$(SETTINGS.container).append(P.$root)
else $ELEMENT.after(P.$root)
P.on({start:P.component.onStart,render:P.component.onRender,stop:P.component.onStop,open:P.component.onOpen,close:P.component.onClose,set:P.component.onSet}).on({start:SETTINGS.onStart,render:SETTINGS.onRender,stop:SETTINGS.onStop,open:SETTINGS.onOpen,close:SETTINGS.onClose,set:SETTINGS.onSet})
IS_DEFAULT_THEME=isUsingDefaultTheme(P.$root.children()[0])
if(ELEMENT.autofocus){P.open()}
return P.trigger('start').trigger('render')},render:function(entireComponent){if(entireComponent)P.$root.html(createWrappedComponent())
else P.$root.find('.'+CLASSES.box).html(P.component.nodes(STATE.open))
return P.trigger('render')},stop:function(){if(!STATE.start)return P
P.close()
if(P._hidden){P._hidden.parentNode.removeChild(P._hidden)}
P.$root.remove()
$ELEMENT.removeClass(CLASSES.input).removeData(NAME)
setTimeout(function(){$ELEMENT.off('.'+STATE.id)},0)
ELEMENT.type=STATE.type
ELEMENT.readOnly=false
P.trigger('stop')
STATE.methods={}
STATE.start=false
return P},open:function(dontGiveFocus){if(STATE.open)return P
$ELEMENT.addClass(CLASSES.active)
aria(ELEMENT,'expanded',true)
setTimeout(function(){P.$root.addClass(CLASSES.opened)
aria(P.$root[0],'hidden',false)},0)
if(dontGiveFocus!==false){STATE.open=true
if(IS_DEFAULT_THEME){$html.css('overflow','hidden').css('padding-right','+='+getScrollbarWidth())}
P.$root.eq(0).focus()
$document.on('click.'+STATE.id+' focusin.'+STATE.id,function(event){var target=event.target
if(target!=ELEMENT&&target!=document&&event.which!=3){P.close(target===P.$root.children()[0])}}).on('keydown.'+STATE.id,function(event){var
keycode=event.keyCode,keycodeToMove=P.component.key[keycode],target=event.target
if(keycode==27){P.close(true)}
else if(target==P.$root[0]&&(keycodeToMove||keycode==13)){event.preventDefault()
if(keycodeToMove){PickerConstructor._.trigger(P.component.key.go,P,[PickerConstructor._.trigger(keycodeToMove)])}
else if(!P.$root.find('.'+CLASSES.highlighted).hasClass(CLASSES.disabled)){P.set('select',P.component.item.highlight).close()}}
else if($.contains(P.$root[0],target)&&keycode==13){event.preventDefault()
target.click()}})}
return P.trigger('open')},close:function(giveFocus){if(giveFocus){P.$root.off('focus.toOpen').eq(0).focus()
setTimeout(function(){P.$root.on('focus.toOpen',handleFocusToOpenEvent)},0)}
$ELEMENT.removeClass(CLASSES.active)
aria(ELEMENT,'expanded',false)
setTimeout(function(){P.$root.removeClass(CLASSES.opened+' '+CLASSES.focused)
aria(P.$root[0],'hidden',true)},0)
if(!STATE.open)return P
STATE.open=false
if(IS_DEFAULT_THEME){$html.css('overflow','').css('padding-right','-='+getScrollbarWidth())}
$document.off('.'+STATE.id)
return P.trigger('close')},clear:function(options){return P.set('clear',null,options)},set:function(thing,value,options){var thingItem,thingValue,thingIsObject=$.isPlainObject(thing),thingObject=thingIsObject?thing:{}
options=thingIsObject&&$.isPlainObject(value)?value:options||{}
if(thing){if(!thingIsObject){thingObject[thing]=value}
for(thingItem in thingObject){thingValue=thingObject[thingItem]
if(thingItem in P.component.item){if(thingValue===undefined)thingValue=null
P.component.set(thingItem,thingValue,options)}
if(thingItem=='select'||thingItem=='clear'){$ELEMENT.val(thingItem=='clear'?'':P.get(thingItem,SETTINGS.format)).trigger('change')}}
P.render()}
return options.muted?P:P.trigger('set',thingObject)},get:function(thing,format){thing=thing||'value'
if(STATE[thing]!=null){return STATE[thing]}
if(thing=='valueSubmit'){if(P._hidden){return P._hidden.value}
thing='value'}
if(thing=='value'){return ELEMENT.value}
if(thing in P.component.item){if(typeof format=='string'){var thingValue=P.component.get(thing)
return thingValue?PickerConstructor._.trigger(P.component.formats.toString,P.component,[format,thingValue]):''}
return P.component.get(thing)}},on:function(thing,method,internal){var thingName,thingMethod,thingIsObject=$.isPlainObject(thing),thingObject=thingIsObject?thing:{}
if(thing){if(!thingIsObject){thingObject[thing]=method}
for(thingName in thingObject){thingMethod=thingObject[thingName]
if(internal){thingName='_'+thingName}
STATE.methods[thingName]=STATE.methods[thingName]||[]
STATE.methods[thingName].push(thingMethod)}}
return P},off:function(){var i,thingName,names=arguments;for(i=0,namesCount=names.length;i<namesCount;i+=1){thingName=names[i]
if(thingName in STATE.methods){delete STATE.methods[thingName]}}
return P},trigger:function(name,data){var _trigger=function(name){var methodList=STATE.methods[name]
if(methodList){methodList.map(function(method){PickerConstructor._.trigger(method,P,[data])})}}
_trigger('_'+name)
_trigger(name)
return P}}
function createWrappedComponent(){return PickerConstructor._.node('div',PickerConstructor._.node('div',PickerConstructor._.node('div',PickerConstructor._.node('div',P.component.nodes(STATE.open),CLASSES.box),CLASSES.wrap),CLASSES.frame),CLASSES.holder)}
function prepareElement(){$ELEMENT.data(NAME,P).addClass(CLASSES.input).attr('tabindex',-1).val($ELEMENT.data('value')?P.get('select',SETTINGS.format):ELEMENT.value)
if(!SETTINGS.editable){$ELEMENT.on('focus.'+STATE.id+' click.'+STATE.id,function(event){event.preventDefault()
P.$root.eq(0).focus()}).on('keydown.'+STATE.id,handleKeydownEvent)}
aria(ELEMENT,{haspopup:true,expanded:false,readonly:false,owns:ELEMENT.id+'_root'})}
function prepareElementRoot(){P.$root.on({keydown:handleKeydownEvent,focusin:function(event){P.$root.removeClass(CLASSES.focused)
event.stopPropagation()},'mousedown click':function(event){var target=event.target
if(target!=P.$root.children()[0]){event.stopPropagation()
if(event.type=='mousedown'&&!$(target).is('input, select, textarea, button, option')){event.preventDefault()
P.$root.eq(0).focus()}}}}).on({focus:function(){$ELEMENT.addClass(CLASSES.target)},blur:function(){$ELEMENT.removeClass(CLASSES.target)}}).on('focus.toOpen',handleFocusToOpenEvent).on('click','[data-pick], [data-nav], [data-clear], [data-close]',function(){var $target=$(this),targetData=$target.data(),targetDisabled=$target.hasClass(CLASSES.navDisabled)||$target.hasClass(CLASSES.disabled),activeElement=getActiveElement()
activeElement=activeElement&&(activeElement.type||activeElement.href)
if(targetDisabled||activeElement&&!$.contains(P.$root[0],activeElement)){P.$root.eq(0).focus()}
if(!targetDisabled&&targetData.nav){P.set('highlight',P.component.item.highlight,{nav:targetData.nav})}
else if(!targetDisabled&&'pick'in targetData){P.set('select',targetData.pick)}
else if(targetData.clear){P.clear().close(true)}
else if(targetData.close){P.close(true)}})
aria(P.$root[0],'hidden',true)}
function prepareElementHidden(){var name
if(SETTINGS.hiddenName===true){name=ELEMENT.name
ELEMENT.name=''}
else{name=[typeof SETTINGS.hiddenPrefix=='string'?SETTINGS.hiddenPrefix:'',typeof SETTINGS.hiddenSuffix=='string'?SETTINGS.hiddenSuffix:'_submit']
name=name[0]+ELEMENT.name+name[1]}
P._hidden=$('<input '+'type=hidden '+'name="'+name+'"'+
($ELEMENT.data('value')||ELEMENT.value?' value="'+P.get('select',SETTINGS.formatSubmit)+'"':'')+'>')[0]
$ELEMENT.on('change.'+STATE.id,function(){P._hidden.value=ELEMENT.value?P.get('select',SETTINGS.formatSubmit):''})
if(SETTINGS.container)$(SETTINGS.container).append(P._hidden)
else $ELEMENT.after(P._hidden)}
function handleKeydownEvent(event){var keycode=event.keyCode,isKeycodeDelete=/^(8|46)$/.test(keycode)
if(keycode==27){P.close()
return false}
if(keycode==32||isKeycodeDelete||!STATE.open&&P.component.key[keycode]){event.preventDefault()
event.stopPropagation()
if(isKeycodeDelete){P.clear().close()}
else{P.open()}}}
function handleFocusToOpenEvent(event){event.stopPropagation()
if(event.type=='focus'){P.$root.addClass(CLASSES.focused)}
P.open()}
return new PickerInstance()}
PickerConstructor.klasses=function(prefix){prefix=prefix||'picker'
return{picker:prefix,opened:prefix+'--opened',focused:prefix+'--focused',input:prefix+'__input',active:prefix+'__input--active',target:prefix+'__input--target',holder:prefix+'__holder',frame:prefix+'__frame',wrap:prefix+'__wrap',box:prefix+'__box'}}
function isUsingDefaultTheme(element){var theme,prop='position'
if(element.currentStyle){theme=element.currentStyle[prop]}
else if(window.getComputedStyle){theme=getComputedStyle(element)[prop]}
return theme=='fixed'}
function getScrollbarWidth(){if($html.height()<=$window.height()){return 0}
var $outer=$('<div style="visibility:hidden;width:100px" />').appendTo('body')
var widthWithoutScroll=$outer[0].offsetWidth
$outer.css('overflow','scroll')
var $inner=$('<div style="width:100%" />').appendTo($outer)
var widthWithScroll=$inner[0].offsetWidth
$outer.remove()
return widthWithoutScroll-widthWithScroll}
PickerConstructor._={group:function(groupObject){var
loopObjectScope,nodesList='',counter=PickerConstructor._.trigger(groupObject.min,groupObject)
for(;counter<=PickerConstructor._.trigger(groupObject.max,groupObject,[counter]);counter+=groupObject.i){loopObjectScope=PickerConstructor._.trigger(groupObject.item,groupObject,[counter])
nodesList+=PickerConstructor._.node(groupObject.node,loopObjectScope[0],loopObjectScope[1],loopObjectScope[2])}
return nodesList},node:function(wrapper,item,klass,attribute){if(!item)return''
item=$.isArray(item)?item.join(''):item
klass=klass?' class="'+klass+'"':''
attribute=attribute?' '+attribute:''
return'<'+wrapper+klass+attribute+'>'+item+'</'+wrapper+'>'},lead:function(number){return(number<10?'0':'')+number},trigger:function(callback,scope,args){return typeof callback=='function'?callback.apply(scope,args||[]):callback},digits:function(string){return(/\d/).test(string[1])?2:1},isDate:function(value){return{}.toString.call(value).indexOf('Date')>-1&&this.isInteger(value.getDate())},isInteger:function(value){return{}.toString.call(value).indexOf('Number')>-1&&value%1===0},ariaAttr:ariaAttr}
PickerConstructor.extend=function(name,Component){$.fn[name]=function(options,action){var componentData=this.data(name)
if(options=='picker'){return componentData}
if(componentData&&typeof options=='string'){return PickerConstructor._.trigger(componentData[options],componentData,[action])}
return this.each(function(){var $this=$(this)
if(!$this.data(name)){new PickerConstructor(this,name,Component,options)}})}
$.fn[name].defaults=Component.defaults}
function aria(element,attribute,value){if($.isPlainObject(attribute)){for(var key in attribute){ariaSet(element,key,attribute[key])}}
else{ariaSet(element,attribute,value)}}
function ariaSet(element,attribute,value){element.setAttribute((attribute=='role'?'':'aria-')+attribute,value)}
function ariaAttr(attribute,data){if(!$.isPlainObject(attribute)){attribute={attribute:data}}
data=''
for(var key in attribute){var attr=(key=='role'?'':'aria-')+key,attrVal=attribute[key]
data+=attrVal==null?'':attr+'="'+attribute[key]+'"'}
return data}
function getActiveElement(){try{return document.activeElement}catch(err){}}
return PickerConstructor}));;(function(factory){if(typeof define=='function'&&define.amd)
define(['picker','jquery'],factory)
else if(typeof exports=='object')
module.exports=factory(require('./picker.js'),require('jquery'))
else factory(Picker,jQuery)}(function(Picker,$){var DAYS_IN_WEEK=7,WEEKS_IN_CALENDAR=6,_=Picker._
function DatePicker(picker,settings){var calendar=this,element=picker.$node[0],elementValue=element.value,elementDataValue=picker.$node.data('value'),valueString=elementDataValue||elementValue,formatString=elementDataValue?settings.formatSubmit:settings.format,isRTL=function(){return element.currentStyle?element.currentStyle.direction=='rtl':getComputedStyle(picker.$root[0]).direction=='rtl'}
calendar.settings=settings
calendar.$node=picker.$node
calendar.queue={min:'measure create',max:'measure create',now:'now create',select:'parse create validate',highlight:'parse navigate create validate',view:'parse create validate viewset',disable:'deactivate',enable:'activate'}
calendar.item={}
calendar.item.clear=null
calendar.item.disable=(settings.disable||[]).slice(0)
calendar.item.enable=-(function(collectionDisabled){return collectionDisabled[0]===true?collectionDisabled.shift():-1})(calendar.item.disable)
calendar.set('min',settings.min).set('max',settings.max).set('now')
if(valueString){calendar.set('select',valueString,{format:formatString})}
else{calendar.set('select',null).set('highlight',calendar.item.now)}
calendar.key={40:7,38:-7,39:function(){return isRTL()?-1:1},37:function(){return isRTL()?1:-1},go:function(timeChange){var highlightedObject=calendar.item.highlight,targetDate=new Date(highlightedObject.year,highlightedObject.month,highlightedObject.date+timeChange)
calendar.set('highlight',targetDate,{interval:timeChange})
this.render()}}
picker.on('render',function(){picker.$root.find('.'+settings.klass.selectMonth).on('change',function(){var value=this.value
if(value){picker.set('highlight',[picker.get('view').year,value,picker.get('highlight').date])
picker.$root.find('.'+settings.klass.selectMonth).trigger('focus')}})
picker.$root.find('.'+settings.klass.selectYear).on('change',function(){var value=this.value
if(value){picker.set('highlight',[value,picker.get('view').month,picker.get('highlight').date])
picker.$root.find('.'+settings.klass.selectYear).trigger('focus')}})},1).on('open',function(){var includeToday=''
if(calendar.disabled(calendar.get('now'))){includeToday=':not(.'+settings.klass.buttonToday+')'}
picker.$root.find('button'+includeToday+', select').attr('disabled',false)},1).on('close',function(){picker.$root.find('button, select').attr('disabled',true)},1)}
DatePicker.prototype.set=function(type,value,options){var calendar=this,calendarItem=calendar.item
if(value===null){if(type=='clear')type='select'
calendarItem[type]=value
return calendar}
calendarItem[(type=='enable'?'disable':type=='flip'?'enable':type)]=calendar.queue[type].split(' ').map(function(method){value=calendar[method](type,value,options)
return value}).pop()
if(type=='select'){calendar.set('highlight',calendarItem.select,options)}
else if(type=='highlight'){calendar.set('view',calendarItem.highlight,options)}
else if(type.match(/^(flip|min|max|disable|enable)$/)){if(calendarItem.select&&calendar.disabled(calendarItem.select)){calendar.set('select',calendarItem.select,options)}
if(calendarItem.highlight&&calendar.disabled(calendarItem.highlight)){calendar.set('highlight',calendarItem.highlight,options)}}
return calendar}
DatePicker.prototype.get=function(type){return this.item[type]}
DatePicker.prototype.create=function(type,value,options){var isInfiniteValue,calendar=this
value=value===undefined?type:value
if(value==-Infinity||value==Infinity){isInfiniteValue=value}
else if($.isPlainObject(value)&&_.isInteger(value.pick)){value=value.obj}
else if($.isArray(value)){value=new Date(value[0],value[1],value[2])
value=_.isDate(value)?value:calendar.create().obj}
else if(_.isInteger(value)||_.isDate(value)){value=calendar.normalize(new Date(value),options)}
else{value=calendar.now(type,value,options)}
return{year:isInfiniteValue||value.getFullYear(),month:isInfiniteValue||value.getMonth(),date:isInfiniteValue||value.getDate(),day:isInfiniteValue||value.getDay(),obj:isInfiniteValue||value,pick:isInfiniteValue||value.getTime()}}
DatePicker.prototype.createRange=function(from,to){var calendar=this,createDate=function(date){if(date===true||$.isArray(date)||_.isDate(date)){return calendar.create(date)}
return date}
if(!_.isInteger(from)){from=createDate(from)}
if(!_.isInteger(to)){to=createDate(to)}
if(_.isInteger(from)&&$.isPlainObject(to)){from=[to.year,to.month,to.date+from];}
else if(_.isInteger(to)&&$.isPlainObject(from)){to=[from.year,from.month,from.date+to];}
return{from:createDate(from),to:createDate(to)}}
DatePicker.prototype.withinRange=function(range,dateUnit){range=this.createRange(range.from,range.to)
return dateUnit.pick>=range.from.pick&&dateUnit.pick<=range.to.pick}
DatePicker.prototype.overlapRanges=function(one,two){var calendar=this
one=calendar.createRange(one.from,one.to)
two=calendar.createRange(two.from,two.to)
return calendar.withinRange(one,two.from)||calendar.withinRange(one,two.to)||calendar.withinRange(two,one.from)||calendar.withinRange(two,one.to)}
DatePicker.prototype.now=function(type,value,options){value=new Date()
if(options&&options.rel){value.setDate(value.getDate()+options.rel)}
return this.normalize(value,options)}
DatePicker.prototype.navigate=function(type,value,options){var targetDateObject,targetYear,targetMonth,targetDate,isTargetArray=$.isArray(value),isTargetObject=$.isPlainObject(value),viewsetObject=this.item.view
if(isTargetArray||isTargetObject){if(isTargetObject){targetYear=value.year
targetMonth=value.month
targetDate=value.date}
else{targetYear=+value[0]
targetMonth=+value[1]
targetDate=+value[2]}
if(options&&options.nav&&viewsetObject&&viewsetObject.month!==targetMonth){targetYear=viewsetObject.year
targetMonth=viewsetObject.month}
targetDateObject=new Date(targetYear,targetMonth+(options&&options.nav?options.nav:0),1)
targetYear=targetDateObject.getFullYear()
targetMonth=targetDateObject.getMonth()
while(new Date(targetYear,targetMonth,targetDate).getMonth()!==targetMonth){targetDate-=1}
value=[targetYear,targetMonth,targetDate]}
return value}
DatePicker.prototype.normalize=function(value){value.setHours(0,0,0,0)
return value}
DatePicker.prototype.measure=function(type,value){var calendar=this
if(!value){value=type=='min'?-Infinity:Infinity}
else if(typeof value=='string'){value=calendar.parse(type,value)}
else if(_.isInteger(value)){value=calendar.now(type,value,{rel:value})}
return value}
DatePicker.prototype.viewset=function(type,dateObject){return this.create([dateObject.year,dateObject.month,1])}
DatePicker.prototype.validate=function(type,dateObject,options){var calendar=this,originalDateObject=dateObject,interval=options&&options.interval?options.interval:1,isFlippedBase=calendar.item.enable===-1,hasEnabledBeforeTarget,hasEnabledAfterTarget,minLimitObject=calendar.item.min,maxLimitObject=calendar.item.max,reachedMin,reachedMax,hasEnabledWeekdays=isFlippedBase&&calendar.item.disable.filter(function(value){if($.isArray(value)){var dateTime=calendar.create(value).pick
if(dateTime<dateObject.pick)hasEnabledBeforeTarget=true
else if(dateTime>dateObject.pick)hasEnabledAfterTarget=true}
return _.isInteger(value)}).length
if(!options||!options.nav)if((!isFlippedBase&&calendar.disabled(dateObject))||(isFlippedBase&&calendar.disabled(dateObject)&&(hasEnabledWeekdays||hasEnabledBeforeTarget||hasEnabledAfterTarget))||(!isFlippedBase&&(dateObject.pick<=minLimitObject.pick||dateObject.pick>=maxLimitObject.pick))){if(isFlippedBase&&!hasEnabledWeekdays&&((!hasEnabledAfterTarget&&interval>0)||(!hasEnabledBeforeTarget&&interval<0))){interval*=-1}
while(calendar.disabled(dateObject)){if(Math.abs(interval)>1&&(dateObject.month<originalDateObject.month||dateObject.month>originalDateObject.month)){dateObject=originalDateObject
interval=interval>0?1:-1}
if(dateObject.pick<=minLimitObject.pick){reachedMin=true
interval=1
dateObject=calendar.create([minLimitObject.year,minLimitObject.month,minLimitObject.date+(dateObject.pick===minLimitObject.pick?0:-1)])}
else if(dateObject.pick>=maxLimitObject.pick){reachedMax=true
interval=-1
dateObject=calendar.create([maxLimitObject.year,maxLimitObject.month,maxLimitObject.date+(dateObject.pick===maxLimitObject.pick?0:1)])}
if(reachedMin&&reachedMax){break}
dateObject=calendar.create([dateObject.year,dateObject.month,dateObject.date+interval])}}
return dateObject}
DatePicker.prototype.disabled=function(dateToVerify){var
calendar=this,isDisabledMatch=calendar.item.disable.filter(function(dateToDisable){if(_.isInteger(dateToDisable)){return dateToVerify.day===(calendar.settings.firstDay?dateToDisable:dateToDisable-1)%7}
if($.isArray(dateToDisable)||_.isDate(dateToDisable)){return dateToVerify.pick===calendar.create(dateToDisable).pick}
if($.isPlainObject(dateToDisable)){return calendar.withinRange(dateToDisable,dateToVerify)}})
isDisabledMatch=isDisabledMatch.length&&!isDisabledMatch.filter(function(dateToDisable){return $.isArray(dateToDisable)&&dateToDisable[3]=='inverted'||$.isPlainObject(dateToDisable)&&dateToDisable.inverted}).length
return calendar.item.enable===-1?!isDisabledMatch:isDisabledMatch||dateToVerify.pick<calendar.item.min.pick||dateToVerify.pick>calendar.item.max.pick}
DatePicker.prototype.parse=function(type,value,options){var calendar=this,parsingObject={}
if(!value||typeof value!='string'){return value}
if(!(options&&options.format)){options=options||{}
options.format=calendar.settings.format}
calendar.formats.toArray(options.format).map(function(label){var
formattingLabel=calendar.formats[label],formatLength=formattingLabel?_.trigger(formattingLabel,calendar,[value,parsingObject]):label.replace(/^!/,'').length
if(formattingLabel){parsingObject[label]=value.substr(0,formatLength)}
value=value.substr(formatLength)})
return[parsingObject.yyyy||parsingObject.yy,+(parsingObject.mm||parsingObject.m)-1,parsingObject.dd||parsingObject.d]}
DatePicker.prototype.formats=(function(){function getWordLengthFromCollection(string,collection,dateObject){var word=string.match(/\w+/)[0]
if(!dateObject.mm&&!dateObject.m){dateObject.m=collection.indexOf(word)+1}
return word.length}
function getFirstWordLength(string){return string.match(/\w+/)[0].length}
return{d:function(string,dateObject){return string?_.digits(string):dateObject.date},dd:function(string,dateObject){return string?2:_.lead(dateObject.date)},ddd:function(string,dateObject){return string?getFirstWordLength(string):this.settings.weekdaysShort[dateObject.day]},dddd:function(string,dateObject){return string?getFirstWordLength(string):this.settings.weekdaysFull[dateObject.day]},m:function(string,dateObject){return string?_.digits(string):dateObject.month+1},mm:function(string,dateObject){return string?2:_.lead(dateObject.month+1)},mmm:function(string,dateObject){var collection=this.settings.monthsShort
return string?getWordLengthFromCollection(string,collection,dateObject):collection[dateObject.month]},mmmm:function(string,dateObject){var collection=this.settings.monthsFull
return string?getWordLengthFromCollection(string,collection,dateObject):collection[dateObject.month]},yy:function(string,dateObject){return string?2:(''+dateObject.year).slice(2)},yyyy:function(string,dateObject){return string?4:dateObject.year},toArray:function(formatString){return formatString.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g)},toString:function(formatString,itemObject){var calendar=this
return calendar.formats.toArray(formatString).map(function(label){return _.trigger(calendar.formats[label],calendar,[0,itemObject])||label.replace(/^!/,'')}).join('')}}})()
DatePicker.prototype.isDateExact=function(one,two){var calendar=this
if((_.isInteger(one)&&_.isInteger(two))||(typeof one=='boolean'&&typeof two=='boolean')){return one===two}
if((_.isDate(one)||$.isArray(one))&&(_.isDate(two)||$.isArray(two))){return calendar.create(one).pick===calendar.create(two).pick}
if($.isPlainObject(one)&&$.isPlainObject(two)){return calendar.isDateExact(one.from,two.from)&&calendar.isDateExact(one.to,two.to)}
return false}
DatePicker.prototype.isDateOverlap=function(one,two){var calendar=this,firstDay=calendar.settings.firstDay?1:0
if(_.isInteger(one)&&(_.isDate(two)||$.isArray(two))){one=one%7+firstDay
return one===calendar.create(two).day+1}
if(_.isInteger(two)&&(_.isDate(one)||$.isArray(one))){two=two%7+firstDay
return two===calendar.create(one).day+1}
if($.isPlainObject(one)&&$.isPlainObject(two)){return calendar.overlapRanges(one,two)}
return false}
DatePicker.prototype.flipEnable=function(val){var itemObject=this.item
itemObject.enable=val||(itemObject.enable==-1?1:-1)}
DatePicker.prototype.deactivate=function(type,datesToDisable){var calendar=this,disabledItems=calendar.item.disable.slice(0)
if(datesToDisable=='flip'){calendar.flipEnable()}
else if(datesToDisable===false){calendar.flipEnable(1)
disabledItems=[]}
else if(datesToDisable===true){calendar.flipEnable(-1)
disabledItems=[]}
else{datesToDisable.map(function(unitToDisable){var matchFound
for(var index=0;index<disabledItems.length;index+=1){if(calendar.isDateExact(unitToDisable,disabledItems[index])){matchFound=true
break}}
if(!matchFound){if(_.isInteger(unitToDisable)||_.isDate(unitToDisable)||$.isArray(unitToDisable)||($.isPlainObject(unitToDisable)&&unitToDisable.from&&unitToDisable.to)){disabledItems.push(unitToDisable)}}})}
return disabledItems}
DatePicker.prototype.activate=function(type,datesToEnable){var calendar=this,disabledItems=calendar.item.disable,disabledItemsCount=disabledItems.length
if(datesToEnable=='flip'){calendar.flipEnable()}
else if(datesToEnable===true){calendar.flipEnable(1)
disabledItems=[]}
else if(datesToEnable===false){calendar.flipEnable(-1)
disabledItems=[]}
else{datesToEnable.map(function(unitToEnable){var matchFound,disabledUnit,index,isExactRange
for(index=0;index<disabledItemsCount;index+=1){disabledUnit=disabledItems[index]
if(calendar.isDateExact(disabledUnit,unitToEnable)){matchFound=disabledItems[index]=null
isExactRange=true
break}
else if(calendar.isDateOverlap(disabledUnit,unitToEnable)){if($.isPlainObject(unitToEnable)){unitToEnable.inverted=true
matchFound=unitToEnable}
else if($.isArray(unitToEnable)){matchFound=unitToEnable
if(!matchFound[3])matchFound.push('inverted')}
else if(_.isDate(unitToEnable)){matchFound=[unitToEnable.getFullYear(),unitToEnable.getMonth(),unitToEnable.getDate(),'inverted']}
break}}
if(matchFound)for(index=0;index<disabledItemsCount;index+=1){if(calendar.isDateExact(disabledItems[index],unitToEnable)){disabledItems[index]=null
break}}
if(isExactRange)for(index=0;index<disabledItemsCount;index+=1){if(calendar.isDateOverlap(disabledItems[index],unitToEnable)){disabledItems[index]=null
break}}
if(matchFound){disabledItems.push(matchFound)}})}
return disabledItems.filter(function(val){return val!=null})}
DatePicker.prototype.nodes=function(isOpen){var
calendar=this,settings=calendar.settings,calendarItem=calendar.item,nowObject=calendarItem.now,selectedObject=calendarItem.select,highlightedObject=calendarItem.highlight,viewsetObject=calendarItem.view,disabledCollection=calendarItem.disable,minLimitObject=calendarItem.min,maxLimitObject=calendarItem.max,tableHead=(function(collection,fullCollection){if(settings.firstDay){collection.push(collection.shift())
fullCollection.push(fullCollection.shift())}
return _.node('thead',_.node('tr',_.group({min:0,max:DAYS_IN_WEEK-1,i:1,node:'th',item:function(counter){return[collection[counter],settings.klass.weekdays,'scope=col title="'+fullCollection[counter]+'"']}})))})((settings.showWeekdaysFull?settings.weekdaysFull:settings.weekdaysLetter).slice(0),settings.weekdaysFull.slice(0)),createMonthNav=function(next){return _.node('div',' ',settings.klass['nav'+(next?'Next':'Prev')]+((next&&viewsetObject.year>=maxLimitObject.year&&viewsetObject.month>=maxLimitObject.month)||(!next&&viewsetObject.year<=minLimitObject.year&&viewsetObject.month<=minLimitObject.month)?' '+settings.klass.navDisabled:''),'data-nav='+(next||-1)+' '+
_.ariaAttr({role:'button',controls:calendar.$node[0].id+'_table'})+' '+'title="'+(next?settings.labelMonthNext:settings.labelMonthPrev)+'"')},createMonthLabel=function(override){var monthsCollection=settings.showMonthsShort?settings.monthsShort:settings.monthsFull
if(override=="short_months"){monthsCollection=settings.monthsShort;}
if(settings.selectMonths&&override==undefined){return _.node('select',_.group({min:0,max:11,i:1,node:'option',item:function(loopedMonth){return[monthsCollection[loopedMonth],0,'value='+loopedMonth+
(viewsetObject.month==loopedMonth?' selected':'')+
(((viewsetObject.year==minLimitObject.year&&loopedMonth<minLimitObject.month)||(viewsetObject.year==maxLimitObject.year&&loopedMonth>maxLimitObject.month))?' disabled':'')]}}),settings.klass.selectMonth+' browser-default',(isOpen?'':'disabled')+' '+
_.ariaAttr({controls:calendar.$node[0].id+'_table'})+' '+'title="'+settings.labelMonthSelect+'"')}
if(override=="short_months")
if(selectedObject!=null)
return _.node('div',monthsCollection[selectedObject.month]);else return _.node('div',monthsCollection[viewsetObject.month]);return _.node('div',monthsCollection[viewsetObject.month],settings.klass.month)},createYearLabel=function(override){var focusedYear=viewsetObject.year,numberYears=settings.selectYears===true?5:~~(settings.selectYears/2)
if(numberYears){var
minYear=minLimitObject.year,maxYear=maxLimitObject.year,lowestYear=focusedYear-numberYears,highestYear=focusedYear+numberYears
if(minYear>lowestYear){highestYear+=minYear-lowestYear
lowestYear=minYear}
if(maxYear<highestYear){var availableYears=lowestYear-minYear,neededYears=highestYear-maxYear
lowestYear-=availableYears>neededYears?neededYears:availableYears
highestYear=maxYear}
if(settings.selectYears&&override==undefined){return _.node('select',_.group({min:lowestYear,max:highestYear,i:1,node:'option',item:function(loopedYear){return[loopedYear,0,'value='+loopedYear+(focusedYear==loopedYear?' selected':'')]}}),settings.klass.selectYear+' browser-default',(isOpen?'':'disabled')+' '+_.ariaAttr({controls:calendar.$node[0].id+'_table'})+' '+'title="'+settings.labelYearSelect+'"')}}
if(override=="raw")
return _.node('div',focusedYear)
return _.node('div',focusedYear,settings.klass.year)}
createDayLabel=function(){if(selectedObject!=null)
return _.node('div',selectedObject.date)
else return _.node('div',nowObject.date)}
createWeekdayLabel=function(){var display_day;if(selectedObject!=null)
display_day=selectedObject.day;else
display_day=nowObject.day;var weekday=settings.weekdaysFull[display_day]
return weekday}
return _.node('div',_.node('div',createWeekdayLabel(),"picker__weekday-display")+
_.node('div',createMonthLabel("short_months"),settings.klass.month_display)+
_.node('div',createDayLabel(),settings.klass.day_display)+
_.node('div',createYearLabel("raw"),settings.klass.year_display),settings.klass.date_display)+
_.node('div',_.node('div',(settings.selectYears?createMonthLabel()+createYearLabel():createMonthLabel()+createYearLabel())+
createMonthNav()+createMonthNav(1),settings.klass.header)+_.node('table',tableHead+
_.node('tbody',_.group({min:0,max:WEEKS_IN_CALENDAR-1,i:1,node:'tr',item:function(rowCounter){var shiftDateBy=settings.firstDay&&calendar.create([viewsetObject.year,viewsetObject.month,1]).day===0?-7:0
return[_.group({min:DAYS_IN_WEEK*rowCounter-viewsetObject.day+shiftDateBy+1,max:function(){return this.min+DAYS_IN_WEEK-1},i:1,node:'td',item:function(targetDate){targetDate=calendar.create([viewsetObject.year,viewsetObject.month,targetDate+(settings.firstDay?1:0)])
var isSelected=selectedObject&&selectedObject.pick==targetDate.pick,isHighlighted=highlightedObject&&highlightedObject.pick==targetDate.pick,isDisabled=disabledCollection&&calendar.disabled(targetDate)||targetDate.pick<minLimitObject.pick||targetDate.pick>maxLimitObject.pick,formattedDate=_.trigger(calendar.formats.toString,calendar,[settings.format,targetDate])
return[_.node('div',targetDate.date,(function(klasses){klasses.push(viewsetObject.month==targetDate.month?settings.klass.infocus:settings.klass.outfocus)
if(nowObject.pick==targetDate.pick){klasses.push(settings.klass.now)}
if(isSelected){klasses.push(settings.klass.selected)}
if(isHighlighted){klasses.push(settings.klass.highlighted)}
if(isDisabled){klasses.push(settings.klass.disabled)}
return klasses.join(' ')})([settings.klass.day]),'data-pick='+targetDate.pick+' '+_.ariaAttr({role:'gridcell',label:formattedDate,selected:isSelected&&calendar.$node.val()===formattedDate?true:null,activedescendant:isHighlighted?true:null,disabled:isDisabled?true:null})),'',_.ariaAttr({role:'presentation'})]}})]}})),settings.klass.table,'id="'+calendar.$node[0].id+'_table'+'" '+_.ariaAttr({role:'grid',controls:calendar.$node[0].id,readonly:true})),settings.klass.calendar_container)
+
_.node('div',_.node('button',settings.today,"btn-flat picker__today",'type=button data-pick='+nowObject.pick+
(isOpen&&!calendar.disabled(nowObject)?'':' disabled')+' '+
_.ariaAttr({controls:calendar.$node[0].id}))+
_.node('button',settings.clear,"btn-flat picker__clear",'type=button data-clear=1'+
(isOpen?'':' disabled')+' '+
_.ariaAttr({controls:calendar.$node[0].id}))+
_.node('button',settings.close,"btn-flat picker__close",'type=button data-close=true '+
(isOpen?'':' disabled')+' '+
_.ariaAttr({controls:calendar.$node[0].id})),settings.klass.footer)}
DatePicker.defaults=(function(prefix){return{labelMonthNext:'Next month',labelMonthPrev:'Previous month',labelMonthSelect:'Select a month',labelYearSelect:'Select a year',monthsFull:['January','February','March','April','May','June','July','August','September','October','November','December'],monthsShort:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],weekdaysFull:['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],weekdaysShort:['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],weekdaysLetter:['S','M','T','W','T','F','S'],today:'Today',clear:'Clear',close:'Close',format:'d mmmm, yyyy',klass:{table:prefix+'table',header:prefix+'header',date_display:prefix+'date-display',day_display:prefix+'day-display',month_display:prefix+'month-display',year_display:prefix+'year-display',calendar_container:prefix+'calendar-container',navPrev:prefix+'nav--prev',navNext:prefix+'nav--next',navDisabled:prefix+'nav--disabled',month:prefix+'month',year:prefix+'year',selectMonth:prefix+'select--month',selectYear:prefix+'select--year',weekdays:prefix+'weekday',day:prefix+'day',disabled:prefix+'day--disabled',selected:prefix+'day--selected',highlighted:prefix+'day--highlighted',now:prefix+'day--today',infocus:prefix+'day--infocus',outfocus:prefix+'day--outfocus',footer:prefix+'footer',buttonClear:prefix+'button--clear',buttonToday:prefix+'button--today',buttonClose:prefix+'button--close'}}})(Picker.klasses().picker+'__')
Picker.extend('pickadate',DatePicker)}));;(function($){$.fn.characterCounter=function(){return this.each(function(){var $input=$(this);var $counterElement=$input.parent().find('span[class="character-counter"]');if($counterElement.length){return;}
var itHasLengthAttribute=$input.attr('length')!==undefined;if(itHasLengthAttribute){$input.on('input',updateCounter);$input.on('focus',updateCounter);$input.on('blur',removeCounterElement);addCounterElement($input);}});};function updateCounter(){var maxLength=+$(this).attr('length'),actualLength=+$(this).val().length,isValidLength=actualLength<=maxLength;$(this).parent().find('span[class="character-counter"]').html(actualLength+'/'+maxLength);addInputStyle(isValidLength,$(this));}
function addCounterElement($input){var $counterElement=$input.parent().find('span[class="character-counter"]');if($counterElement.length){return;}
$counterElement=$('<span/>').addClass('character-counter').css('float','right').css('font-size','12px').css('height',1);$input.parent().append($counterElement);}
function removeCounterElement(){$(this).parent().find('span[class="character-counter"]').html('');}
function addInputStyle(isValidLength,$input){var inputHasInvalidClass=$input.hasClass('invalid');if(isValidLength&&inputHasInvalidClass){$input.removeClass('invalid');}
else if(!isValidLength&&!inputHasInvalidClass){$input.removeClass('valid');$input.addClass('invalid');}}
$(document).ready(function(){$('input, textarea').characterCounter();});}(jQuery));;(function($){var methods={init:function(options){var defaults={time_constant:200,dist:-100,shift:0,padding:0,full_width:false,indicators:false,no_wrap:false};options=$.extend(defaults,options);return this.each(function(){var images,offset,center,pressed,dim,count,reference,referenceY,amplitude,target,velocity,xform,frame,timestamp,ticker,dragged,vertical_dragged;var $indicators=$('<ul class="indicators"></ul>');var view=$(this);var showIndicators=view.attr('data-indicators')||options.indicators;if(view.hasClass('initialized')){$(this).trigger('carouselNext',[0.000001]);return true;}
if(options.full_width){options.dist=0;var firstImage=view.find('.carousel-item img').first();if(firstImage.length){imageHeight=firstImage.on('load',function(){view.css('height',$(this).height());});}else{imageHeight=view.find('.carousel-item').first().height();view.css('height',imageHeight);}
if(showIndicators){view.find('.carousel-fixed-item').addClass('with-indicators');}}
view.addClass('initialized');pressed=false;offset=target=0;images=[];item_width=view.find('.carousel-item').first().innerWidth();dim=item_width*2+options.padding;view.find('.carousel-item').each(function(i){images.push($(this)[0]);if(showIndicators){var $indicator=$('<li class="indicator-item"></li>');if(i===0){$indicator.addClass('active');}
$indicator.click(function(){var index=$(this).index();cycleTo(index);});$indicators.append($indicator);}});if(showIndicators){view.append($indicators);}
count=images.length;function setupEvents(){if(typeof window.ontouchstart!=='undefined'){view[0].addEventListener('touchstart',tap);view[0].addEventListener('touchmove',drag);view[0].addEventListener('touchend',release);}
view[0].addEventListener('mousedown',tap);view[0].addEventListener('mousemove',drag);view[0].addEventListener('mouseup',release);view[0].addEventListener('mouseleave',release);view[0].addEventListener('click',click);}
function xpos(e){if(e.targetTouches&&(e.targetTouches.length>=1)){return e.targetTouches[0].clientX;}
return e.clientX;}
function ypos(e){if(e.targetTouches&&(e.targetTouches.length>=1)){return e.targetTouches[0].clientY;}
return e.clientY;}
function wrap(x){return(x>=count)?(x%count):(x<0)?wrap(count+(x%count)):x;}
function scroll(x){var i,half,delta,dir,tween,el,alignment,xTranslation;offset=(typeof x==='number')?x:offset;center=Math.floor((offset+dim/2)/dim);delta=offset-center*dim;dir=(delta<0)?1:-1;tween=-dir*delta*2/dim;half=count>>1;if(!options.full_width){alignment='translateX('+(view[0].clientWidth-item_width)/2+'px) ';alignment+='translateY('+(view[0].clientHeight-item_width)/2+'px)';}else{alignment='translateX(0)';}
if(showIndicators){var diff=(center%count);var activeIndicator=$indicators.find('.indicator-item.active');if(activeIndicator.index()!==diff){activeIndicator.removeClass('active');$indicators.find('.indicator-item').eq(diff).addClass('active');}}
if(!options.no_wrap||(center>=0&&center<count)){el=images[wrap(center)];el.style[xform]=alignment+' translateX('+(-delta/2)+'px)'+' translateX('+(dir*options.shift*tween*i)+'px)'+' translateZ('+(options.dist*tween)+'px)';el.style.zIndex=0;if(options.full_width){tweenedOpacity=1;}
else{tweenedOpacity=1-0.2*tween;}
el.style.opacity=tweenedOpacity;el.style.display='block';}
for(i=1;i<=half;++i){if(options.full_width){zTranslation=options.dist;tweenedOpacity=(i===half&&delta<0)?1-tween:1;}else{zTranslation=options.dist*(i*2+tween*dir);tweenedOpacity=1-0.2*(i*2+tween*dir);}
if(!options.no_wrap||center+i<count){el=images[wrap(center+i)];el.style[xform]=alignment+' translateX('+(options.shift+(dim*i-delta)/2)+'px)'+' translateZ('+zTranslation+'px)';el.style.zIndex=-i;el.style.opacity=tweenedOpacity;el.style.display='block';}
if(options.full_width){zTranslation=options.dist;tweenedOpacity=(i===half&&delta>0)?1-tween:1;}else{zTranslation=options.dist*(i*2-tween*dir);tweenedOpacity=1-0.2*(i*2-tween*dir);}
if(!options.no_wrap||center-i>=0){el=images[wrap(center-i)];el.style[xform]=alignment+' translateX('+(-options.shift+(-dim*i-delta)/2)+'px)'+' translateZ('+zTranslation+'px)';el.style.zIndex=-i;el.style.opacity=tweenedOpacity;el.style.display='block';}}
if(!options.no_wrap||(center>=0&&center<count)){el=images[wrap(center)];el.style[xform]=alignment+' translateX('+(-delta/2)+'px)'+' translateX('+(dir*options.shift*tween)+'px)'+' translateZ('+(options.dist*tween)+'px)';el.style.zIndex=0;if(options.full_width){tweenedOpacity=1;}
else{tweenedOpacity=1-0.2*tween;}
el.style.opacity=tweenedOpacity;el.style.display='block';}}
function track(){var now,elapsed,delta,v;now=Date.now();elapsed=now-timestamp;timestamp=now;delta=offset-frame;frame=offset;v=1000*delta/(1+elapsed);velocity=0.8*v+0.2*velocity;}
function autoScroll(){var elapsed,delta;if(amplitude){elapsed=Date.now()-timestamp;delta=amplitude*Math.exp(-elapsed/options.time_constant);if(delta>2||delta<-2){scroll(target-delta);requestAnimationFrame(autoScroll);}else{scroll(target);}}}
function click(e){if(dragged){e.preventDefault();e.stopPropagation();return false;}else if(!options.full_width){var clickedIndex=$(e.target).closest('.carousel-item').index();var diff=(center%count)-clickedIndex;if(diff!==0){e.preventDefault();e.stopPropagation();}
cycleTo(clickedIndex);}}
function cycleTo(n){var diff=(center%count)-n;if(!options.no_wrap){if(diff<0){if(Math.abs(diff+count)<Math.abs(diff)){diff+=count;}}else if(diff>0){if(Math.abs(diff-count)<diff){diff-=count;}}}
if(diff<0){view.trigger('carouselNext',[Math.abs(diff)]);}else if(diff>0){view.trigger('carouselPrev',[diff]);}}
function tap(e){pressed=true;dragged=false;vertical_dragged=false;reference=xpos(e);referenceY=ypos(e);velocity=amplitude=0;frame=offset;timestamp=Date.now();clearInterval(ticker);ticker=setInterval(track,100);}
function drag(e){var x,delta,deltaY;if(pressed){x=xpos(e);y=ypos(e);delta=reference-x;deltaY=Math.abs(referenceY-y);if(deltaY<30&&!vertical_dragged){if(delta>2||delta<-2){dragged=true;reference=x;scroll(offset+delta);}}else if(dragged){e.preventDefault();e.stopPropagation();return false;}else{vertical_dragged=true;}}
if(dragged){e.preventDefault();e.stopPropagation();return false;}}
function release(e){if(pressed){pressed=false;}else{return;}
clearInterval(ticker);target=offset;if(velocity>10||velocity<-10){amplitude=0.9*velocity;target=offset+amplitude;}
target=Math.round(target/dim)*dim;if(options.no_wrap){if(target>=dim*(count-1)){target=dim*(count-1);}else if(target<0){target=0;}}
amplitude=target-offset;timestamp=Date.now();requestAnimationFrame(autoScroll);if(dragged){e.preventDefault();e.stopPropagation();}
return false;}
xform='transform';['webkit','Moz','O','ms'].every(function(prefix){var e=prefix+'Transform';if(typeof document.body.style[e]!=='undefined'){xform=e;return false;}
return true;});window.onresize=scroll;setupEvents();scroll(offset);$(this).on('carouselNext',function(e,n){if(n===undefined){n=1;}
target=offset+dim*n;if(offset!==target){amplitude=target-offset;timestamp=Date.now();requestAnimationFrame(autoScroll);}});$(this).on('carouselPrev',function(e,n){if(n===undefined){n=1;}
target=offset-dim*n;if(offset!==target){amplitude=target-offset;timestamp=Date.now();requestAnimationFrame(autoScroll);}});$(this).on('carouselSet',function(e,n){if(n===undefined){n=0;}
cycleTo(n);});});},next:function(n){$(this).trigger('carouselNext',[n]);},prev:function(n){$(this).trigger('carouselPrev',[n]);},set:function(n){$(this).trigger('carouselSet',[n]);}};$.fn.carousel=function(methodOrOptions){if(methods[methodOrOptions]){return methods[methodOrOptions].apply(this,Array.prototype.slice.call(arguments,1));}else if(typeof methodOrOptions==='object'||!methodOrOptions){return methods.init.apply(this,arguments);}else{$.error('Method '+methodOrOptions+' does not exist on jQuery.carousel');}};}(jQuery));;

/* /scrummer/static/src/js/libs/external/dropify.js defined in bundle 'scrummer.assets' */
;(function(root,factory){if(typeof define==='function'&&define.amd){define(['jquery.expander.js'],factory);}else if(typeof exports==='object'){module.exports=factory(require('jquery'));}else{root.Dropify=factory(root.jQuery);}}(this,function($){var pluginName="dropify";function Dropify(element,options){if(!(window.File&&window.FileReader&&window.FileList&&window.Blob)){return;}
var defaults={defaultFile:'',maxFileSize:0,minWidth:0,maxWidth:0,minHeight:0,maxHeight:0,showRemove:true,showLoader:true,showErrors:true,errorTimeout:3000,errorsPosition:'overlay',imgFileExtensions:['png','jpg','jpeg','gif','bmp'],maxFileSizePreview:"5M",allowedFormats:['portrait','square','landscape'],allowedFileExtensions:['*'],messages:{'default':'Drag and drop a file here or click','replace':'Drag and drop or click to replace','remove':'Remove','error':'Ooops, something wrong appended.'},error:{'fileSize':'The file size is too big ({{ value }} max).','minWidth':'The image width is too small ({{ value }}}px min).','maxWidth':'The image width is too big ({{ value }}}px max).','minHeight':'The image height is too small ({{ value }}}px min).','maxHeight':'The image height is too big ({{ value }}px max).','imageFormat':'The image format is not allowed ({{ value }} only).','fileExtension':'The file is not allowed ({{ value }} only).'},tpl:{wrap:'<div class="dropify-wrapper"></div>',loader:'<div class="dropify-loader"></div>',message:'<div class="dropify-message"><span class="file-icon" /> <p>{{ default }}</p></div>',preview:'<div class="dropify-preview"><span class="dropify-render"></span><div class="dropify-infos"><div class="dropify-infos-inner"><p class="dropify-infos-message">{{ replace }}</p></div></div></div>',filename:'<p class="dropify-filename"><span class="file-icon"></span> <span class="dropify-filename-inner"></span></p>',clearButton:'<button type="button" class="dropify-clear">{{ remove }}</button>',errorLine:'<p class="dropify-error">{{ error }}</p>',errorsContainer:'<div class="dropify-errors-container"><ul></ul></div>'}};this.element=element;this.input=$(this.element);this.wrapper=null;this.preview=null;this.filenameWrapper=null;this.settings=$.extend(true,defaults,options,this.input.data());this.errorsEvent=$.Event('dropify.errors');this.isDisabled=false;this.isInit=false;this.file={object:null,name:null,size:null,width:null,height:null,type:null};if(!Array.isArray(this.settings.allowedFormats)){this.settings.allowedFormats=this.settings.allowedFormats.split(' ');}
if(!Array.isArray(this.settings.allowedFileExtensions)){this.settings.allowedFileExtensions=this.settings.allowedFileExtensions.split(' ');}
this.onChange=this.onChange.bind(this);this.clearElement=this.clearElement.bind(this);this.onFileReady=this.onFileReady.bind(this);this.translateMessages();this.createElements();this.setContainerSize();this.errorsEvent.errors=[];this.input.on('change',this.onChange);}
Dropify.prototype.onChange=function(){this.resetPreview();this.readFile(this.element);};Dropify.prototype.createElements=function(){this.isInit=true;this.input.wrap($(this.settings.tpl.wrap));this.wrapper=this.input.parent();var messageWrapper=$(this.settings.tpl.message).insertBefore(this.input);$(this.settings.tpl.errorLine).appendTo(messageWrapper);if(this.isTouchDevice()===true){this.wrapper.addClass('touch-fallback');}
if(this.input.attr('disabled')){this.isDisabled=true;this.wrapper.addClass('disabled');}
if(this.settings.showLoader===true){this.loader=$(this.settings.tpl.loader);this.loader.insertBefore(this.input);}
this.preview=$(this.settings.tpl.preview);this.preview.insertAfter(this.input);if(this.isDisabled===false&&this.settings.showRemove===true){this.clearButton=$(this.settings.tpl.clearButton);this.clearButton.insertAfter(this.input);this.clearButton.on('click',this.clearElement);}
this.filenameWrapper=$(this.settings.tpl.filename);this.filenameWrapper.prependTo(this.preview.find('.dropify-infos-inner'));if(this.settings.showErrors===true){this.errorsContainer=$(this.settings.tpl.errorsContainer);if(this.settings.errorsPosition==='outside'){this.errorsContainer.insertAfter(this.wrapper);}else{this.errorsContainer.insertBefore(this.input);}}
var defaultFile=this.settings.defaultFile||'';if(defaultFile.trim()!==''){this.file.name=this.cleanFilename(defaultFile);this.setPreview(this.isImage(),defaultFile);}};Dropify.prototype.readFile=function(input){if(input.files&&input.files[0]){var reader=new FileReader();var image=new Image();var file=input.files[0];var srcBase64=null;var _this=this;var eventFileReady=$.Event("dropify.fileReady");this.clearErrors();this.showLoader();this.setFileInformations(file);this.errorsEvent.errors=[];this.checkFileSize();this.isFileExtensionAllowed();if(this.isImage()&&this.file.size<this.sizeToByte(this.settings.maxFileSizePreview)){this.input.on('dropify.fileReady',this.onFileReady);reader.readAsDataURL(file);reader.onload=function(_file){srcBase64=_file.target.result;image.src=_file.target.result;image.onload=function(){_this.setFileDimensions(this.width,this.height);_this.validateImage();_this.input.trigger(eventFileReady,[true,srcBase64]);};}.bind(this);}else{this.onFileReady(false);}}};Dropify.prototype.onFileReady=function(event,previewable,src){this.input.off('dropify.fileReady',this.onFileReady);if(this.errorsEvent.errors.length===0){this.setPreview(previewable,src);}else{this.input.trigger(this.errorsEvent,[this]);for(var i=this.errorsEvent.errors.length-1;i>=0;i--){var errorNamespace=this.errorsEvent.errors[i].namespace;var errorKey=errorNamespace.split('.').pop();this.showError(errorKey);}
if(typeof this.errorsContainer!=="undefined"){this.errorsContainer.addClass('visible');var errorsContainer=this.errorsContainer;setTimeout(function(){errorsContainer.removeClass('visible');},this.settings.errorTimeout);}
this.wrapper.addClass('has-error');this.resetPreview();this.clearElement();}};Dropify.prototype.setFileInformations=function(file){this.file.object=file;this.file.name=file.name;this.file.size=file.size;this.file.type=file.type;this.file.width=null;this.file.height=null;};Dropify.prototype.setFileDimensions=function(width,height){this.file.width=width;this.file.height=height;};Dropify.prototype.setPreview=function(previewable,src){this.wrapper.removeClass('has-error').addClass('has-preview');this.filenameWrapper.children('.dropify-filename-inner').html(this.file.name);var render=this.preview.children('.dropify-render');this.hideLoader();if(previewable===true){var imgTag=$('<img />').attr('src',src);if(this.settings.height){imgTag.css("max-height",this.settings.height);}
imgTag.appendTo(render);}else{$('<i />').attr('class','dropify-font-file').appendTo(render);$('<span class="dropify-extension" />').html(this.getFileType()).appendTo(render);}
this.preview.fadeIn();};Dropify.prototype.resetPreview=function(){this.wrapper.removeClass('has-preview');var render=this.preview.children('.dropify-render');render.find('.dropify-extension').remove();render.find('i').remove();render.find('img').remove();this.preview.hide();this.hideLoader();};Dropify.prototype.cleanFilename=function(src){var filename=src.split('\\').pop();if(filename==src){filename=src.split('/').pop();}
return src!==""?filename:'';};Dropify.prototype.clearElement=function(){if(this.errorsEvent.errors.length===0){var eventBefore=$.Event("dropify.beforeClear");this.input.trigger(eventBefore,[this]);if(eventBefore.result!==false){this.resetFile();this.input.val('');this.resetPreview();this.input.trigger($.Event("dropify.afterClear"),[this]);}}else{this.resetFile();this.input.val('');this.resetPreview();}};Dropify.prototype.resetFile=function(){this.file.object=null;this.file.name=null;this.file.size=null;this.file.type=null;this.file.width=null;this.file.height=null;};Dropify.prototype.setContainerSize=function(){if(this.settings.height){this.wrapper.height(this.settings.height);}};Dropify.prototype.isTouchDevice=function(){return(('ontouchstart'in window)||(navigator.MaxTouchPoints>0)||(navigator.msMaxTouchPoints>0));};Dropify.prototype.getFileType=function(){return this.file.name.split('.').pop().toLowerCase();};Dropify.prototype.isImage=function(){if(this.settings.imgFileExtensions.indexOf(this.getFileType())!="-1"){return true;}
return false;};Dropify.prototype.isFileExtensionAllowed=function(){if(this.settings.allowedFileExtensions.indexOf('*')!="-1"||this.settings.allowedFileExtensions.indexOf(this.getFileType())!="-1"){return true;}
this.pushError("fileExtension");return false;};Dropify.prototype.translateMessages=function(){for(var name in this.settings.tpl){for(var key in this.settings.messages){this.settings.tpl[name]=this.settings.tpl[name].replace('{{ '+key+' }}',this.settings.messages[key]);}}};Dropify.prototype.checkFileSize=function(){if(this.sizeToByte(this.settings.maxFileSize)!==0&&this.file.size>this.sizeToByte(this.settings.maxFileSize)){this.pushError("fileSize");}};Dropify.prototype.sizeToByte=function(size){var value=0;if(size!==0){var unit=size.slice(-1).toUpperCase(),kb=1024,mb=kb*1024,gb=mb*1024;if(unit==='K'){value=parseFloat(size)*kb;}else if(unit==='M'){value=parseFloat(size)*mb;}else if(unit==='G'){value=parseFloat(size)*gb;}}
return value;};Dropify.prototype.validateImage=function(){if(this.settings.minWidth!==0&&this.settings.minWidth>=this.file.width){this.pushError("minWidth");}
if(this.settings.maxWidth!==0&&this.settings.maxWidth<=this.file.width){this.pushError("maxWidth");}
if(this.settings.minHeight!==0&&this.settings.minHeight>=this.file.height){this.pushError("minHeight");}
if(this.settings.maxHeight!==0&&this.settings.maxHeight<=this.file.height){this.pushError("maxHeight");}
if(this.settings.allowedFormats.indexOf(this.getImageFormat())=="-1"){this.pushError("imageFormat");}};Dropify.prototype.getImageFormat=function(){if(this.file.width==this.file.height){return"square";}
if(this.file.width<this.file.height){return"portrait";}
if(this.file.width>this.file.height){return"landscape";}};Dropify.prototype.pushError=function(errorKey){var e=$.Event("dropify.error."+errorKey);this.errorsEvent.errors.push(e);this.input.trigger(e,[this]);};Dropify.prototype.clearErrors=function(){if(typeof this.errorsContainer!=="undefined"){this.errorsContainer.children('ul').html('');}};Dropify.prototype.showError=function(errorKey){if(typeof this.errorsContainer!=="undefined"){this.errorsContainer.children('ul').append('<li>'+this.getError(errorKey)+'</li>');}};Dropify.prototype.getError=function(errorKey){var error=this.settings.error[errorKey],value='';if(errorKey==='fileSize'){value=this.settings.maxFileSize;}else if(errorKey==='minWidth'){value=this.settings.minWidth;}else if(errorKey==='maxWidth'){value=this.settings.maxWidth;}else if(errorKey==='minHeight'){value=this.settings.minHeight;}else if(errorKey==='maxHeight'){value=this.settings.maxHeight;}else if(errorKey==='imageFormat'){value=this.settings.allowedFormats.join(', ');}else if(errorKey==='fileExtension'){value=this.settings.allowedFileExtensions.join(', ');}
if(value!==''){return error.replace('{{ value }}',value);}
return error;};Dropify.prototype.showLoader=function(){if(typeof this.loader!=="undefined"){this.loader.show();}};Dropify.prototype.hideLoader=function(){if(typeof this.loader!=="undefined"){this.loader.hide();}};Dropify.prototype.destroy=function(){this.input.siblings().remove();this.input.unwrap();this.isInit=false;};Dropify.prototype.init=function(){this.createElements();};Dropify.prototype.isDropified=function(){return this.isInit;};$.fn[pluginName]=function(options){this.each(function(){if(!$.data(this,pluginName)){$.data(this,pluginName,new Dropify(this,options));}});return this;};return Dropify;}));;

/* /scrummer/static/src/js/libs/external/jquery.expander.js defined in bundle 'scrummer.assets' */
(function(factory){if(typeof define==='function'&&define.amd){define(['jquery.expander.js'],factory);}else if(typeof module==='object'&&typeof module.exports==='object'){module.exports=factory;}else{factory(jQuery);}})(function($){$.expander={version:'1.7.0',defaults:{slicePoint:100,sliceOn:null,preserveWords:true,normalizeWhitespace:true,showWordCount:false,detailPrefix:' ',wordCountText:' ({{count}} words)',widow:4,expandText:'read more',expandPrefix:'&hellip; ',expandAfterSummary:false,wordEnd:/(&(?:[^;]+;)?|[0-9a-zA-Z\u00C0-\u0100]+|[^\u0000-\u007F]+)$/,summaryClass:'summary',detailClass:'details',moreClass:'read-more',lessClass:'read-less',moreLinkClass:'more-link',lessLinkClass:'less-link',collapseTimer:0,expandEffect:'slideDown',expandSpeed:250,collapseEffect:'slideUp',collapseSpeed:200,userCollapse:true,userCollapseText:'read less',userCollapsePrefix:' ',onSlice:null,beforeExpand:null,afterExpand:null,onCollapse:null,afterCollapse:null}};$.fn.expander=function(options){var meth='init';if(typeof options==='string'){meth=options;options={};}
var opts=$.extend({},$.expander.defaults,options);var rSelfClose=/^<(?:area|br|col|embed|hr|img|input|link|meta|param).*>$/i;var rAmpWordEnd=opts.wordEnd;var rOpenCloseTag=/<\/?(\w+)[^>]*>/g;var rOpenTag=/<(\w+)[^>]*>/g;var rCloseTag=/<\/(\w+)>/g;var rLastCloseTag=/(<\/([^>]+)>)\s*$/;var rTagPlus=/^(<[^>]+>)+.?/;var rMultiSpace=/\s\s+/g;var delayedCollapse;var removeSpaces=function(str){return opts.normalizeWhitespace?$.trim(str||'').replace(rMultiSpace,' '):str;};var methods={init:function(){this.each(function(){var i,l,tmp,newChar,summTagless,summOpens,summCloses,lastCloseTag,detailText,detailTagless,html,expand;var $thisDetails,$readMore;var slicePointChanged;var openTagsForDetails=[];var closeTagsForsummaryText=[];var strayChars='';var defined={};var thisEl=this;var $this=$(this);var $summEl=$([]);var o=$.extend({},opts,$this.data('expander')||$.meta&&$this.data()||{});var hasDetails=!!$this.find('.'+o.detailClass).length;var hasBlocks=!!$this.find('*').filter(function(){var display=$(this).css('display');return(/^block|table|list/).test(display);}).length;var el=hasBlocks?'div':'span';var detailSelector=el+'.'+o.detailClass;var moreClass=o.moreClass+'';var lessClass=o.lessClass+'';var expandSpeed=o.expandSpeed||0;var allHtml=removeSpaces($this.html());var summaryText=allHtml.slice(0,o.slicePoint);o.moreSelector='span.'+moreClass.split(' ').join('.');o.lessSelector='span.'+lessClass.split(' ').join('.');if($.data(this,'expanderInit')){return;}
$.data(this,'expanderInit',true);$.data(this,'expander',o);$.each(['onSlice','beforeExpand','afterExpand','onCollapse','afterCollapse'],function(index,val){defined[val]=$.isFunction(o[val]);});summaryText=backup(summaryText);summTagless=summaryText.replace(rOpenCloseTag,'').length;while(summTagless<o.slicePoint){newChar=allHtml.charAt(summaryText.length);if(newChar==='<'){newChar=allHtml.slice(summaryText.length).match(rTagPlus)[0];}
summaryText+=newChar;summTagless++;}
if(o.sliceOn){slicePointChanged=changeSlicePoint({sliceOn:o.sliceOn,slicePoint:o.slicePoint,allHtml:allHtml,summaryText:summaryText});summaryText=slicePointChanged.summaryText;}
summaryText=backup(summaryText,o.preserveWords&&allHtml.slice(summaryText.length).length);summOpens=summaryText.match(rOpenTag)||[];summCloses=summaryText.match(rCloseTag)||[];tmp=[];$.each(summOpens,function(index,val){if(!rSelfClose.test(val)){tmp.push(val);}});summOpens=tmp;l=summCloses.length;for(i=0;i<l;i++){summCloses[i]=summCloses[i].replace(rCloseTag,'$1');}
$.each(summOpens,function(index,val){var thisTagName=val.replace(rOpenTag,'$1');var closePosition=$.inArray(thisTagName,summCloses);if(closePosition===-1){openTagsForDetails.push(val);closeTagsForsummaryText.push('</'+thisTagName+'>');}else{summCloses.splice(closePosition,1);}});closeTagsForsummaryText.reverse();if(!hasDetails){detailText=allHtml.slice(summaryText.length);detailTagless=$.trim(detailText.replace(rOpenCloseTag,''));if(detailTagless===''||detailTagless.split(/\s+/).length<o.widow){return;}
lastCloseTag=closeTagsForsummaryText.pop()||'';summaryText+=closeTagsForsummaryText.join('');detailText=openTagsForDetails.join('')+detailText;}else{detailText=$this.find(detailSelector).remove().html();summaryText=$this.html();allHtml=summaryText+detailText;lastCloseTag='';}
o.moreLabel=$this.find(o.moreSelector).length?'':buildMoreLabel(o,detailText);if(hasBlocks){detailText=allHtml;}else if(summaryText.charAt(summaryText.length-1)==='&'){strayChars=/^[#\w\d\\]+;/.exec(detailText);if(strayChars){detailText=detailText.slice(strayChars[0].length);summaryText+=strayChars[0];}}
summaryText+=lastCloseTag;o.summary=summaryText;o.details=detailText;o.lastCloseTag=lastCloseTag;if(defined.onSlice){tmp=o.onSlice.call(thisEl,o);o=tmp&&tmp.details?tmp:o;}
html=buildHTML(o,hasBlocks);$this.empty().append(html);$thisDetails=$this.find(detailSelector);$readMore=$this.find(o.moreSelector);if(o.collapseEffect==='slideUp'&&o.expandEffect!=='slideDown'||$this.is(':hidden')){$thisDetails.css({display:'none'});}else{$thisDetails[o.collapseEffect](0);}
$summEl=$this.find('div.'+o.summaryClass);expand=function(event){event.preventDefault();var exSpeed=event.startExpanded?0:expandSpeed;$readMore.hide();$summEl.hide();if(defined.beforeExpand){o.beforeExpand.call(thisEl);}
$thisDetails.stop(false,true)[o.expandEffect](exSpeed,function(){$thisDetails.css({zoom:''});if(defined.afterExpand){o.afterExpand.call(thisEl);}
delayCollapse(o,$thisDetails,thisEl);});};$readMore.find('a').unbind('click.expander').bind('click.expander',expand);if(o.userCollapse&&!$this.find(o.lessSelector).length){$this.find(detailSelector).append('<span class="'+o.lessClass+'">'+o.userCollapsePrefix+'<a href="#" class="'+o.lessLinkClass+'">'+o.userCollapseText+'</a></span>');}
$this.find(o.lessSelector+' a').unbind('click.expander').bind('click.expander',function(event){event.preventDefault();clearTimeout(delayedCollapse);var $detailsCollapsed=$(this).closest(detailSelector);reCollapse(o,$detailsCollapsed);if(defined.onCollapse){o.onCollapse.call(thisEl,true);}});if(o.startExpanded){expand({preventDefault:function(){},startExpanded:true});}});},destroy:function(){this.each(function(){var o,details;var $this=$(this);if(!$this.data('expanderInit')){return;}
o=$.extend({},$this.data('expander')||{},opts);details=$this.find('.'+o.detailClass).contents();$this.removeData('expanderInit');$this.removeData('expander');$this.find(o.moreSelector).remove();$this.find('.'+o.summaryClass).remove();$this.find('.'+o.detailClass).after(details).remove();$this.find(o.lessSelector).remove();});}};if(methods[meth]){methods[meth].call(this);}
function buildHTML(o,blocks){var el='span';var summary=o.summary;var closingTagParts=rLastCloseTag.exec(summary);var closingTag=closingTagParts?closingTagParts[2].toLowerCase():'';if(blocks){el='div';if(closingTagParts&&closingTag!=='a'&&!o.expandAfterSummary){summary=summary.replace(rLastCloseTag,o.moreLabel+'$1');}else{summary+=o.moreLabel;}
summary='<div class="'+o.summaryClass+'">'+summary+'</div>';}else{summary+=o.moreLabel;}
return[summary,o.detailPrefix||'','<',el+' class="'+o.detailClass+'"','>',o.details,'</'+el+'>'].join('');}
function buildMoreLabel(o,detailText){var ret='<span class="'+o.moreClass+'">'+o.expandPrefix;if(o.showWordCount){o.wordCountText=o.wordCountText.replace(/\{\{count\}\}/,detailText.replace(rOpenCloseTag,'').replace(/\&(?:amp|nbsp);/g,'').replace(/(?:^\s+|\s+$)/,'').match(/\w+/g).length);}else{o.wordCountText='';}
ret+='<a href="#" class="'+o.moreLinkClass+'">'+o.expandText+o.wordCountText+'</a></span>';return ret;}
function backup(txt,preserveWords){if(txt.lastIndexOf('<')>txt.lastIndexOf('>')){txt=txt.slice(0,txt.lastIndexOf('<'));}
if(preserveWords){txt=txt.replace(rAmpWordEnd,'');}
return $.trim(txt);}
function reCollapse(o,el){el.stop(true,true)[o.collapseEffect](o.collapseSpeed,function(){var prevMore=el.prev('span.'+o.moreClass).show();if(!prevMore.length){el.parent().children('div.'+o.summaryClass).show().find('span.'+o.moreClass).show();}
if(o.afterCollapse){o.afterCollapse.call(el);}});}
function delayCollapse(option,$collapseEl,thisEl){if(option.collapseTimer){delayedCollapse=setTimeout(function(){reCollapse(option,$collapseEl);if($.isFunction(option.onCollapse)){option.onCollapse.call(thisEl,false);}},option.collapseTimer);}}
function changeSlicePoint(info){var sliceOnTemp='ExpandMoreHere374216623';var summaryTextClean=info.summaryText.replace(info.sliceOn,sliceOnTemp);summaryTextClean=$('<div>'+summaryTextClean+'</div>').text();var sliceOnIndexClean=summaryTextClean.indexOf(sliceOnTemp);var sliceOnIndexHtml=info.summaryText.indexOf(info.sliceOn);if(sliceOnIndexClean!==-1&&sliceOnIndexClean<info.slicePoint){info.summaryText=info.allHtml.slice(0,sliceOnIndexHtml);}
return info;}
return this;};$.fn.expander.defaults=$.expander.defaults;});;

/* /scrummer/static/src/js/libs/external/jquery.validate.js defined in bundle 'scrummer.assets' */
(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory);}else if(typeof module==="object"&&module.exports){module.exports=factory(require("jquery"));}else{factory(jQuery);}}(function($){$.extend($.fn,{validate:function(options){if(!this.length){if(options&&options.debug&&window.console){console.warn("Nothing selected, can't validate, returning nothing.");}
return;}
var validator=$.data(this[0],"validator");if(validator){return validator;}
this.attr("novalidate","novalidate");validator=new $.validator(options,this[0]);$.data(this[0],"validator",validator);if(validator.settings.onsubmit){this.on("click.validate",":submit",function(event){if(validator.settings.submitHandler){validator.submitButton=event.currentTarget;}
if($(this).hasClass("cancel")){validator.cancelSubmit=true;}
if($(this).attr("formnovalidate")!==undefined){validator.cancelSubmit=true;}});this.on("submit.validate",function(event){if(validator.settings.debug){event.preventDefault();}
function handle(){var hidden,result;if(validator.settings.submitHandler){if(validator.submitButton){hidden=$("<input type='hidden'/>").attr("name",validator.submitButton.name).val($(validator.submitButton).val()).appendTo(validator.currentForm);}
result=validator.settings.submitHandler.call(validator,validator.currentForm,event);if(validator.submitButton){hidden.remove();}
if(result!==undefined){return result;}
return false;}
return true;}
if(validator.cancelSubmit){validator.cancelSubmit=false;return handle();}
if(validator.form()){if(validator.pendingRequest){validator.formSubmitted=true;return false;}
return handle();}else{validator.focusInvalid();return false;}});}
return validator;},valid:function(){var valid,validator,errorList;if($(this[0]).is("form")){valid=this.validate().form();}else{errorList=[];valid=true;validator=$(this[0].form).validate();this.each(function(){valid=validator.element(this)&&valid;if(!valid){errorList=errorList.concat(validator.errorList);}});validator.errorList=errorList;}
return valid;},rules:function(command,argument){var element=this[0],settings,staticRules,existingRules,data,param,filtered;if(element==null){return;}
if(!element.form&&element.hasAttribute("contenteditable")){element.form=this.closest("form")[0];element.name=this.attr("name");}
if(element.form==null){return;}
if(command){settings=$.data(element.form,"validator").settings;staticRules=settings.rules;existingRules=$.validator.staticRules(element);switch(command){case"add":$.extend(existingRules,$.validator.normalizeRule(argument));delete existingRules.messages;staticRules[element.name]=existingRules;if(argument.messages){settings.messages[element.name]=$.extend(settings.messages[element.name],argument.messages);}
break;case"remove":if(!argument){delete staticRules[element.name];return existingRules;}
filtered={};$.each(argument.split(/\s/),function(index,method){filtered[method]=existingRules[method];delete existingRules[method];if(method==="required"){$(element).removeAttr("aria-required");}});return filtered;}}
data=$.validator.normalizeRules($.extend({},$.validator.classRules(element),$.validator.attributeRules(element),$.validator.dataRules(element),$.validator.staticRules(element)),element);if(data.required){param=data.required;delete data.required;data=$.extend({required:param},data);$(element).attr("aria-required","true");}
if(data.remote){param=data.remote;delete data.remote;data=$.extend(data,{remote:param});}
return data;}});$.extend($.expr.pseudos||$.expr[":"],{blank:function(a){return!$.trim(""+$(a).val());},filled:function(a){var val=$(a).val();return val!==null&&!!$.trim(""+val);},unchecked:function(a){return!$(a).prop("checked");}});$.validator=function(options,form){this.settings=$.extend(true,{},$.validator.defaults,options);this.currentForm=form;this.init();};$.validator.format=function(source,params){if(arguments.length===1){return function(){var args=$.makeArray(arguments);args.unshift(source);return $.validator.format.apply(this,args);};}
if(params===undefined){return source;}
if(arguments.length>2&&params.constructor!==Array){params=$.makeArray(arguments).slice(1);}
if(params.constructor!==Array){params=[params];}
$.each(params,function(i,n){source=source.replace(new RegExp("\\{"+i+"\\}","g"),function(){return n;});});return source;};$.extend($.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",pendingClass:"pending",validClass:"valid",errorElement:"label",focusCleanup:false,focusInvalid:true,errorContainer:$([]),errorLabelContainer:$([]),onsubmit:true,ignore:":hidden",ignoreTitle:false,onfocusin:function(element){this.lastActive=element;if(this.settings.focusCleanup){if(this.settings.unhighlight){this.settings.unhighlight.call(this,element,this.settings.errorClass,this.settings.validClass);}
this.hideThese(this.errorsFor(element));}},onfocusout:function(element){if(!this.checkable(element)&&(element.name in this.submitted||!this.optional(element))){this.element(element);}},onkeyup:function(element,event){var excludedKeys=[16,17,18,20,35,36,37,38,39,40,45,144,225];if(event.which===9&&this.elementValue(element)===""||$.inArray(event.keyCode,excludedKeys)!==-1){return;}else if(element.name in this.submitted||element.name in this.invalid){this.element(element);}},onclick:function(element){if(element.name in this.submitted){this.element(element);}else if(element.parentNode.name in this.submitted){this.element(element.parentNode);}},highlight:function(element,errorClass,validClass){if(element.type==="radio"){this.findByName(element.name).addClass(errorClass).removeClass(validClass);}else{$(element).addClass(errorClass).removeClass(validClass);}},unhighlight:function(element,errorClass,validClass){if(element.type==="radio"){this.findByName(element.name).removeClass(errorClass).addClass(validClass);}else{$(element).removeClass(errorClass).addClass(validClass);}}},setDefaults:function(settings){$.extend($.validator.defaults,settings);},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",equalTo:"Please enter the same value again.",maxlength:$.validator.format("Please enter no more than {0} characters."),minlength:$.validator.format("Please enter at least {0} characters."),rangelength:$.validator.format("Please enter a value between {0} and {1} characters long."),range:$.validator.format("Please enter a value between {0} and {1}."),max:$.validator.format("Please enter a value less than or equal to {0}."),min:$.validator.format("Please enter a value greater than or equal to {0}."),step:$.validator.format("Please enter a multiple of {0}.")},autoCreateRanges:false,prototype:{init:function(){this.labelContainer=$(this.settings.errorLabelContainer);this.errorContext=this.labelContainer.length&&this.labelContainer||$(this.currentForm);this.containers=$(this.settings.errorContainer).add(this.settings.errorLabelContainer);this.submitted={};this.valueCache={};this.pendingRequest=0;this.pending={};this.invalid={};this.reset();var groups=(this.groups={}),rules;$.each(this.settings.groups,function(key,value){if(typeof value==="string"){value=value.split(/\s/);}
$.each(value,function(index,name){groups[name]=key;});});rules=this.settings.rules;$.each(rules,function(key,value){rules[key]=$.validator.normalizeRule(value);});function delegate(event){if(!this.form&&this.hasAttribute("contenteditable")){this.form=$(this).closest("form")[0];this.name=$(this).attr("name");}
var validator=$.data(this.form,"validator"),eventType="on"+event.type.replace(/^validate/,""),settings=validator.settings;if(settings[eventType]&&!$(this).is(settings.ignore)){settings[eventType].call(validator,this,event);}}
$(this.currentForm).on("focusin.validate focusout.validate keyup.validate",":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'], "+"[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], "+"[type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'], "+"[type='radio'], [type='checkbox'], [contenteditable], [type='button']",delegate).on("click.validate","select, option, [type='radio'], [type='checkbox']",delegate);if(this.settings.invalidHandler){$(this.currentForm).on("invalid-form.validate",this.settings.invalidHandler);}
$(this.currentForm).find("[required], [data-rule-required], .required").attr("aria-required","true");},form:function(){this.checkForm();$.extend(this.submitted,this.errorMap);this.invalid=$.extend({},this.errorMap);if(!this.valid()){$(this.currentForm).triggerHandler("invalid-form",[this]);}
this.showErrors();return this.valid();},checkForm:function(){this.prepareForm();for(var i=0,elements=(this.currentElements=this.elements());elements[i];i++){this.check(elements[i]);}
return this.valid();},element:function(element){var cleanElement=this.clean(element),checkElement=this.validationTargetFor(cleanElement),v=this,result=true,rs,group;if(checkElement===undefined){delete this.invalid[cleanElement.name];}else{this.prepareElement(checkElement);this.currentElements=$(checkElement);group=this.groups[checkElement.name];if(group){$.each(this.groups,function(name,testgroup){if(testgroup===group&&name!==checkElement.name){cleanElement=v.validationTargetFor(v.clean(v.findByName(name)));if(cleanElement&&cleanElement.name in v.invalid){v.currentElements.push(cleanElement);result=v.check(cleanElement)&&result;}}});}
rs=this.check(checkElement)!==false;result=result&&rs;if(rs){this.invalid[checkElement.name]=false;}else{this.invalid[checkElement.name]=true;}
if(!this.numberOfInvalids()){this.toHide=this.toHide.add(this.containers);}
this.showErrors();$(element).attr("aria-invalid",!rs);}
return result;},showErrors:function(errors){if(errors){var validator=this;$.extend(this.errorMap,errors);this.errorList=$.map(this.errorMap,function(message,name){return{message:message,element:validator.findByName(name)[0]};});this.successList=$.grep(this.successList,function(element){return!(element.name in errors);});}
if(this.settings.showErrors){this.settings.showErrors.call(this,this.errorMap,this.errorList);}else{this.defaultShowErrors();}},resetForm:function(){if($.fn.resetForm){$(this.currentForm).resetForm();}
this.invalid={};this.submitted={};this.prepareForm();this.hideErrors();var elements=this.elements().removeData("previousValue").removeAttr("aria-invalid");this.resetElements(elements);},resetElements:function(elements){var i;if(this.settings.unhighlight){for(i=0;elements[i];i++){this.settings.unhighlight.call(this,elements[i],this.settings.errorClass,"");this.findByName(elements[i].name).removeClass(this.settings.validClass);}}else{elements.removeClass(this.settings.errorClass).removeClass(this.settings.validClass);}},numberOfInvalids:function(){return this.objectLength(this.invalid);},objectLength:function(obj){var count=0,i;for(i in obj){if(obj[i]!==undefined&&obj[i]!==null&&obj[i]!==false){count++;}}
return count;},hideErrors:function(){this.hideThese(this.toHide);},hideThese:function(errors){errors.not(this.containers).text("");this.addWrapper(errors).hide();},valid:function(){return this.size()===0;},size:function(){return this.errorList.length;},focusInvalid:function(){if(this.settings.focusInvalid){try{$(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin");}catch(e){}}},findLastActive:function(){var lastActive=this.lastActive;return lastActive&&$.grep(this.errorList,function(n){return n.element.name===lastActive.name;}).length===1&&lastActive;},elements:function(){var validator=this,rulesCache={};return $(this.currentForm).find("input, select, textarea, [contenteditable]").not(":submit, :reset, :image, :disabled").not(this.settings.ignore).filter(function(){var name=this.name||$(this).attr("name");if(!name&&validator.settings.debug&&window.console){console.error("%o has no name assigned",this);}
if(this.hasAttribute("contenteditable")){this.form=$(this).closest("form")[0];this.name=name;}
if(name in rulesCache||!validator.objectLength($(this).rules())){return false;}
rulesCache[name]=true;return true;});},clean:function(selector){return $(selector)[0];},errors:function(){var errorClass=this.settings.errorClass.split(" ").join(".");return $(this.settings.errorElement+"."+errorClass,this.errorContext);},resetInternals:function(){this.successList=[];this.errorList=[];this.errorMap={};this.toShow=$([]);this.toHide=$([]);},reset:function(){this.resetInternals();this.currentElements=$([]);},prepareForm:function(){this.reset();this.toHide=this.errors().add(this.containers);},prepareElement:function(element){this.reset();this.toHide=this.errorsFor(element);},elementValue:function(element){var $element=$(element),type=element.type,val,idx;if(type==="radio"||type==="checkbox"){return this.findByName(element.name).filter(":checked").val();}else if(type==="number"&&typeof element.validity!=="undefined"){return element.validity.badInput?"NaN":$element.val();}
if(element.hasAttribute("contenteditable")){val=$element.text();}else{val=$element.val();}
if(type==="file"){if(val.substr(0,12)==="C:\\fakepath\\"){return val.substr(12);}
idx=val.lastIndexOf("/");if(idx>=0){return val.substr(idx+1);}
idx=val.lastIndexOf("\\");if(idx>=0){return val.substr(idx+1);}
return val;}
if(typeof val==="string"){return val.replace(/\r/g,"");}
return val;},check:function(element){element=this.validationTargetFor(this.clean(element));var rules=$(element).rules(),rulesCount=$.map(rules,function(n,i){return i;}).length,dependencyMismatch=false,val=this.elementValue(element),result,method,rule,normalizer;if(typeof rules.normalizer==="function"){normalizer=rules.normalizer;}else if(typeof this.settings.normalizer==="function"){normalizer=this.settings.normalizer;}
if(normalizer){val=normalizer.call(element,val);if(typeof val!=="string"){throw new TypeError("The normalizer should return a string value.");}
delete rules.normalizer;}
for(method in rules){rule={method:method,parameters:rules[method]};try{result=$.validator.methods[method].call(this,val,element,rule.parameters);if(result==="dependency-mismatch"&&rulesCount===1){dependencyMismatch=true;continue;}
dependencyMismatch=false;if(result==="pending"){this.toHide=this.toHide.not(this.errorsFor(element));return;}
if(!result){this.formatAndAdd(element,rule);return false;}}catch(e){if(this.settings.debug&&window.console){console.log("Exception occurred when checking element "+element.id+", check the '"+rule.method+"' method.",e);}
if(e instanceof TypeError){e.message+=".  Exception occurred when checking element "+element.id+", check the '"+rule.method+"' method.";}
throw e;}}
if(dependencyMismatch){return;}
if(this.objectLength(rules)){this.successList.push(element);}
return true;},customDataMessage:function(element,method){return $(element).data("msg"+method.charAt(0).toUpperCase()+
method.substring(1).toLowerCase())||$(element).data("msg");},customMessage:function(name,method){var m=this.settings.messages[name];return m&&(m.constructor===String?m:m[method]);},findDefined:function(){for(var i=0;i<arguments.length;i++){if(arguments[i]!==undefined){return arguments[i];}}
return undefined;},defaultMessage:function(element,rule){if(typeof rule==="string"){rule={method:rule};}
var message=this.findDefined(this.customMessage(element.name,rule.method),this.customDataMessage(element,rule.method),!this.settings.ignoreTitle&&element.title||undefined,$.validator.messages[rule.method],"<strong>Warning: No message defined for "+element.name+"</strong>"),theregex=/\$?\{(\d+)\}/g;if(typeof message==="function"){message=message.call(this,rule.parameters,element);}else if(theregex.test(message)){message=$.validator.format(message.replace(theregex,"{$1}"),rule.parameters);}
return message;},formatAndAdd:function(element,rule){var message=this.defaultMessage(element,rule);this.errorList.push({message:message,element:element,method:rule.method});this.errorMap[element.name]=message;this.submitted[element.name]=message;},addWrapper:function(toToggle){if(this.settings.wrapper){toToggle=toToggle.add(toToggle.parent(this.settings.wrapper));}
return toToggle;},defaultShowErrors:function(){var i,elements,error;for(i=0;this.errorList[i];i++){error=this.errorList[i];if(this.settings.highlight){this.settings.highlight.call(this,error.element,this.settings.errorClass,this.settings.validClass);}
this.showLabel(error.element,error.message);}
if(this.errorList.length){this.toShow=this.toShow.add(this.containers);}
if(this.settings.success){for(i=0;this.successList[i];i++){this.showLabel(this.successList[i]);}}
if(this.settings.unhighlight){for(i=0,elements=this.validElements();elements[i];i++){this.settings.unhighlight.call(this,elements[i],this.settings.errorClass,this.settings.validClass);}}
this.toHide=this.toHide.not(this.toShow);this.hideErrors();this.addWrapper(this.toShow).show();},validElements:function(){return this.currentElements.not(this.invalidElements());},invalidElements:function(){return $(this.errorList).map(function(){return this.element;});},showLabel:function(element,message){var place,group,errorID,v,error=this.errorsFor(element),elementID=this.idOrName(element),describedBy=$(element).attr("aria-describedby");if(error.length){error.removeClass(this.settings.validClass).addClass(this.settings.errorClass);error.html(message);}else{error=$("<"+this.settings.errorElement+">").attr("id",elementID+"-error").addClass(this.settings.errorClass).html(message||"");place=error;if(this.settings.wrapper){place=error.hide().show().wrap("<"+this.settings.wrapper+"/>").parent();}
if(this.labelContainer.length){this.labelContainer.append(place);}else if(this.settings.errorPlacement){this.settings.errorPlacement.call(this,place,$(element));}else{place.insertAfter(element);}
if(error.is("label")){error.attr("for",elementID);}else if(error.parents("label[for='"+this.escapeCssMeta(elementID)+"']").length===0){errorID=error.attr("id");if(!describedBy){describedBy=errorID;}else if(!describedBy.match(new RegExp("\\b"+this.escapeCssMeta(errorID)+"\\b"))){describedBy+=" "+errorID;}
$(element).attr("aria-describedby",describedBy);group=this.groups[element.name];if(group){v=this;$.each(v.groups,function(name,testgroup){if(testgroup===group){$("[name='"+v.escapeCssMeta(name)+"']",v.currentForm).attr("aria-describedby",error.attr("id"));}});}}}
if(!message&&this.settings.success){error.text("");if(typeof this.settings.success==="string"){error.addClass(this.settings.success);}else{this.settings.success(error,element);}}
this.toShow=this.toShow.add(error);},errorsFor:function(element){var name=this.escapeCssMeta(this.idOrName(element)),describer=$(element).attr("aria-describedby"),selector="label[for='"+name+"'], label[for='"+name+"'] *";if(describer){selector=selector+", #"+this.escapeCssMeta(describer).replace(/\s+/g,", #");}
return this.errors().filter(selector);},escapeCssMeta:function(string){return string.replace(/([\\!"#$%&'()*+,./:;<=>?@\[\]^`{|}~])/g,"\\$1");},idOrName:function(element){return this.groups[element.name]||(this.checkable(element)?element.name:element.id||element.name);},validationTargetFor:function(element){if(this.checkable(element)){element=this.findByName(element.name);}
return $(element).not(this.settings.ignore)[0];},checkable:function(element){return(/radio|checkbox/i).test(element.type);},findByName:function(name){return $(this.currentForm).find("[name='"+this.escapeCssMeta(name)+"']");},getLength:function(value,element){switch(element.nodeName.toLowerCase()){case"select":return $("option:selected",element).length;case"input":if(this.checkable(element)){return this.findByName(element.name).filter(":checked").length;}}
return value.length;},depend:function(param,element){return this.dependTypes[typeof param]?this.dependTypes[typeof param](param,element):true;},dependTypes:{"boolean":function(param){return param;},"string":function(param,element){return!!$(param,element.form).length;},"function":function(param,element){return param(element);}},optional:function(element){var val=this.elementValue(element);return!$.validator.methods.required.call(this,val,element)&&"dependency-mismatch";},startRequest:function(element){if(!this.pending[element.name]){this.pendingRequest++;$(element).addClass(this.settings.pendingClass);this.pending[element.name]=true;}},stopRequest:function(element,valid){this.pendingRequest--;if(this.pendingRequest<0){this.pendingRequest=0;}
delete this.pending[element.name];$(element).removeClass(this.settings.pendingClass);if(valid&&this.pendingRequest===0&&this.formSubmitted&&this.form()){$(this.currentForm).submit();this.formSubmitted=false;}else if(!valid&&this.pendingRequest===0&&this.formSubmitted){$(this.currentForm).triggerHandler("invalid-form",[this]);this.formSubmitted=false;}},previousValue:function(element,method){method=typeof method==="string"&&method||"remote";return $.data(element,"previousValue")||$.data(element,"previousValue",{old:null,valid:true,message:this.defaultMessage(element,{method:method})});},destroy:function(){this.resetForm();$(this.currentForm).off(".validate").removeData("validator").find(".validate-equalTo-blur").off(".validate-equalTo").removeClass("validate-equalTo-blur");}},classRuleSettings:{required:{required:true},email:{email:true},url:{url:true},date:{date:true},dateISO:{dateISO:true},number:{number:true},digits:{digits:true},creditcard:{creditcard:true}},addClassRules:function(className,rules){if(className.constructor===String){this.classRuleSettings[className]=rules;}else{$.extend(this.classRuleSettings,className);}},classRules:function(element){var rules={},classes=$(element).attr("class");if(classes){$.each(classes.split(" "),function(){if(this in $.validator.classRuleSettings){$.extend(rules,$.validator.classRuleSettings[this]);}});}
return rules;},normalizeAttributeRule:function(rules,type,method,value){if(/min|max|step/.test(method)&&(type===null||/number|range|text/.test(type))){value=Number(value);if(isNaN(value)){value=undefined;}}
if(value||value===0){rules[method]=value;}else if(type===method&&type!=="range"){rules[method]=true;}},attributeRules:function(element){var rules={},$element=$(element),type=element.getAttribute("type"),method,value;for(method in $.validator.methods){if(method==="required"){value=element.getAttribute(method);if(value===""){value=true;}
value=!!value;}else{value=$element.attr(method);}
this.normalizeAttributeRule(rules,type,method,value);}
if(rules.maxlength&&/-1|2147483647|524288/.test(rules.maxlength)){delete rules.maxlength;}
return rules;},dataRules:function(element){var rules={},$element=$(element),type=element.getAttribute("type"),method,value;for(method in $.validator.methods){value=$element.data("rule"+method.charAt(0).toUpperCase()+method.substring(1).toLowerCase());this.normalizeAttributeRule(rules,type,method,value);}
return rules;},staticRules:function(element){var rules={},validator=$.data(element.form,"validator");if(validator.settings.rules){rules=$.validator.normalizeRule(validator.settings.rules[element.name])||{};}
return rules;},normalizeRules:function(rules,element){$.each(rules,function(prop,val){if(val===false){delete rules[prop];return;}
if(val.param||val.depends){var keepRule=true;switch(typeof val.depends){case"string":keepRule=!!$(val.depends,element.form).length;break;case"function":keepRule=val.depends.call(element,element);break;}
if(keepRule){rules[prop]=val.param!==undefined?val.param:true;}else{$.data(element.form,"validator").resetElements($(element));delete rules[prop];}}});$.each(rules,function(rule,parameter){rules[rule]=$.isFunction(parameter)&&rule!=="normalizer"?parameter(element):parameter;});$.each(["minlength","maxlength"],function(){if(rules[this]){rules[this]=Number(rules[this]);}});$.each(["rangelength","range"],function(){var parts;if(rules[this]){if($.isArray(rules[this])){rules[this]=[Number(rules[this][0]),Number(rules[this][1])];}else if(typeof rules[this]==="string"){parts=rules[this].replace(/[\[\]]/g,"").split(/[\s,]+/);rules[this]=[Number(parts[0]),Number(parts[1])];}}});if($.validator.autoCreateRanges){if(rules.min!=null&&rules.max!=null){rules.range=[rules.min,rules.max];delete rules.min;delete rules.max;}
if(rules.minlength!=null&&rules.maxlength!=null){rules.rangelength=[rules.minlength,rules.maxlength];delete rules.minlength;delete rules.maxlength;}}
return rules;},normalizeRule:function(data){if(typeof data==="string"){var transformed={};$.each(data.split(/\s/),function(){transformed[this]=true;});data=transformed;}
return data;},addMethod:function(name,method,message){$.validator.methods[name]=method;$.validator.messages[name]=message!==undefined?message:$.validator.messages[name];if(method.length<3){$.validator.addClassRules(name,$.validator.normalizeRule(name));}},methods:{required:function(value,element,param){if(!this.depend(param,element)){return"dependency-mismatch";}
if(element.nodeName.toLowerCase()==="select"){var val=$(element).val();return val&&val.length>0;}
if(this.checkable(element)){return this.getLength(value,element)>0;}
return value.length>0;},email:function(value,element){return this.optional(element)||/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(value);},url:function(value,element){return this.optional(element)||/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(value);},date:function(value,element){return this.optional(element)||!/Invalid|NaN/.test(new Date(value).toString());},dateISO:function(value,element){return this.optional(element)||/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(value);},number:function(value,element){return this.optional(element)||/^(?:-?\d+|-?\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(value);},digits:function(value,element){return this.optional(element)||/^\d+$/.test(value);},minlength:function(value,element,param){var length=$.isArray(value)?value.length:this.getLength(value,element);return this.optional(element)||length>=param;},maxlength:function(value,element,param){var length=$.isArray(value)?value.length:this.getLength(value,element);return this.optional(element)||length<=param;},rangelength:function(value,element,param){var length=$.isArray(value)?value.length:this.getLength(value,element);return this.optional(element)||(length>=param[0]&&length<=param[1]);},min:function(value,element,param){return this.optional(element)||value>=param;},max:function(value,element,param){return this.optional(element)||value<=param;},range:function(value,element,param){return this.optional(element)||(value>=param[0]&&value<=param[1]);},step:function(value,element,param){var type=$(element).attr("type"),errorMessage="Step attribute on input type "+type+" is not supported.",supportedTypes=["text","number","range"],re=new RegExp("\\b"+type+"\\b"),notSupported=type&&!re.test(supportedTypes.join()),decimalPlaces=function(num){var match=(""+num).match(/(?:\.(\d+))?$/);if(!match){return 0;}
return match[1]?match[1].length:0;},toInt=function(num){return Math.round(num*Math.pow(10,decimals));},valid=true,decimals;if(notSupported){throw new Error(errorMessage);}
decimals=decimalPlaces(param);if(decimalPlaces(value)>decimals||toInt(value)%toInt(param)!==0){valid=false;}
return this.optional(element)||valid;},equalTo:function(value,element,param){var target=$(param);if(this.settings.onfocusout&&target.not(".validate-equalTo-blur").length){target.addClass("validate-equalTo-blur").on("blur.validate-equalTo",function(){$(element).valid();});}
return value===target.val();},remote:function(value,element,param,method){if(this.optional(element)){return"dependency-mismatch";}
method=typeof method==="string"&&method||"remote";var previous=this.previousValue(element,method),validator,data,optionDataString;if(!this.settings.messages[element.name]){this.settings.messages[element.name]={};}
previous.originalMessage=previous.originalMessage||this.settings.messages[element.name][method];this.settings.messages[element.name][method]=previous.message;param=typeof param==="string"&&{url:param}||param;optionDataString=$.param($.extend({data:value},param.data));if(previous.old===optionDataString){return previous.valid;}
previous.old=optionDataString;validator=this;this.startRequest(element);data={};data[element.name]=value;$.ajax($.extend(true,{mode:"abort",port:"validate"+element.name,dataType:"json",data:data,context:validator.currentForm,success:function(response){var valid=response===true||response==="true",errors,message,submitted;validator.settings.messages[element.name][method]=previous.originalMessage;if(valid){submitted=validator.formSubmitted;validator.resetInternals();validator.toHide=validator.errorsFor(element);validator.formSubmitted=submitted;validator.successList.push(element);validator.invalid[element.name]=false;validator.showErrors();}else{errors={};message=response||validator.defaultMessage(element,{method:method,parameters:value});errors[element.name]=previous.message=message;validator.invalid[element.name]=true;validator.showErrors(errors);}
previous.valid=valid;validator.stopRequest(element,valid);}},param));return"pending";}}});var pendingRequests={},ajax;if($.ajaxPrefilter){$.ajaxPrefilter(function(settings,_,xhr){var port=settings.port;if(settings.mode==="abort"){if(pendingRequests[port]){pendingRequests[port].abort();}
pendingRequests[port]=xhr;}});}else{ajax=$.ajax;$.ajax=function(settings){var mode=("mode"in settings?settings:$.ajaxSettings).mode,port=("port"in settings?settings:$.ajaxSettings).port;if(mode==="abort"){if(pendingRequests[port]){pendingRequests[port].abort();}
pendingRequests[port]=ajax.apply(this,arguments);return pendingRequests[port];}
return ajax.apply(this,arguments);};}
return $;}));;

/* /scrummer/static/src/js/libs/external/jquery-ui.js defined in bundle 'scrummer.assets' */
(function(factory){if(typeof define==="function"&&define.amd){define(["jquery.expander.js"],factory);}else{factory(jQuery);}}(function($){$.ui=$.ui||{};var version=$.ui.version="1.12.0";var widgetUuid=0;var widgetSlice=Array.prototype.slice;$.cleanData=(function(orig){return function(elems){var events,elem,i;for(i=0;(elem=elems[i])!=null;i++){try{events=$._data(elem,"events");if(events&&events.remove){$(elem).triggerHandler("remove");}}catch(e){}}
orig(elems);};})($.cleanData);$.widget=function(name,base,prototype){var existingConstructor,constructor,basePrototype;var proxiedPrototype={};var namespace=name.split(".")[0];name=name.split(".")[1];var fullName=namespace+"-"+name;if(!prototype){prototype=base;base=$.Widget;}
if($.isArray(prototype)){prototype=$.extend.apply(null,[{}].concat(prototype));}
$.expr[":"][fullName.toLowerCase()]=function(elem){return!!$.data(elem,fullName);};$[namespace]=$[namespace]||{};existingConstructor=$[namespace][name];constructor=$[namespace][name]=function(options,element){if(!this._createWidget){return new constructor(options,element);}
if(arguments.length){this._createWidget(options,element);}};$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]});basePrototype=new base();basePrototype.options=$.widget.extend({},basePrototype.options);$.each(prototype,function(prop,value){if(!$.isFunction(value)){proxiedPrototype[prop]=value;return;}
proxiedPrototype[prop]=(function(){function _super(){return base.prototype[prop].apply(this,arguments);}
function _superApply(args){return base.prototype[prop].apply(this,args);}
return function(){var __super=this._super;var __superApply=this._superApply;var returnValue;this._super=_super;this._superApply=_superApply;returnValue=value.apply(this,arguments);this._super=__super;this._superApply=__superApply;return returnValue;};})();});constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor?(basePrototype.widgetEventPrefix||name):name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName});if(existingConstructor){$.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+"."+childPrototype.widgetName,constructor,child._proto);});delete existingConstructor._childConstructors;}else{base._childConstructors.push(constructor);}
$.widget.bridge(name,constructor);return constructor;};$.widget.extend=function(target){var input=widgetSlice.call(arguments,1);var inputIndex=0;var inputLength=input.length;var key;var value;for(;inputIndex<inputLength;inputIndex++){for(key in input[inputIndex]){value=input[inputIndex][key];if(input[inputIndex].hasOwnProperty(key)&&value!==undefined){if($.isPlainObject(value)){target[key]=$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value);}else{target[key]=value;}}}}
return target;};$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall=typeof options==="string";var args=widgetSlice.call(arguments,1);var returnValue=this;if(isMethodCall){this.each(function(){var methodValue;var instance=$.data(this,fullName);if(options==="instance"){returnValue=instance;return false;}
if(!instance){return $.error("cannot call methods on "+name+" prior to initialization; "+"attempted to call method '"+options+"'");}
if(!$.isFunction(instance[options])||options.charAt(0)==="_"){return $.error("no such method '"+options+"' for "+name+" widget instance");}
methodValue=instance[options].apply(instance,args);if(methodValue!==instance&&methodValue!==undefined){returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue;return false;}});}else{if(args.length){options=$.widget.extend.apply(null,[options].concat(args));}
this.each(function(){var instance=$.data(this,fullName);if(instance){instance.option(options||{});if(instance._init){instance._init();}}else{$.data(this,fullName,new object(options,this));}});}
return returnValue;};};$.Widget=function(){};$.Widget._childConstructors=[];$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:false,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0];this.element=$(element);this.uuid=widgetUuid++;this.eventNamespace="."+this.widgetName+this.uuid;this.bindings=$();this.hoverable=$();this.focusable=$();this.classesElementLookup={};if(element!==this){$.data(element,this.widgetFullName,this);this._on(true,this.element,{remove:function(event){if(event.target===element){this.destroy();}}});this.document=$(element.style?element.ownerDocument:element.document||element);this.window=$(this.document[0].defaultView||this.document[0].parentWindow);}
this.options=$.widget.extend({},this.options,this._getCreateOptions(),options);this._create();if(this.options.disabled){this._setOptionDisabled(this.options.disabled);}
this._trigger("create",null,this._getCreateEventData());this._init();},_getCreateOptions:function(){return{};},_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){var that=this;this._destroy();$.each(this.classesElementLookup,function(key,value){that._removeClass(value,key);});this.element.off(this.eventNamespace).removeData(this.widgetFullName);this.widget().off(this.eventNamespace).removeAttr("aria-disabled");this.bindings.off(this.eventNamespace);},_destroy:$.noop,widget:function(){return this.element;},option:function(key,value){var options=key;var parts;var curOption;var i;if(arguments.length===0){return $.widget.extend({},this.options);}
if(typeof key==="string"){options={};parts=key.split(".");key=parts.shift();if(parts.length){curOption=options[key]=$.widget.extend({},this.options[key]);for(i=0;i<parts.length-1;i++){curOption[parts[i]]=curOption[parts[i]]||{};curOption=curOption[parts[i]];}
key=parts.pop();if(arguments.length===1){return curOption[key]===undefined?null:curOption[key];}
curOption[key]=value;}else{if(arguments.length===1){return this.options[key]===undefined?null:this.options[key];}
options[key]=value;}}
this._setOptions(options);return this;},_setOptions:function(options){var key;for(key in options){this._setOption(key,options[key]);}
return this;},_setOption:function(key,value){if(key==="classes"){this._setOptionClasses(value);}
this.options[key]=value;if(key==="disabled"){this._setOptionDisabled(value);}
return this;},_setOptionClasses:function(value){var classKey,elements,currentElements;for(classKey in value){currentElements=this.classesElementLookup[classKey];if(value[classKey]===this.options.classes[classKey]||!currentElements||!currentElements.length){continue;}
elements=$(currentElements.get());this._removeClass(currentElements,classKey);elements.addClass(this._classes({element:elements,keys:classKey,classes:value,add:true}));}},_setOptionDisabled:function(value){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!value);if(value){this._removeClass(this.hoverable,null,"ui-state-hover");this._removeClass(this.focusable,null,"ui-state-focus");}},enable:function(){return this._setOptions({disabled:false});},disable:function(){return this._setOptions({disabled:true});},_classes:function(options){var full=[];var that=this;options=$.extend({element:this.element,classes:this.options.classes||{}},options);function processClassString(classes,checkOption){var current,i;for(i=0;i<classes.length;i++){current=that.classesElementLookup[classes[i]]||$();if(options.add){current=$($.unique(current.get().concat(options.element.get())));}else{current=$(current.not(options.element).get());}
that.classesElementLookup[classes[i]]=current;full.push(classes[i]);if(checkOption&&options.classes[classes[i]]){full.push(options.classes[classes[i]]);}}}
if(options.keys){processClassString(options.keys.match(/\S+/g)||[],true);}
if(options.extra){processClassString(options.extra.match(/\S+/g)||[]);}
return full.join(" ");},_removeClass:function(element,keys,extra){return this._toggleClass(element,keys,extra,false);},_addClass:function(element,keys,extra){return this._toggleClass(element,keys,extra,true);},_toggleClass:function(element,keys,extra,add){add=(typeof add==="boolean")?add:extra;var shift=(typeof element==="string"||element===null),options={extra:shift?keys:extra,keys:shift?element:keys,element:shift?this.element:element,add:add};options.element.toggleClass(this._classes(options),add);return this;},_on:function(suppressDisabledCheck,element,handlers){var delegateElement;var instance=this;if(typeof suppressDisabledCheck!=="boolean"){handlers=element;element=suppressDisabledCheck;suppressDisabledCheck=false;}
if(!handlers){handlers=element;element=this.element;delegateElement=this.widget();}else{element=delegateElement=$(element);this.bindings=this.bindings.add(element);}
$.each(handlers,function(event,handler){function handlerProxy(){if(!suppressDisabledCheck&&(instance.options.disabled===true||$(this).hasClass("ui-state-disabled"))){return;}
return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments);}
if(typeof handler!=="string"){handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++;}
var match=event.match(/^([\w:-]*)\s*(.*)$/);var eventName=match[1]+instance.eventNamespace;var selector=match[2];if(selector){delegateElement.on(eventName,selector,handlerProxy);}else{element.on(eventName,handlerProxy);}});},_off:function(element,eventName){eventName=(eventName||"").split(" ").join(this.eventNamespace+" ")+
this.eventNamespace;element.off(eventName).off(eventName);this.bindings=$(this.bindings.not(element).get());this.focusable=$(this.focusable.not(element).get());this.hoverable=$(this.hoverable.not(element).get());},_delay:function(handler,delay){function handlerProxy(){return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments);}
var instance=this;return setTimeout(handlerProxy,delay||0);},_hoverable:function(element){this.hoverable=this.hoverable.add(element);this._on(element,{mouseenter:function(event){this._addClass($(event.currentTarget),null,"ui-state-hover");},mouseleave:function(event){this._removeClass($(event.currentTarget),null,"ui-state-hover");}});},_focusable:function(element){this.focusable=this.focusable.add(element);this._on(element,{focusin:function(event){this._addClass($(event.currentTarget),null,"ui-state-focus");},focusout:function(event){this._removeClass($(event.currentTarget),null,"ui-state-focus");}});},_trigger:function(type,event,data){var prop,orig;var callback=this.options[type];data=data||{};event=$.Event(event);event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase();event.target=this.element[0];orig=event.originalEvent;if(orig){for(prop in orig){if(!(prop in event)){event[prop]=orig[prop];}}}
this.element.trigger(event,data);return!($.isFunction(callback)&&callback.apply(this.element[0],[event].concat(data))===false||event.isDefaultPrevented());}};$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){$.Widget.prototype["_"+method]=function(element,options,callback){if(typeof options==="string"){options={effect:options};}
var hasOptions;var effectName=!options?method:options===true||typeof options==="number"?defaultEffect:options.effect||defaultEffect;options=options||{};if(typeof options==="number"){options={duration:options};}
hasOptions=!$.isEmptyObject(options);options.complete=callback;if(options.delay){element.delay(options.delay);}
if(hasOptions&&$.effects&&$.effects.effect[effectName]){element[method](options);}else if(effectName!==method&&element[effectName]){element[effectName](options.duration,options.easing,callback);}else{element.queue(function(next){$(this)[method]();if(callback){callback.call(element[0]);}
next();});}};});var widget=$.widget;var data=$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo(function(dataName){return function(elem){return!!$.data(elem,dataName);};}):function(elem,i,match){return!!$.data(elem,match[3]);}});var scrollParent=$.fn.scrollParent=function(includeHidden){var position=this.css("position"),excludeStaticParent=position==="absolute",overflowRegex=includeHidden?/(auto|scroll|hidden)/:/(auto|scroll)/,scrollParent=this.parents().filter(function(){var parent=$(this);if(excludeStaticParent&&parent.css("position")==="static"){return false;}
return overflowRegex.test(parent.css("overflow")+parent.css("overflow-y")+
parent.css("overflow-x"));}).eq(0);return position==="fixed"||!scrollParent.length?$(this[0].ownerDocument||document):scrollParent;};var ie=$.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());var mouseHandled=false;$(document).on("mouseup",function(){mouseHandled=false;});var widgetsMouse=$.widget("ui.mouse",{version:"1.12.0",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var that=this;this.element.on("mousedown."+this.widgetName,function(event){return that._mouseDown(event);}).on("click."+this.widgetName,function(event){if(true===$.data(event.target,that.widgetName+".preventClickEvent")){$.removeData(event.target,that.widgetName+".preventClickEvent");event.stopImmediatePropagation();return false;}});this.started=false;},_mouseDestroy:function(){this.element.off("."+this.widgetName);if(this._mouseMoveDelegate){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate);}},_mouseDown:function(event){if(mouseHandled){return;}
this._mouseMoved=false;(this._mouseStarted&&this._mouseUp(event));this._mouseDownEvent=event;var that=this,btnIsLeft=(event.which===1),elIsCancel=(typeof this.options.cancel==="string"&&event.target.nodeName?$(event.target).closest(this.options.cancel).length:false);if(!btnIsLeft||elIsCancel||!this._mouseCapture(event)){return true;}
this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){that.mouseDelayMet=true;},this.options.delay);}
if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=(this._mouseStart(event)!==false);if(!this._mouseStarted){event.preventDefault();return true;}}
if(true===$.data(event.target,this.widgetName+".preventClickEvent")){$.removeData(event.target,this.widgetName+".preventClickEvent");}
this._mouseMoveDelegate=function(event){return that._mouseMove(event);};this._mouseUpDelegate=function(event){return that._mouseUp(event);};this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate);event.preventDefault();mouseHandled=true;return true;},_mouseMove:function(event){if(this._mouseMoved){if($.ui.ie&&(!document.documentMode||document.documentMode<9)&&!event.button){return this._mouseUp(event);}else if(!event.which){if(event.originalEvent.altKey||event.originalEvent.ctrlKey||event.originalEvent.metaKey||event.originalEvent.shiftKey){this.ignoreMissingWhich=true;}else if(!this.ignoreMissingWhich){return this._mouseUp(event);}}}
if(event.which||event.button){this._mouseMoved=true;}
if(this._mouseStarted){this._mouseDrag(event);return event.preventDefault();}
if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=(this._mouseStart(this._mouseDownEvent,event)!==false);(this._mouseStarted?this._mouseDrag(event):this._mouseUp(event));}
return!this._mouseStarted;},_mouseUp:function(event){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(event.target===this._mouseDownEvent.target){$.data(event.target,this.widgetName+".preventClickEvent",true);}
this._mouseStop(event);}
if(this._mouseDelayTimer){clearTimeout(this._mouseDelayTimer);delete this._mouseDelayTimer;}
this.ignoreMissingWhich=false;mouseHandled=false;event.preventDefault();},_mouseDistanceMet:function(event){return(Math.max(Math.abs(this._mouseDownEvent.pageX-event.pageX),Math.abs(this._mouseDownEvent.pageY-event.pageY))>=this.options.distance);},_mouseDelayMet:function(){return this.mouseDelayMet;},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true;}});var plugin=$.ui.plugin={add:function(module,option,set){var i,proto=$.ui[module].prototype;for(i in set){proto.plugins[i]=proto.plugins[i]||[];proto.plugins[i].push([option,set[i]]);}},call:function(instance,name,args,allowDisconnected){var i,set=instance.plugins[name];if(!set){return;}
if(!allowDisconnected&&(!instance.element[0].parentNode||instance.element[0].parentNode.nodeType===11)){return;}
for(i=0;i<set.length;i++){if(instance.options[set[i][0]]){set[i][1].apply(instance.element,args);}}}};var safeActiveElement=$.ui.safeActiveElement=function(document){var activeElement;try{activeElement=document.activeElement;}catch(error){activeElement=document.body;}
if(!activeElement){activeElement=document.body;}
if(!activeElement.nodeName){activeElement=document.body;}
return activeElement;};var safeBlur=$.ui.safeBlur=function(element){if(element&&element.nodeName.toLowerCase()!=="body"){$(element).trigger("blur");}};$.widget("ui.draggable",$.ui.mouse,{version:"1.12.0",widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false,drag:null,start:null,stop:null},_create:function(){if(this.options.helper==="original"){this._setPositionRelative();}
if(this.options.addClasses){this._addClass("ui-draggable");}
this._setHandleClassName();this._mouseInit();},_setOption:function(key,value){this._super(key,value);if(key==="handle"){this._removeHandleClassName();this._setHandleClassName();}},_destroy:function(){if((this.helper||this.element).is(".ui-draggable-dragging")){this.destroyOnClear=true;return;}
this._removeHandleClassName();this._mouseDestroy();},_mouseCapture:function(event){var o=this.options;this._blurActiveElement(event);if(this.helper||o.disabled||$(event.target).closest(".ui-resizable-handle").length>0){return false;}
this.handle=this._getHandle(event);if(!this.handle){return false;}
this._blockFrames(o.iframeFix===true?"iframe":o.iframeFix);return true;},_blockFrames:function(selector){this.iframeBlocks=this.document.find(selector).map(function(){var iframe=$(this);return $("<div>").css("position","absolute").appendTo(iframe.parent()).outerWidth(iframe.outerWidth()).outerHeight(iframe.outerHeight()).offset(iframe.offset())[0];});},_unblockFrames:function(){if(this.iframeBlocks){this.iframeBlocks.remove();delete this.iframeBlocks;}},_blurActiveElement:function(event){var activeElement=$.ui.safeActiveElement(this.document[0]),target=$(event.target);if(this._getHandle(event)&&target.closest(activeElement).length){return;}
$.ui.safeBlur(activeElement);},_mouseStart:function(event){var o=this.options;this.helper=this._createHelper(event);this._addClass(this.helper,"ui-draggable-dragging");this._cacheHelperProportions();if($.ui.ddmanager){$.ui.ddmanager.current=this;}
this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent(true);this.offsetParent=this.helper.offsetParent();this.hasFixedAncestor=this.helper.parents().filter(function(){return $(this).css("position")==="fixed";}).length>0;this.positionAbs=this.element.offset();this._refreshOffsets(event);this.originalPosition=this.position=this._generatePosition(event,false);this.originalPageX=event.pageX;this.originalPageY=event.pageY;(o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt));this._setContainment();if(this._trigger("start",event)===false){this._clear();return false;}
this._cacheHelperProportions();if($.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(this,event);}
this._mouseDrag(event,true);if($.ui.ddmanager){$.ui.ddmanager.dragStart(this,event);}
return true;},_refreshOffsets:function(event){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:false,parent:this._getParentOffset(),relative:this._getRelativeOffset()};this.offset.click={left:event.pageX-this.offset.left,top:event.pageY-this.offset.top};},_mouseDrag:function(event,noPropagation){if(this.hasFixedAncestor){this.offset.parent=this._getParentOffset();}
this.position=this._generatePosition(event,true);this.positionAbs=this._convertPositionTo("absolute");if(!noPropagation){var ui=this._uiHash();if(this._trigger("drag",event,ui)===false){this._mouseUp(new $.Event("mouseup",event));return false;}
this.position=ui.position;}
this.helper[0].style.left=this.position.left+"px";this.helper[0].style.top=this.position.top+"px";if($.ui.ddmanager){$.ui.ddmanager.drag(this,event);}
return false;},_mouseStop:function(event){var that=this,dropped=false;if($.ui.ddmanager&&!this.options.dropBehaviour){dropped=$.ui.ddmanager.drop(this,event);}
if(this.dropped){dropped=this.dropped;this.dropped=false;}
if((this.options.revert==="invalid"&&!dropped)||(this.options.revert==="valid"&&dropped)||this.options.revert===true||($.isFunction(this.options.revert)&&this.options.revert.call(this.element,dropped))){$(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){if(that._trigger("stop",event)!==false){that._clear();}});}else{if(this._trigger("stop",event)!==false){this._clear();}}
return false;},_mouseUp:function(event){this._unblockFrames();if($.ui.ddmanager){$.ui.ddmanager.dragStop(this,event);}
if(this.handleElement.is(event.target)){this.element.trigger("focus");}
return $.ui.mouse.prototype._mouseUp.call(this,event);},cancel:function(){if(this.helper.is(".ui-draggable-dragging")){this._mouseUp(new $.Event("mouseup",{target:this.element[0]}));}else{this._clear();}
return this;},_getHandle:function(event){return this.options.handle?!!$(event.target).closest(this.element.find(this.options.handle)).length:true;},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element;this._addClass(this.handleElement,"ui-draggable-handle");},_removeHandleClassName:function(){this._removeClass(this.handleElement,"ui-draggable-handle");},_createHelper:function(event){var o=this.options,helperIsFunction=$.isFunction(o.helper),helper=helperIsFunction?$(o.helper.apply(this.element[0],[event])):(o.helper==="clone"?this.element.clone().removeAttr("id"):this.element);if(!helper.parents("body").length){helper.appendTo((o.appendTo==="parent"?this.element[0].parentNode:o.appendTo));}
if(helperIsFunction&&helper[0]===this.element[0]){this._setPositionRelative();}
if(helper[0]!==this.element[0]&&!(/(fixed|absolute)/).test(helper.css("position"))){helper.css("position","absolute");}
return helper;},_setPositionRelative:function(){if(!(/^(?:r|a|f)/).test(this.element.css("position"))){this.element[0].style.position="relative";}},_adjustOffsetFromHelper:function(obj){if(typeof obj==="string"){obj=obj.split(" ");}
if($.isArray(obj)){obj={left:+obj[0],top:+obj[1]||0};}
if("left"in obj){this.offset.click.left=obj.left+this.margins.left;}
if("right"in obj){this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left;}
if("top"in obj){this.offset.click.top=obj.top+this.margins.top;}
if("bottom"in obj){this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top;}},_isRootNode:function(element){return(/(html|body)/i).test(element.tagName)||element===this.document[0];},_getParentOffset:function(){var po=this.offsetParent.offset(),document=this.document[0];if(this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])){po.left+=this.scrollParent.scrollLeft();po.top+=this.scrollParent.scrollTop();}
if(this._isRootNode(this.offsetParent[0])){po={top:0,left:0};}
return{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)};},_getRelativeOffset:function(){if(this.cssPosition!=="relative"){return{top:0,left:0};}
var p=this.element.position(),scrollIsRootNode=this._isRootNode(this.scrollParent[0]);return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+
(!scrollIsRootNode?this.scrollParent.scrollTop():0),left:p.left-(parseInt(this.helper.css("left"),10)||0)+
(!scrollIsRootNode?this.scrollParent.scrollLeft():0)};},_cacheMargins:function(){this.margins={left:(parseInt(this.element.css("marginLeft"),10)||0),top:(parseInt(this.element.css("marginTop"),10)||0),right:(parseInt(this.element.css("marginRight"),10)||0),bottom:(parseInt(this.element.css("marginBottom"),10)||0)};},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()};},_setContainment:function(){var isUserScrollable,c,ce,o=this.options,document=this.document[0];this.relativeContainer=null;if(!o.containment){this.containment=null;return;}
if(o.containment==="window"){this.containment=[$(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,$(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,$(window).scrollLeft()+$(window).width()-
this.helperProportions.width-this.margins.left,$(window).scrollTop()+
($(window).height()||document.body.parentNode.scrollHeight)-
this.helperProportions.height-this.margins.top];return;}
if(o.containment==="document"){this.containment=[0,0,$(document).width()-this.helperProportions.width-this.margins.left,($(document).height()||document.body.parentNode.scrollHeight)-
this.helperProportions.height-this.margins.top];return;}
if(o.containment.constructor===Array){this.containment=o.containment;return;}
if(o.containment==="parent"){o.containment=this.helper[0].parentNode;}
c=$(o.containment);ce=c[0];if(!ce){return;}
isUserScrollable=/(scroll|auto)/.test(c.css("overflow"));this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+
(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+
(parseInt(c.css("paddingTop"),10)||0),(isUserScrollable?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-
(parseInt(c.css("borderRightWidth"),10)||0)-
(parseInt(c.css("paddingRight"),10)||0)-
this.helperProportions.width-
this.margins.left-
this.margins.right,(isUserScrollable?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-
(parseInt(c.css("borderBottomWidth"),10)||0)-
(parseInt(c.css("paddingBottom"),10)||0)-
this.helperProportions.height-
this.margins.top-
this.margins.bottom];this.relativeContainer=c;},_convertPositionTo:function(d,pos){if(!pos){pos=this.position;}
var mod=d==="absolute"?1:-1,scrollIsRootNode=this._isRootNode(this.scrollParent[0]);return{top:(pos.top+
this.offset.relative.top*mod+
this.offset.parent.top*mod-
((this.cssPosition==="fixed"?-this.offset.scroll.top:(scrollIsRootNode?0:this.offset.scroll.top))*mod)),left:(pos.left+
this.offset.relative.left*mod+
this.offset.parent.left*mod-
((this.cssPosition==="fixed"?-this.offset.scroll.left:(scrollIsRootNode?0:this.offset.scroll.left))*mod))};},_generatePosition:function(event,constrainPosition){var containment,co,top,left,o=this.options,scrollIsRootNode=this._isRootNode(this.scrollParent[0]),pageX=event.pageX,pageY=event.pageY;if(!scrollIsRootNode||!this.offset.scroll){this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()};}
if(constrainPosition){if(this.containment){if(this.relativeContainer){co=this.relativeContainer.offset();containment=[this.containment[0]+co.left,this.containment[1]+co.top,this.containment[2]+co.left,this.containment[3]+co.top];}else{containment=this.containment;}
if(event.pageX-this.offset.click.left<containment[0]){pageX=containment[0]+this.offset.click.left;}
if(event.pageY-this.offset.click.top<containment[1]){pageY=containment[1]+this.offset.click.top;}
if(event.pageX-this.offset.click.left>containment[2]){pageX=containment[2]+this.offset.click.left;}
if(event.pageY-this.offset.click.top>containment[3]){pageY=containment[3]+this.offset.click.top;}}
if(o.grid){top=o.grid[1]?this.originalPageY+Math.round((pageY-
this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY;pageY=containment?((top-this.offset.click.top>=containment[1]||top-this.offset.click.top>containment[3])?top:((top-this.offset.click.top>=containment[1])?top-o.grid[1]:top+o.grid[1])):top;left=o.grid[0]?this.originalPageX+
Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX;pageX=containment?((left-this.offset.click.left>=containment[0]||left-this.offset.click.left>containment[2])?left:((left-this.offset.click.left>=containment[0])?left-o.grid[0]:left+o.grid[0])):left;}
if(o.axis==="y"){pageX=this.originalPageX;}
if(o.axis==="x"){pageY=this.originalPageY;}}
return{top:(pageY-
this.offset.click.top-
this.offset.relative.top-
this.offset.parent.top+
(this.cssPosition==="fixed"?-this.offset.scroll.top:(scrollIsRootNode?0:this.offset.scroll.top))),left:(pageX-
this.offset.click.left-
this.offset.relative.left-
this.offset.parent.left+
(this.cssPosition==="fixed"?-this.offset.scroll.left:(scrollIsRootNode?0:this.offset.scroll.left)))};},_clear:function(){this._removeClass(this.helper,"ui-draggable-dragging");if(this.helper[0]!==this.element[0]&&!this.cancelHelperRemoval){this.helper.remove();}
this.helper=null;this.cancelHelperRemoval=false;if(this.destroyOnClear){this.destroy();}},_trigger:function(type,event,ui){ui=ui||this._uiHash();$.ui.plugin.call(this,type,[event,ui,this],true);if(/^(drag|start|stop)/.test(type)){this.positionAbs=this._convertPositionTo("absolute");ui.offset=this.positionAbs;}
return $.Widget.prototype._trigger.call(this,type,event,ui);},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs};}});$.ui.plugin.add("draggable","connectToSortable",{start:function(event,ui,draggable){var uiSortable=$.extend({},ui,{item:draggable.element});draggable.sortables=[];$(draggable.options.connectToSortable).each(function(){var sortable=$(this).sortable("instance");if(sortable&&!sortable.options.disabled){draggable.sortables.push(sortable);sortable.refreshPositions();sortable._trigger("activate",event,uiSortable);}});},stop:function(event,ui,draggable){var uiSortable=$.extend({},ui,{item:draggable.element});draggable.cancelHelperRemoval=false;$.each(draggable.sortables,function(){var sortable=this;if(sortable.isOver){sortable.isOver=0;draggable.cancelHelperRemoval=true;sortable.cancelHelperRemoval=false;sortable._storedCSS={position:sortable.placeholder.css("position"),top:sortable.placeholder.css("top"),left:sortable.placeholder.css("left")};sortable._mouseStop(event);sortable.options.helper=sortable.options._helper;}else{sortable.cancelHelperRemoval=true;sortable._trigger("deactivate",event,uiSortable);}});},drag:function(event,ui,draggable){$.each(draggable.sortables,function(){var innermostIntersecting=false,sortable=this;sortable.positionAbs=draggable.positionAbs;sortable.helperProportions=draggable.helperProportions;sortable.offset.click=draggable.offset.click;if(sortable._intersectsWith(sortable.containerCache)){innermostIntersecting=true;$.each(draggable.sortables,function(){this.positionAbs=draggable.positionAbs;this.helperProportions=draggable.helperProportions;this.offset.click=draggable.offset.click;if(this!==sortable&&this._intersectsWith(this.containerCache)&&$.contains(sortable.element[0],this.element[0])){innermostIntersecting=false;}
return innermostIntersecting;});}
if(innermostIntersecting){if(!sortable.isOver){sortable.isOver=1;draggable._parent=ui.helper.parent();sortable.currentItem=ui.helper.appendTo(sortable.element).data("ui-sortable-item",true);sortable.options._helper=sortable.options.helper;sortable.options.helper=function(){return ui.helper[0];};event.target=sortable.currentItem[0];sortable._mouseCapture(event,true);sortable._mouseStart(event,true,true);sortable.offset.click.top=draggable.offset.click.top;sortable.offset.click.left=draggable.offset.click.left;sortable.offset.parent.left-=draggable.offset.parent.left-
sortable.offset.parent.left;sortable.offset.parent.top-=draggable.offset.parent.top-
sortable.offset.parent.top;draggable._trigger("toSortable",event);draggable.dropped=sortable.element;$.each(draggable.sortables,function(){this.refreshPositions();});draggable.currentItem=draggable.element;sortable.fromOutside=draggable;}
if(sortable.currentItem){sortable._mouseDrag(event);ui.position=sortable.position;}}else{if(sortable.isOver){sortable.isOver=0;sortable.cancelHelperRemoval=true;sortable.options._revert=sortable.options.revert;sortable.options.revert=false;sortable._trigger("out",event,sortable._uiHash(sortable));sortable._mouseStop(event,true);sortable.options.revert=sortable.options._revert;sortable.options.helper=sortable.options._helper;if(sortable.placeholder){sortable.placeholder.remove();}
ui.helper.appendTo(draggable._parent);draggable._refreshOffsets(event);ui.position=draggable._generatePosition(event,true);draggable._trigger("fromSortable",event);draggable.dropped=false;$.each(draggable.sortables,function(){this.refreshPositions();});}}});}});$.ui.plugin.add("draggable","cursor",{start:function(event,ui,instance){var t=$("body"),o=instance.options;if(t.css("cursor")){o._cursor=t.css("cursor");}
t.css("cursor",o.cursor);},stop:function(event,ui,instance){var o=instance.options;if(o._cursor){$("body").css("cursor",o._cursor);}}});$.ui.plugin.add("draggable","opacity",{start:function(event,ui,instance){var t=$(ui.helper),o=instance.options;if(t.css("opacity")){o._opacity=t.css("opacity");}
t.css("opacity",o.opacity);},stop:function(event,ui,instance){var o=instance.options;if(o._opacity){$(ui.helper).css("opacity",o._opacity);}}});$.ui.plugin.add("draggable","scroll",{start:function(event,ui,i){if(!i.scrollParentNotHidden){i.scrollParentNotHidden=i.helper.scrollParent(false);}
if(i.scrollParentNotHidden[0]!==i.document[0]&&i.scrollParentNotHidden[0].tagName!=="HTML"){i.overflowOffset=i.scrollParentNotHidden.offset();}},drag:function(event,ui,i){var o=i.options,scrolled=false,scrollParent=i.scrollParentNotHidden[0],document=i.document[0];if(scrollParent!==document&&scrollParent.tagName!=="HTML"){if(!o.axis||o.axis!=="x"){if((i.overflowOffset.top+scrollParent.offsetHeight)-event.pageY<o.scrollSensitivity){scrollParent.scrollTop=scrolled=scrollParent.scrollTop+o.scrollSpeed;}else if(event.pageY-i.overflowOffset.top<o.scrollSensitivity){scrollParent.scrollTop=scrolled=scrollParent.scrollTop-o.scrollSpeed;}}
if(!o.axis||o.axis!=="y"){if((i.overflowOffset.left+scrollParent.offsetWidth)-event.pageX<o.scrollSensitivity){scrollParent.scrollLeft=scrolled=scrollParent.scrollLeft+o.scrollSpeed;}else if(event.pageX-i.overflowOffset.left<o.scrollSensitivity){scrollParent.scrollLeft=scrolled=scrollParent.scrollLeft-o.scrollSpeed;}}}else{if(!o.axis||o.axis!=="x"){if(event.pageY-$(document).scrollTop()<o.scrollSensitivity){scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed);}else if($(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity){scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed);}}
if(!o.axis||o.axis!=="y"){if(event.pageX-$(document).scrollLeft()<o.scrollSensitivity){scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed);}else if($(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity){scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed);}}}
if(scrolled!==false&&$.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(i,event);}}});$.ui.plugin.add("draggable","snap",{start:function(event,ui,i){var o=i.options;i.snapElements=[];$(o.snap.constructor!==String?(o.snap.items||":data(ui-draggable)"):o.snap).each(function(){var $t=$(this),$o=$t.offset();if(this!==i.element[0]){i.snapElements.push({item:this,width:$t.outerWidth(),height:$t.outerHeight(),top:$o.top,left:$o.left});}});},drag:function(event,ui,inst){var ts,bs,ls,rs,l,r,t,b,i,first,o=inst.options,d=o.snapTolerance,x1=ui.offset.left,x2=x1+inst.helperProportions.width,y1=ui.offset.top,y2=y1+inst.helperProportions.height;for(i=inst.snapElements.length-1;i>=0;i--){l=inst.snapElements[i].left-inst.margins.left;r=l+inst.snapElements[i].width;t=inst.snapElements[i].top-inst.margins.top;b=t+inst.snapElements[i].height;if(x2<l-d||x1>r+d||y2<t-d||y1>b+d||!$.contains(inst.snapElements[i].item.ownerDocument,inst.snapElements[i].item)){if(inst.snapElements[i].snapping){(inst.options.snap.release&&inst.options.snap.release.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})));}
inst.snapElements[i].snapping=false;continue;}
if(o.snapMode!=="inner"){ts=Math.abs(t-y2)<=d;bs=Math.abs(b-y1)<=d;ls=Math.abs(l-x2)<=d;rs=Math.abs(r-x1)<=d;if(ts){ui.position.top=inst._convertPositionTo("relative",{top:t-inst.helperProportions.height,left:0}).top;}
if(bs){ui.position.top=inst._convertPositionTo("relative",{top:b,left:0}).top;}
if(ls){ui.position.left=inst._convertPositionTo("relative",{top:0,left:l-inst.helperProportions.width}).left;}
if(rs){ui.position.left=inst._convertPositionTo("relative",{top:0,left:r}).left;}}
first=(ts||bs||ls||rs);if(o.snapMode!=="outer"){ts=Math.abs(t-y1)<=d;bs=Math.abs(b-y2)<=d;ls=Math.abs(l-x1)<=d;rs=Math.abs(r-x2)<=d;if(ts){ui.position.top=inst._convertPositionTo("relative",{top:t,left:0}).top;}
if(bs){ui.position.top=inst._convertPositionTo("relative",{top:b-inst.helperProportions.height,left:0}).top;}
if(ls){ui.position.left=inst._convertPositionTo("relative",{top:0,left:l}).left;}
if(rs){ui.position.left=inst._convertPositionTo("relative",{top:0,left:r-inst.helperProportions.width}).left;}}
if(!inst.snapElements[i].snapping&&(ts||bs||ls||rs||first)){(inst.options.snap.snap&&inst.options.snap.snap.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})));}
inst.snapElements[i].snapping=(ts||bs||ls||rs||first);}}});$.ui.plugin.add("draggable","stack",{start:function(event,ui,instance){var min,o=instance.options,group=$.makeArray($(o.stack)).sort(function(a,b){return(parseInt($(a).css("zIndex"),10)||0)-
(parseInt($(b).css("zIndex"),10)||0);});if(!group.length){return;}
min=parseInt($(group[0]).css("zIndex"),10)||0;$(group).each(function(i){$(this).css("zIndex",min+i);});this.css("zIndex",(min+group.length));}});$.ui.plugin.add("draggable","zIndex",{start:function(event,ui,instance){var t=$(ui.helper),o=instance.options;if(t.css("zIndex")){o._zIndex=t.css("zIndex");}
t.css("zIndex",o.zIndex);},stop:function(event,ui,instance){var o=instance.options;if(o._zIndex){$(ui.helper).css("zIndex",o._zIndex);}}});var widgetsDraggable=$.ui.draggable;$.widget("ui.droppable",{version:"1.12.0",widgetEventPrefix:"drop",options:{accept:"*",addClasses:true,greedy:false,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var proportions,o=this.options,accept=o.accept;this.isover=false;this.isout=true;this.accept=$.isFunction(accept)?accept:function(d){return d.is(accept);};this.proportions=function(){if(arguments.length){proportions=arguments[0];}else{return proportions?proportions:proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};}};this._addToManager(o.scope);o.addClasses&&this._addClass("ui-droppable");},_addToManager:function(scope){$.ui.ddmanager.droppables[scope]=$.ui.ddmanager.droppables[scope]||[];$.ui.ddmanager.droppables[scope].push(this);},_splice:function(drop){var i=0;for(;i<drop.length;i++){if(drop[i]===this){drop.splice(i,1);}}},_destroy:function(){var drop=$.ui.ddmanager.droppables[this.options.scope];this._splice(drop);},_setOption:function(key,value){if(key==="accept"){this.accept=$.isFunction(value)?value:function(d){return d.is(value);};}else if(key==="scope"){var drop=$.ui.ddmanager.droppables[this.options.scope];this._splice(drop);this._addToManager(value);}
this._super(key,value);},_activate:function(event){var draggable=$.ui.ddmanager.current;this._addActiveClass();if(draggable){this._trigger("activate",event,this.ui(draggable));}},_deactivate:function(event){var draggable=$.ui.ddmanager.current;this._removeActiveClass();if(draggable){this._trigger("deactivate",event,this.ui(draggable));}},_over:function(event){var draggable=$.ui.ddmanager.current;if(!draggable||(draggable.currentItem||draggable.element)[0]===this.element[0]){return;}
if(this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){this._addHoverClass();this._trigger("over",event,this.ui(draggable));}},_out:function(event){var draggable=$.ui.ddmanager.current;if(!draggable||(draggable.currentItem||draggable.element)[0]===this.element[0]){return;}
if(this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){this._removeHoverClass();this._trigger("out",event,this.ui(draggable));}},_drop:function(event,custom){var draggable=custom||$.ui.ddmanager.current,childrenIntersection=false;if(!draggable||(draggable.currentItem||draggable.element)[0]===this.element[0]){return false;}
this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var inst=$(this).droppable("instance");if(inst.options.greedy&&!inst.options.disabled&&inst.options.scope===draggable.options.scope&&inst.accept.call(inst.element[0],(draggable.currentItem||draggable.element))&&intersect(draggable,$.extend(inst,{offset:inst.element.offset()}),inst.options.tolerance,event)){childrenIntersection=true;return false;}});if(childrenIntersection){return false;}
if(this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){this._removeActiveClass();this._removeHoverClass();this._trigger("drop",event,this.ui(draggable));return this.element;}
return false;},ui:function(c){return{draggable:(c.currentItem||c.element),helper:c.helper,position:c.position,offset:c.positionAbs};},_addHoverClass:function(){this._addClass("ui-droppable-hover");},_removeHoverClass:function(){this._removeClass("ui-droppable-hover");},_addActiveClass:function(){this._addClass("ui-droppable-active");},_removeActiveClass:function(){this._removeClass("ui-droppable-active");}});var intersect=$.ui.intersect=(function(){function isOverAxis(x,reference,size){return(x>=reference)&&(x<(reference+size));}
return function(draggable,droppable,toleranceMode,event){if(!droppable.offset){return false;}
var x1=(draggable.positionAbs||draggable.position.absolute).left+draggable.margins.left,y1=(draggable.positionAbs||draggable.position.absolute).top+draggable.margins.top,x2=x1+draggable.helperProportions.width,y2=y1+draggable.helperProportions.height,l=droppable.offset.left,t=droppable.offset.top,r=l+droppable.proportions().width,b=t+droppable.proportions().height;switch(toleranceMode){case"fit":return(l<=x1&&x2<=r&&t<=y1&&y2<=b);case"intersect":return(l<x1+(draggable.helperProportions.width/2)&&x2-(draggable.helperProportions.width/2)<r&&t<y1+(draggable.helperProportions.height/2)&&y2-(draggable.helperProportions.height/2)<b);case"pointer":return isOverAxis(event.pageY,t,droppable.proportions().height)&&isOverAxis(event.pageX,l,droppable.proportions().width);case"touch":return((y1>=t&&y1<=b)||(y2>=t&&y2<=b)||(y1<t&&y2>b))&&((x1>=l&&x1<=r)||(x2>=l&&x2<=r)||(x1<l&&x2>r));default:return false;}};})();$.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,event){var i,j,m=$.ui.ddmanager.droppables[t.options.scope]||[],type=event?event.type:null,list=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();droppablesLoop:for(i=0;i<m.length;i++){if(m[i].options.disabled||(t&&!m[i].accept.call(m[i].element[0],(t.currentItem||t.element)))){continue;}
for(j=0;j<list.length;j++){if(list[j]===m[i].element[0]){m[i].proportions().height=0;continue droppablesLoop;}}
m[i].visible=m[i].element.css("display")!=="none";if(!m[i].visible){continue;}
if(type==="mousedown"){m[i]._activate.call(m[i],event);}
m[i].offset=m[i].element.offset();m[i].proportions({width:m[i].element[0].offsetWidth,height:m[i].element[0].offsetHeight});}},drop:function(draggable,event){var dropped=false;$.each(($.ui.ddmanager.droppables[draggable.options.scope]||[]).slice(),function(){if(!this.options){return;}
if(!this.options.disabled&&this.visible&&intersect(draggable,this,this.options.tolerance,event)){dropped=this._drop.call(this,event)||dropped;}
if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){this.isout=true;this.isover=false;this._deactivate.call(this,event);}});return dropped;},dragStart:function(draggable,event){draggable.element.parentsUntil("body").on("scroll.droppable",function(){if(!draggable.options.refreshPositions){$.ui.ddmanager.prepareOffsets(draggable,event);}});},drag:function(draggable,event){if(draggable.options.refreshPositions){$.ui.ddmanager.prepareOffsets(draggable,event);}
$.each($.ui.ddmanager.droppables[draggable.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible){return;}
var parentInstance,scope,parent,intersects=intersect(draggable,this,this.options.tolerance,event),c=!intersects&&this.isover?"isout":(intersects&&!this.isover?"isover":null);if(!c){return;}
if(this.options.greedy){scope=this.options.scope;parent=this.element.parents(":data(ui-droppable)").filter(function(){return $(this).droppable("instance").options.scope===scope;});if(parent.length){parentInstance=$(parent[0]).droppable("instance");parentInstance.greedyChild=(c==="isover");}}
if(parentInstance&&c==="isover"){parentInstance.isover=false;parentInstance.isout=true;parentInstance._out.call(parentInstance,event);}
this[c]=true;this[c==="isout"?"isover":"isout"]=false;this[c==="isover"?"_over":"_out"].call(this,event);if(parentInstance&&c==="isout"){parentInstance.isout=false;parentInstance.isover=true;parentInstance._over.call(parentInstance,event);}});},dragStop:function(draggable,event){draggable.element.parentsUntil("body").off("scroll.droppable");if(!draggable.options.refreshPositions){$.ui.ddmanager.prepareOffsets(draggable,event);}}};if($.uiBackCompat!==false){$.widget("ui.droppable",$.ui.droppable,{options:{hoverClass:false,activeClass:false},_addActiveClass:function(){this._super();if(this.options.activeClass){this.element.addClass(this.options.activeClass);}},_removeActiveClass:function(){this._super();if(this.options.activeClass){this.element.removeClass(this.options.activeClass);}},_addHoverClass:function(){this._super();if(this.options.hoverClass){this.element.addClass(this.options.hoverClass);}},_removeHoverClass:function(){this._super();if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass);}}});}
var widgetsDroppable=$.ui.droppable;var widgetsSortable=$.widget("ui.sortable",$.ui.mouse,{version:"1.12.0",widgetEventPrefix:"sort",ready:false,options:{appendTo:"parent",axis:false,connectWith:false,containment:false,cursor:"auto",cursorAt:false,dropOnEmpty:true,forcePlaceholderSize:false,forceHelperSize:false,grid:false,handle:false,helper:"original",items:"> *",opacity:false,placeholder:false,revert:false,scroll:true,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1000,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(x,reference,size){return(x>=reference)&&(x<(reference+size));},_isFloating:function(item){return(/left|right/).test(item.css("float"))||(/inline|table-cell/).test(item.css("display"));},_create:function(){this.containerCache={};this._addClass("ui-sortable");this.refresh();this.offset=this.element.offset();this._mouseInit();this._setHandleClassName();this.ready=true;},_setOption:function(key,value){this._super(key,value);if(key==="handle"){this._setHandleClassName();}},_setHandleClassName:function(){var that=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle");$.each(this.items,function(){that._addClass(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle");});},_destroy:function(){this._mouseDestroy();for(var i=this.items.length-1;i>=0;i--){this.items[i].item.removeData(this.widgetName+"-item");}
return this;},_mouseCapture:function(event,overrideHandle){var currentItem=null,validHandle=false,that=this;if(this.reverting){return false;}
if(this.options.disabled||this.options.type==="static"){return false;}
this._refreshItems(event);$(event.target).parents().each(function(){if($.data(this,that.widgetName+"-item")===that){currentItem=$(this);return false;}});if($.data(event.target,that.widgetName+"-item")===that){currentItem=$(event.target);}
if(!currentItem){return false;}
if(this.options.handle&&!overrideHandle){$(this.options.handle,currentItem).find("*").addBack().each(function(){if(this===event.target){validHandle=true;}});if(!validHandle){return false;}}
this.currentItem=currentItem;this._removeCurrentsFromItems();return true;},_mouseStart:function(event,overrideHandle,noActivation){var i,body,o=this.options;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(event);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};$.extend(this.offset,{click:{left:event.pageX-this.offset.left,top:event.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");this.originalPosition=this._generatePosition(event);this.originalPageX=event.pageX;this.originalPageY=event.pageY;(o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt));this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};if(this.helper[0]!==this.currentItem[0]){this.currentItem.hide();}
this._createPlaceholder();if(o.containment){this._setContainment();}
if(o.cursor&&o.cursor!=="auto"){body=this.document.find("body");this.storedCursor=body.css("cursor");body.css("cursor",o.cursor);this.storedStylesheet=$("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(body);}
if(o.opacity){if(this.helper.css("opacity")){this._storedOpacity=this.helper.css("opacity");}
this.helper.css("opacity",o.opacity);}
if(o.zIndex){if(this.helper.css("zIndex")){this._storedZIndex=this.helper.css("zIndex");}
this.helper.css("zIndex",o.zIndex);}
if(this.scrollParent[0]!==this.document[0]&&this.scrollParent[0].tagName!=="HTML"){this.overflowOffset=this.scrollParent.offset();}
this._trigger("start",event,this._uiHash());if(!this._preserveHelperProportions){this._cacheHelperProportions();}
if(!noActivation){for(i=this.containers.length-1;i>=0;i--){this.containers[i]._trigger("activate",event,this._uiHash(this));}}
if($.ui.ddmanager){$.ui.ddmanager.current=this;}
if($.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(this,event);}
this.dragging=true;this._addClass(this.helper,"ui-sortable-helper");this._mouseDrag(event);return true;},_mouseDrag:function(event){var i,item,itemElement,intersection,o=this.options,scrolled=false;this.position=this._generatePosition(event);this.positionAbs=this._convertPositionTo("absolute");if(!this.lastPositionAbs){this.lastPositionAbs=this.positionAbs;}
if(this.options.scroll){if(this.scrollParent[0]!==this.document[0]&&this.scrollParent[0].tagName!=="HTML"){if((this.overflowOffset.top+this.scrollParent[0].offsetHeight)-
event.pageY<o.scrollSensitivity){this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop+o.scrollSpeed;}else if(event.pageY-this.overflowOffset.top<o.scrollSensitivity){this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop-o.scrollSpeed;}
if((this.overflowOffset.left+this.scrollParent[0].offsetWidth)-
event.pageX<o.scrollSensitivity){this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft+o.scrollSpeed;}else if(event.pageX-this.overflowOffset.left<o.scrollSensitivity){this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft-o.scrollSpeed;}}else{if(event.pageY-this.document.scrollTop()<o.scrollSensitivity){scrolled=this.document.scrollTop(this.document.scrollTop()-o.scrollSpeed);}else if(this.window.height()-(event.pageY-this.document.scrollTop())<o.scrollSensitivity){scrolled=this.document.scrollTop(this.document.scrollTop()+o.scrollSpeed);}
if(event.pageX-this.document.scrollLeft()<o.scrollSensitivity){scrolled=this.document.scrollLeft(this.document.scrollLeft()-o.scrollSpeed);}else if(this.window.width()-(event.pageX-this.document.scrollLeft())<o.scrollSensitivity){scrolled=this.document.scrollLeft(this.document.scrollLeft()+o.scrollSpeed);}}
if(scrolled!==false&&$.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(this,event);}}
this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!=="y"){this.helper[0].style.left=this.position.left+"px";}
if(!this.options.axis||this.options.axis!=="x"){this.helper[0].style.top=this.position.top+"px";}
for(i=this.items.length-1;i>=0;i--){item=this.items[i];itemElement=item.item[0];intersection=this._intersectsWithPointer(item);if(!intersection){continue;}
if(item.instance!==this.currentContainer){continue;}
if(itemElement!==this.currentItem[0]&&this.placeholder[intersection===1?"next":"prev"]()[0]!==itemElement&&!$.contains(this.placeholder[0],itemElement)&&(this.options.type==="semi-dynamic"?!$.contains(this.element[0],itemElement):true)){this.direction=intersection===1?"down":"up";if(this.options.tolerance==="pointer"||this._intersectsWithSides(item)){this._rearrange(event,item);}else{break;}
this._trigger("change",event,this._uiHash());break;}}
this._contactContainers(event);if($.ui.ddmanager){$.ui.ddmanager.drag(this,event);}
this._trigger("sort",event,this._uiHash());this.lastPositionAbs=this.positionAbs;return false;},_mouseStop:function(event,noPropagation){if(!event){return;}
if($.ui.ddmanager&&!this.options.dropBehaviour){$.ui.ddmanager.drop(this,event);}
if(this.options.revert){var that=this,cur=this.placeholder.offset(),axis=this.options.axis,animation={};if(!axis||axis==="x"){animation.left=cur.left-this.offset.parent.left-this.margins.left+
(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft);}
if(!axis||axis==="y"){animation.top=cur.top-this.offset.parent.top-this.margins.top+
(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop);}
this.reverting=true;$(this.helper).animate(animation,parseInt(this.options.revert,10)||500,function(){that._clear(event);});}else{this._clear(event,noPropagation);}
return false;},cancel:function(){if(this.dragging){this._mouseUp({target:null});if(this.options.helper==="original"){this.currentItem.css(this._storedCSS);this._removeClass(this.currentItem,"ui-sortable-helper");}else{this.currentItem.show();}
for(var i=this.containers.length-1;i>=0;i--){this.containers[i]._trigger("deactivate",null,this._uiHash(this));if(this.containers[i].containerCache.over){this.containers[i]._trigger("out",null,this._uiHash(this));this.containers[i].containerCache.over=0;}}}
if(this.placeholder){if(this.placeholder[0].parentNode){this.placeholder[0].parentNode.removeChild(this.placeholder[0]);}
if(this.options.helper!=="original"&&this.helper&&this.helper[0].parentNode){this.helper.remove();}
$.extend(this,{helper:null,dragging:false,reverting:false,_noFinalSort:null});if(this.domPosition.prev){$(this.domPosition.prev).after(this.currentItem);}else{$(this.domPosition.parent).prepend(this.currentItem);}}
return this;},serialize:function(o){var items=this._getItemsAsjQuery(o&&o.connected),str=[];o=o||{};$(items).each(function(){var res=($(o.item||this).attr(o.attribute||"id")||"").match(o.expression||(/(.+)[\-=_](.+)/));if(res){str.push((o.key||res[1]+"[]")+"="+(o.key&&o.expression?res[1]:res[2]));}});if(!str.length&&o.key){str.push(o.key+"=");}
return str.join("&");},toArray:function(o){var items=this._getItemsAsjQuery(o&&o.connected),ret=[];o=o||{};items.each(function(){ret.push($(o.item||this).attr(o.attribute||"id")||"");});return ret;},_intersectsWith:function(item){var x1=this.positionAbs.left,x2=x1+this.helperProportions.width,y1=this.positionAbs.top,y2=y1+this.helperProportions.height,l=item.left,r=l+item.width,t=item.top,b=t+item.height,dyClick=this.offset.click.top,dxClick=this.offset.click.left,isOverElementHeight=(this.options.axis==="x")||((y1+dyClick)>t&&(y1+dyClick)<b),isOverElementWidth=(this.options.axis==="y")||((x1+dxClick)>l&&(x1+dxClick)<r),isOverElement=isOverElementHeight&&isOverElementWidth;if(this.options.tolerance==="pointer"||this.options.forcePointerForContainers||(this.options.tolerance!=="pointer"&&this.helperProportions[this.floating?"width":"height"]>item[this.floating?"width":"height"])){return isOverElement;}else{return(l<x1+(this.helperProportions.width/2)&&x2-(this.helperProportions.width/2)<r&&t<y1+(this.helperProportions.height/2)&&y2-(this.helperProportions.height/2)<b);}},_intersectsWithPointer:function(item){var verticalDirection,horizontalDirection,isOverElementHeight=(this.options.axis==="x")||this._isOverAxis(this.positionAbs.top+this.offset.click.top,item.top,item.height),isOverElementWidth=(this.options.axis==="y")||this._isOverAxis(this.positionAbs.left+this.offset.click.left,item.left,item.width),isOverElement=isOverElementHeight&&isOverElementWidth;if(!isOverElement){return false;}
verticalDirection=this._getDragVerticalDirection();horizontalDirection=this._getDragHorizontalDirection();return this.floating?((horizontalDirection==="right"||verticalDirection==="down")?2:1):(verticalDirection&&(verticalDirection==="down"?2:1));},_intersectsWithSides:function(item){var isOverBottomHalf=this._isOverAxis(this.positionAbs.top+
this.offset.click.top,item.top+(item.height/2),item.height),isOverRightHalf=this._isOverAxis(this.positionAbs.left+
this.offset.click.left,item.left+(item.width/2),item.width),verticalDirection=this._getDragVerticalDirection(),horizontalDirection=this._getDragHorizontalDirection();if(this.floating&&horizontalDirection){return((horizontalDirection==="right"&&isOverRightHalf)||(horizontalDirection==="left"&&!isOverRightHalf));}else{return verticalDirection&&((verticalDirection==="down"&&isOverBottomHalf)||(verticalDirection==="up"&&!isOverBottomHalf));}},_getDragVerticalDirection:function(){var delta=this.positionAbs.top-this.lastPositionAbs.top;return delta!==0&&(delta>0?"down":"up");},_getDragHorizontalDirection:function(){var delta=this.positionAbs.left-this.lastPositionAbs.left;return delta!==0&&(delta>0?"right":"left");},refresh:function(event){this._refreshItems(event);this._setHandleClassName();this.refreshPositions();return this;},_connectWith:function(){var options=this.options;return options.connectWith.constructor===String?[options.connectWith]:options.connectWith;},_getItemsAsjQuery:function(connected){var i,j,cur,inst,items=[],queries=[],connectWith=this._connectWith();if(connectWith&&connected){for(i=connectWith.length-1;i>=0;i--){cur=$(connectWith[i],this.document[0]);for(j=cur.length-1;j>=0;j--){inst=$.data(cur[j],this.widgetFullName);if(inst&&inst!==this&&!inst.options.disabled){queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element):$(inst.options.items,inst.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),inst]);}}}}
queries.push([$.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):$(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);function addItems(){items.push(this);}
for(i=queries.length-1;i>=0;i--){queries[i][0].each(addItems);}
return $(items);},_removeCurrentsFromItems:function(){var list=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=$.grep(this.items,function(item){for(var j=0;j<list.length;j++){if(list[j]===item.item[0]){return false;}}
return true;});},_refreshItems:function(event){this.items=[];this.containers=[this];var i,j,cur,inst,targetData,_queries,item,queriesLength,items=this.items,queries=[[$.isFunction(this.options.items)?this.options.items.call(this.element[0],event,{item:this.currentItem}):$(this.options.items,this.element),this]],connectWith=this._connectWith();if(connectWith&&this.ready){for(i=connectWith.length-1;i>=0;i--){cur=$(connectWith[i],this.document[0]);for(j=cur.length-1;j>=0;j--){inst=$.data(cur[j],this.widgetFullName);if(inst&&inst!==this&&!inst.options.disabled){queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element[0],event,{item:this.currentItem}):$(inst.options.items,inst.element),inst]);this.containers.push(inst);}}}}
for(i=queries.length-1;i>=0;i--){targetData=queries[i][1];_queries=queries[i][0];for(j=0,queriesLength=_queries.length;j<queriesLength;j++){item=$(_queries[j]);item.data(this.widgetName+"-item",targetData);items.push({item:item,instance:targetData,width:0,height:0,left:0,top:0});}}},refreshPositions:function(fast){this.floating=this.items.length?this.options.axis==="x"||this._isFloating(this.items[0].item):false;if(this.offsetParent&&this.helper){this.offset.parent=this._getParentOffset();}
var i,item,t,p;for(i=this.items.length-1;i>=0;i--){item=this.items[i];if(item.instance!==this.currentContainer&&this.currentContainer&&item.item[0]!==this.currentItem[0]){continue;}
t=this.options.toleranceElement?$(this.options.toleranceElement,item.item):item.item;if(!fast){item.width=t.outerWidth();item.height=t.outerHeight();}
p=t.offset();item.left=p.left;item.top=p.top;}
if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this);}else{for(i=this.containers.length-1;i>=0;i--){p=this.containers[i].element.offset();this.containers[i].containerCache.left=p.left;this.containers[i].containerCache.top=p.top;this.containers[i].containerCache.width=this.containers[i].element.outerWidth();this.containers[i].containerCache.height=this.containers[i].element.outerHeight();}}
return this;},_createPlaceholder:function(that){that=that||this;var className,o=that.options;if(!o.placeholder||o.placeholder.constructor===String){className=o.placeholder;o.placeholder={element:function(){var nodeName=that.currentItem[0].nodeName.toLowerCase(),element=$("<"+nodeName+">",that.document[0]);that._addClass(element,"ui-sortable-placeholder",className||that.currentItem[0].className)._removeClass(element,"ui-sortable-helper");if(nodeName==="tbody"){that._createTrPlaceholder(that.currentItem.find("tr").eq(0),$("<tr>",that.document[0]).appendTo(element));}else if(nodeName==="tr"){that._createTrPlaceholder(that.currentItem,element);}else if(nodeName==="img"){element.attr("src",that.currentItem.attr("src"));}
if(!className){element.css("visibility","hidden");}
return element;},update:function(container,p){if(className&&!o.forcePlaceholderSize){return;}
if(!p.height()){p.height(that.currentItem.innerHeight()-
parseInt(that.currentItem.css("paddingTop")||0,10)-
parseInt(that.currentItem.css("paddingBottom")||0,10));}
if(!p.width()){p.width(that.currentItem.innerWidth()-
parseInt(that.currentItem.css("paddingLeft")||0,10)-
parseInt(that.currentItem.css("paddingRight")||0,10));}}};}
that.placeholder=$(o.placeholder.element.call(that.element,that.currentItem));that.currentItem.after(that.placeholder);o.placeholder.update(that,that.placeholder);},_createTrPlaceholder:function(sourceTr,targetTr){var that=this;sourceTr.children().each(function(){$("<td>&#160;</td>",that.document[0]).attr("colspan",$(this).attr("colspan")||1).appendTo(targetTr);});},_contactContainers:function(event){var i,j,dist,itemWithLeastDistance,posProperty,sizeProperty,cur,nearBottom,floating,axis,innermostContainer=null,innermostIndex=null;for(i=this.containers.length-1;i>=0;i--){if($.contains(this.currentItem[0],this.containers[i].element[0])){continue;}
if(this._intersectsWith(this.containers[i].containerCache)){if(innermostContainer&&$.contains(this.containers[i].element[0],innermostContainer.element[0])){continue;}
innermostContainer=this.containers[i];innermostIndex=i;}else{if(this.containers[i].containerCache.over){this.containers[i]._trigger("out",event,this._uiHash(this));this.containers[i].containerCache.over=0;}}}
if(!innermostContainer){return;}
if(this.containers.length===1){if(!this.containers[innermostIndex].containerCache.over){this.containers[innermostIndex]._trigger("over",event,this._uiHash(this));this.containers[innermostIndex].containerCache.over=1;}}else{dist=10000;itemWithLeastDistance=null;floating=innermostContainer.floating||this._isFloating(this.currentItem);posProperty=floating?"left":"top";sizeProperty=floating?"width":"height";axis=floating?"pageX":"pageY";for(j=this.items.length-1;j>=0;j--){if(!$.contains(this.containers[innermostIndex].element[0],this.items[j].item[0])){continue;}
if(this.items[j].item[0]===this.currentItem[0]){continue;}
cur=this.items[j].item.offset()[posProperty];nearBottom=false;if(event[axis]-cur>this.items[j][sizeProperty]/2){nearBottom=true;}
if(Math.abs(event[axis]-cur)<dist){dist=Math.abs(event[axis]-cur);itemWithLeastDistance=this.items[j];this.direction=nearBottom?"up":"down";}}
if(!itemWithLeastDistance&&!this.options.dropOnEmpty){return;}
if(this.currentContainer===this.containers[innermostIndex]){if(!this.currentContainer.containerCache.over){this.containers[innermostIndex]._trigger("over",event,this._uiHash());this.currentContainer.containerCache.over=1;}
return;}
itemWithLeastDistance?this._rearrange(event,itemWithLeastDistance,null,true):this._rearrange(event,null,this.containers[innermostIndex].element,true);this._trigger("change",event,this._uiHash());this.containers[innermostIndex]._trigger("change",event,this._uiHash(this));this.currentContainer=this.containers[innermostIndex];this.options.placeholder.update(this.currentContainer,this.placeholder);this.containers[innermostIndex]._trigger("over",event,this._uiHash(this));this.containers[innermostIndex].containerCache.over=1;}},_createHelper:function(event){var o=this.options,helper=$.isFunction(o.helper)?$(o.helper.apply(this.element[0],[event,this.currentItem])):(o.helper==="clone"?this.currentItem.clone():this.currentItem);if(!helper.parents("body").length){$(o.appendTo!=="parent"?o.appendTo:this.currentItem[0].parentNode)[0].appendChild(helper[0]);}
if(helper[0]===this.currentItem[0]){this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")};}
if(!helper[0].style.width||o.forceHelperSize){helper.width(this.currentItem.width());}
if(!helper[0].style.height||o.forceHelperSize){helper.height(this.currentItem.height());}
return helper;},_adjustOffsetFromHelper:function(obj){if(typeof obj==="string"){obj=obj.split(" ");}
if($.isArray(obj)){obj={left:+obj[0],top:+obj[1]||0};}
if("left"in obj){this.offset.click.left=obj.left+this.margins.left;}
if("right"in obj){this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left;}
if("top"in obj){this.offset.click.top=obj.top+this.margins.top;}
if("bottom"in obj){this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top;}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var po=this.offsetParent.offset();if(this.cssPosition==="absolute"&&this.scrollParent[0]!==this.document[0]&&$.contains(this.scrollParent[0],this.offsetParent[0])){po.left+=this.scrollParent.scrollLeft();po.top+=this.scrollParent.scrollTop();}
if(this.offsetParent[0]===this.document[0].body||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&$.ui.ie)){po={top:0,left:0};}
return{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)};},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var p=this.currentItem.position();return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+
this.scrollParent.scrollTop(),left:p.left-(parseInt(this.helper.css("left"),10)||0)+
this.scrollParent.scrollLeft()};}else{return{top:0,left:0};}},_cacheMargins:function(){this.margins={left:(parseInt(this.currentItem.css("marginLeft"),10)||0),top:(parseInt(this.currentItem.css("marginTop"),10)||0)};},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()};},_setContainment:function(){var ce,co,over,o=this.options;if(o.containment==="parent"){o.containment=this.helper[0].parentNode;}
if(o.containment==="document"||o.containment==="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,o.containment==="document"?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,(o.containment==="document"?(this.document.height()||document.body.parentNode.scrollHeight):this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];}
if(!(/^(document|window|parent)$/).test(o.containment)){ce=$(o.containment)[0];co=$(o.containment).offset();over=($(ce).css("overflow")!=="hidden");this.containment=[co.left+(parseInt($(ce).css("borderLeftWidth"),10)||0)+
(parseInt($(ce).css("paddingLeft"),10)||0)-this.margins.left,co.top+(parseInt($(ce).css("borderTopWidth"),10)||0)+
(parseInt($(ce).css("paddingTop"),10)||0)-this.margins.top,co.left+(over?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-
(parseInt($(ce).css("borderLeftWidth"),10)||0)-
(parseInt($(ce).css("paddingRight"),10)||0)-
this.helperProportions.width-this.margins.left,co.top+(over?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-
(parseInt($(ce).css("borderTopWidth"),10)||0)-
(parseInt($(ce).css("paddingBottom"),10)||0)-
this.helperProportions.height-this.margins.top];}},_convertPositionTo:function(d,pos){if(!pos){pos=this.position;}
var mod=d==="absolute"?1:-1,scroll=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==this.document[0]&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,scrollIsRootNode=(/(html|body)/i).test(scroll[0].tagName);return{top:(pos.top+
this.offset.relative.top*mod+
this.offset.parent.top*mod-
((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():(scrollIsRootNode?0:scroll.scrollTop()))*mod)),left:(pos.left+
this.offset.relative.left*mod+
this.offset.parent.left*mod-
((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())*mod))};},_generatePosition:function(event){var top,left,o=this.options,pageX=event.pageX,pageY=event.pageY,scroll=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==this.document[0]&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,scrollIsRootNode=(/(html|body)/i).test(scroll[0].tagName);if(this.cssPosition==="relative"&&!(this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0])){this.offset.relative=this._getRelativeOffset();}
if(this.originalPosition){if(this.containment){if(event.pageX-this.offset.click.left<this.containment[0]){pageX=this.containment[0]+this.offset.click.left;}
if(event.pageY-this.offset.click.top<this.containment[1]){pageY=this.containment[1]+this.offset.click.top;}
if(event.pageX-this.offset.click.left>this.containment[2]){pageX=this.containment[2]+this.offset.click.left;}
if(event.pageY-this.offset.click.top>this.containment[3]){pageY=this.containment[3]+this.offset.click.top;}}
if(o.grid){top=this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1];pageY=this.containment?((top-this.offset.click.top>=this.containment[1]&&top-this.offset.click.top<=this.containment[3])?top:((top-this.offset.click.top>=this.containment[1])?top-o.grid[1]:top+o.grid[1])):top;left=this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0];pageX=this.containment?((left-this.offset.click.left>=this.containment[0]&&left-this.offset.click.left<=this.containment[2])?left:((left-this.offset.click.left>=this.containment[0])?left-o.grid[0]:left+o.grid[0])):left;}}
return{top:(pageY-
this.offset.click.top-
this.offset.relative.top-
this.offset.parent.top+
((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():(scrollIsRootNode?0:scroll.scrollTop())))),left:(pageX-
this.offset.click.left-
this.offset.relative.left-
this.offset.parent.left+
((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())))};},_rearrange:function(event,i,a,hardRefresh){a?a[0].appendChild(this.placeholder[0]):i.item[0].parentNode.insertBefore(this.placeholder[0],(this.direction==="down"?i.item[0]:i.item[0].nextSibling));this.counter=this.counter?++this.counter:1;var counter=this.counter;this._delay(function(){if(counter===this.counter){this.refreshPositions(!hardRefresh);}});},_clear:function(event,noPropagation){this.reverting=false;var i,delayedTriggers=[];if(!this._noFinalSort&&this.currentItem.parent().length){this.placeholder.before(this.currentItem);}
this._noFinalSort=null;if(this.helper[0]===this.currentItem[0]){for(i in this._storedCSS){if(this._storedCSS[i]==="auto"||this._storedCSS[i]==="static"){this._storedCSS[i]="";}}
this.currentItem.css(this._storedCSS);this._removeClass(this.currentItem,"ui-sortable-helper");}else{this.currentItem.show();}
if(this.fromOutside&&!noPropagation){delayedTriggers.push(function(event){this._trigger("receive",event,this._uiHash(this.fromOutside));});}
if((this.fromOutside||this.domPosition.prev!==this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!==this.currentItem.parent()[0])&&!noPropagation){delayedTriggers.push(function(event){this._trigger("update",event,this._uiHash());});}
if(this!==this.currentContainer){if(!noPropagation){delayedTriggers.push(function(event){this._trigger("remove",event,this._uiHash());});delayedTriggers.push((function(c){return function(event){c._trigger("receive",event,this._uiHash(this));};}).call(this,this.currentContainer));delayedTriggers.push((function(c){return function(event){c._trigger("update",event,this._uiHash(this));};}).call(this,this.currentContainer));}}
function delayEvent(type,instance,container){return function(event){container._trigger(type,event,instance._uiHash(instance));};}
for(i=this.containers.length-1;i>=0;i--){if(!noPropagation){delayedTriggers.push(delayEvent("deactivate",this,this.containers[i]));}
if(this.containers[i].containerCache.over){delayedTriggers.push(delayEvent("out",this,this.containers[i]));this.containers[i].containerCache.over=0;}}
if(this.storedCursor){this.document.find("body").css("cursor",this.storedCursor);this.storedStylesheet.remove();}
if(this._storedOpacity){this.helper.css("opacity",this._storedOpacity);}
if(this._storedZIndex){this.helper.css("zIndex",this._storedZIndex==="auto"?"":this._storedZIndex);}
this.dragging=false;if(!noPropagation){this._trigger("beforeStop",event,this._uiHash());}
this.placeholder[0].parentNode.removeChild(this.placeholder[0]);if(!this.cancelHelperRemoval){if(this.helper[0]!==this.currentItem[0]){this.helper.remove();}
this.helper=null;}
if(!noPropagation){for(i=0;i<delayedTriggers.length;i++){delayedTriggers[i].call(this,event);}
this._trigger("stop",event,this._uiHash());}
this.fromOutside=false;return!this.cancelHelperRemoval;},_trigger:function(){if($.Widget.prototype._trigger.apply(this,arguments)===false){this.cancel();}},_uiHash:function(_inst){var inst=_inst||this;return{helper:inst.helper,placeholder:inst.placeholder||$([]),position:inst.position,originalPosition:inst.originalPosition,offset:inst.positionAbs,item:inst.currentItem,sender:_inst?_inst.element:null};}});}));;

/* /scrummer/static/src/js/libs/external/materialNote.js defined in bundle 'scrummer.assets' */
(function(factory){if(typeof define==='function'&&define.amd){define(['jquery'],factory);}else{factory(window.jQuery);}}(function($){if(!Array.prototype.reduce){Array.prototype.reduce=function(callback){var t=Object(this),len=t.length>>>0,k=0,value;if(arguments.length===2){value=arguments[1];}else{while(k<len&&!(k in t)){k++;}
if(k>=len){throw new TypeError('Reduce of empty array with no initial value');}
value=t[k++];}
for(;k<len;k++){if(k in t){value=callback(value,t[k],k,t);}}
return value;};}
if('function'!==typeof Array.prototype.filter){Array.prototype.filter=function(func){var t=Object(this),len=t.length>>>0;var res=[];var thisArg=arguments.length>=2?arguments[1]:void 0;for(var i=0;i<len;i++){if(i in t){var val=t[i];if(func.call(thisArg,val,i,t)){res.push(val);}}}
return res;};}
var isSupportAmd=typeof define==='function'&&define.amd;var isFontInstalled=function(fontName){if(fontName==="Roboto")return true;var testFontName=fontName==='Comic Sans MS'?'Courier New':'Comic Sans MS';var $tester=$('<div>').css({position:'absolute',left:'-9999px',top:'-9999px',fontSize:'200px'}).text('mmmmmmmmmwwwwwww').appendTo(document.body);var originalWidth=$tester.css('fontFamily',testFontName).width();var width=$tester.css('fontFamily',fontName+','+testFontName).width();$tester.remove();return originalWidth!==width;};var userAgent=navigator.userAgent;var agent={isMac:navigator.appVersion.indexOf('Mac')>-1,isMSIE:/MSIE|Trident/i.test(userAgent),isFF:/firefox/i.test(userAgent),isWebkit:/webkit/i.test(userAgent),isSafari:/safari/i.test(userAgent),jqueryVersion:parseFloat($.fn.jquery),isSupportAmd:isSupportAmd,hasCodeMirror:isSupportAmd?require.specified('CodeMirror'):!!window.CodeMirror,isFontInstalled:isFontInstalled,isW3CRangeSupport:!!document.createRange};var func=(function(){var eq=function(itemA){return function(itemB){return itemA===itemB;};};var eq2=function(itemA,itemB){return itemA===itemB;};var peq2=function(propName){return function(itemA,itemB){return itemA[propName]===itemB[propName];};};var ok=function(){return true;};var fail=function(){return false;};var not=function(f){return function(){return!f.apply(f,arguments);};};var and=function(fA,fB){return function(item){return fA(item)&&fB(item);};};var self=function(a){return a;};var idCounter=0;var uniqueId=function(prefix){var id=++idCounter+'';return prefix?prefix+id:id;};var rect2bnd=function(rect){var $document=$(document);return{top:rect.top+$document.scrollTop(),left:rect.left+$document.scrollLeft(),width:rect.right-rect.left,height:rect.bottom-rect.top};};var invertObject=function(obj){var inverted={};for(var key in obj){if(obj.hasOwnProperty(key)){inverted[obj[key]]=key;}}
return inverted;};var namespaceToCamel=function(namespace,prefix){prefix=prefix||'';return prefix+namespace.split('.').map(function(name){return name.substring(0,1).toUpperCase()+name.substring(1);}).join('');};return{eq:eq,eq2:eq2,peq2:peq2,ok:ok,fail:fail,self:self,not:not,and:and,uniqueId:uniqueId,rect2bnd:rect2bnd,invertObject:invertObject,namespaceToCamel:namespaceToCamel};})();var list=(function(){var head=function(array){return array[0];};var last=function(array){return array[array.length-1];};var initial=function(array){return array.slice(0,array.length-1);};var tail=function(array){return array.slice(1);};var find=function(array,pred){for(var idx=0,len=array.length;idx<len;idx++){var item=array[idx];if(pred(item)){return item;}}};var all=function(array,pred){for(var idx=0,len=array.length;idx<len;idx++){if(!pred(array[idx])){return false;}}
return true;};var contains=function(array,item){return $.inArray(item,array)!==-1;};var sum=function(array,fn){fn=fn||func.self;return array.reduce(function(memo,v){return memo+fn(v);},0);};var from=function(collection){var result=[],idx=-1,length=collection.length;while(++idx<length){result[idx]=collection[idx];}
return result;};var clusterBy=function(array,fn){if(!array.length){return[];}
var aTail=tail(array);return aTail.reduce(function(memo,v){var aLast=last(memo);if(fn(last(aLast),v)){aLast[aLast.length]=v;}else{memo[memo.length]=[v];}
return memo;},[[head(array)]]);};var compact=function(array){var aResult=[];for(var idx=0,len=array.length;idx<len;idx++){if(array[idx]){aResult.push(array[idx]);}}
return aResult;};var unique=function(array){var results=[];for(var idx=0,len=array.length;idx<len;idx++){if(!contains(results,array[idx])){results.push(array[idx]);}}
return results;};var next=function(array,item){var idx=array.indexOf(item);if(idx===-1){return null;}
return array[idx+1];};var prev=function(array,item){var idx=array.indexOf(item);if(idx===-1){return null;}
return array[idx-1];};return{head:head,last:last,initial:initial,tail:tail,prev:prev,next:next,find:find,contains:contains,all:all,sum:sum,from:from,clusterBy:clusterBy,compact:compact,unique:unique};})();var NBSP_CHAR=String.fromCharCode(160);var ZERO_WIDTH_NBSP_CHAR='\ufeff';var dom=(function(){var isEditable=function(node){return node&&$(node).hasClass('note-editable');};var isControlSizing=function(node){return node&&$(node).hasClass('note-control-sizing');};var buildLayoutInfo=function($editor){var makeFinder;if($editor.hasClass('note-air-editor')){var id=list.last($editor.attr('id').split('-'));makeFinder=function(sIdPrefix){return function(){return $(sIdPrefix+id);};};return{editor:function(){return $editor;},holder:function(){return $editor.data('holder');},editable:function(){return $editor;},popover:makeFinder('#note-popover-'),handle:makeFinder('#note-handle-'),dialog:makeFinder('#note-dialog-')};}else{makeFinder=function(sClassName){return function(){return $editor.find(sClassName);};};return{editor:function(){return $editor;},holder:function(){return $editor.data('holder');},dropzone:makeFinder('.note-dropzone'),toolbar:makeFinder('.note-toolbar'),editable:makeFinder('.note-editable'),codable:makeFinder('.note-codable'),statusbar:makeFinder('.note-statusbar'),popover:makeFinder('.note-popover'),handle:makeFinder('.note-handle'),dialog:makeFinder('.note-dialog')};}};var makeLayoutInfo=function(descendant){var $target=$(descendant).closest('.note-editor, .note-air-editor, .note-air-layout');if(!$target.length){return null;}
var $editor;if($target.is('.note-editor, .note-air-editor')){$editor=$target;}else{$editor=$('#note-editor-'+list.last($target.attr('id').split('-')));}
return buildLayoutInfo($editor);};var makePredByNodeName=function(nodeName){nodeName=nodeName.toUpperCase();return function(node){return node&&node.nodeName.toUpperCase()===nodeName;};};var isText=function(node){return node&&node.nodeType===3;};var isVoid=function(node){return node&&/^BR|^IMG|^HR/.test(node.nodeName.toUpperCase());};var isPara=function(node){if(isEditable(node)){return false;}
return node&&/^DIV|^P|^LI|^H[1-7]/.test(node.nodeName.toUpperCase());};var isLi=makePredByNodeName('LI');var isPurePara=function(node){return isPara(node)&&!isLi(node);};var isTable=makePredByNodeName('TABLE');var isInline=function(node){return!isBodyContainer(node)&&!isList(node)&&!isPara(node)&&!isTable(node)&&!isBlockquote(node);};var isList=function(node){return node&&/^UL|^OL/.test(node.nodeName.toUpperCase());};var isCell=function(node){return node&&/^TD|^TH/.test(node.nodeName.toUpperCase());};var isBlockquote=makePredByNodeName('BLOCKQUOTE');var isBodyContainer=function(node){return isCell(node)||isBlockquote(node)||isEditable(node);};var isAnchor=makePredByNodeName('A');var isParaInline=function(node){return isInline(node)&&!!ancestor(node,isPara);};var isBodyInline=function(node){return isInline(node)&&!ancestor(node,isPara);};var isBody=makePredByNodeName('BODY');var isClosestSibling=function(nodeA,nodeB){return nodeA.nextSibling===nodeB||nodeA.previousSibling===nodeB;};var withClosestSiblings=function(node,pred){pred=pred||func.ok;var siblings=[];if(node.previousSibling&&pred(node.previousSibling)){siblings.push(node.previousSibling);}
siblings.push(node);if(node.nextSibling&&pred(node.nextSibling)){siblings.push(node.nextSibling);}
return siblings;};var blankHTML=agent.isMSIE?'&nbsp;':'<br>';var nodeLength=function(node){if(isText(node)){return node.nodeValue.length;}
return node.childNodes.length;};var isEmpty=function(node){var len=nodeLength(node);if(len===0){return true;}else if(!isText(node)&&len===1&&node.innerHTML===blankHTML){return true;}else if(list.all(node.childNodes,isText)&&node.innerHTML===''){return true;}
return false;};var paddingBlankHTML=function(node){if(!isVoid(node)&&!nodeLength(node)){node.innerHTML=blankHTML;}};var ancestor=function(node,pred){while(node){if(pred(node)){return node;}
if(isEditable(node)){break;}
node=node.parentNode;}
return null;};var singleChildAncestor=function(node,pred){node=node.parentNode;while(node){if(nodeLength(node)!==1){break;}
if(pred(node)){return node;}
if(isEditable(node)){break;}
node=node.parentNode;}
return null;};var listAncestor=function(node,pred){pred=pred||func.fail;var ancestors=[];ancestor(node,function(el){if(!isEditable(el)){ancestors.push(el);}
return pred(el);});return ancestors;};var lastAncestor=function(node,pred){var ancestors=listAncestor(node);return list.last(ancestors.filter(pred));};var commonAncestor=function(nodeA,nodeB){var ancestors=listAncestor(nodeA);for(var n=nodeB;n;n=n.parentNode){if($.inArray(n,ancestors)>-1){return n;}}
return null;};var listPrev=function(node,pred){pred=pred||func.fail;var nodes=[];while(node){if(pred(node)){break;}
nodes.push(node);node=node.previousSibling;}
return nodes;};var listNext=function(node,pred){pred=pred||func.fail;var nodes=[];while(node){if(pred(node)){break;}
nodes.push(node);node=node.nextSibling;}
return nodes;};var listDescendant=function(node,pred){var descendents=[];pred=pred||func.ok;(function fnWalk(current){if(node!==current&&pred(current)){descendents.push(current);}
for(var idx=0,len=current.childNodes.length;idx<len;idx++){fnWalk(current.childNodes[idx]);}})(node);return descendents;};var wrap=function(node,wrapperName){var parent=node.parentNode;var wrapper=$('<'+wrapperName+'>')[0];parent.insertBefore(wrapper,node);wrapper.appendChild(node);return wrapper;};var insertAfter=function(node,preceding){var next=preceding.nextSibling,parent=preceding.parentNode;if(next){parent.insertBefore(node,next);}else{parent.appendChild(node);}
return node;};var appendChildNodes=function(node,aChild){$.each(aChild,function(idx,child){node.appendChild(child);});return node;};var isLeftEdgePoint=function(point){return point.offset===0;};var isRightEdgePoint=function(point){return point.offset===nodeLength(point.node);};var isEdgePoint=function(point){return isLeftEdgePoint(point)||isRightEdgePoint(point);};var isLeftEdgeOf=function(node,ancestor){while(node&&node!==ancestor){if(position(node)!==0){return false;}
node=node.parentNode;}
return true;};var isRightEdgeOf=function(node,ancestor){while(node&&node!==ancestor){if(position(node)!==nodeLength(node.parentNode)-1){return false;}
node=node.parentNode;}
return true;};var position=function(node){var offset=0;while((node=node.previousSibling)){offset+=1;}
return offset;};var hasChildren=function(node){return!!(node&&node.childNodes&&node.childNodes.length);};var prevPoint=function(point,isSkipInnerOffset){var node,offset;if(point.offset===0){if(isEditable(point.node)){return null;}
node=point.node.parentNode;offset=position(point.node);}else if(hasChildren(point.node)){node=point.node.childNodes[point.offset-1];offset=nodeLength(node);}else{node=point.node;offset=isSkipInnerOffset?0:point.offset-1;}
return{node:node,offset:offset};};var nextPoint=function(point,isSkipInnerOffset){var node,offset;if(nodeLength(point.node)===point.offset){if(isEditable(point.node)){return null;}
node=point.node.parentNode;offset=position(point.node)+1;}else if(hasChildren(point.node)){node=point.node.childNodes[point.offset];offset=0;}else{node=point.node;offset=isSkipInnerOffset?nodeLength(point.node):point.offset+1;}
return{node:node,offset:offset};};var isSamePoint=function(pointA,pointB){return pointA.node===pointB.node&&pointA.offset===pointB.offset;};var isVisiblePoint=function(point){if(isText(point.node)||!hasChildren(point.node)||isEmpty(point.node)){return true;}
var leftNode=point.node.childNodes[point.offset-1];var rightNode=point.node.childNodes[point.offset];if((!leftNode||isVoid(leftNode))&&(!rightNode||isVoid(rightNode))){return true;}
return false;};var prevPointUntil=function(point,pred){while(point){if(pred(point)){return point;}
point=prevPoint(point);}
return null;};var nextPointUntil=function(point,pred){while(point){if(pred(point)){return point;}
point=nextPoint(point);}
return null;};var isCharPoint=function(point){if(!isText(point.node)){return false;}
var ch=point.node.nodeValue.charAt(point.offset-1);return ch&&(ch!==' '&&ch!==NBSP_CHAR);};var walkPoint=function(startPoint,endPoint,handler,isSkipInnerOffset){var point=startPoint;while(point){handler(point);if(isSamePoint(point,endPoint)){break;}
var isSkipOffset=isSkipInnerOffset&&startPoint.node!==point.node&&endPoint.node!==point.node;point=nextPoint(point,isSkipOffset);}};var makeOffsetPath=function(ancestor,node){var ancestors=listAncestor(node,func.eq(ancestor));return $.map(ancestors,position).reverse();};var fromOffsetPath=function(ancestor,offsets){var current=ancestor;for(var i=0,len=offsets.length;i<len;i++){if(current.childNodes.length<=offsets[i]){current=current.childNodes[current.childNodes.length-1];}else{current=current.childNodes[offsets[i]];}}
return current;};var splitNode=function(point,options){var isSkipPaddingBlankHTML=options&&options.isSkipPaddingBlankHTML;var isNotSplitEdgePoint=options&&options.isNotSplitEdgePoint;if(isEdgePoint(point)&&(isText(point.node)||isNotSplitEdgePoint)){if(isLeftEdgePoint(point)){return point.node;}else if(isRightEdgePoint(point)){return point.node.nextSibling;}}
if(isText(point.node)){return point.node.splitText(point.offset);}else{var childNode=point.node.childNodes[point.offset];var clone=insertAfter(point.node.cloneNode(false),point.node);appendChildNodes(clone,listNext(childNode));if(!isSkipPaddingBlankHTML){paddingBlankHTML(point.node);paddingBlankHTML(clone);}
return clone;}};var splitTree=function(root,point,options){var ancestors=listAncestor(point.node,func.eq(root));if(!ancestors.length){return null;}else if(ancestors.length===1){return splitNode(point,options);}
return ancestors.reduce(function(node,parent){if(node===point.node){node=splitNode(point,options);}
return splitNode({node:parent,offset:node?dom.position(node):nodeLength(parent)},options);});};var splitPoint=function(point,isInline){var pred=isInline?isPara:isBodyContainer;var ancestors=listAncestor(point.node,pred);var topAncestor=list.last(ancestors)||point.node;var splitRoot,container;if(pred(topAncestor)){splitRoot=ancestors[ancestors.length-2];container=topAncestor;}else{splitRoot=topAncestor;container=splitRoot.parentNode;}
var pivot=splitRoot&&splitTree(splitRoot,point,{isSkipPaddingBlankHTML:isInline,isNotSplitEdgePoint:isInline});if(!pivot&&container===point.node){pivot=point.node.childNodes[point.offset];}
return{rightNode:pivot,container:container};};var create=function(nodeName){return document.createElement(nodeName);};var createText=function(text){return document.createTextNode(text);};var remove=function(node,isRemoveChild){if(!node||!node.parentNode){return;}
if(node.removeNode){return node.removeNode(isRemoveChild);}
var parent=node.parentNode;if(!isRemoveChild){var nodes=[];var i,len;for(i=0,len=node.childNodes.length;i<len;i++){nodes.push(node.childNodes[i]);}
for(i=0,len=nodes.length;i<len;i++){parent.insertBefore(nodes[i],node);}}
parent.removeChild(node);};var removeWhile=function(node,pred){while(node){if(isEditable(node)||!pred(node)){break;}
var parent=node.parentNode;remove(node);node=parent;}};var replace=function(node,nodeName){if(node.nodeName.toUpperCase()===nodeName.toUpperCase()){return node;}
var newNode=create(nodeName);if(node.style.cssText){newNode.style.cssText=node.style.cssText;}
appendChildNodes(newNode,list.from(node.childNodes));insertAfter(newNode,node);remove(node);return newNode;};var isTextarea=makePredByNodeName('TEXTAREA');var value=function($node,stripLinebreaks){var val=isTextarea($node[0])?$node.val():$node.html();if(stripLinebreaks){return val.replace(/[\n\r]/g,'');}
return val;};var html=function($node,isNewlineOnBlock){var markup=value($node);if(isNewlineOnBlock){var regexTag=/<(\/?)(\b(?!!)[^>\s]*)(.*?)(\s*\/?>)/g;markup=markup.replace(regexTag,function(match,endSlash,name){name=name.toUpperCase();var isEndOfInlineContainer=/^DIV|^TD|^TH|^P|^LI|^H[1-7]/.test(name)&&!!endSlash;var isBlockNode=/^BLOCKQUOTE|^TABLE|^TBODY|^TR|^HR|^UL|^OL/.test(name);return match+((isEndOfInlineContainer||isBlockNode)?'\n':'');});markup=$.trim(markup);}
return markup;};return{NBSP_CHAR:NBSP_CHAR,ZERO_WIDTH_NBSP_CHAR:ZERO_WIDTH_NBSP_CHAR,blank:blankHTML,emptyPara:'<p>'+blankHTML+'</p>',makePredByNodeName:makePredByNodeName,isEditable:isEditable,isControlSizing:isControlSizing,buildLayoutInfo:buildLayoutInfo,makeLayoutInfo:makeLayoutInfo,isText:isText,isVoid:isVoid,isPara:isPara,isPurePara:isPurePara,isInline:isInline,isBlock:func.not(isInline),isBodyInline:isBodyInline,isBody:isBody,isParaInline:isParaInline,isList:isList,isTable:isTable,isCell:isCell,isBlockquote:isBlockquote,isBodyContainer:isBodyContainer,isAnchor:isAnchor,isDiv:makePredByNodeName('DIV'),isLi:isLi,isBR:makePredByNodeName('BR'),isSpan:makePredByNodeName('SPAN'),isB:makePredByNodeName('B'),isU:makePredByNodeName('U'),isS:makePredByNodeName('S'),isI:makePredByNodeName('I'),isImg:makePredByNodeName('IMG'),isTextarea:isTextarea,isEmpty:isEmpty,isEmptyAnchor:func.and(isAnchor,isEmpty),isClosestSibling:isClosestSibling,withClosestSiblings:withClosestSiblings,nodeLength:nodeLength,isLeftEdgePoint:isLeftEdgePoint,isRightEdgePoint:isRightEdgePoint,isEdgePoint:isEdgePoint,isLeftEdgeOf:isLeftEdgeOf,isRightEdgeOf:isRightEdgeOf,prevPoint:prevPoint,nextPoint:nextPoint,isSamePoint:isSamePoint,isVisiblePoint:isVisiblePoint,prevPointUntil:prevPointUntil,nextPointUntil:nextPointUntil,isCharPoint:isCharPoint,walkPoint:walkPoint,ancestor:ancestor,singleChildAncestor:singleChildAncestor,listAncestor:listAncestor,lastAncestor:lastAncestor,listNext:listNext,listPrev:listPrev,listDescendant:listDescendant,commonAncestor:commonAncestor,wrap:wrap,insertAfter:insertAfter,appendChildNodes:appendChildNodes,position:position,hasChildren:hasChildren,makeOffsetPath:makeOffsetPath,fromOffsetPath:fromOffsetPath,splitTree:splitTree,splitPoint:splitPoint,create:create,createText:createText,remove:remove,removeWhile:removeWhile,replace:replace,html:html,value:value};})();var range=(function(){var textRangeToPoint=function(textRange,isStart){var container=textRange.parentElement(),offset;var tester=document.body.createTextRange(),prevContainer;var childNodes=list.from(container.childNodes);for(offset=0;offset<childNodes.length;offset++){if(dom.isText(childNodes[offset])){continue;}
tester.moveToElementText(childNodes[offset]);if(tester.compareEndPoints('StartToStart',textRange)>=0){break;}
prevContainer=childNodes[offset];}
if(offset!==0&&dom.isText(childNodes[offset-1])){var textRangeStart=document.body.createTextRange(),curTextNode=null;textRangeStart.moveToElementText(prevContainer||container);textRangeStart.collapse(!prevContainer);curTextNode=prevContainer?prevContainer.nextSibling:container.firstChild;var pointTester=textRange.duplicate();pointTester.setEndPoint('StartToStart',textRangeStart);var textCount=pointTester.text.replace(/[\r\n]/g,'').length;while(textCount>curTextNode.nodeValue.length&&curTextNode.nextSibling){textCount-=curTextNode.nodeValue.length;curTextNode=curTextNode.nextSibling;}
var dummy=curTextNode.nodeValue;if(isStart&&curTextNode.nextSibling&&dom.isText(curTextNode.nextSibling)&&textCount===curTextNode.nodeValue.length){textCount-=curTextNode.nodeValue.length;curTextNode=curTextNode.nextSibling;}
container=curTextNode;offset=textCount;}
return{cont:container,offset:offset};};var pointToTextRange=function(point){var textRangeInfo=function(container,offset){var node,isCollapseToStart;if(dom.isText(container)){var prevTextNodes=dom.listPrev(container,func.not(dom.isText));var prevContainer=list.last(prevTextNodes).previousSibling;node=prevContainer||container.parentNode;offset+=list.sum(list.tail(prevTextNodes),dom.nodeLength);isCollapseToStart=!prevContainer;}else{node=container.childNodes[offset]||container;if(dom.isText(node)){return textRangeInfo(node,0);}
offset=0;isCollapseToStart=false;}
return{node:node,collapseToStart:isCollapseToStart,offset:offset};};var textRange=document.body.createTextRange();var info=textRangeInfo(point.node,point.offset);textRange.moveToElementText(info.node);textRange.collapse(info.collapseToStart);textRange.moveStart('character',info.offset);return textRange;};var WrappedRange=function(sc,so,ec,eo){this.sc=sc;this.so=so;this.ec=ec;this.eo=eo;var nativeRange=function(){if(agent.isW3CRangeSupport){var w3cRange=document.createRange();w3cRange.setStart(sc,so);w3cRange.setEnd(ec,eo);return w3cRange;}else{var textRange=pointToTextRange({node:sc,offset:so});textRange.setEndPoint('EndToEnd',pointToTextRange({node:ec,offset:eo}));return textRange;}};this.getPoints=function(){return{sc:sc,so:so,ec:ec,eo:eo};};this.getStartPoint=function(){return{node:sc,offset:so};};this.getEndPoint=function(){return{node:ec,offset:eo};};this.select=function(){var nativeRng=nativeRange();if(agent.isW3CRangeSupport){var selection=document.getSelection();if(selection.rangeCount>0){selection.removeAllRanges();}
selection.addRange(nativeRng);}else{nativeRng.select();}
return this;};this.normalize=function(){var getVisiblePoint=function(point){if(!dom.isVisiblePoint(point)){if(dom.isLeftEdgePoint(point)){point=dom.nextPointUntil(point,dom.isVisiblePoint);}else{point=dom.prevPointUntil(point,dom.isVisiblePoint);}}
return point;};var startPoint=getVisiblePoint(this.getStartPoint());var endPoint=getVisiblePoint(this.getEndPoint());return new WrappedRange(startPoint.node,startPoint.offset,endPoint.node,endPoint.offset);};this.nodes=function(pred,options){pred=pred||func.ok;var includeAncestor=options&&options.includeAncestor;var fullyContains=options&&options.fullyContains;var startPoint=this.getStartPoint();var endPoint=this.getEndPoint();var nodes=[];var leftEdgeNodes=[];dom.walkPoint(startPoint,endPoint,function(point){if(dom.isEditable(point.node)){return;}
var node;if(fullyContains){if(dom.isLeftEdgePoint(point)){leftEdgeNodes.push(point.node);}
if(dom.isRightEdgePoint(point)&&list.contains(leftEdgeNodes,point.node)){node=point.node;}}else if(includeAncestor){node=dom.ancestor(point.node,pred);}else{node=point.node;}
if(node&&pred(node)){nodes.push(node);}},true);return list.unique(nodes);};this.commonAncestor=function(){return dom.commonAncestor(sc,ec);};this.expand=function(pred){var startAncestor=dom.ancestor(sc,pred);var endAncestor=dom.ancestor(ec,pred);if(!startAncestor&&!endAncestor){return new WrappedRange(sc,so,ec,eo);}
var boundaryPoints=this.getPoints();if(startAncestor){boundaryPoints.sc=startAncestor;boundaryPoints.so=0;}
if(endAncestor){boundaryPoints.ec=endAncestor;boundaryPoints.eo=dom.nodeLength(endAncestor);}
return new WrappedRange(boundaryPoints.sc,boundaryPoints.so,boundaryPoints.ec,boundaryPoints.eo);};this.collapse=function(isCollapseToStart){if(isCollapseToStart){return new WrappedRange(sc,so,sc,so);}else{return new WrappedRange(ec,eo,ec,eo);}};this.splitText=function(){var isSameContainer=sc===ec;var boundaryPoints=this.getPoints();if(dom.isText(ec)&&!dom.isEdgePoint(this.getEndPoint())){ec.splitText(eo);}
if(dom.isText(sc)&&!dom.isEdgePoint(this.getStartPoint())){boundaryPoints.sc=sc.splitText(so);boundaryPoints.so=0;if(isSameContainer){boundaryPoints.ec=boundaryPoints.sc;boundaryPoints.eo=eo-so;}}
return new WrappedRange(boundaryPoints.sc,boundaryPoints.so,boundaryPoints.ec,boundaryPoints.eo);};this.deleteContents=function(){if(this.isCollapsed()){return this;}
var rng=this.splitText();var nodes=rng.nodes(null,{fullyContains:true});var point=dom.prevPointUntil(rng.getStartPoint(),function(point){return!list.contains(nodes,point.node);});var emptyParents=[];$.each(nodes,function(idx,node){var parent=node.parentNode;if(point.node!==parent&&dom.nodeLength(parent)===1){emptyParents.push(parent);}
dom.remove(node,false);});$.each(emptyParents,function(idx,node){dom.remove(node,false);});return new WrappedRange(point.node,point.offset,point.node,point.offset).normalize();};var makeIsOn=function(pred){return function(){var ancestor=dom.ancestor(sc,pred);return!!ancestor&&(ancestor===dom.ancestor(ec,pred));};};this.isOnEditable=makeIsOn(dom.isEditable);this.isOnList=makeIsOn(dom.isList);this.isOnAnchor=makeIsOn(dom.isAnchor);this.isOnCell=makeIsOn(dom.isCell);this.isLeftEdgeOf=function(pred){if(!dom.isLeftEdgePoint(this.getStartPoint())){return false;}
var node=dom.ancestor(this.sc,pred);return node&&dom.isLeftEdgeOf(this.sc,node);};this.isCollapsed=function(){return sc===ec&&so===eo;};this.wrapBodyInlineWithPara=function(){if(dom.isBodyContainer(sc)&&dom.isEmpty(sc)){sc.innerHTML=dom.emptyPara;return new WrappedRange(sc.firstChild,0,sc.firstChild,0);}
if(dom.isParaInline(sc)||dom.isPara(sc)){return this.normalize();}
var topAncestor;if(dom.isInline(sc)){var ancestors=dom.listAncestor(sc,func.not(dom.isInline));topAncestor=list.last(ancestors);if(!dom.isInline(topAncestor)){topAncestor=ancestors[ancestors.length-2]||sc.childNodes[so];}}else{topAncestor=sc.childNodes[so>0?so-1:0];}
var inlineSiblings=dom.listPrev(topAncestor,dom.isParaInline).reverse();inlineSiblings=inlineSiblings.concat(dom.listNext(topAncestor.nextSibling,dom.isParaInline));if(inlineSiblings.length){var para=dom.wrap(list.head(inlineSiblings),'p');dom.appendChildNodes(para,list.tail(inlineSiblings));}
return this.normalize();};this.insertNode=function(node){var rng=this.wrapBodyInlineWithPara().deleteContents();var info=dom.splitPoint(rng.getStartPoint(),dom.isInline(node));if(info.rightNode){info.rightNode.parentNode.insertBefore(node,info.rightNode);}else{info.container.appendChild(node);}
return node;};this.pasteHTML=function(markup){var self=this;var contentsContainer=$('<div></div>').html(markup)[0];var childNodes=list.from(contentsContainer.childNodes);this.wrapBodyInlineWithPara().deleteContents();return $.map(childNodes.reverse(),function(childNode){return self.insertNode(childNode);}).reverse();};this.toString=function(){var nativeRng=nativeRange();return agent.isW3CRangeSupport?nativeRng.toString():nativeRng.text;};this.getWordRange=function(findAfter){var endPoint=this.getEndPoint();if(!dom.isCharPoint(endPoint)){return this;}
var startPoint=dom.prevPointUntil(endPoint,function(point){return!dom.isCharPoint(point);});if(findAfter){endPoint=dom.nextPointUntil(endPoint,function(point){return!dom.isCharPoint(point);});}
return new WrappedRange(startPoint.node,startPoint.offset,endPoint.node,endPoint.offset);};this.bookmark=function(editable){return{s:{path:dom.makeOffsetPath(editable,sc),offset:so},e:{path:dom.makeOffsetPath(editable,ec),offset:eo}};};this.paraBookmark=function(paras){return{s:{path:list.tail(dom.makeOffsetPath(list.head(paras),sc)),offset:so},e:{path:list.tail(dom.makeOffsetPath(list.last(paras),ec)),offset:eo}};};this.getClientRects=function(){var nativeRng=nativeRange();return nativeRng.getClientRects();};};return{create:function(sc,so,ec,eo){if(!arguments.length){if(agent.isW3CRangeSupport){var selection=document.getSelection();if(!selection||selection.rangeCount===0){return null;}else if(dom.isBody(selection.anchorNode)){return null;}
var nativeRng=selection.getRangeAt(0);sc=nativeRng.startContainer;so=nativeRng.startOffset;ec=nativeRng.endContainer;eo=nativeRng.endOffset;}else{var textRange=document.selection.createRange();var textRangeEnd=textRange.duplicate();textRangeEnd.collapse(false);var textRangeStart=textRange;textRangeStart.collapse(true);var startPoint=textRangeToPoint(textRangeStart,true),endPoint=textRangeToPoint(textRangeEnd,false);if(dom.isText(startPoint.node)&&dom.isLeftEdgePoint(startPoint)&&dom.isTextNode(endPoint.node)&&dom.isRightEdgePoint(endPoint)&&endPoint.node.nextSibling===startPoint.node){startPoint=endPoint;}
sc=startPoint.cont;so=startPoint.offset;ec=endPoint.cont;eo=endPoint.offset;}}else if(arguments.length===2){ec=sc;eo=so;}
return new WrappedRange(sc,so,ec,eo);},createFromNode:function(node){var sc=node;var so=0;var ec=node;var eo=dom.nodeLength(ec);if(dom.isVoid(sc)){so=dom.listPrev(sc).length-1;sc=sc.parentNode;}
if(dom.isBR(ec)){eo=dom.listPrev(ec).length-1;ec=ec.parentNode;}else if(dom.isVoid(ec)){eo=dom.listPrev(ec).length;ec=ec.parentNode;}
return this.create(sc,so,ec,eo);},createFromNodeBefore:function(node){return this.createFromNode(node).collapse(true);},createFromNodeAfter:function(node){return this.createFromNode(node).collapse();},createFromBookmark:function(editable,bookmark){var sc=dom.fromOffsetPath(editable,bookmark.s.path);var so=bookmark.s.offset;var ec=dom.fromOffsetPath(editable,bookmark.e.path);var eo=bookmark.e.offset;return new WrappedRange(sc,so,ec,eo);},createFromParaBookmark:function(bookmark,paras){var so=bookmark.s.offset;var eo=bookmark.e.offset;var sc=dom.fromOffsetPath(list.head(paras),bookmark.s.path);var ec=dom.fromOffsetPath(list.last(paras),bookmark.e.path);return new WrappedRange(sc,so,ec,eo);}};})();var defaults={version:'0.6.9',options:{defaultTextColor:'#212121',defaultBackColor:'#ddd',followingToolbar:true,otherStaticBarClass:"staticTop",width:null,height:null,minHeight:null,maxHeight:null,focus:false,tabsize:4,styleWithSpan:true,disableLinkTarget:false,disableDragAndDrop:false,disableResizeEditor:false,shortcuts:true,placeholder:false,prettifyHtml:true,iconPrefix:'',icons:{font:{bold:'format_bold',italic:'format_italic',underline:'format_underlined',clear:'clear',height:'format_size',strikethrough:'strikethrough_s',superscript:'vertical_align_top',subscript:'vertical_align_bottom'},image:{image:'image',floatLeft:'format_align_left',floatRight:'format_align_right',floatNone:'format_align_justify',shapeRounded:'crop_3_2',shapeCircle:'panorama_fish_eye',shapeThumbnail:'collections',bordered:'border_outer',shapeNone:'image',remove:'delete'},link:{link:'insert_link',unlink:'clear',edit:'create'},table:{table:'border_all'},hr:{insert:'add'},style:{style:'border_color'},lists:{unordered:'format_list_bulleted',ordered:'format_list_numbered'},options:{help:'help',fullscreen:'settings_overscan',codeview:'code'},paragraph:{paragraph:'format_textdirection_l_to_r',outdent:'format_indent_decrease',indent:'format_indent_increase',left:'format_align_left',center:'format_align_center',right:'format_align_right',justify:'format_align_justify'},color:{recent:'format_color_text'},history:{undo:'undo',redo:'redo'},misc:{check:'check'}},codemirror:{mode:'text/html',htmlMode:true,indentWithTabs:true,tabSize:4,lineNumbers:true,theme:'monokai',maxHighlightLength:'Infinity'},lang:'en-US',direction:null,toolbar:[['style',['style']],['font',['bold','italic','underline','clear']],['fontname',['fontname']],['fontsize',['fontsize']],['color',['color']],['para',['ul','ol','paragraph']],['height',['height']],['table',['table']],['insert',['link','hr']],['view',['fullscreen','codeview']],],plugin:{},airMode:false,airPopover:[['color',['color']],['font',['bold','underline','clear']],['para',['ul','paragraph']],['table',['table']],['insert',['link','picture']]],styleTags:['p','blockquote','pre','h1','h2','h3','h4','h5','h6'],defaultFontName:'Roboto',fontNames:['Roboto','Arial','Arial Black','Comic Sans MS','Courier New','Helvetica Neue','Helvetica','Impact','Times New Roman','Verdana'],fontNamesIgnoreCheck:[],fontSizes:['12','13','14','15','16','17','18','25','37'],colors:[['#fafafa','#efebe9','#7e57c2','#ab47bc','#5c6bc0','#42a5f5','#26c6da','#66bb6a','#9ccc65','#ffee58','#ffca28','#ffa726','#ff7043','#ef5350','#ec407a'],['#f5f5f5','#d7ccc8','#673ab7','#9c27b0','#3f51b5','#2196f3','#00bcd4','#4caf50','#8bc34a','#ffeb3b','#ffc107','#ff9800','#ff5722','#f44336','#e91e63'],['#eeeeee','#bcaaa4','#5e35b1','#8e24aa','#3949ab','#1e88e5','#00acc1','#43a047','#7cb342','#fdd835','#ffb300','#fb8c00','#f4511e','#e53935','#d81b60'],['#e0e0e0','#a1887f','#512da8','#7b1fa2','#303f9f','#1976d2','#0097a7','#388e3c','#689f38','#fbc02d','#ffa000','#f57c00','#e64a19','#d32f2f','#c2185b'],['#bdbdbd','#8d6e63','#4527a0','#6a1b9a','#283593','#1565c0','#00838f','#2e7d32','#558b2f','#f9a825','#ff8f00','#ef6c00','#d84315','#c62828','#ad1457'],['#9e9e9e','#795548','#311b92','#4a148c','#1a237e','#0d47a1','#006064','#1b5e20','#33691e','#f57f17','#ff6f00','#e65100','#bf360c','#b71c1c','#880e4f'],['#757575','#6d4c41','#b388ff','#ea80fc','#8c9eff','#82b1ff','#84ffff','#b9f6ca','#ccff90','#ffff8d','#ffe57f','#ffd180','#ff9e80','#ff8a80','#ff80ab'],['#616161','#5d4037','#7c4dff','#e040fb','#536dfe','#448aff','#18ffff','#69f0ae','#b2ff59','#ffff00','#ffd740','#ffab40','#ff6e40','#ff5252','#ff4081'],['#424242','#4e342e','#651fff','#d500f9','#3d5afe','#2979ff','#00e5ff','#00e676','#76ff03','#ffea00','#ffc400','#ff9100','#ff3d00','#ff1744','#f50057'],['#212121','#3e2723','#6200ea','#aa00ff','#304ffe','#2962ff','#00b8d4','#00c853','#64dd17','#ffd600','#ffab00','#ff6d00','#dd2c00','#d50000','#c51162'],],colorTitles:[['grey lighten5','brown lighten5','deep-purple lighten1','purple lighten1','indigo lighten1','blue lighten1','cyan lighten1','green lighten1','light-green lighten1','yellow lighten1','amber lighten1','orange lighten1','deep-orange lighten1','red lighten1','pink lighten1'],['grey lighten4','brown lighten4','deep-purple','purple','indigo','blue','cyan','green','light-green','yellow','amber','orange','deep-orange','red','pink'],['grey lighten3','brown lighten3','deep-purple darken1','purple darken1','indigo darken1','blue darken1','cyan darken1','green darken1','light-green darken1','yellow darken1','amber darken1','orange darken1','deep-orange darken1','red darken1','pink darken1'],['grey lighten2','brown lighten2','deep-purple darken2','purple darken2','indigo darken2','blue darken2','cyan darken2','green darken2','light-green darken2','yellow darken2','amber darken2','orange darken2','deep-orange darken2','red darken2','pink darken2'],['grey lighten1','brown lighten1','deep-purple darken3','purple darken3','indigo darken3','blue darken3','cyan darken3','green darken3','light-green darken3','yellow darken3','amber darken3','orange darken3','deep-orange darken3','red darken3','pink darken3'],['grey','brown','deep-purple darken4','purple darken4','indigo darken4','blue darken4','cyan darken4','green darken4','light-green darken4','yellow darken4','amber darken4','orange darken4','deep-orange darken4','red darken4','pink darken4'],['grey darken1','brown darken1','deep-purple accent1','purple accent1','indigo accent1','blue accent1','cyan accent1','green accent1','light-green accent1','yellow accent1','amber accent1','orange accent1','deep-orange accent1','red accent1','pink accent1'],['grey darken2','brown darken2','deep-purple accent2','purple accent2','indigo accent2','blue accent2','cyan accent2','green accent2','light-green accent2','yellow accent2','amber accent2','orange accent2','deep-orange accent2','red accent2','pink accent2'],['grey darken3','brown darken3','deep-purple accent3','purple accent3','indigo accent3','blue accent3','cyan accent3','green accent3','light-green accent3','yellow accent3','amber accent3','orange accent3','deep-orange accent3','red accent3','pink accent3'],['grey darken4','brown darken4','deep-purple accent4','purple accent4','indigo accent4','blue accent4','cyan accent4','green accent4','light-green accent4','yellow accent4','amber accent4','orange accent4','deep-orange accent4','red accent4','pink accent4'],],lineHeights:['1.0','1.2','1.4','1.5','1.6','1.8','2.0','3.0'],insertTableMaxSize:{col:12,row:10},maximumImageFileSize:null,oninit:null,onfocus:null,onblur:null,onenter:null,onkeyup:null,onkeydown:null,onImageUpload:null,onImageUploadError:null,onMediaDelete:null,onToolbarClick:null,onsubmit:null,onCreateLink:function(sLinkUrl){if(sLinkUrl.indexOf('@')!==-1&&sLinkUrl.indexOf(':')===-1){sLinkUrl='mailto:'+sLinkUrl;}
return sLinkUrl;},keyMap:{pc:{'ENTER':'insertParagraph','CTRL+Z':'undo','CTRL+Y':'redo','TAB':'tab','SHIFT+TAB':'untab','CTRL+B':'bold','CTRL+I':'italic','CTRL+U':'underline','CTRL+SHIFT+S':'strikethrough','CTRL+BACKSLASH':'removeFormat','CTRL+SHIFT+L':'justifyLeft','CTRL+SHIFT+E':'justifyCenter','CTRL+SHIFT+R':'justifyRight','CTRL+SHIFT+J':'justifyFull','CTRL+SHIFT+NUM7':'insertUnorderedList','CTRL+SHIFT+NUM8':'insertOrderedList','CTRL+LEFTBRACKET':'outdent','CTRL+RIGHTBRACKET':'indent','CTRL+NUM0':'formatPara','CTRL+NUM1':'formatH1','CTRL+NUM2':'formatH2','CTRL+NUM3':'formatH3','CTRL+NUM4':'formatH4','CTRL+NUM5':'formatH5','CTRL+NUM6':'formatH6','CTRL+ENTER':'insertHorizontalRule','CTRL+K':'showLinkDialog'},mac:{'ENTER':'insertParagraph','CMD+Z':'undo','CMD+SHIFT+Z':'redo','TAB':'tab','SHIFT+TAB':'untab','CMD+B':'bold','CMD+I':'italic','CMD+U':'underline','CMD+SHIFT+S':'strikethrough','CMD+BACKSLASH':'removeFormat','CMD+SHIFT+L':'justifyLeft','CMD+SHIFT+E':'justifyCenter','CMD+SHIFT+R':'justifyRight','CMD+SHIFT+J':'justifyFull','CMD+SHIFT+NUM7':'insertUnorderedList','CMD+SHIFT+NUM8':'insertOrderedList','CMD+LEFTBRACKET':'outdent','CMD+RIGHTBRACKET':'indent','CMD+NUM0':'formatPara','CMD+NUM1':'formatH1','CMD+NUM2':'formatH2','CMD+NUM3':'formatH3','CMD+NUM4':'formatH4','CMD+NUM5':'formatH5','CMD+NUM6':'formatH6','CMD+ENTER':'insertHorizontalRule','CMD+K':'showLinkDialog'}}},lang:{'en-US':{font:{bold:'Bold',italic:'Italic',underline:'Underline',clear:'Remove Font Style',height:'Line Height',name:'Font Family',strikethrough:'Strikethrough',subscript:'Subscript',superscript:'Superscript',size:'Font Size'},image:{image:'Picture',insert:'Insert Image',resizeFull:'Resize Full',resizeHalf:'Resize Half',resizeQuarter:'Resize Quarter',floatLeft:'Float Left',floatRight:'Float Right',floatNone:'Float None',shapeRounded:'Shape: Rounded',shapeCircle:'Shape: Circle',bordered:'Bordered',shapeThumbnail:'Shape: Thumbnail',shapeNone:'Shape: None',dragImageHere:'Drag image or text here',dropImage:'Drop image or Text',selectFromFiles:'Select from files',maximumFileSize:'Maximum file size',maximumFileSizeError:'Maximum file size exceeded.',url:'Image URL',remove:'Remove Image'},link:{link:'Link',insert:'Insert Link',unlink:'Unlink',edit:'Edit',textToDisplay:'Text to display',url:'To what URL should this link go?',openInNewWindow:'Open in new window'},table:{table:'Table',striped:'Striped',hoverable:'Hoverable',responsive:'Responsive',bordered:'Bordered'},hr:{insert:'Insert Horizontal Rule'},style:{style:'Style',normal:'Normal',blockquote:'Quote',pre:'Code',h1:'Header 1',h2:'Header 2',h3:'Header 3',h4:'Header 4',h5:'Header 5',h6:'Header 6'},lists:{unordered:'Unordered list',ordered:'Ordered list'},options:{help:'Help',fullscreen:'Full Screen',codeview:'Code View'},paragraph:{paragraph:'Paragraph',outdent:'Outdent',indent:'Indent',left:'Align left',center:'Align center',right:'Align right',justify:'Justify full'},color:{recent:'Recent Color',more:'More Color',background:'Back',foreground:'Text',transparent:'Transparent',setTransparent:'Transparent',reset:'Reset',resetToDefault:'Default'},shortcut:{shortcuts:'Keyboard shortcuts',close:'Close',textFormatting:'Text formatting',action:'Action',paragraphFormatting:'Paragraph formatting',documentStyle:'Document Style',extraKeys:'Extra keys'},history:{undo:'Undo',redo:'Redo'}}}};var async=(function(){var readFileAsDataURL=function(file){return $.Deferred(function(deferred){$.extend(new FileReader(),{onload:function(e){var sDataURL=e.target.result;deferred.resolve(sDataURL);},onerror:function(){deferred.reject(this);}}).readAsDataURL(file);}).promise();};var createImage=function(sUrl,filename){return $.Deferred(function(deferred){var $img=$('<img>');$img.one('load',function(){$img.off('error abort');deferred.resolve($img);}).one('error abort',function(){$img.off('load').detach();deferred.reject($img);}).css({display:'none'}).appendTo(document.body).attr({'src':sUrl,'data-filename':filename});}).promise();};return{readFileAsDataURL:readFileAsDataURL,createImage:createImage};})();var key=(function(){var keyMap={'BACKSPACE':8,'TAB':9,'ENTER':13,'SPACE':32,'NUM0':48,'NUM1':49,'NUM2':50,'NUM3':51,'NUM4':52,'NUM5':53,'NUM6':54,'NUM7':55,'NUM8':56,'B':66,'E':69,'I':73,'J':74,'K':75,'L':76,'R':82,'S':83,'U':85,'Y':89,'Z':90,'SLASH':191,'LEFTBRACKET':219,'BACKSLASH':220,'RIGHTBRACKET':221};return{isEdit:function(keyCode){return list.contains([8,9,13,32],keyCode);},isMove:function(keyCode){return list.contains([37,38,39,40],keyCode);},nameFromCode:func.invertObject(keyMap),code:keyMap};})();var History=function($editable){var stack=[],stackOffset=-1;var editable=$editable[0];var makeSnapshot=function(){var rng=range.create();var emptyBookmark={s:{path:[],offset:0},e:{path:[],offset:0}};return{contents:$editable.html(),bookmark:(rng?rng.bookmark(editable):emptyBookmark)};};var applySnapshot=function(snapshot){if(snapshot.contents!==null){$editable.html(snapshot.contents);}
if(snapshot.bookmark!==null){range.createFromBookmark(editable,snapshot.bookmark).select();}};this.undo=function(){if(0<stackOffset){stackOffset--;applySnapshot(stack[stackOffset]);}};this.redo=function(){if(stack.length-1>stackOffset){stackOffset++;applySnapshot(stack[stackOffset]);}};this.recordUndo=function(){stackOffset++;if(stack.length>stackOffset){stack=stack.slice(0,stackOffset);}
stack.push(makeSnapshot());};this.recordUndo();};var Style=function(){var jQueryCSS=function($obj,propertyNames){if(agent.jqueryVersion<1.9){var result={};$.each(propertyNames,function(idx,propertyName){result[propertyName]=$obj.css(propertyName);});return result;}
return $obj.css.call($obj,propertyNames);};this.stylePara=function(rng,styleInfo){$.each(rng.nodes(dom.isPara,{includeAncestor:true}),function(idx,para){$(para).css(styleInfo);});};this.styleNodes=function(rng,options){rng=rng.splitText();var nodeName=options&&options.nodeName||'SPAN';var expandClosestSibling=!!(options&&options.expandClosestSibling);var onlyPartialContains=!!(options&&options.onlyPartialContains);if(rng.isCollapsed()){return[rng.insertNode(dom.create(nodeName))];}
var pred=dom.makePredByNodeName(nodeName);var nodes=$.map(rng.nodes(dom.isText,{fullyContains:true}),function(text){return dom.singleChildAncestor(text,pred)||dom.wrap(text,nodeName);});if(expandClosestSibling){if(onlyPartialContains){var nodesInRange=rng.nodes();pred=func.and(pred,function(node){return list.contains(nodesInRange,node);});}
return $.map(nodes,function(node){var siblings=dom.withClosestSiblings(node,pred);var head=list.head(siblings);var tails=list.tail(siblings);$.each(tails,function(idx,elem){dom.appendChildNodes(head,elem.childNodes);dom.remove(elem);});return list.head(siblings);});}else{return nodes;}};this.current=function(rng,target){var $cont=$(dom.isText(rng.sc)?rng.sc.parentNode:rng.sc);var properties=['font-family','font-size','text-align','list-style-type','line-height'];var styleInfo=jQueryCSS($cont,properties)||{};styleInfo['font-size']=parseInt(styleInfo['font-size'],10);styleInfo['font-bold']=document.queryCommandState('bold')?'bold':'normal';styleInfo['font-italic']=document.queryCommandState('italic')?'italic':'normal';styleInfo['font-underline']=document.queryCommandState('underline')?'underline':'normal';styleInfo['font-strikethrough']=document.queryCommandState('strikeThrough')?'strikethrough':'normal';styleInfo['font-superscript']=document.queryCommandState('superscript')?'superscript':'normal';styleInfo['font-subscript']=document.queryCommandState('subscript')?'subscript':'normal';if(!rng.isOnList()){styleInfo['list-style']='none';}else{var aOrderedType=['circle','disc','disc-leading-zero','square'];var isUnordered=$.inArray(styleInfo['list-style-type'],aOrderedType)>-1;styleInfo['list-style']=isUnordered?'unordered':'ordered';}
var para=dom.ancestor(rng.sc,dom.isPara);if(para&&para.style['line-height']){styleInfo['line-height']=para.style.lineHeight;}else{var lineHeight=parseInt(styleInfo['line-height'],10)/parseInt(styleInfo['font-size'],10);styleInfo['line-height']=lineHeight.toFixed(1);}
styleInfo.image=dom.isImg(target)&&target;styleInfo.anchor=rng.isOnAnchor()&&dom.ancestor(rng.sc,dom.isAnchor);styleInfo.ancestors=dom.listAncestor(rng.sc,dom.isEditable);styleInfo.range=rng;return styleInfo;};};var Bullet=function(){this.insertOrderedList=function(){this.toggleList('OL');};this.insertUnorderedList=function(){this.toggleList('UL');};this.indent=function(){var self=this;var rng=range.create().wrapBodyInlineWithPara();var paras=rng.nodes(dom.isPara,{includeAncestor:true});var clustereds=list.clusterBy(paras,func.peq2('parentNode'));$.each(clustereds,function(idx,paras){var head=list.head(paras);if(dom.isLi(head)){self.wrapList(paras,head.parentNode.nodeName);}else{$.each(paras,function(idx,para){$(para).css('marginLeft',function(idx,val){return(parseInt(val,10)||0)+25;});});}});rng.select();};this.outdent=function(){var self=this;var rng=range.create().wrapBodyInlineWithPara();var paras=rng.nodes(dom.isPara,{includeAncestor:true});var clustereds=list.clusterBy(paras,func.peq2('parentNode'));$.each(clustereds,function(idx,paras){var head=list.head(paras);if(dom.isLi(head)){self.releaseList([paras]);}else{$.each(paras,function(idx,para){$(para).css('marginLeft',function(idx,val){val=(parseInt(val,10)||0);return val>25?val-25:'';});});}});rng.select();};this.toggleList=function(listName){var self=this;var rng=range.create().wrapBodyInlineWithPara();var paras=rng.nodes(dom.isPara,{includeAncestor:true});var bookmark=rng.paraBookmark(paras);var clustereds=list.clusterBy(paras,func.peq2('parentNode'));if(list.find(paras,dom.isPurePara)){var wrappedParas=[];$.each(clustereds,function(idx,paras){wrappedParas=wrappedParas.concat(self.wrapList(paras,listName));});paras=wrappedParas;}else{var diffLists=rng.nodes(dom.isList,{includeAncestor:true}).filter(function(listNode){return!$.nodeName(listNode,listName);});if(diffLists.length){$.each(diffLists,function(idx,listNode){dom.replace(listNode,listName);});}else{paras=this.releaseList(clustereds,true);}}
range.createFromParaBookmark(bookmark,paras).select();};this.wrapList=function(paras,listName){var head=list.head(paras);var last=list.last(paras);var prevList=dom.isList(head.previousSibling)&&head.previousSibling;var nextList=dom.isList(last.nextSibling)&&last.nextSibling;var listNode=prevList||dom.insertAfter(dom.create(listName||'UL'),last);paras=$.map(paras,function(para){return dom.isPurePara(para)?dom.replace(para,'LI'):para;});dom.appendChildNodes(listNode,paras);if(nextList){dom.appendChildNodes(listNode,list.from(nextList.childNodes));dom.remove(nextList);}
return paras;};this.releaseList=function(clustereds,isEscapseToBody){var releasedParas=[];$.each(clustereds,function(idx,paras){var head=list.head(paras);var last=list.last(paras);var headList=isEscapseToBody?dom.lastAncestor(head,dom.isList):head.parentNode;var lastList=headList.childNodes.length>1?dom.splitTree(headList,{node:last.parentNode,offset:dom.position(last)+1},{isSkipPaddingBlankHTML:true}):null;var middleList=dom.splitTree(headList,{node:head.parentNode,offset:dom.position(head)},{isSkipPaddingBlankHTML:true});paras=isEscapseToBody?dom.listDescendant(middleList,dom.isLi):list.from(middleList.childNodes).filter(dom.isLi);if(isEscapseToBody||!dom.isList(headList.parentNode)){paras=$.map(paras,function(para){return dom.replace(para,'P');});}
$.each(list.from(paras).reverse(),function(idx,para){dom.insertAfter(para,headList);});var rootLists=list.compact([headList,middleList,lastList]);$.each(rootLists,function(idx,rootList){var listNodes=[rootList].concat(dom.listDescendant(rootList,dom.isList));$.each(listNodes.reverse(),function(idx,listNode){if(!dom.nodeLength(listNode)){dom.remove(listNode,true);}});});releasedParas=releasedParas.concat(paras);});return releasedParas;};};var Typing=function(){var bullet=new Bullet();this.insertTab=function($editable,rng,tabsize){var tab=dom.createText(new Array(tabsize+1).join(dom.NBSP_CHAR));rng=rng.deleteContents();rng.insertNode(tab,true);rng=range.create(tab,tabsize);rng.select();};this.insertParagraph=function(){var rng=range.create();rng=rng.deleteContents();rng=rng.wrapBodyInlineWithPara();var splitRoot=dom.ancestor(rng.sc,dom.isPara);var nextPara;if(splitRoot){if(dom.isEmpty(splitRoot)&&dom.isLi(splitRoot)){bullet.toggleList(splitRoot.parentNode.nodeName);return;}else{nextPara=dom.splitTree(splitRoot,rng.getStartPoint());var emptyAnchors=dom.listDescendant(splitRoot,dom.isEmptyAnchor);emptyAnchors=emptyAnchors.concat(dom.listDescendant(nextPara,dom.isEmptyAnchor));$.each(emptyAnchors,function(idx,anchor){dom.remove(anchor);});}}else{var next=rng.sc.childNodes[rng.so];nextPara=$(dom.emptyPara)[0];if(next){rng.sc.insertBefore(nextPara,next);}else{rng.sc.appendChild(nextPara);}}
range.create(nextPara,0).normalize().select();};};var Table=function(){this.tab=function(rng,isShift){var cell=dom.ancestor(rng.commonAncestor(),dom.isCell);var table=dom.ancestor(cell,dom.isTable);var cells=dom.listDescendant(table,dom.isCell);var nextCell=list[isShift?'prev':'next'](cells,cell);if(nextCell){range.create(nextCell,0).select();}};this.createTable=function(tOptions){var tds=[],tdHTML;var theaders=[];var colCount=tOptions[0];var rowCount=tOptions[1];var classes=tOptions.slice(2,tOptions.length);for(var idxCol=0;idxCol<colCount;idxCol++){tds.push('<td>(item)</td>');theaders.push('<th>header</th>');}
tdHTML=tds.join('');theaders=theaders.join('');var trs=[],trHTML;for(var idxRow=0;idxRow<rowCount;idxRow++){trs.push('<tr>'+tdHTML+'</tr>');}
trHTML=trs.join('');return $('<table class="'+classes.join(' ')+'"><thead><tr>'+theaders+'</tr></thead><tbody>'+trHTML+'</tbody></table>')[0];};};var KEY_BOGUS='bogus';var Editor=function(handler){var style=new Style();var table=new Table();var typing=new Typing();var bullet=new Bullet();this.createRange=function($editable){this.focus($editable);return range.create();};this.saveRange=function($editable,thenCollapse){this.focus($editable);$editable.data('range',range.create());if(thenCollapse){range.create().collapse().select();}};this.saveNode=function($editable){var copy=[];for(var key=0,len=$editable[0].childNodes.length;key<len;key++){copy.push($editable[0].childNodes[key]);}
$editable.data('childNodes',copy);};this.restoreRange=function($editable){var rng=$editable.data('range');if(rng){rng.select();this.focus($editable);}};this.restoreNode=function($editable){$editable.html('');var child=$editable.data('childNodes');for(var index=0,len=child.length;index<len;index++){$editable[0].appendChild(child[index]);}};this.currentStyle=function(target){var rng=range.create();return rng?rng.isOnEditable()&&style.current(rng,target):false;};var triggerOnBeforeChange=function($editable){var $holder=dom.makeLayoutInfo($editable).holder();handler.bindCustomEvent($holder,$editable.data('callbacks'),'before.command')($editable.html(),$editable);};var triggerOnChange=function($editable){var $holder=dom.makeLayoutInfo($editable).holder();handler.bindCustomEvent($holder,$editable.data('callbacks'),'change')($editable.html(),$editable);};this.undo=function($editable){triggerOnBeforeChange($editable);$editable.data('NoteHistory').undo();triggerOnChange($editable);};this.redo=function($editable){triggerOnBeforeChange($editable);$editable.data('NoteHistory').redo();triggerOnChange($editable);};var self=this;var beforeCommand=this.beforeCommand=function($editable){triggerOnBeforeChange($editable);self.focus($editable);};var afterCommand=this.afterCommand=function($editable,isPreventTrigger){$editable.data('NoteHistory').recordUndo();if(!isPreventTrigger){triggerOnChange($editable);}};var commands=['bold','italic','underline','strikethrough','superscript','subscript','justifyLeft','justifyCenter','justifyRight','justifyFull','formatBlock','removeFormat','backColor','foreColor','fontName'];for(var idx=0,len=commands.length;idx<len;idx++){this[commands[idx]]=(function(sCmd){return function($editable,value){beforeCommand($editable);document.execCommand(sCmd,false,value);afterCommand($editable,true);};})(commands[idx]);}
this.insertHorizontalRule=function(){var hrNode=$('<div />');hrNode.addClass('divider');range.create().insertNode(hrNode[0]);};this.tab=function($editable,options){var rng=this.createRange($editable);if(rng.isCollapsed()&&rng.isOnCell()){table.tab(rng);}else{beforeCommand($editable);typing.insertTab($editable,rng,options.tabsize);afterCommand($editable);}};this.untab=function($editable){var rng=this.createRange($editable);if(rng.isCollapsed()&&rng.isOnCell()){table.tab(rng,true);}};this.insertParagraph=function($editable){beforeCommand($editable);typing.insertParagraph($editable);afterCommand($editable);};this.insertOrderedList=function($editable){beforeCommand($editable);bullet.insertOrderedList($editable);afterCommand($editable);};this.insertUnorderedList=function($editable){beforeCommand($editable);bullet.insertUnorderedList($editable);afterCommand($editable);};this.indent=function($editable){beforeCommand($editable);bullet.indent($editable);afterCommand($editable);};this.outdent=function($editable){beforeCommand($editable);bullet.outdent($editable);afterCommand($editable);};this.insertImage=function($editable,sUrl,filename){async.createImage(sUrl,filename).then(function($image){beforeCommand($editable);$image.css({display:'',width:Math.min($editable.width(),$image.width())});range.create().insertNode($image[0]);range.createFromNodeAfter($image[0]).select();afterCommand($editable);}).fail(function(){var $holder=dom.makeLayoutInfo($editable).holder();handler.bindCustomEvent($holder,$editable.data('callbacks'),'image.upload.error')();});};this.insertNode=function($editable,node){beforeCommand($editable);range.create().insertNode(node);range.createFromNodeAfter(node).select();afterCommand($editable);};this.insertText=function($editable,text){beforeCommand($editable);var textNode=range.create().insertNode(dom.createText(text));range.create(textNode,dom.nodeLength(textNode)).select();afterCommand($editable);};this.pasteHTML=function($editable,markup){beforeCommand($editable);var contents=range.create().pasteHTML(markup);range.createFromNodeAfter(list.last(contents)).select();afterCommand($editable);};this.formatBlock=function($editable,tagName){beforeCommand($editable);tagName=agent.isMSIE?'<'+tagName+'>':tagName;document.execCommand('FormatBlock',false,tagName);afterCommand($editable);};this.formatPara=function($editable){beforeCommand($editable);this.formatBlock($editable,'P');afterCommand($editable);};for(var idx=1;idx<=6;idx++){this['formatH'+idx]=function(idx){return function($editable){this.formatBlock($editable,'H'+idx);};}(idx);};this.fontSize=function($editable,value){var rng=range.create();var isCollapsed=rng.isCollapsed();if(isCollapsed){var spans=style.styleNodes(rng);var firstSpan=list.head(spans);$(spans).css({'font-size':value+'px'});if(firstSpan&&!dom.nodeLength(firstSpan)){firstSpan.innerHTML=dom.ZERO_WIDTH_NBSP_CHAR;range.createFromNodeAfter(firstSpan.firstChild).select();$editable.data(KEY_BOGUS,firstSpan);}}else{beforeCommand($editable);$(style.styleNodes(rng)).css({'font-size':value+'px'});afterCommand($editable);}};this.removeBogus=function($editable){var bogusNode=$editable.data(KEY_BOGUS);if(!bogusNode){return;}
var textNode=list.find(list.from(bogusNode.childNodes),dom.isText);var bogusCharIdx=textNode.nodeValue.indexOf(dom.ZERO_WIDTH_NBSP_CHAR);if(bogusCharIdx!==-1){textNode.deleteData(bogusCharIdx,1);}
if(dom.isEmpty(bogusNode)){dom.remove(bogusNode);}
$editable.removeData(KEY_BOGUS);};this.lineHeight=function($editable,value){beforeCommand($editable);style.stylePara(range.create(),{lineHeight:value});afterCommand($editable);};this.unlink=function($editable){var rng=this.createRange($editable);if(rng.isOnAnchor()){var anchor=dom.ancestor(rng.sc,dom.isAnchor);rng=range.createFromNode(anchor);rng.select();beforeCommand($editable);document.execCommand('unlink');afterCommand($editable);}};this.createLink=function($editable,linkInfo,options){var linkUrl=linkInfo.url;var linkText=linkInfo.text;var isNewWindow=linkInfo.newWindow;var rng=linkInfo.range;var isTextChanged=rng.toString()!==linkText;beforeCommand($editable);if(options.onCreateLink){linkUrl=options.onCreateLink(linkUrl);}
var anchors=[];if(isTextChanged){var anchor=rng.insertNode($('<A>'+linkText+'</A>')[0]);anchors.push(anchor);}else{anchors=style.styleNodes(rng,{nodeName:'A',expandClosestSibling:true,onlyPartialContains:true});}
$.each(anchors,function(idx,anchor){$(anchor).attr('href',linkUrl);if(isNewWindow){$(anchor).attr('target','_blank');}else{$(anchor).removeAttr('target');}});var startRange=range.createFromNodeBefore(list.head(anchors));var startPoint=startRange.getStartPoint();var endRange=range.createFromNodeAfter(list.last(anchors));var endPoint=endRange.getEndPoint();range.create(startPoint.node,startPoint.offset,endPoint.node,endPoint.offset).select();afterCommand($editable);};this.getLinkInfo=function($editable){this.focus($editable);var rng=range.create().expand(dom.isAnchor);var $anchor=$(list.head(rng.nodes(dom.isAnchor)));return{range:rng,text:rng.toString(),isNewWindow:$anchor.length?$anchor.attr('target')==='_blank':false,url:$anchor.length?$anchor.attr('href'):''};};this.color=function($editable,sObjColor){var oColor=JSON.parse(sObjColor);var foreColor=oColor.foreColor,backColor=oColor.backColor;beforeCommand($editable);if(foreColor){document.execCommand('foreColor',false,foreColor);}
if(backColor){document.execCommand('backColor',false,backColor);}
afterCommand($editable);};this.insertTable=function($editable,sDim){var tOptions=sDim.split('x');beforeCommand($editable);var rng=range.create().deleteContents();rng.insertNode(table.createTable(tOptions));afterCommand($editable);};this.floatMe=function($editable,value,$target){beforeCommand($editable);$target.css('float',value);afterCommand($editable);};this.imageShape=function($editable,value,$target){beforeCommand($editable);$target.removeClass('img-rounded img-circle img-thumbnail img-bordered');if(value){$target.addClass(value);}
afterCommand($editable);};this.imageClass=function($editable,value,$target){beforeCommand($editable);if(value){if($target.hasClass(value)){$target.removeClass(value);}else{$target.addClass(value);}}
afterCommand($editable);};this.resize=function($editable,value,$target){beforeCommand($editable);$target.css({width:value*100+'%',height:''});afterCommand($editable);};this.resizeTo=function(pos,$target,bKeepRatio){var imageSize;if(bKeepRatio){var newRatio=pos.y/pos.x;var ratio=$target.data('ratio');imageSize={width:ratio>newRatio?pos.x:pos.y/ratio,height:ratio>newRatio?pos.x*ratio:pos.y};}else{imageSize={width:pos.x,height:pos.y};}
$target.css(imageSize);};this.removeMedia=function($editable,value,$target){beforeCommand($editable);$target.detach();handler.bindCustomEvent($(),$editable.data('callbacks'),'media.delete')($target,$editable);afterCommand($editable);};this.focus=function($editable){$editable.focus();if(agent.isFF&&!range.create().isOnEditable()){range.createFromNode($editable[0]).normalize().collapse().select();}};this.isEmpty=function($editable){return dom.isEmpty($editable[0])||dom.emptyPara===$editable.html();};};var Button=function(){this.update=function($container,styleInfo){var checkDropdownMenu=function($btn,value){$btn.find('.dropdown-menu li').each(function(){var div=$(this).children('div');var currentValue=div.data('value');if((currentValue+'')===(value+'')){div.children('i').removeClass('transparent');}else{div.children('i').addClass('transparent');}});};var btnState=function(selector,pred){var $btn=$container.find(selector);$btn.toggleClass('active',pred());};if(styleInfo.image){var $img=$(styleInfo.image);btnState('.btn[data-event="imageClass"][data-value="img-rounded"]',function(){return $img.hasClass('img-rounded');});btnState('.btn[data-event="imageClass"][data-value="img-circle"]',function(){return $img.hasClass('img-circle');});btnState('.btn[data-event="imageClass"][data-value="img-thumbnail"]',function(){return $img.hasClass('img-thumbnail');});btnState('.btn[data-event="imageClass"][data-value="img-bordered"]',function(){return $img.hasClass('img-bordered');});btnState('.btn[data-event="imageShape"]:not([data-value])',function(){return!$img.is('.img-rounded, .img-circle, .img-thumbnail, .img-bordered');});var imgFloat=$img.css('float');btnState('.btn[data-event="floatMe"][data-value="left"]',function(){return imgFloat==='left';});btnState('.btn[data-event="floatMe"][data-value="right"]',function(){return imgFloat==='right';});btnState('.btn[data-event="floatMe"][data-value="none"]',function(){return imgFloat!=='left'&&imgFloat!=='right';});var style=$img.attr('style');btnState('.btn[data-event="resize"][data-value="1"]',function(){return!!/(^|\s)(max-)?width\s*:\s*100%/.test(style);});btnState('.btn[data-event="resize"][data-value="0.5"]',function(){return!!/(^|\s)(max-)?width\s*:\s*50%/.test(style);});btnState('.btn[data-event="resize"][data-value="0.25"]',function(){return!!/(^|\s)(max-)?width\s*:\s*25%/.test(style);});return;}
var $fontname=$container.find('.note-fontname[data-name=fontname]');if($fontname.length){var selectedFont=styleInfo['font-family'];if(!!selectedFont){var list=selectedFont.split(',');for(var i=0,len=list.length;i<len;i++){selectedFont=list[i].replace(/[\'\"]/g,'').replace(/\s+$/,'').replace(/^\s+/,'');if(agent.isFontInstalled(selectedFont)){break;}}
$fontname.find('.note-current-fontname').text(selectedFont);checkDropdownMenu($fontname,selectedFont);}}
var $fontsize=$container.find('.note-fontsize[data-name=fontsize]');$fontsize.find('.note-current-fontsize').text(styleInfo['font-size']);checkDropdownMenu($fontsize,parseFloat(styleInfo['font-size']));var $lineHeight=$container.find('.note-height[data-name=lineheight]');checkDropdownMenu($lineHeight,parseFloat(styleInfo['line-height']));btnState('.btn[data-event="bold"]',function(){return styleInfo['font-bold']==='bold';});btnState('.btn[data-event="italic"]',function(){return styleInfo['font-italic']==='italic';});btnState('.btn[data-event="underline"]',function(){return styleInfo['font-underline']==='underline';});btnState('.btn[data-event="strikethrough"]',function(){return styleInfo['font-strikethrough']==='strikethrough';});btnState('.btn[data-event="superscript"]',function(){return styleInfo['font-superscript']==='superscript';});btnState('.btn[data-event="subscript"]',function(){return styleInfo['font-subscript']==='subscript';});btnState('.btn[data-event="justifyLeft"]',function(){return styleInfo['text-align']==='left'||styleInfo['text-align']==='start';});btnState('.btn[data-event="justifyCenter"]',function(){return styleInfo['text-align']==='center';});btnState('.btn[data-event="justifyRight"]',function(){return styleInfo['text-align']==='right';});btnState('.btn[data-event="justifyFull"]',function(){return styleInfo['text-align']==='justify';});btnState('.btn[data-event="insertUnorderedList"]',function(){return styleInfo['list-style']==='unordered';});btnState('.btn[data-event="insertOrderedList"]',function(){return styleInfo['list-style']==='ordered';});};this.updateRecentColor=function(button,eventName,value){var $color=$(button).closest('.note-color');var $recentColor=$color.find('.note-recent-color');var colorInfo=JSON.parse($recentColor.attr('data-value'));var sKey=eventName==='backColor'?'background-color':'color';colorInfo[eventName]=value;$recentColor.attr('data-value',JSON.stringify(colorInfo));$recentColor.css(sKey,value);};};var Toolbar=function(){var button=new Button();this.update=function($toolbar,styleInfo){button.update($toolbar,styleInfo);};this.updateRecentColor=function(buttonNode,eventName,value){button.updateRecentColor(buttonNode,eventName,value);};this.activate=function($toolbar){$toolbar.find('button, .btn').not('.btn[data-event="codeview"]').removeClass('disabled');};this.deactivate=function($toolbar){$toolbar.find('button, .btn').not('.btn[data-event="codeview"]').addClass('disabled');};this.updateFullscreen=function($container,bFullscreen){var $btn=$container.find('.btn[data-event="fullscreen"]');$btn.toggleClass('active',bFullscreen);};this.updateCodeview=function($container,isCodeview){var $btn=$container.find('.btn[data-event="codeview"]');$btn.toggleClass('active',isCodeview);if(isCodeview){this.deactivate($container);}else{this.activate($container);}};this.get=function($editable,name){var $toolbar=dom.makeLayoutInfo($editable).toolbar();return $toolbar.find('[data-name='+name+']');};this.setButtonState=function($editable,name,isActive){isActive=(isActive===false)?false:true;var $button=this.get($editable,name);$button.toggleClass('active',isActive);};};var EDITABLE_PADDING=24;var Statusbar=function(){var $document=$(document);this.attach=function(layoutInfo,options){if(!options.disableResizeEditor){layoutInfo.statusbar().on('mousedown',hStatusbarMousedown);}};var hStatusbarMousedown=function(event){event.preventDefault();event.stopPropagation();var $editable=dom.makeLayoutInfo(event.target).editable();var editableTop=$editable.offset().top-$document.scrollTop();var layoutInfo=dom.makeLayoutInfo(event.currentTarget||event.target);var options=layoutInfo.editor().data('options');$document.on('mousemove',function(event){var nHeight=event.clientY-(editableTop+EDITABLE_PADDING);nHeight=(options.minHeight>0)?Math.max(nHeight,options.minHeight):nHeight;nHeight=(options.maxHeight>0)?Math.min(nHeight,options.maxHeight):nHeight;$editable.height(nHeight);}).one('mouseup',function(){$document.off('mousemove');});};};var Popover=function(){var button=new Button();var posFromPlaceholder=function(placeholder,isAirMode){var $placeholder=$(placeholder);var pos=isAirMode?$placeholder.offset():$placeholder.position();var height=$placeholder.outerHeight(true);return{left:pos.left,top:pos.top+height};};var showPopover=function($popover,pos){$popover.css({display:'block',left:pos.left,top:pos.top});};var PX_POPOVER_ARROW_OFFSET_X=20;this.update=function($popover,styleInfo,isAirMode){button.update($popover,styleInfo);var $linkPopover=$popover.find('.note-link-popover');if(styleInfo.anchor){var $anchor=$linkPopover.find('a');var href=$(styleInfo.anchor).attr('href');var target=$(styleInfo.anchor).attr('target');$anchor.attr('href',href).html(href);if(!target){$anchor.removeAttr('target');}else{$anchor.attr('target','_blank');}
showPopover($linkPopover,posFromPlaceholder(styleInfo.anchor,isAirMode));}else{$linkPopover.hide();}
var $imagePopover=$popover.find('.note-image-popover');if(styleInfo.image){showPopover($imagePopover,posFromPlaceholder(styleInfo.image,isAirMode));}else{$imagePopover.hide();}
var $airPopover=$popover.find('.note-air-popover');if(isAirMode&&!styleInfo.range.isCollapsed()){var rect=list.last(styleInfo.range.getClientRects());if(rect){var bnd=func.rect2bnd(rect);showPopover($airPopover,{left:Math.max(bnd.left+bnd.width/2-PX_POPOVER_ARROW_OFFSET_X,0),top:bnd.top+bnd.height});}}else{$airPopover.hide();}};this.updateRecentColor=function(button,eventName,value){button.updateRecentColor(button,eventName,value);};this.hide=function($popover){$popover.children().hide();};};var Handle=function(handler){var $document=$(document);var hHandleMousedown=function(event){if(dom.isControlSizing(event.target)){event.preventDefault();event.stopPropagation();var layoutInfo=dom.makeLayoutInfo(event.target),$handle=layoutInfo.handle(),$popover=layoutInfo.popover(),$editable=layoutInfo.editable(),$editor=layoutInfo.editor();var target=$handle.find('.note-control-selection').data('target'),$target=$(target),posStart=$target.offset(),scrollTop=$document.scrollTop();var isAirMode=$editor.data('options').airMode;$document.on('mousemove',function(event){handler.invoke('editor.resizeTo',{x:event.clientX-posStart.left,y:event.clientY-(posStart.top-scrollTop)},$target,!event.shiftKey);handler.invoke('handle.update',$handle,{image:target},isAirMode);handler.invoke('popover.update',$popover,{image:target},isAirMode);}).one('mouseup',function(){$document.off('mousemove');handler.invoke('editor.afterCommand',$editable);});if(!$target.data('ratio')){$target.data('ratio',$target.height()/$target.width());}}};this.attach=function(layoutInfo){layoutInfo.handle().on('mousedown',hHandleMousedown);};this.update=function($handle,styleInfo,isAirMode){var $selection=$handle.find('.note-control-selection');if(styleInfo.image){var $image=$(styleInfo.image);var pos=isAirMode?$image.offset():$image.position();var imageSize={w:$image.outerWidth(true),h:$image.outerHeight(true)};$selection.css({display:'block',left:pos.left,top:pos.top,width:imageSize.w,height:imageSize.h}).data('target',styleInfo.image);var sizingText=imageSize.w+'x'+imageSize.h;$selection.find('.note-control-selection-info').text(sizingText);}else{$selection.hide();}};this.hide=function($handle){$handle.children().hide();};};var Fullscreen=function(handler){var $window=$(window);var $scrollbar=$('html, body');this.toggle=function(layoutInfo){var $editor=layoutInfo.editor(),$toolbar=layoutInfo.toolbar(),$editable=layoutInfo.editable(),$codable=layoutInfo.codable();var resize=function(size){$editable.css('height',size.h);$codable.css('height',size.h);if($codable.data('cmeditor')){$codable.data('cmeditor').setsize(null,size.h);}};$editor.toggleClass('fullscreen');var isFullscreen=$editor.hasClass('fullscreen');if(isFullscreen){$editable.data('orgheight',$editable.css('height'));$window.on('resize',function(){resize({h:$window.height()-$toolbar.outerHeight()});}).trigger('resize');$scrollbar.css('overflow','hidden');$toolbar.css('top',0);}else{$window.off('resize');resize({h:$editable.data('orgheight')});$scrollbar.css('overflow','visible');}
handler.invoke('toolbar.updateFullscreen',$toolbar,isFullscreen);};};var CodeMirror;if(agent.hasCodeMirror){if(agent.isSupportAmd){require(['CodeMirror'],function(cm){CodeMirror=cm;});}else{CodeMirror=window.CodeMirror;}}
var Codeview=function(handler){this.sync=function(layoutInfo){var isCodeview=handler.invoke('codeview.isActivated',layoutInfo);if(isCodeview&&agent.hasCodeMirror){layoutInfo.codable().data('cmEditor').save();}};this.isActivated=function(layoutInfo){var $editor=layoutInfo.editor();return $editor.hasClass('codeview');};this.toggle=function(layoutInfo){if(this.isActivated(layoutInfo)){this.deactivate(layoutInfo);}else{this.activate(layoutInfo);}};this.activate=function(layoutInfo){var $editor=layoutInfo.editor(),$toolbar=layoutInfo.toolbar(),$editable=layoutInfo.editable(),$codable=layoutInfo.codable(),$popover=layoutInfo.popover(),$handle=layoutInfo.handle();var options=$editor.data('options');var codeString=dom.html($editable,false);function beautifyHTML(code,level,insideLastBlock,dictionary){var openTag=code.indexOf('<');var closeTag=code.indexOf('>');var chunk;if(openTag===0){chunk=code.substring(0,closeTag+1);code=code.substring(closeTag+1);if(chunk.indexOf("</")===0){level--;nsideLastBlock=false;}else{if(insideLastBlock){level++;}
var found=false;for(var i=0;i<dictionary.length;i++){if(chunk.indexOf(dictionary[i])===0){found=true;break;}}
if(!found){insideLastBlock=true;}else{insideLastBlock=false;}}}else{chunk=code.substring(0,openTag);code=code.substring(openTag);if(insideLastBlock){level++;}
insideLastBlock=false;}
chunk=new Array(level+1).join('    ')+chunk.trim();if(code.length===0){return chunk;}
return chunk+"\n"+beautifyHTML(code.trim(),level,insideLastBlock,dictionary);}
var selfCloseTags=['<img','<br','<hr'];codeString=beautifyHTML(codeString,0,false,selfCloseTags);$codable.val(codeString);var buttonHeight=$toolbar.find('.btn[data-event=codeview]').height();var areaHeight=$(window).height()-buttonHeight;$codable.height($editable.height());handler.invoke('toolbar.updateCodeview',$toolbar,true);handler.invoke('popover.hide',$popover);handler.invoke('handle.hide',$handle);$editor.addClass('codeview');$codable.focus();if(agent.hasCodeMirror){var cmEditor=CodeMirror.fromTextArea($codable[0],options.codemirror);if(options.codemirror.tern){var server=new CodeMirror.TernServer(options.codemirror.tern);cmEditor.ternServer=server;cmEditor.on('cursorActivity',function(cm){server.updateArgHints(cm);});}
if($editor.hasClass('fullscreen')){cmEditor.setSize(null,areaHeight);}
else{cmEditor.setSize(null,$editable.outerHeight());}
$codable.data('cmEditor',cmEditor);}};this.deactivate=function(layoutInfo){var $holder=layoutInfo.holder(),$editor=layoutInfo.editor(),$toolbar=layoutInfo.toolbar(),$editable=layoutInfo.editable(),$codable=layoutInfo.codable();var options=$editor.data('options');if(agent.hasCodeMirror){var cmEditor=$codable.data('cmEditor');$codable.val(cmEditor.getValue());cmEditor.toTextArea();}
var value=dom.value($codable,options.prettifyHtml)||dom.emptyPara;var isChange=$editable.html()!==value;$editable.html(value);$editable.height(options.height?$codable.height():'auto');$editor.removeClass('codeview');if(isChange){handler.bindCustomEvent($holder,$editable.data('callbacks'),'change')($editable.html(),$editable);}
$editable.focus();handler.invoke('toolbar.updateCodeview',$toolbar,false);};};var DragAndDrop=function(handler){var $document=$(document);this.attach=function(layoutInfo,options){if(options.airMode||options.disableDragAndDrop){$document.on('drop',function(e){e.preventDefault();});}else{this.attachDragAndDropEvent(layoutInfo,options);}};this.attachDragAndDropEvent=function(layoutInfo,options){var collection=$(),$editor=layoutInfo.editor(),$dropzone=layoutInfo.dropzone(),$dropzoneMessage=$dropzone.find('.note-dropzone-message');$document.on('dragenter',function(e){var isCodeview=handler.invoke('codeview.isActivated',layoutInfo);var hasEditorSize=$editor.width()>0&&$editor.height()>0;if(!isCodeview&&!collection.length&&hasEditorSize){$editor.addClass('dragover');$dropzone.width($editor.width());$dropzone.height($editor.height());$dropzoneMessage.text(options.langInfo.image.dragImageHere);}
collection=collection.add(e.target);}).on('dragleave',function(e){collection=collection.not(e.target);if(!collection.length){$editor.removeClass('dragover');}}).on('drop',function(){collection=$();$editor.removeClass('dragover');});$dropzone.on('dragenter',function(){$dropzone.addClass('hover');$dropzoneMessage.text(options.langInfo.image.dropImage);}).on('dragleave',function(){$dropzone.removeClass('hover');$dropzoneMessage.text(options.langInfo.image.dragImageHere);});$dropzone.on('drop',function(event){var dataTransfer=event.originalEvent.dataTransfer;var layoutInfo=dom.makeLayoutInfo(event.currentTarget||event.target);if(dataTransfer&&dataTransfer.files&&dataTransfer.files.length){event.preventDefault();layoutInfo.editable().focus();handler.insertImages(layoutInfo,dataTransfer.files);}else{var insertNodefunc=function(){layoutInfo.holder().materialnote('insertNode',this);};for(var i=0,len=dataTransfer.types.length;i<len;i++){var type=dataTransfer.types[i];var content=dataTransfer.getData(type);if(type.toLowerCase().indexOf('text')>-1){layoutInfo.holder().materialnote('pasteHTML',content);}else{$(content).each(insertNodefunc);}}}}).on('dragover',false);};};var Clipboard=function(handler){var $paste;this.attach=function(layoutInfo){if(window.clipboardData||agent.isFF){$paste=$('<div />').attr('contenteditable',true).css({position:'absolute',left:-100000,'opacity':0});layoutInfo.editable().after($paste);$paste.one('paste',hPasteClipboardImage);layoutInfo.editable().on('keydown',function(e){if(e.ctrlKey&&e.keyCode===86){handler.invoke('saveRange',layoutInfo.editable());if($paste){$paste.focus();}}});}
layoutInfo.editable().on('paste',hPasteClipboardImage);};var hPasteClipboardImage=function(event){var clipboardData=event.originalEvent.clipboardData;var layoutInfo=dom.makeLayoutInfo(event.currentTarget||event.target);var $editable=layoutInfo.editable();if(!clipboardData||!clipboardData.items||!clipboardData.items.length){var callbacks=$editable.data('callbacks');if(!callbacks.onImageUpload){return;}
setTimeout(function(){if(!$paste){return;}
var imgNode=$paste[0].firstChild;if(!imgNode){return;}
handler.invoke('restoreRange',$editable);if(!dom.isImg(imgNode)){handler.invoke('pasteHTML',$editable,$paste.html());}else{var datauri=imgNode.src;var data=atob(datauri.split(',')[1]);var array=new Uint8Array(data.length);for(var i=0;i<data.length;i++){array[i]=data.charCodeAt(i);}
var blob=new Blob([array],{type:'image/png'});blob.name='clipboard.png';handler.invoke('focus',$editable);handler.insertImages(layoutInfo,[blob]);}
$paste.remove();},0);return;}
var item=list.head(clipboardData.items);var isClipboardImage=item.kind==='file'&&item.type.indexOf('image/')!==-1;if(isClipboardImage){handler.insertImages(layoutInfo,[item.getAsFile()]);}
handler.invoke('editor.afterCommand',$editable);};};var LinkDialog=function(handler){var toggleBtn=function($btn,isEnable){$btn.toggleClass('disabled',!isEnable);$btn.attr('disabled',!isEnable);};var bindEnterKey=function($input,$btn){$input.on('keypress',function(event){if(event.keyCode===key.code.ENTER){$btn.trigger('click');}});};this.showLinkDialog=function($editable,$dialog,linkInfo){return $.Deferred(function(deferred){var $linkDialog=$dialog.find('.note-link-dialog');var $linkText=$linkDialog.find('.note-link-text'),$linkTextLabel=$linkText.next('label'),$linkUrl=$linkDialog.find('.note-link-url'),$linkBtn=$linkDialog.find('.note-link-btn'),$closeBtn=$linkDialog.find('.btnClose');var $openInNewWindow=$linkDialog.find('input[type=checkbox]');$linkDialog.materialModal();$linkDialog.materialModal("open");$linkText.val(linkInfo.text);if(linkInfo.text.length>0)$linkTextLabel.addClass('active');$linkText.on('keyup',function(){toggleBtn($linkBtn,$linkText.val()&&$linkUrl.val());linkInfo.text=$linkText.val();});$closeBtn.click(function(event){event.preventDefault();$linkDialog.materialModal("close");});if(!linkInfo.url){linkInfo.url=linkInfo.text||'http://';toggleBtn($linkBtn,linkInfo.text);}
$linkUrl.on('keyup',function(){toggleBtn($linkBtn,$linkText.val()&&$linkUrl.val());if(!linkInfo.text){$linkTextLabel.addClass('active');$linkText.val($linkUrl.val());}}).val(linkInfo.url).trigger('focus').trigger('select');bindEnterKey($linkUrl,$linkBtn);bindEnterKey($linkText,$linkBtn);$openInNewWindow.prop('checked',linkInfo.newWindow);$linkBtn.one('click',function(event){event.preventDefault();deferred.resolve({range:linkInfo.range,url:$linkUrl.val(),text:$linkText.val(),newWindow:$openInNewWindow.is(':checked')});$('.note-link-text').val('');$('.note-link-text').next('label').removeClass('active');$('.note-link-url').val('');$linkDialog.materialModal("close");});}).promise();};this.show=function(layoutInfo){var $editor=layoutInfo.editor(),$dialog=layoutInfo.dialog(),$editable=layoutInfo.editable(),$popover=layoutInfo.popover(),linkInfo=handler.invoke('editor.getLinkInfo',$editable);var options=$editor.data('options');handler.invoke('editor.saveRange',$editable);this.showLinkDialog($editable,$dialog,linkInfo).then(function(linkInfo){handler.invoke('editor.restoreRange',$editable);handler.invoke('editor.createLink',$editable,linkInfo,options);handler.invoke('popover.hide',$popover);}).fail(function(){handler.invoke('editor.restoreRange',$editable);});};};var ImageDialog=function(handler){var toggleBtn=function($btn,isEnable){$btn.toggleClass('disabled',!isEnable);$btn.attr('disabled',!isEnable);};var bindEnterKey=function($input,$btn){$input.on('keypress',function(event){if(event.keyCode===key.code.ENTER){$btn.trigger('click');}});};this.show=function(layoutInfo){var $dialog=layoutInfo.dialog(),$editable=layoutInfo.editable();handler.invoke('editor.saveRange',$editable);this.showImageDialog($editable,$dialog).then(function(data){handler.invoke('editor.restoreRange',$editable);if(typeof data==='string'){handler.invoke('editor.insertImage',$editable,data);}else{handler.insertImages(layoutInfo,data);}}).fail(function(){handler.invoke('editor.restoreRange',$editable);});};this.showImageDialog=function($editable,$dialog){return $.Deferred(function(deferred){var $imageDialog=$dialog.find('.note-image-dialog');var $imageInput=$dialog.find('.note-image-input'),$imageUrl=$dialog.find('.note-image-url'),$imageBtn=$dialog.find('.note-image-btn'),$closeBtn=$imageDialog.find('.btnClose');$imageDialog.materialModal("open");$imageInput.replaceWith($imageInput.clone().on('change',function(){deferred.resolve(this.files||this.value);$imageUrl.val('');$imageDialog.materialModal("close");deferred.resolve();}).val(''));$imageBtn.click(function(event){event.preventDefault();deferred.resolve($imageUrl.val());$imageUrl.val('');$imageDialog.materialModal("close");deferred.resolve();});$closeBtn.click(function(event){event.preventDefault();$imageDialog.materialModal("close");});$imageUrl.on('keyup paste',function(event){var url;if(event.type==='paste'){url=event.originalEvent.clipboardData.getData('text');}else{url=$imageUrl.val();}
toggleBtn($imageBtn,url);});bindEnterKey($imageUrl,$imageBtn);});};};var HelpDialog=function(handler){this.showHelpDialog=function($editable,$dialog){return $.Deferred(function(deferred){var $helpDialog=$dialog.find('.note-help-dialog');$helpDialog.materialModal("open");deferred.resolve();}).promise();};this.show=function(layoutInfo){var $dialog=layoutInfo.dialog(),$editable=layoutInfo.editable();handler.invoke('editor.saveRange',$editable,true);this.showHelpDialog($editable,$dialog).then(function(){handler.invoke('editor.restoreRange',$editable);});};};var EventHandler=function(){var modules=this.modules={editor:new Editor(this),toolbar:new Toolbar(this),statusbar:new Statusbar(this),popover:new Popover(this),handle:new Handle(this),fullscreen:new Fullscreen(this),codeview:new Codeview(this),dragAndDrop:new DragAndDrop(this),clipboard:new Clipboard(this),linkDialog:new LinkDialog(this),imageDialog:new ImageDialog(this),helpDialog:new HelpDialog(this)};this.invoke=function(){var moduleAndMethod=list.head(list.from(arguments));var args=list.tail(list.from(arguments));var splits=moduleAndMethod.split('.');var hasSeparator=splits.length>1;var moduleName=hasSeparator&&list.head(splits);var methodName=hasSeparator?list.last(splits):list.head(splits);var module=this.getModule(moduleName);var method=module[methodName];return method&&method.apply(module,args);};this.getModule=function(moduleName){return this.modules[moduleName]||this.modules.editor;};var bindCustomEvent=this.bindCustomEvent=function($holder,callbacks,eventNamespace){return function(){var callback=callbacks[func.namespaceToCamel(eventNamespace,'on')];if(callback){callback.apply($holder[0],arguments);}
return $holder.trigger('materialnote.'+eventNamespace,arguments);};};this.insertImages=function(layoutInfo,files){var $editor=layoutInfo.editor(),$editable=layoutInfo.editable(),$holder=layoutInfo.holder();var callbacks=$editable.data('callbacks');var options=$editor.data('options');if(callbacks.onImageUpload){bindCustomEvent($holder,callbacks,'image.upload')(files);}else{$.each(files,function(idx,file){var filename=file.name;if(options.maximumImageFileSize&&options.maximumImageFileSize<file.size){bindCustomEvent($holder,callbacks,'image.upload.error')(options.langInfo.image.maximumFileSizeError);}else{async.readFileAsDataURL(file).then(function(sDataURL){modules.editor.insertImage($editable,sDataURL,filename);}).fail(function(){bindCustomEvent($holder,callbacks,'image.upload.error')(options.langInfo.image.maximumFileSizeError);});}});}};var commands={showLinkDialog:function(layoutInfo){modules.linkDialog.show(layoutInfo);},showImageDialog:function(layoutInfo){modules.imageDialog.show(layoutInfo);},showHelpDialog:function(layoutInfo){modules.helpDialog.show(layoutInfo);},fullscreen:function(layoutInfo){modules.fullscreen.toggle(layoutInfo);},codeview:function(layoutInfo){modules.codeview.toggle(layoutInfo);}};var hMousedown=function(event){if(dom.isImg(event.target)){event.preventDefault();}};var hKeyupAndMouseup=function(event){var layoutInfo=dom.makeLayoutInfo(event.currentTarget||event.target);modules.editor.removeBogus(layoutInfo.editable());hToolbarAndPopoverUpdate(event);};var hToolbarAndPopoverUpdate=function(event){setTimeout(function(){var layoutInfo=dom.makeLayoutInfo(event.currentTarget||event.target);var styleInfo=modules.editor.currentStyle(event.target);if(!styleInfo){return;}
var isAirMode=layoutInfo.editor().data('options').airMode;if(!isAirMode){modules.toolbar.update(layoutInfo.toolbar(),styleInfo);}
modules.popover.update(layoutInfo.popover(),styleInfo,isAirMode);modules.handle.update(layoutInfo.handle(),styleInfo,isAirMode);},0);};var hScroll=function(event){var layoutInfo=dom.makeLayoutInfo(event.currentTarget||event.target);modules.popover.hide(layoutInfo.popover());modules.handle.hide(layoutInfo.handle());};var hToolbarAndPopoverMousedown=function(event){var $btn=$(event.target).closest('[data-event]');if($btn.length){event.preventDefault();}};var hToolbarAndPopoverClick=function(event){var $btn=$(event.target).closest('[data-event]');if($btn.length){var eventName=$btn.attr('data-event'),value=$btn.attr('data-value'),hide=$btn.attr('data-hide');var layoutInfo=dom.makeLayoutInfo(event.target);var $target;if($.inArray(eventName,['resize','floatMe','removeMedia','imageShape','imageClass'])!==-1){var $selection=layoutInfo.handle().find('.note-control-selection');$target=$($selection.data('target'));}
if(hide){$btn.parents('.popover').hide();}
if($.isFunction($.materialnote.pluginEvents[eventName])){$.materialnote.pluginEvents[eventName](event,modules.editor,layoutInfo,value);}else if(modules.editor[eventName]){var $editable=layoutInfo.editable();$editable.focus();modules.editor[eventName]($editable,value,$target);event.preventDefault();}else if(commands[eventName]){commands[eventName].call(this,layoutInfo);event.preventDefault();}
if($.inArray(eventName,['backColor','foreColor'])!==-1){var options=layoutInfo.editor().data('options',options);var module=options.airMode?modules.popover:modules.toolbar;module.updateRecentColor(list.head($btn),eventName,value);}
hToolbarAndPopoverUpdate(event);}};var gridUnit=26;var hDimensionPickerMove=function(event,options){var $picker=$(event.target.parentNode);var $dropdown=$picker.parent();var $dimensionDisplay=$picker.next();var $catcher=$picker.find('.note-dimension-picker-mousecatcher');var $highlighted=$picker.find('.note-dimension-picker-highlighted');var $unhighlighted=$picker.find('.note-dimension-picker-unhighlighted');var $hoverableOption=$dropdown.find("[id$='-hoverable']");var $borderedOption=$dropdown.find("[id$='-bordered']");var $stripedOption=$dropdown.find("[id$='-striped']");var $responsiveOption=$dropdown.find("[id$='-responsive']");var posOffset;if(event.offsetX===undefined){var posCatcher=$(event.target).offset();posOffset={x:event.pageX-posCatcher.left,y:event.pageY-posCatcher.top};}else{posOffset={x:event.offsetX,y:event.offsetY};}
var dim={c:Math.ceil(posOffset.x/gridUnit)||1,r:Math.ceil(posOffset.y/gridUnit)||1};var tableOptions=[];if($hoverableOption.is(':checked'))tableOptions.push('hoverable');if($borderedOption.is(':checked'))tableOptions.push('bordered');if($stripedOption.is(':checked'))tableOptions.push('striped');if($responsiveOption.is(':checked'))tableOptions.push('responsive-table');$highlighted.css({width:(dim.c*gridUnit)+'px',height:(dim.r*gridUnit)+'px'});$catcher.attr('data-value',dim.c+'x'+dim.r+'x'+tableOptions.join('x'));$unhighlighted.css({width:(options.insertTableMaxSize*gridUnit)+'px'});if(3<dim.r&&dim.r<options.insertTableMaxSize.row){$unhighlighted.css({height:((dim.r+1)*gridUnit)+'px'});}
$dimensionDisplay.html(dim.c+' x '+dim.r);};this.bindKeyMap=function(layoutInfo,keyMap){var $editor=layoutInfo.editor();var $editable=layoutInfo.editable();$editable.on('keydown',function(event){var keys=[];if(event.metaKey){keys.push('CMD');}
if(event.ctrlKey&&!event.altKey){keys.push('CTRL');}
if(event.shiftKey){keys.push('SHIFT');}
var keyName=key.nameFromCode[event.keyCode];if(keyName){keys.push(keyName);}
var pluginEvent;var keyString=keys.join('+');var eventName=keyMap[keyString];if(eventName){pluginEvent=$.materialnote.pluginEvents[keyString];if($.isFunction(pluginEvent)){if(pluginEvent(event,modules.editor,layoutInfo)){return false;}}
pluginEvent=$.materialnote.pluginEvents[eventName];if($.isFunction(pluginEvent)){pluginEvent(event,modules.editor,layoutInfo);}else if(modules.editor[eventName]){modules.editor[eventName]($editable,$editor.data('options'));event.preventDefault();}else if(commands[eventName]){commands[eventName].call(this,layoutInfo);event.preventDefault();}}else if(key.isEdit(event.keyCode)){modules.editor.afterCommand($editable);}});};this.attach=function(layoutInfo,options){if(options.shortcuts){this.bindKeyMap(layoutInfo,options.keyMap[agent.isMac?'mac':'pc']);}
layoutInfo.editable().on('mousedown',hMousedown);layoutInfo.editable().on('keyup mouseup',hKeyupAndMouseup);layoutInfo.editable().on('scroll',hScroll);modules.clipboard.attach(layoutInfo,options);modules.handle.attach(layoutInfo,options);layoutInfo.popover().on('click',hToolbarAndPopoverClick);layoutInfo.popover().on('mousedown',hToolbarAndPopoverMousedown);modules.dragAndDrop.attach(layoutInfo,options);if(!options.airMode){layoutInfo.toolbar().on('click',hToolbarAndPopoverClick);layoutInfo.toolbar().on('mousedown',hToolbarAndPopoverMousedown);modules.statusbar.attach(layoutInfo,options);}
var $catcherContainer=options.airMode?layoutInfo.popover():layoutInfo.toolbar();var $catcher=$catcherContainer.find('.note-dimension-picker-mousecatcher');$catcher.css({width:options.insertTableMaxSize.col*gridUnit+'px',height:options.insertTableMaxSize.row*gridUnit+'px'}).on('mousemove',function(event){hDimensionPickerMove(event,options);});layoutInfo.editor().data('options',options);if(!agent.isMSIE){setTimeout(function(){document.execCommand('styleWithCSS',0,options.styleWithSpan);},0);}
var history=new History(layoutInfo.editable());layoutInfo.editable().data('NoteHistory',history);layoutInfo.editable().data('callbacks',{onInit:options.onInit,onFocus:options.onFocus,onBlur:options.onBlur,onKeydown:options.onKeydown,onKeyup:options.onKeyup,onMousedown:options.onMousedown,onEnter:options.onEnter,onPaste:options.onPaste,onBeforeCommand:options.onBeforeCommand,onChange:options.onChange,onImageUpload:options.onImageUpload,onImageUploadError:options.onImageUploadError,onMediaDelete:options.onMediaDelete,onToolbarClick:options.onToolbarClick});if(dom.isTextarea(list.head(layoutInfo.holder()))){layoutInfo.holder().closest('form').submit(function(){layoutInfo.holder().val(layoutInfo.holder().code());});}};this.attachCustomEvent=function(layoutInfo,options){var $holder=layoutInfo.holder();var $editable=layoutInfo.editable();var callbacks=$editable.data('callbacks');$editable.focus(bindCustomEvent($holder,callbacks,'focus'));$editable.blur(bindCustomEvent($holder,callbacks,'blur'));$editable.keydown(function(event){if(event.keyCode===key.code.ENTER){bindCustomEvent($holder,callbacks,'enter').call(this,event);}
bindCustomEvent($holder,callbacks,'keydown').call(this,event);});$editable.keyup(bindCustomEvent($holder,callbacks,'keyup'));$editable.on('mousedown',bindCustomEvent($holder,callbacks,'mousedown'));$editable.on('mouseup',bindCustomEvent($holder,callbacks,'mouseup'));$editable.on('scroll',bindCustomEvent($holder,callbacks,'scroll'));$editable.on('paste',bindCustomEvent($holder,callbacks,'paste'));var changeEventName=agent.isMSIE?'DOMCharacterDataModified DOMSubtreeModified DOMNodeInserted':'input';$editable.on(changeEventName,function(){bindCustomEvent($holder,callbacks,'change')($editable.html(),$editable);});if(!options.airMode){layoutInfo.toolbar().click(bindCustomEvent($holder,callbacks,'toolbar.click'));layoutInfo.popover().click(bindCustomEvent($holder,callbacks,'popover.click'));}
if(dom.isTextarea(list.head($holder))){$holder.closest('form').submit(function(e){bindCustomEvent($holder,callbacks,'submit').call(this,e,$holder.code());});}
bindCustomEvent($holder,callbacks,'init')(layoutInfo);for(var i=0,len=$.materialnote.plugins.length;i<len;i++){if($.isFunction($.materialnote.plugins[i].init)){$.materialnote.plugins[i].init(layoutInfo);}}};this.detach=function(layoutInfo,options){layoutInfo.holder().off();layoutInfo.editable().off();layoutInfo.popover().off();layoutInfo.handle().off();layoutInfo.dialog().off();if(!options.airMode){layoutInfo.dropzone().off();layoutInfo.toolbar().off();layoutInfo.statusbar().off();}};};var Renderer=function(){var tplButton=function(label,options){var event=options.event;var value=options.value;var title=options.title;var style=options.style;var btnClassName=options.btnClassName;var className=options.className;var dropdown=options.dropdown;var hide=options.hide;if(!dropdown){var button=['<div class="waves-effect waves-light btn',(className?" "+className:'')+'"',(title?' title="'+title+'"':''),(style?' style="'+style+'"':''),(event?' data-event="'+event+'"':''),(value?' data-value=\''+value+'\'':''),(hide?' data-hide=\''+hide+'\'':''),' tabindex="-1">'+label+'</div>'].join('');return button;}else{var list=['<div class="btn-group',(className?" "+className:'')+'">','<button class="waves-effect waves-light btn dropdown '+(btnClassName?btnClassName:'')+'"',(title?' title="'+title+'"':''),(event?' data-event="'+event+'"':''),(value?' data-value=\''+value+'\'':''),(hide?' data-hide=\''+hide+'\'':''),'><i class="material-icons left">arrow_drop_down</i>'+label+'</button>',dropdown,'</div>'].join('');return list;}};var tplIconButton=function(iconClassName,options){var label='<i class="material-icons">'+iconClassName+'</i>';return tplButton(label,options);};var tplPopover=function(className,content){var $popover=$('<div class="'+className+' popover bottom in" style="display: none;">'+'<div class="arrow"></div>'+'<div class="popover-content">'+'</div>'+'</div>');$popover.find('.popover-content').append(content);return $popover;};var tplDialog=function(className,title,body,footer){var modal=['<div class="'+className+' modal modal-fixed-footer">','<div class="modal-content">',(title?'<h4>'+title+'</h4>':''),'<p>'+body+'</p>','</div>',(footer?'<div class="modal-footer">'+footer+'</div>':''),'</div>'].join('');return modal;};var tplButtonInfo={picture:function(lang,options){return tplIconButton(options.iconPrefix+options.icons.image.image,{event:'showImageDialog',title:lang.image.image,hide:true});},link:function(lang,options){return tplIconButton(options.iconPrefix+options.icons.link.link,{event:'showLinkDialog',title:lang.link.link,hide:true});},table:function(lang,options){var dropdown='<ul class="note-table dropdown-menu">'+'<div class="row">'+'<div class="col s6 preventDropClose"><input type="checkbox" id="'+materialUniqueId+'-bordered" checked="checked" /><label for="'+materialUniqueId+'-bordered">'+lang.table.bordered+'</label></div>'+'<div class="col s6 preventDropClose"><input type="checkbox" id="'+materialUniqueId+'-striped" checked="checked" /><label for="'+materialUniqueId+'-striped">'+lang.table.striped+'</label></div>'+'</div>'+'<div class="row">'+'<div class="col s6 preventDropClose"><input type="checkbox" id="'+materialUniqueId+'-hoverable" checked="checked" /><label for="'+materialUniqueId+'-hoverable">'+lang.table.hoverable+'</label></div>'+'<div class="col s6 preventDropClose"><input type="checkbox" id="'+materialUniqueId+'-responsive" checked="checked" /><label for="'+materialUniqueId+'-responsive">'+lang.table.responsive+'</label></div>'+'</div>'+'<div class="note-dimension-picker">'+'<div class="note-dimension-picker-mousecatcher" data-event="insertTable" data-value="1x1"></div>'+'<div class="note-dimension-picker-highlighted"></div>'+'<div class="note-dimension-picker-unhighlighted"></div>'+'</div>'+'<div class="note-dimension-display"> 1 x 1 </div>'+'</ul>';return tplIconButton(options.iconPrefix+options.icons.table.table,{title:lang.table.table,dropdown:dropdown});},style:function(lang,options){var items=options.styleTags.reduce(function(memo,v){var label=lang.style[v==='p'?'normal':v];return memo+'<li><div data-event="formatBlock" data-value="'+v+'">'+
((v==='p'||v==='pre')?label:'<'+v+'>'+label+'</'+v+'>')+'</div></li>';},'');return tplIconButton(options.iconPrefix+options.icons.style.style,{title:lang.style.style,dropdown:'<ul class="dropdown-menu largeDropdown">'+items+'</ul>'});},fontname:function(lang,options){var realFontList=[];var items=options.fontNames.reduce(function(memo,v){if(!agent.isFontInstalled(v)&&options.fontNamesIgnoreCheck.indexOf(v)===-1){return memo;}
realFontList.push(v);return memo+'<li><div data-event="fontName" href="#" data-value="'+v+'" style="font-family:\''+v+'\'">'+'<i class="material-icons tiny transparent">'+options.iconPrefix+options.icons.misc.check+'</i> '+v+'</div></li>';},'');var hasDefaultFont=agent.isFontInstalled(options.defaultFontName);var defaultFontName=(hasDefaultFont)?options.defaultFontName:realFontList[0];var label='<div class="note-current-fontname">'+defaultFontName+'</div>';return tplButton(label,{title:lang.font.name,className:'note-fontname',dropdown:'<ul class="dropdown-menu note-check">'+items+'</ul>'});},fontsize:function(lang,options){var items=options.fontSizes.reduce(function(memo,v){return memo+'<li><div data-event="fontSize" href="#" data-value="'+v+'">'+'<i class="material-icons tiny transparent">'+options.iconPrefix+options.icons.misc.check+'</i> '+v+'</div></li>';},'');var label='<span class="note-current-fontsize">15</span>';return tplButton(label,{title:lang.font.size,className:'note-fontsize',dropdown:'<ul class="dropdown-menu note-check">'+items+'</ul>'});},color:function(lang,options){var colorButtonLabel='<i class="material-icons">'+options.icons.color.recent+'</i>',colorButton=tplButton(colorButtonLabel,{className:'note-recent-color',title:lang.color.recent,style:"color: "+options.defaultTextColor+"; background-color: "+options.defaultBackColor+";",event:'color',value:'{"backColor": "'+options.defaultBackColor+'"}'});var dropdown='<ul id="colors" class="dropdown-menu">'+'<li>'+'<div class="col s12">'+'<ul class="tabs">'+'<li class="tab"><a href="#'+materialUniqueId+'-foreColor" class="active">'+lang.color.foreground+'</a></li>'+'<li class="tab"><a href="#'+materialUniqueId+'-backColor">'+lang.color.background+'</a></li>'+'</ul>'+'</div>'+'<div class="col s12 colorTable">'+'<div id="'+materialUniqueId+'-foreColor">'+'<div class="note-color-reset waves-effect waves-light btn" data-event="foreColor" data-value="'+options.defaultTextColor+'" title="'+lang.color.reset+'">'+
lang.color.resetToDefault+'</div>'+'<div class="colorName"></div>'+'<div class="note-color-palette" data-target-event="foreColor"></div>'+'</div>'+'<div id="'+materialUniqueId+'-backColor">'+'<div class="note-color-reset waves-effect waves-light btn" data-event="backColor"'+' data-value="'+options.defaultBackColor+'" title="'+lang.color.transparent+'">'+
lang.color.setTransparent+'</div>'+'<div class="colorName"></div>'+'<div class="note-color-palette" data-target-event="backColor"></div>'+'</div>'+'</div>'+'</li>'+'</ul>';var moreButton=tplButton('',{title:lang.color.more,className:'closeLeft',dropdown:dropdown});return moreButton+colorButton;},bold:function(lang,options){return tplIconButton(options.iconPrefix+options.icons.font.bold,{event:'bold',title:lang.font.bold});},italic:function(lang,options){return tplIconButton(options.iconPrefix+options.icons.font.italic,{event:'italic',title:lang.font.italic});},underline:function(lang,options){return tplIconButton(options.iconPrefix+options.icons.font.underline,{event:'underline',title:lang.font.underline});},strikethrough:function(lang,options){return tplIconButton(options.iconPrefix+options.icons.font.strikethrough,{event:'strikethrough',title:lang.font.strikethrough});},superscript:function(lang,options){return tplIconButton(options.iconPrefix+options.icons.font.superscript,{event:'superscript',title:lang.font.superscript});},subscript:function(lang,options){return tplIconButton(options.iconPrefix+options.icons.font.subscript,{event:'subscript',title:lang.font.subscript});},clear:function(lang,options){return tplIconButton(options.iconPrefix+options.icons.font.clear,{event:'removeFormat',title:lang.font.clear});},ul:function(lang,options){return tplIconButton(options.iconPrefix+options.icons.lists.unordered,{event:'insertUnorderedList',title:lang.lists.unordered});},ol:function(lang,options){return tplIconButton(options.iconPrefix+options.icons.lists.ordered,{event:'insertOrderedList',title:lang.lists.ordered});},leftButton:function(lang,options){return tplIconButton(options.iconPrefix+options.icons.paragraph.left,{title:lang.paragraph.left,event:'justifyLeft'});},centerButton:function(lang,options){return tplIconButton(options.iconPrefix+options.icons.paragraph.center,{title:lang.paragraph.center,event:'justifyCenter'});},rightButton:function(lang,options){return tplIconButton(options.iconPrefix+options.icons.paragraph.right,{title:lang.paragraph.right,event:'justifyRight'});},justifyButton:function(lang,options){return tplIconButton(options.iconPrefix+options.icons.paragraph.justify,{title:lang.paragraph.justify,event:'justifyFull'});},outdentButton:function(lang,options){return tplIconButton(options.iconPrefix+options.icons.paragraph.outdent,{title:lang.paragraph.outdent,event:'outdent'});},indentButton:function(lang,options){return tplIconButton(options.iconPrefix+options.icons.paragraph.indent,{title:lang.paragraph.indent,event:'indent'});},paragraph:function(lang,options){var leftButton=tplIconButton(options.iconPrefix+options.icons.paragraph.left,{title:lang.paragraph.left,event:'justifyLeft'});var centerButton=tplIconButton(options.iconPrefix+options.icons.paragraph.center,{title:lang.paragraph.center,event:'justifyCenter'});var rightButton=tplIconButton(options.iconPrefix+options.icons.paragraph.right,{title:lang.paragraph.right,event:'justifyRight'});var justifyButton=tplIconButton(options.iconPrefix+options.icons.paragraph.justify,{title:lang.paragraph.justify,event:'justifyFull'});var outdentButton=tplIconButton(options.iconPrefix+options.icons.paragraph.outdent,{title:lang.paragraph.outdent,event:'outdent'});var indentButton=tplIconButton(options.iconPrefix+options.icons.paragraph.indent,{title:lang.paragraph.indent,event:'indent'});var dropdown='<ul class="dropdown-menu">'+'<div class="note-align btn-group">'+
leftButton+centerButton+rightButton+justifyButton+'</div>'+'<div class="note-list btn-group">'+
indentButton+outdentButton+'</div>'+'</ul>';return tplIconButton(options.iconPrefix+options.icons.paragraph.paragraph,{title:lang.paragraph.paragraph,dropdown:dropdown});},lineheight:function(lang,options){var items=options.lineHeights.reduce(function(memo,v){return memo+'<li><div data-event="lineHeight" href="#" data-value="'+parseFloat(v)+'">'+'<i class="material-icons tiny transparent">'+options.iconPrefix+options.icons.misc.check+'</i> '+v+'</div></li>';},'');return tplIconButton(options.iconPrefix+options.icons.font.height,{title:lang.font.height,className:'note-height',dropdown:'<ul class="dropdown-menu note-check">'+items+'</ul>'});},help:function(lang,options){return tplIconButton(options.iconPrefix+options.icons.options.help,{event:'showHelpDialog',title:lang.options.help,hide:true});},fullscreen:function(lang,options){return tplIconButton(options.iconPrefix+options.icons.options.fullscreen,{event:'fullscreen',title:lang.options.fullscreen});},codeview:function(lang,options){return tplIconButton(options.iconPrefix+options.icons.options.codeview,{event:'codeview',title:lang.options.codeview});},undo:function(lang,options){return tplIconButton(options.iconPrefix+options.icons.history.undo,{event:'undo',title:lang.history.undo});},redo:function(lang,options){return tplIconButton(options.iconPrefix+options.icons.history.redo,{event:'redo',title:lang.history.redo});},hr:function(lang,options){return tplIconButton(options.iconPrefix+options.icons.hr.insert,{event:'insertHorizontalRule',title:lang.hr.insert});}};var tplPopovers=function(lang,options){var tplLinkPopover=function(){var linkButton=tplIconButton(options.iconPrefix+options.icons.link.edit,{title:lang.link.edit,event:'showLinkDialog',hide:true});var unlinkButton=tplIconButton(options.iconPrefix+options.icons.link.unlink,{title:lang.link.unlink,event:'unlink'});var content='<a href="http://www.google.com" target="_blank">www.google.com</a>&nbsp;&nbsp;'+'<div class="note-insert btn-group">'+
linkButton+unlinkButton+'</div>';return tplPopover('note-link-popover',content);};var tplImagePopover=function(){var fullButton=tplButton('<span class="note-fontsize-10">100%</span>',{title:lang.image.resizeFull,event:'resize',value:'1'});var halfButton=tplButton('<span class="note-fontsize-10">50%</span>',{title:lang.image.resizeHalf,event:'resize',value:'0.5'});var quarterButton=tplButton('<span class="note-fontsize-10">25%</span>',{title:lang.image.resizeQuarter,event:'resize',value:'0.25'});var leftButton=tplIconButton(options.iconPrefix+options.icons.image.floatLeft,{title:lang.image.floatLeft,event:'floatMe',value:'left'});var rightButton=tplIconButton(options.iconPrefix+options.icons.image.floatRight,{title:lang.image.floatRight,event:'floatMe',value:'right'});var justifyButton=tplIconButton(options.iconPrefix+options.icons.image.floatNone,{title:lang.image.floatNone,event:'floatMe',value:'none'});var roundedButton=tplIconButton(options.iconPrefix+options.icons.image.shapeRounded,{title:lang.image.shapeRounded,event:'imageClass',value:'img-rounded'});var circleButton=tplIconButton(options.iconPrefix+options.icons.image.shapeCircle,{title:lang.image.shapeCircle,event:'imageClass',value:'img-circle'});var thumbnailButton=tplIconButton(options.iconPrefix+options.icons.image.shapeThumbnail,{title:lang.image.shapeThumbnail,event:'imageClass',value:'img-thumbnail'});var borderedButton=tplIconButton(options.iconPrefix+options.icons.image.bordered,{title:lang.image.bordered,event:'imageClass',value:'img-bordered'});var noneButton=tplIconButton(options.iconPrefix+options.icons.image.shapeNone,{title:lang.image.shapeNone,event:'imageShape',value:''});var removeButton=tplIconButton(options.iconPrefix+options.icons.image.remove,{title:lang.image.remove,event:'removeMedia',value:'none'});var content='<div class="btn-group">'+leftButton+rightButton+justifyButton+'</div>'+'<div class="btn-group">'+roundedButton+circleButton+thumbnailButton+borderedButton+noneButton+'</div>'+'<div class="btn-group">'+removeButton+'</div>';return tplPopover('note-image-popover',content);};var tplAirPopover=function(){var $content=$('<div />');for(var idx=0,len=options.airPopover.length;idx<len;idx++){var group=options.airPopover[idx];var $group=$('<div class="note-'+group[0]+' btn-group">');for(var i=0,lenGroup=group[1].length;i<lenGroup;i++){var $button=$(tplButtonInfo[group[1][i]](lang,options));$button.attr('data-name',group[1][i]);$group.append($button);}
$content.append($group);}
return tplPopover('note-air-popover',$content.children());};var $notePopover=$('<div class="note-popover" />');$notePopover.append(tplLinkPopover());$notePopover.append(tplImagePopover());if(options.airMode){$notePopover.append(tplAirPopover());}
return $notePopover;};var tplHandles=function(){return'<div class="note-handle">'+'<div class="note-control-selection">'+'<div class="note-control-selection-bg"></div>'+'<div class="note-control-sizing note-control-se"></div>'+'<div class="note-control-selection-info"></div>'+'</div>'+'</div>';};var tplShortcut=function(title,keys){var keyClass='note-shortcut-col col-xs-6 note-shortcut-';var body=[];for(var i in keys){if(keys.hasOwnProperty(i)){body.push('<tr><td>'+keys[i].kbd+'</td><td>'+keys[i].text+'</td></tr>');}}
return'<thead><tr><th>'+title+'</th><th>'+'(keys)'+'</th></tr></thead>'+'<tbody>'+body.join('')+'</tbody>';};var tplShortcutText=function(lang){var keys=[{kbd:'⌘ + B',text:lang.font.bold},{kbd:'⌘ + I',text:lang.font.italic},{kbd:'⌘ + U',text:lang.font.underline},{kbd:'⌘ + \\',text:lang.font.clear}];return tplShortcut(lang.shortcut.textFormatting,keys);};var tplShortcutAction=function(lang){var keys=[{kbd:'⌘ + Z',text:lang.history.undo},{kbd:'⌘ + ⇧ + Z',text:lang.history.redo},{kbd:'⌘ + ]',text:lang.paragraph.indent},{kbd:'⌘ + [',text:lang.paragraph.outdent},{kbd:'⌘ + ENTER',text:lang.hr.insert}];return tplShortcut(lang.shortcut.action,keys);};var tplShortcutPara=function(lang){var keys=[{kbd:'⌘ + ⇧ + L',text:lang.paragraph.left},{kbd:'⌘ + ⇧ + E',text:lang.paragraph.center},{kbd:'⌘ + ⇧ + R',text:lang.paragraph.right},{kbd:'⌘ + ⇧ + J',text:lang.paragraph.justify},{kbd:'⌘ + ⇧ + NUM7',text:lang.lists.ordered},{kbd:'⌘ + ⇧ + NUM8',text:lang.lists.unordered}];return tplShortcut(lang.shortcut.paragraphFormatting,keys);};var tplShortcutStyle=function(lang){var keys=[{kbd:'⌘ + NUM0',text:lang.style.normal},{kbd:'⌘ + NUM1',text:lang.style.h1},{kbd:'⌘ + NUM2',text:lang.style.h2},{kbd:'⌘ + NUM3',text:lang.style.h3},{kbd:'⌘ + NUM4',text:lang.style.h4},{kbd:'⌘ + NUM5',text:lang.style.h5},{kbd:'⌘ + NUM6',text:lang.style.h6}];return tplShortcut(lang.shortcut.documentStyle,keys);};var tplExtraShortcuts=function(lang,options){var extraKeys=options.extraKeys;var keys=[];for(var key in extraKeys){if(extraKeys.hasOwnProperty(key)){keys.push({kbd:key,text:extraKeys[key]});}}
return tplShortcut(lang.shortcut.extraKeys,keys);};var tplShortcutTable=function(lang,options){var template=['<table class="striped hoverable">'+tplShortcutAction(lang,options)+'</table>','<table class="striped hoverable">'+tplShortcutStyle(lang,options)+'</table>','<table class="striped hoverable">'+tplShortcutText(lang,options)+'</table>','<table class="striped hoverable">'+tplShortcutPara(lang,options)+'</table>'].join('<br>');if(options.extraKeys){}
return template;};var replaceMacKeys=function(sHtml){return sHtml.replace(/⌘/g,'Ctrl').replace(/⇧/g,'Shift');};var tplDialogInfo={image:function(lang,options){var imageLimitation='';if(options.maximumImageFileSize){var unit=Math.floor(Math.log(options.maximumImageFileSize)/Math.log(1024));var readableSize=(options.maximumImageFileSize/Math.pow(1024,unit)).toFixed(2)*1+' '+' KMGTP'[unit]+'B';imageLimitation='<small>'+lang.image.maximumFileSize+' : '+readableSize+'</small>';}
var body='<div class="row">'+'<div class="col s12">'+'<div class="file-field input-field">'+'<div class="btn">'+'<span>'+lang.image.image+'</span>'+'<input class="note-image-input" name="files" type="file" />'+'</div>'+'<div class="file-path-wrapper">'+'<input class="file-path" type="text" />'+'</div>'+'</div>'+'</div>'+'</div>'+'<div class="row">'+'<div class="input-field col s12">'+'<input class="note-image-url" type="text" />'+'<label>'+lang.image.url+'</label>'+'</div>'+'</div>';var footer='<button href="#" class="waves-effect waves-light btn-flat note-image-btn disabled" disabled>'+lang.image.insert+'</button>'+'<button class="waves-effect waves-light btn-flat btnClose">'+lang.shortcut.close+'</button>';return tplDialog('note-image-dialog',lang.image.insert,body,footer);},link:function(lang,options){var body='<div class="row">'+'<div class="input-field col s12">'+'<input class="note-link-text" type="text" />'+'<label>'+lang.link.textToDisplay+'</label>'+'</div>'+'</div>'+'<div class="row">'+'<div class="input-field col s12">'+'<input class="note-link-url" type="text" value="http://" />'+'<label class="active">'+lang.link.url+'</label>'+'</div>'+'</div>'+
(!options.disableLinkTarget?'<div class="row">'+'<div class="col s12">'+'<input type="checkbox" id="'+materialUniqueId+'-noteInsertLinkNewWindow" checked="checked" />'+'<label for="'+materialUniqueId+'-noteInsertLinkNewWindow">'+lang.link.openInNewWindow+'</label>'+'</div>'+'</div>':'');var footer='<button href="#" class="waves-effect waves-light btn-flat note-link-btn disabled" disabled>'+lang.link.insert+'</button>'+'<button class="waves-effect waves-light btn-flat btnClose">'+lang.shortcut.close+'</button>';return tplDialog('note-link-dialog',lang.link.insert,body,footer);},help:function(lang,options){var body=(agent.isMac?tplShortcutTable(lang,options):replaceMacKeys(tplShortcutTable(lang,options)));var footer='<button href="#" class="waves-effect waves-light btn-flat modal-close">'+lang.shortcut.close+'</button>';return tplDialog('note-help-dialog',lang.shortcut.shortcuts,body,footer);}};var tplDialogs=function(lang,options){var dialogs='';$.each(tplDialogInfo,function(idx,tplDialog){dialogs+=tplDialog(lang,options);});return'<div class="note-dialog">'+dialogs+'</div>';};var tplStatusbar=function(){return'<div class="note-resizebar">'+'<div class="note-icon-bar"></div>'+'<div class="note-icon-bar"></div>'+'<div class="note-icon-bar"></div>'+'</div>';};var representShortcut=function(str){if(agent.isMac){str=str.replace('CMD','⌘').replace('SHIFT','⇧');}
return str.replace('BACKSLASH','\\').replace('SLASH','/').replace('LEFTBRACKET','[').replace('RIGHTBRACKET',']');};var createTooltip=function($container,keyMap,sPlacement){$(document).ready(function(){var invertedKeyMap=func.invertObject(keyMap);var $buttons=$container.find('.btn');$buttons.each(function(i,elBtn){var $btn=$(elBtn);var sShortcut=invertedKeyMap[$btn.data('event')];var text=$btn.attr('title');if(sShortcut){$btn.attr('data-tooltip',function(i,v){text=text+' ('+representShortcut(sShortcut)+')';$(this).removeAttr('title');return text;});}
$btn.attr('data-position','bottom');$btn.attr('data-tooltip',text);$btn.removeAttr('title');}).ckTooltip({container:$container,position:'top',delay:30});});};var createPalette=function($container,options){var colorInfo=options.colors;var colorTitles=options.colorTitles;$container.find('.note-color-palette').each(function(){var $palette=$(this),eventName=$palette.attr('data-target-event');var paletteContents=[];for(var row=0,lenRow=colorInfo.length;row<lenRow;row++){var colors=colorInfo[row];var titles=colorTitles[row];var buttons=[];for(var col=0,lenCol=colors.length;col<lenCol;col++){var color=colors[col];var title=titles[col];buttons.push(['<button type="button" class="note-color-btn" style="background-color:',color,';" data-event="',eventName,'" data-value="',color,'" data-description="',title,'" data-toggle="button" tabindex="-1"></button>'].join(''));}
paletteContents.push('<div class="note-color-row">'+buttons.join('')+'</div>');}
$palette.html(paletteContents.join(''));$palette.find('button').mouseenter(function(){$palette.siblings('.colorName').html($(this).data('description'));});$palette.mouseleave(function(){$(this).siblings('.colorName').html('');});});};this.createLayoutByAirMode=function($holder,options){var langInfo=options.langInfo;var keyMap=options.keyMap[agent.isMac?'mac':'pc'];var id=func.uniqueId();$holder.addClass('note-air-editor note-editable');$holder.attr({'id':'note-editor-'+id,'contentEditable':true});var body=document.body;var $popover=$(tplPopovers(langInfo,options));$popover.addClass('note-air-layout');$popover.attr('id','note-popover-'+id);$popover.appendTo(body);createTooltip($popover,keyMap);createPalette($popover,options);var $handle=$(tplHandles());$handle.addClass('note-air-layout');$handle.attr('id','note-handle-'+id);$handle.appendTo(body);var $dialog=$(tplDialogs(langInfo,options));$dialog.addClass('note-air-layout');$dialog.attr('id','note-dialog-'+id);$dialog.find('button.close, a.modal-close').click(function(){$(this).closest('.modal').materialModal("close");});$dialog.appendTo(body);};this.createLayoutByFrame=function($holder,options){var langInfo=options.langInfo;var $editor=$('<div class="note-editor"></div>');if(options.width){$editor.width(options.width);}
if(options.height>0){$('<div class="note-statusbar">'+(options.disableResizeEditor?'':tplStatusbar())+'</div>').prependTo($editor);}
var isContentEditable=!$holder.is(':disabled');var $editable=$('<div class="note-editable" contentEditable="'+isContentEditable+'"></div>').prependTo($editor);if(options.height){$editable.height(options.height);}
if(options.direction){$editable.attr('dir',options.direction);}
var placeholder=$holder.attr('placeholder')||options.placeholder;if(placeholder){$editable.attr('data-placeholder',placeholder);}
$editable.html(dom.html($holder));$('<textarea class="note-codable"></textarea>').prependTo($editor);var $toolbar=$('<div class="note-toolbar btn-toolbar" />');for(var idx=0,len=options.toolbar.length;idx<len;idx++){var groupName=options.toolbar[idx][0];var groupButtons=options.toolbar[idx][1];var $group=$('<div class="note-'+groupName+' btn-group" />');for(var i=0,btnLength=groupButtons.length;i<btnLength;i++){var buttonInfo=tplButtonInfo[groupButtons[i]];if(!$.isFunction(buttonInfo)){continue;}
var $button=$(buttonInfo(langInfo,options));$button.attr('data-name',groupButtons[i]);$group.append($button);}
$toolbar.append($group);}
$toolbar.prependTo($editor);var keyMap=options.keyMap[agent.isMac?'mac':'pc'];createPalette($toolbar,options);createTooltip($toolbar,keyMap,'bottom');function followingBar(){$(window).scroll(function(){var isFullscreen=$editor.hasClass('fullscreen');if(isFullscreen){console.log("fullscreen");return false;}
var toolbar=$editor.children('.note-toolbar');var toolbarHeight=toolbar.outerHeight();var editable=$editor.children('.note-editable');var editableHeight=editable.outerHeight();var editorWidth=$editor.width;var toolbarOffset,editorOffsetTop,editorOffsetBottom;var activateOffset,deactivateOffsetTop,deactivateOffsetBottom;var currentOffset;var relativeOffset;var otherBarHeight;otherBarHeight=$("."+options.otherStaticBarClass).outerHeight();if(!otherBarHeight)otherBarHeight=0;currentOffset=$(document).scrollTop();toolbarOffset=toolbar.offset().top;editorOffsetTop=$editor.offset().top;editorOffsetBottom=editorOffsetTop+editableHeight;activateOffset=toolbarOffset-otherBarHeight;deactivateOffsetBottom=editorOffsetBottom-otherBarHeight;deactivateOffsetTop=editorOffsetTop-otherBarHeight;if((currentOffset>activateOffset)&&(currentOffset<deactivateOffsetBottom)){relativeOffset=currentOffset-$editor.offset().top+otherBarHeight;toolbar.css({'top':relativeOffset+'px','z-index':2000});}else{if((currentOffset<toolbarOffset)&&(currentOffset<deactivateOffsetBottom)){toolbar.css({'top':0,'z-index':1052});if(currentOffset>deactivateOffsetTop){relativeOffset=currentOffset-$editor.offset().top+otherBarHeight;toolbar.css({'top':relativeOffset+'px','z-index':2000});}}}});}
if(options.followingToolbar){followingBar();}
var $popover=$(tplPopovers(langInfo,options)).prependTo($editor);createPalette($popover,options);createTooltip($popover,keyMap);$(tplHandles()).prependTo($editor);var $dialog=$(tplDialogs(langInfo,options)).prependTo($editor);$dialog.find('button.close, a.modal-close').click(function(){$(this).closest('.modal').materialModal("close");});$('<div class="note-dropzone"><div class="note-dropzone-message"></div></div>').prependTo($editor);$editor.insertAfter($holder);$holder.hide();};this.hasNoteEditor=function($holder){return this.noteEditorFromHolder($holder).length>0;};this.noteEditorFromHolder=function($holder){if($holder.hasClass('note-air-editor')){return $holder;}else if($holder.next().hasClass('note-editor')){return $holder.next();}else{return $();}};this.createLayout=function($holder,options){if(options.airMode){this.createLayoutByAirMode($holder,options);}else{this.createLayoutByFrame($holder,options);}};this.layoutInfoFromHolder=function($holder){var $editor=this.noteEditorFromHolder($holder);if(!$editor.length){return;}
$editor.data('holder',$holder);return dom.buildLayoutInfo($editor);};this.removeLayout=function($holder,layoutInfo,options){if(options.airMode){$holder.removeClass('note-air-editor note-editable').removeAttr('id contentEditable');layoutInfo.popover().remove();layoutInfo.handle().remove();layoutInfo.dialog().remove();}else{$holder.html(layoutInfo.editable().html());layoutInfo.editor().remove();$holder.show();}};this.getTemplate=function(){return{button:tplButton,iconButton:tplIconButton,dialog:tplDialog};};this.addButtonInfo=function(name,buttonInfo){tplButtonInfo[name]=buttonInfo;};this.addDialogInfo=function(name,dialogInfo){tplDialogInfo[name]=dialogInfo;};};$.materialnote=$.materialnote||{};$.extend($.materialnote,defaults);var renderer=new Renderer();var eventHandler=new EventHandler();$.extend($.materialnote,{renderer:renderer,eventHandler:eventHandler,core:{agent:agent,list:list,dom:dom,range:range},pluginEvents:{},plugins:[]});$.materialnote.addPlugin=function(plugin){$.materialnote.plugins.push(plugin);if(plugin.buttons){$.each(plugin.buttons,function(name,button){renderer.addButtonInfo(name,button);});}
if(plugin.dialogs){$.each(plugin.dialogs,function(name,dialog){renderer.addDialogInfo(name,dialog);});}
if(plugin.events){$.each(plugin.events,function(name,event){$.materialnote.pluginEvents[name]=event;});}
if(plugin.langs){$.each(plugin.langs,function(locale,lang){if($.materialnote.lang[locale]){$.extend($.materialnote.lang[locale],lang);}});}
if(plugin.options){$.extend($.materialnote.options,plugin.options);}};$.fn.extend({materialnote:function(){var type=$.type(list.head(arguments));var isExternalAPICalled=type==='string';var hasInitOptions=type==='object';var options=hasInitOptions?list.head(arguments):{};options=$.extend({},$.materialnote.options,options);options.icons=$.extend({},$.materialnote.options.icons,options.icons);options.langInfo=$.extend(true,{},$.materialnote.lang['en-US'],$.materialnote.lang[options.lang]);if(!isExternalAPICalled&&hasInitOptions){for(var i=0,len=$.materialnote.plugins.length;i<len;i++){var plugin=$.materialnote.plugins[i];if(options.plugin[plugin.name]){$.materialnote.plugins[i]=$.extend(true,plugin,options.plugin[plugin.name]);}}}
this.each(function(idx,holder){materialUniqueId=$(holder).attr('id');var $holder=$(holder);if(!renderer.hasNoteEditor($holder)){renderer.createLayout($holder,options);var layoutInfo=renderer.layoutInfoFromHolder($holder);$holder.data('layoutInfo',layoutInfo);eventHandler.attach(layoutInfo,options);eventHandler.attachCustomEvent(layoutInfo,options);}});var $first=this.first();if($first.length){var layoutInfo=renderer.layoutInfoFromHolder($first);if(isExternalAPICalled){var moduleAndMethod=list.head(list.from(arguments));var args=list.tail(list.from(arguments));var params=[moduleAndMethod,layoutInfo.editable()].concat(args);return eventHandler.invoke.apply(eventHandler,params);}else if(options.focus){layoutInfo.editable().focus();}}
$(this).each(function(index,editor){var tabs;var tabContainer;var toolbar;var isAir=false;if($(editor).hasClass('note-air-editor')){var id=$(this).attr('id');if(id)id=id.substring(id.lastIndexOf('-')+1,id.length);editor=$('#note-popover-'+id).find('.note-air-popover');tabContainer=editor.find('ul.tabs');tabs=editor.find('li.tab a');toolbar=$(editor).find('.popover-content button.dropdown');isAir=true;}else{editor=$(editor).next('.note-editor');tabContainer=editor.find('ul.tabs');tabs=editor.find('li.tab a');toolbar=$(editor).find('.note-toolbar button.dropdown');}
var go=true;function handleDropdowns(select,bar){var list=$(select).next('ul.dropdown-menu');var container=$(select).parent('.btn-group');list.slideUp(0);$('.preventDropClose').click(function(event){event.stopPropagation();});$(select).click(function(event){var btnOffset=Math.round($(select).parent('.btn-group').offset().left-toolbar.offset().left);var listBorderWidth=parseInt(list.css("border-left-width"));var editorWidth=editor.outerWidth();var listOffset=listBorderWidth;list.css({'max-width':editorWidth+'px'});var listWidth=list.outerWidth();var th=listWidth+btnOffset;if(th>=editorWidth){listOffset=th-editorWidth;if(!isAir){listOffset=listOffset+listBorderWidth;}}
list.css({'left':'-'+listOffset+'px'});var reopen=true;if(list.is(':visible'))reopen=false;bar.find('ul.dropdown-menu').slideUp(200);if(reopen){list.slideToggle(200);}
event.stopPropagation();});tabs.unbind().click(function(event){go=false;});}
$(window).click(function(event){if(go)editor.find('ul.dropdown-menu').slideUp(200);go=true;event.stopPropagation();});toolbar.each(function(index,select){handleDropdowns(select,editor);});tabContainer.tabs();});return this;},code:function(html){if(html===undefined){var $holder=this.first();if(!$holder.length){return;}
var layoutInfo=renderer.layoutInfoFromHolder($holder);var $editable=layoutInfo&&layoutInfo.editable();if($editable&&$editable.length){var isCodeview=eventHandler.invoke('codeview.isActivated',layoutInfo);eventHandler.invoke('codeview.sync',layoutInfo);return isCodeview?layoutInfo.codable().val():layoutInfo.editable().html();}
return dom.value($holder);}
this.each(function(i,holder){var layoutInfo=renderer.layoutInfoFromHolder($(holder));var $editable=layoutInfo&&layoutInfo.editable();if($editable){$editable.html(html);}});return this;},destroy:function(){this.each(function(idx,holder){var $holder=$(holder);if(!renderer.hasNoteEditor($holder)){return;}
var info=renderer.layoutInfoFromHolder($holder);var options=info.editor().data('options');eventHandler.detach(info,options);renderer.removeLayout($holder,info,options);});return this;}});}));;

/* /scrummer/static/src/js/libs/external/ion.rangeSlider.js defined in bundle 'scrummer.assets' */
(function(factory){if(typeof define==='function'&&define.amd){define(['jquery'],function($){factory($,document,window,navigator);});}else{factory(jQuery,document,window,navigator);}}(function($,document,window,navigator,undefined){"use strict";var plugin_count=0;var is_old_ie=(function(){var n=navigator.userAgent,r=/msie\s\d+/i,v;if(n.search(r)>0){v=r.exec(n).toString();v=v.split(" ")[1];if(v<9){$("html").addClass("lt-ie9");return true;}}
return false;}());if(!Function.prototype.bind){Function.prototype.bind=function bind(that){var target=this;var slice=[].slice;if(typeof target!="function"){throw new TypeError();}
var args=slice.call(arguments,1),bound=function(){if(this instanceof bound){var F=function(){};F.prototype=target.prototype;var self=new F();var result=target.apply(self,args.concat(slice.call(arguments)));if(Object(result)===result){return result;}
return self;}else{return target.apply(that,args.concat(slice.call(arguments)));}};return bound;};}
if(!Array.prototype.indexOf){Array.prototype.indexOf=function(searchElement,fromIndex){var k;if(this==null){throw new TypeError('"this" is null or not defined');}
var O=Object(this);var len=O.length>>>0;if(len===0){return-1;}
var n=+fromIndex||0;if(Math.abs(n)===Infinity){n=0;}
if(n>=len){return-1;}
k=Math.max(n>=0?n:len-Math.abs(n),0);while(k<len){if(k in O&&O[k]===searchElement){return k;}
k++;}
return-1;};}
var base_html='<span class="irs">'+'<span class="irs-line" tabindex="-1"><span class="irs-line-left"></span><span class="irs-line-mid"></span><span class="irs-line-right"></span></span>'+'<span class="irs-min">0</span><span class="irs-max">1</span>'+'<span class="irs-from">0</span><span class="irs-to">0</span><span class="irs-single">0</span>'+'</span>'+'<span class="irs-grid"></span>'+'<span class="irs-bar"></span>';var single_html='<span class="irs-bar-edge"></span>'+'<span class="irs-shadow shadow-single"></span>'+'<span class="irs-slider single"></span>';var double_html='<span class="irs-shadow shadow-from"></span>'+'<span class="irs-shadow shadow-to"></span>'+'<span class="irs-slider from"></span>'+'<span class="irs-slider to"></span>';var disable_html='<span class="irs-disable-mask"></span>';var IonRangeSlider=function(input,options,plugin_count){this.VERSION="2.1.4";this.input=input;this.plugin_count=plugin_count;this.current_plugin=0;this.calc_count=0;this.update_tm=0;this.old_from=0;this.old_to=0;this.old_min_interval=null;this.raf_id=null;this.dragging=false;this.force_redraw=false;this.no_diapason=false;this.is_key=false;this.is_update=false;this.is_start=true;this.is_finish=false;this.is_active=false;this.is_resize=false;this.is_click=false;this.$cache={win:$(window),body:$(document.body),input:$(input),cont:null,rs:null,min:null,max:null,from:null,to:null,single:null,bar:null,line:null,s_single:null,s_from:null,s_to:null,shad_single:null,shad_from:null,shad_to:null,edge:null,grid:null,grid_labels:[]};this.coords={x_gap:0,x_pointer:0,w_rs:0,w_rs_old:0,w_handle:0,p_gap:0,p_gap_left:0,p_gap_right:0,p_step:0,p_pointer:0,p_handle:0,p_single_fake:0,p_single_real:0,p_from_fake:0,p_from_real:0,p_to_fake:0,p_to_real:0,p_bar_x:0,p_bar_w:0,grid_gap:0,big_num:0,big:[],big_w:[],big_p:[],big_x:[]};this.labels={w_min:0,w_max:0,w_from:0,w_to:0,w_single:0,p_min:0,p_max:0,p_from_fake:0,p_from_left:0,p_to_fake:0,p_to_left:0,p_single_fake:0,p_single_left:0};var $inp=this.$cache.input,val=$inp.prop("value"),config,config_from_data,prop;config={type:"single",min:10,max:100,from:null,to:null,step:1,min_interval:0,max_interval:0,drag_interval:false,values:[],p_values:[],from_fixed:false,from_min:null,from_max:null,from_shadow:false,to_fixed:false,to_min:null,to_max:null,to_shadow:false,prettify_enabled:true,prettify_separator:" ",prettify:null,force_edges:false,keyboard:false,keyboard_step:5,grid:false,grid_margin:true,grid_num:4,grid_snap:false,hide_min_max:false,hide_from_to:false,prefix:"",postfix:"",max_postfix:"",decorate_both:true,values_separator:" — ",input_values_separator:";",disable:false,onStart:null,onChange:null,onFinish:null,onUpdate:null};config_from_data={type:$inp.data("type"),min:$inp.data("min"),max:$inp.data("max"),from:$inp.data("from"),to:$inp.data("to"),step:$inp.data("step"),min_interval:$inp.data("minInterval"),max_interval:$inp.data("maxInterval"),drag_interval:$inp.data("dragInterval"),values:$inp.data("values"),from_fixed:$inp.data("fromFixed"),from_min:$inp.data("fromMin"),from_max:$inp.data("fromMax"),from_shadow:$inp.data("fromShadow"),to_fixed:$inp.data("toFixed"),to_min:$inp.data("toMin"),to_max:$inp.data("toMax"),to_shadow:$inp.data("toShadow"),prettify_enabled:$inp.data("prettifyEnabled"),prettify_separator:$inp.data("prettifySeparator"),force_edges:$inp.data("forceEdges"),keyboard:$inp.data("keyboard"),keyboard_step:$inp.data("keyboardStep"),grid:$inp.data("grid"),grid_margin:$inp.data("gridMargin"),grid_num:$inp.data("gridNum"),grid_snap:$inp.data("gridSnap"),hide_min_max:$inp.data("hideMinMax"),hide_from_to:$inp.data("hideFromTo"),prefix:$inp.data("prefix"),postfix:$inp.data("postfix"),max_postfix:$inp.data("maxPostfix"),decorate_both:$inp.data("decorateBoth"),values_separator:$inp.data("valuesSeparator"),input_values_separator:$inp.data("inputValuesSeparator"),disable:$inp.data("disable")};config_from_data.values=config_from_data.values&&config_from_data.values.split(",");for(prop in config_from_data){if(config_from_data.hasOwnProperty(prop)){if(!config_from_data[prop]&&config_from_data[prop]!==0){delete config_from_data[prop];}}}
if(val){val=val.split(config_from_data.input_values_separator||options.input_values_separator||";");if(val[0]&&val[0]==+val[0]){val[0]=+val[0];}
if(val[1]&&val[1]==+val[1]){val[1]=+val[1];}
if(options&&options.values&&options.values.length){config.from=val[0]&&options.values.indexOf(val[0]);config.to=val[1]&&options.values.indexOf(val[1]);}else{config.from=val[0]&&+val[0];config.to=val[1]&&+val[1];}}
$.extend(config,options);$.extend(config,config_from_data);this.options=config;this.validate();this.result={input:this.$cache.input,slider:null,min:this.options.min,max:this.options.max,from:this.options.from,from_percent:0,from_value:null,to:this.options.to,to_percent:0,to_value:null};this.init();};IonRangeSlider.prototype={init:function(is_update){this.no_diapason=false;this.coords.p_step=this.convertToPercent(this.options.step,true);this.target="base";this.toggleInput();this.append();this.setMinMax();if(is_update){this.force_redraw=true;this.calc(true);this.callOnUpdate();}else{this.force_redraw=true;this.calc(true);this.callOnStart();}
this.updateScene();},append:function(){var container_html='<span class="irs js-irs-'+this.plugin_count+'"></span>';this.$cache.input.before(container_html);this.$cache.input.prop("readonly",true);this.$cache.cont=this.$cache.input.prev();this.result.slider=this.$cache.cont;this.$cache.cont.html(base_html);this.$cache.rs=this.$cache.cont.find(".irs");this.$cache.min=this.$cache.cont.find(".irs-min");this.$cache.max=this.$cache.cont.find(".irs-max");this.$cache.from=this.$cache.cont.find(".irs-from");this.$cache.to=this.$cache.cont.find(".irs-to");this.$cache.single=this.$cache.cont.find(".irs-single");this.$cache.bar=this.$cache.cont.find(".irs-bar");this.$cache.line=this.$cache.cont.find(".irs-line");this.$cache.grid=this.$cache.cont.find(".irs-grid");if(this.options.type==="single"){this.$cache.cont.append(single_html);this.$cache.edge=this.$cache.cont.find(".irs-bar-edge");this.$cache.s_single=this.$cache.cont.find(".single");this.$cache.from[0].style.visibility="hidden";this.$cache.to[0].style.visibility="hidden";this.$cache.shad_single=this.$cache.cont.find(".shadow-single");}else{this.$cache.cont.append(double_html);this.$cache.s_from=this.$cache.cont.find(".from");this.$cache.s_to=this.$cache.cont.find(".to");this.$cache.shad_from=this.$cache.cont.find(".shadow-from");this.$cache.shad_to=this.$cache.cont.find(".shadow-to");this.setTopHandler();}
if(this.options.hide_from_to){this.$cache.from[0].style.display="none";this.$cache.to[0].style.display="none";this.$cache.single[0].style.display="none";}
this.appendGrid();if(this.options.disable){this.appendDisableMask();this.$cache.input[0].disabled=true;}else{this.$cache.cont.removeClass("irs-disabled");this.$cache.input[0].disabled=false;this.bindEvents();}
if(this.options.drag_interval){this.$cache.bar[0].style.cursor="ew-resize";}},setTopHandler:function(){var min=this.options.min,max=this.options.max,from=this.options.from,to=this.options.to;if(from>min&&to===max){this.$cache.s_from.addClass("type_last");}else if(to<max){this.$cache.s_to.addClass("type_last");}},changeLevel:function(target){switch(target){case"single":this.coords.p_gap=this.toFixed(this.coords.p_pointer-this.coords.p_single_fake);break;case"from":this.coords.p_gap=this.toFixed(this.coords.p_pointer-this.coords.p_from_fake);this.$cache.s_from.addClass("state_hover");this.$cache.s_from.addClass("type_last");this.$cache.s_to.removeClass("type_last");break;case"to":this.coords.p_gap=this.toFixed(this.coords.p_pointer-this.coords.p_to_fake);this.$cache.s_to.addClass("state_hover");this.$cache.s_to.addClass("type_last");this.$cache.s_from.removeClass("type_last");break;case"both":this.coords.p_gap_left=this.toFixed(this.coords.p_pointer-this.coords.p_from_fake);this.coords.p_gap_right=this.toFixed(this.coords.p_to_fake-this.coords.p_pointer);this.$cache.s_to.removeClass("type_last");this.$cache.s_from.removeClass("type_last");break;}},appendDisableMask:function(){this.$cache.cont.append(disable_html);this.$cache.cont.addClass("irs-disabled");},remove:function(){this.$cache.cont.remove();this.$cache.cont=null;this.$cache.line.off("keydown.irs_"+this.plugin_count);this.$cache.body.off("touchmove.irs_"+this.plugin_count);this.$cache.body.off("mousemove.irs_"+this.plugin_count);this.$cache.win.off("touchend.irs_"+this.plugin_count);this.$cache.win.off("mouseup.irs_"+this.plugin_count);if(is_old_ie){this.$cache.body.off("mouseup.irs_"+this.plugin_count);this.$cache.body.off("mouseleave.irs_"+this.plugin_count);}
this.$cache.grid_labels=[];this.coords.big=[];this.coords.big_w=[];this.coords.big_p=[];this.coords.big_x=[];cancelAnimationFrame(this.raf_id);},bindEvents:function(){if(this.no_diapason){return;}
this.$cache.body.on("touchmove.irs_"+this.plugin_count,this.pointerMove.bind(this));this.$cache.body.on("mousemove.irs_"+this.plugin_count,this.pointerMove.bind(this));this.$cache.win.on("touchend.irs_"+this.plugin_count,this.pointerUp.bind(this));this.$cache.win.on("mouseup.irs_"+this.plugin_count,this.pointerUp.bind(this));this.$cache.line.on("touchstart.irs_"+this.plugin_count,this.pointerClick.bind(this,"click"));this.$cache.line.on("mousedown.irs_"+this.plugin_count,this.pointerClick.bind(this,"click"));if(this.options.drag_interval&&this.options.type==="double"){this.$cache.bar.on("touchstart.irs_"+this.plugin_count,this.pointerDown.bind(this,"both"));this.$cache.bar.on("mousedown.irs_"+this.plugin_count,this.pointerDown.bind(this,"both"));}else{this.$cache.bar.on("touchstart.irs_"+this.plugin_count,this.pointerClick.bind(this,"click"));this.$cache.bar.on("mousedown.irs_"+this.plugin_count,this.pointerClick.bind(this,"click"));}
if(this.options.type==="single"){this.$cache.single.on("touchstart.irs_"+this.plugin_count,this.pointerDown.bind(this,"single"));this.$cache.s_single.on("touchstart.irs_"+this.plugin_count,this.pointerDown.bind(this,"single"));this.$cache.shad_single.on("touchstart.irs_"+this.plugin_count,this.pointerClick.bind(this,"click"));this.$cache.single.on("mousedown.irs_"+this.plugin_count,this.pointerDown.bind(this,"single"));this.$cache.s_single.on("mousedown.irs_"+this.plugin_count,this.pointerDown.bind(this,"single"));this.$cache.edge.on("mousedown.irs_"+this.plugin_count,this.pointerClick.bind(this,"click"));this.$cache.shad_single.on("mousedown.irs_"+this.plugin_count,this.pointerClick.bind(this,"click"));}else{this.$cache.single.on("touchstart.irs_"+this.plugin_count,this.pointerDown.bind(this,null));this.$cache.single.on("mousedown.irs_"+this.plugin_count,this.pointerDown.bind(this,null));this.$cache.from.on("touchstart.irs_"+this.plugin_count,this.pointerDown.bind(this,"from"));this.$cache.s_from.on("touchstart.irs_"+this.plugin_count,this.pointerDown.bind(this,"from"));this.$cache.to.on("touchstart.irs_"+this.plugin_count,this.pointerDown.bind(this,"to"));this.$cache.s_to.on("touchstart.irs_"+this.plugin_count,this.pointerDown.bind(this,"to"));this.$cache.shad_from.on("touchstart.irs_"+this.plugin_count,this.pointerClick.bind(this,"click"));this.$cache.shad_to.on("touchstart.irs_"+this.plugin_count,this.pointerClick.bind(this,"click"));this.$cache.from.on("mousedown.irs_"+this.plugin_count,this.pointerDown.bind(this,"from"));this.$cache.s_from.on("mousedown.irs_"+this.plugin_count,this.pointerDown.bind(this,"from"));this.$cache.to.on("mousedown.irs_"+this.plugin_count,this.pointerDown.bind(this,"to"));this.$cache.s_to.on("mousedown.irs_"+this.plugin_count,this.pointerDown.bind(this,"to"));this.$cache.shad_from.on("mousedown.irs_"+this.plugin_count,this.pointerClick.bind(this,"click"));this.$cache.shad_to.on("mousedown.irs_"+this.plugin_count,this.pointerClick.bind(this,"click"));}
if(this.options.keyboard){this.$cache.line.on("keydown.irs_"+this.plugin_count,this.key.bind(this,"keyboard"));}
if(is_old_ie){this.$cache.body.on("mouseup.irs_"+this.plugin_count,this.pointerUp.bind(this));this.$cache.body.on("mouseleave.irs_"+this.plugin_count,this.pointerUp.bind(this));}},pointerMove:function(e){if(!this.dragging){return;}
var x=e.pageX||e.originalEvent.touches&&e.originalEvent.touches[0].pageX;this.coords.x_pointer=x-this.coords.x_gap;this.calc();},pointerUp:function(e){if(this.current_plugin!==this.plugin_count){return;}
if(this.is_active){this.is_active=false;}else{return;}
this.$cache.cont.find(".state_hover").removeClass("state_hover");this.force_redraw=true;if(is_old_ie){$("*").prop("unselectable",false);}
this.updateScene();this.restoreOriginalMinInterval();if($.contains(this.$cache.cont[0],e.target)||this.dragging){this.is_finish=true;this.callOnFinish();}
this.dragging=false;},pointerDown:function(target,e){e.preventDefault();var x=e.pageX||e.originalEvent.touches&&e.originalEvent.touches[0].pageX;if(e.button===2){return;}
if(target==="both"){this.setTempMinInterval();}
if(!target){target=this.target;}
this.current_plugin=this.plugin_count;this.target=target;this.is_active=true;this.dragging=true;this.coords.x_gap=this.$cache.rs.offset().left;this.coords.x_pointer=x-this.coords.x_gap;this.calcPointerPercent();this.changeLevel(target);if(is_old_ie){$("*").prop("unselectable",true);}
this.$cache.line.trigger("focus");this.updateScene();},pointerClick:function(target,e){e.preventDefault();var x=e.pageX||e.originalEvent.touches&&e.originalEvent.touches[0].pageX;if(e.button===2){return;}
this.current_plugin=this.plugin_count;this.target=target;this.is_click=true;this.coords.x_gap=this.$cache.rs.offset().left;this.coords.x_pointer=+(x-this.coords.x_gap).toFixed();this.force_redraw=true;this.calc();this.$cache.line.trigger("focus");},key:function(target,e){if(this.current_plugin!==this.plugin_count||e.altKey||e.ctrlKey||e.shiftKey||e.metaKey){return;}
switch(e.which){case 83:case 65:case 40:case 37:e.preventDefault();this.moveByKey(false);break;case 87:case 68:case 38:case 39:e.preventDefault();this.moveByKey(true);break;}
return true;},moveByKey:function(right){var p=this.coords.p_pointer;if(right){p+=this.options.keyboard_step;}else{p-=this.options.keyboard_step;}
this.coords.x_pointer=this.toFixed(this.coords.w_rs/100*p);this.is_key=true;this.calc();},setMinMax:function(){if(!this.options){return;}
if(this.options.hide_min_max){this.$cache.min[0].style.display="none";this.$cache.max[0].style.display="none";return;}
if(this.options.values.length){this.$cache.min.html(this.decorate(this.options.p_values[this.options.min]));this.$cache.max.html(this.decorate(this.options.p_values[this.options.max]));}else{this.$cache.min.html(this.decorate(this._prettify(this.options.min),this.options.min));this.$cache.max.html(this.decorate(this._prettify(this.options.max),this.options.max));}
this.labels.w_min=this.$cache.min.outerWidth(false);this.labels.w_max=this.$cache.max.outerWidth(false);},setTempMinInterval:function(){var interval=this.result.to-this.result.from;if(this.old_min_interval===null){this.old_min_interval=this.options.min_interval;}
this.options.min_interval=interval;},restoreOriginalMinInterval:function(){if(this.old_min_interval!==null){this.options.min_interval=this.old_min_interval;this.old_min_interval=null;}},calc:function(update){if(!this.options){return;}
this.calc_count++;if(this.calc_count===10||update){this.calc_count=0;this.coords.w_rs=this.$cache.rs.outerWidth(false);this.calcHandlePercent();}
if(!this.coords.w_rs){return;}
this.calcPointerPercent();var handle_x=this.getHandleX();if(this.target==="click"){this.coords.p_gap=this.coords.p_handle/2;handle_x=this.getHandleX();if(this.options.drag_interval){this.target="both_one";}else{this.target=this.chooseHandle(handle_x);}}
switch(this.target){case"base":var w=(this.options.max-this.options.min)/100,f=(this.result.from-this.options.min)/w,t=(this.result.to-this.options.min)/w;this.coords.p_single_real=this.toFixed(f);this.coords.p_from_real=this.toFixed(f);this.coords.p_to_real=this.toFixed(t);this.coords.p_single_real=this.checkDiapason(this.coords.p_single_real,this.options.from_min,this.options.from_max);this.coords.p_from_real=this.checkDiapason(this.coords.p_from_real,this.options.from_min,this.options.from_max);this.coords.p_to_real=this.checkDiapason(this.coords.p_to_real,this.options.to_min,this.options.to_max);this.coords.p_single_fake=this.convertToFakePercent(this.coords.p_single_real);this.coords.p_from_fake=this.convertToFakePercent(this.coords.p_from_real);this.coords.p_to_fake=this.convertToFakePercent(this.coords.p_to_real);this.target=null;break;case"single":if(this.options.from_fixed){break;}
this.coords.p_single_real=this.convertToRealPercent(handle_x);this.coords.p_single_real=this.calcWithStep(this.coords.p_single_real);this.coords.p_single_real=this.checkDiapason(this.coords.p_single_real,this.options.from_min,this.options.from_max);this.coords.p_single_fake=this.convertToFakePercent(this.coords.p_single_real);break;case"from":if(this.options.from_fixed){break;}
this.coords.p_from_real=this.convertToRealPercent(handle_x);this.coords.p_from_real=this.calcWithStep(this.coords.p_from_real);if(this.coords.p_from_real>this.coords.p_to_real){this.coords.p_from_real=this.coords.p_to_real;}
this.coords.p_from_real=this.checkDiapason(this.coords.p_from_real,this.options.from_min,this.options.from_max);this.coords.p_from_real=this.checkMinInterval(this.coords.p_from_real,this.coords.p_to_real,"from");this.coords.p_from_real=this.checkMaxInterval(this.coords.p_from_real,this.coords.p_to_real,"from");this.coords.p_from_fake=this.convertToFakePercent(this.coords.p_from_real);break;case"to":if(this.options.to_fixed){break;}
this.coords.p_to_real=this.convertToRealPercent(handle_x);this.coords.p_to_real=this.calcWithStep(this.coords.p_to_real);if(this.coords.p_to_real<this.coords.p_from_real){this.coords.p_to_real=this.coords.p_from_real;}
this.coords.p_to_real=this.checkDiapason(this.coords.p_to_real,this.options.to_min,this.options.to_max);this.coords.p_to_real=this.checkMinInterval(this.coords.p_to_real,this.coords.p_from_real,"to");this.coords.p_to_real=this.checkMaxInterval(this.coords.p_to_real,this.coords.p_from_real,"to");this.coords.p_to_fake=this.convertToFakePercent(this.coords.p_to_real);break;case"both":if(this.options.from_fixed||this.options.to_fixed){break;}
handle_x=this.toFixed(handle_x+(this.coords.p_handle*0.1));this.coords.p_from_real=this.convertToRealPercent(handle_x)-this.coords.p_gap_left;this.coords.p_from_real=this.calcWithStep(this.coords.p_from_real);this.coords.p_from_real=this.checkDiapason(this.coords.p_from_real,this.options.from_min,this.options.from_max);this.coords.p_from_real=this.checkMinInterval(this.coords.p_from_real,this.coords.p_to_real,"from");this.coords.p_from_fake=this.convertToFakePercent(this.coords.p_from_real);this.coords.p_to_real=this.convertToRealPercent(handle_x)+this.coords.p_gap_right;this.coords.p_to_real=this.calcWithStep(this.coords.p_to_real);this.coords.p_to_real=this.checkDiapason(this.coords.p_to_real,this.options.to_min,this.options.to_max);this.coords.p_to_real=this.checkMinInterval(this.coords.p_to_real,this.coords.p_from_real,"to");this.coords.p_to_fake=this.convertToFakePercent(this.coords.p_to_real);break;case"both_one":if(this.options.from_fixed||this.options.to_fixed){break;}
var real_x=this.convertToRealPercent(handle_x),from=this.result.from_percent,to=this.result.to_percent,full=to-from,half=full/2,new_from=real_x-half,new_to=real_x+half;if(new_from<0){new_from=0;new_to=new_from+full;}
if(new_to>100){new_to=100;new_from=new_to-full;}
this.coords.p_from_real=this.calcWithStep(new_from);this.coords.p_from_real=this.checkDiapason(this.coords.p_from_real,this.options.from_min,this.options.from_max);this.coords.p_from_fake=this.convertToFakePercent(this.coords.p_from_real);this.coords.p_to_real=this.calcWithStep(new_to);this.coords.p_to_real=this.checkDiapason(this.coords.p_to_real,this.options.to_min,this.options.to_max);this.coords.p_to_fake=this.convertToFakePercent(this.coords.p_to_real);break;}
if(this.options.type==="single"){this.coords.p_bar_x=(this.coords.p_handle/2);this.coords.p_bar_w=this.coords.p_single_fake;this.result.from_percent=this.coords.p_single_real;this.result.from=this.convertToValue(this.coords.p_single_real);if(this.options.values.length){this.result.from_value=this.options.values[this.result.from];}}else{this.coords.p_bar_x=this.toFixed(this.coords.p_from_fake+(this.coords.p_handle/2));this.coords.p_bar_w=this.toFixed(this.coords.p_to_fake-this.coords.p_from_fake);this.result.from_percent=this.coords.p_from_real;this.result.from=this.convertToValue(this.coords.p_from_real);this.result.to_percent=this.coords.p_to_real;this.result.to=this.convertToValue(this.coords.p_to_real);if(this.options.values.length){this.result.from_value=this.options.values[this.result.from];this.result.to_value=this.options.values[this.result.to];}}
this.calcMinMax();this.calcLabels();},calcPointerPercent:function(){if(!this.coords.w_rs){this.coords.p_pointer=0;return;}
if(this.coords.x_pointer<0||isNaN(this.coords.x_pointer)){this.coords.x_pointer=0;}else if(this.coords.x_pointer>this.coords.w_rs){this.coords.x_pointer=this.coords.w_rs;}
this.coords.p_pointer=this.toFixed(this.coords.x_pointer/this.coords.w_rs*100);},convertToRealPercent:function(fake){var full=100-this.coords.p_handle;return fake/full*100;},convertToFakePercent:function(real){var full=100-this.coords.p_handle;return real/100*full;},getHandleX:function(){var max=100-this.coords.p_handle,x=this.toFixed(this.coords.p_pointer-this.coords.p_gap);if(x<0){x=0;}else if(x>max){x=max;}
return x;},calcHandlePercent:function(){if(this.options.type==="single"){this.coords.w_handle=this.$cache.s_single.outerWidth(false);}else{this.coords.w_handle=this.$cache.s_from.outerWidth(false);}
this.coords.p_handle=this.toFixed(this.coords.w_handle/this.coords.w_rs*100);},chooseHandle:function(real_x){if(this.options.type==="single"){return"single";}else{var m_point=this.coords.p_from_real+((this.coords.p_to_real-this.coords.p_from_real)/2);if(real_x>=m_point){return this.options.to_fixed?"from":"to";}else{return this.options.from_fixed?"to":"from";}}},calcMinMax:function(){if(!this.coords.w_rs){return;}
this.labels.p_min=this.labels.w_min/this.coords.w_rs*100;this.labels.p_max=this.labels.w_max/this.coords.w_rs*100;},calcLabels:function(){if(!this.coords.w_rs||this.options.hide_from_to){return;}
if(this.options.type==="single"){this.labels.w_single=this.$cache.single.outerWidth(false);this.labels.p_single_fake=this.labels.w_single/this.coords.w_rs*100;this.labels.p_single_left=this.coords.p_single_fake+(this.coords.p_handle/2)-(this.labels.p_single_fake/2);this.labels.p_single_left=this.checkEdges(this.labels.p_single_left,this.labels.p_single_fake);}else{this.labels.w_from=this.$cache.from.outerWidth(false);this.labels.p_from_fake=this.labels.w_from/this.coords.w_rs*100;this.labels.p_from_left=this.coords.p_from_fake+(this.coords.p_handle/2)-(this.labels.p_from_fake/2);this.labels.p_from_left=this.toFixed(this.labels.p_from_left);this.labels.p_from_left=this.checkEdges(this.labels.p_from_left,this.labels.p_from_fake);this.labels.w_to=this.$cache.to.outerWidth(false);this.labels.p_to_fake=this.labels.w_to/this.coords.w_rs*100;this.labels.p_to_left=this.coords.p_to_fake+(this.coords.p_handle/2)-(this.labels.p_to_fake/2);this.labels.p_to_left=this.toFixed(this.labels.p_to_left);this.labels.p_to_left=this.checkEdges(this.labels.p_to_left,this.labels.p_to_fake);this.labels.w_single=this.$cache.single.outerWidth(false);this.labels.p_single_fake=this.labels.w_single/this.coords.w_rs*100;this.labels.p_single_left=((this.labels.p_from_left+this.labels.p_to_left+this.labels.p_to_fake)/2)-(this.labels.p_single_fake/2);this.labels.p_single_left=this.toFixed(this.labels.p_single_left);this.labels.p_single_left=this.checkEdges(this.labels.p_single_left,this.labels.p_single_fake);}},updateScene:function(){if(this.raf_id){cancelAnimationFrame(this.raf_id);this.raf_id=null;}
clearTimeout(this.update_tm);this.update_tm=null;if(!this.options){return;}
this.drawHandles();if(this.is_active){this.raf_id=requestAnimationFrame(this.updateScene.bind(this));}else{this.update_tm=setTimeout(this.updateScene.bind(this),300);}},drawHandles:function(){this.coords.w_rs=this.$cache.rs.outerWidth(false);if(!this.coords.w_rs){return;}
if(this.coords.w_rs!==this.coords.w_rs_old){this.target="base";this.is_resize=true;}
if(this.coords.w_rs!==this.coords.w_rs_old||this.force_redraw){this.setMinMax();this.calc(true);this.drawLabels();if(this.options.grid){this.calcGridMargin();this.calcGridLabels();}
this.force_redraw=true;this.coords.w_rs_old=this.coords.w_rs;this.drawShadow();}
if(!this.coords.w_rs){return;}
if(!this.dragging&&!this.force_redraw&&!this.is_key){return;}
if(this.old_from!==this.result.from||this.old_to!==this.result.to||this.force_redraw||this.is_key){this.drawLabels();this.$cache.bar[0].style.left=this.coords.p_bar_x+"%";this.$cache.bar[0].style.width=this.coords.p_bar_w+"%";if(this.options.type==="single"){this.$cache.s_single[0].style.left=this.coords.p_single_fake+"%";this.$cache.single[0].style.left=this.labels.p_single_left+"%";if(this.options.values.length){this.$cache.input.prop("value",this.result.from_value);}else{this.$cache.input.prop("value",this.result.from);}
this.$cache.input.data("from",this.result.from);}else{this.$cache.s_from[0].style.left=this.coords.p_from_fake+"%";this.$cache.s_to[0].style.left=this.coords.p_to_fake+"%";if(this.old_from!==this.result.from||this.force_redraw){this.$cache.from[0].style.left=this.labels.p_from_left+"%";}
if(this.old_to!==this.result.to||this.force_redraw){this.$cache.to[0].style.left=this.labels.p_to_left+"%";}
this.$cache.single[0].style.left=this.labels.p_single_left+"%";if(this.options.values.length){this.$cache.input.prop("value",this.result.from_value+this.options.input_values_separator+this.result.to_value);}else{this.$cache.input.prop("value",this.result.from+this.options.input_values_separator+this.result.to);}
this.$cache.input.data("from",this.result.from);this.$cache.input.data("to",this.result.to);}
if((this.old_from!==this.result.from||this.old_to!==this.result.to)&&!this.is_start){this.$cache.input.trigger("change");}
this.old_from=this.result.from;this.old_to=this.result.to;if(!this.is_resize&&!this.is_update&&!this.is_start&&!this.is_finish){this.callOnChange();}
if(this.is_key||this.is_click){this.is_key=false;this.is_click=false;this.callOnFinish();}
this.is_update=false;this.is_resize=false;this.is_finish=false;}
this.is_start=false;this.is_key=false;this.is_click=false;this.force_redraw=false;},drawLabels:function(){if(!this.options){return;}
var values_num=this.options.values.length,p_values=this.options.p_values,text_single,text_from,text_to;if(this.options.hide_from_to){return;}
if(this.options.type==="single"){if(values_num){text_single=this.decorate(p_values[this.result.from]);this.$cache.single.html(text_single);}else{text_single=this.decorate(this._prettify(this.result.from),this.result.from);this.$cache.single.html(text_single);}
this.calcLabels();if(this.labels.p_single_left<this.labels.p_min+1){this.$cache.min[0].style.visibility="hidden";}else{this.$cache.min[0].style.visibility="visible";}
if(this.labels.p_single_left+this.labels.p_single_fake>100-this.labels.p_max-1){this.$cache.max[0].style.visibility="hidden";}else{this.$cache.max[0].style.visibility="visible";}}else{if(values_num){if(this.options.decorate_both){text_single=this.decorate(p_values[this.result.from]);text_single+=this.options.values_separator;text_single+=this.decorate(p_values[this.result.to]);}else{text_single=this.decorate(p_values[this.result.from]+this.options.values_separator+p_values[this.result.to]);}
text_from=this.decorate(p_values[this.result.from]);text_to=this.decorate(p_values[this.result.to]);this.$cache.single.html(text_single);this.$cache.from.html(text_from);this.$cache.to.html(text_to);}else{if(this.options.decorate_both){text_single=this.decorate(this._prettify(this.result.from),this.result.from);text_single+=this.options.values_separator;text_single+=this.decorate(this._prettify(this.result.to),this.result.to);}else{text_single=this.decorate(this._prettify(this.result.from)+this.options.values_separator+this._prettify(this.result.to),this.result.to);}
text_from=this.decorate(this._prettify(this.result.from),this.result.from);text_to=this.decorate(this._prettify(this.result.to),this.result.to);this.$cache.single.html(text_single);this.$cache.from.html(text_from);this.$cache.to.html(text_to);}
this.calcLabels();var min=Math.min(this.labels.p_single_left,this.labels.p_from_left),single_left=this.labels.p_single_left+this.labels.p_single_fake,to_left=this.labels.p_to_left+this.labels.p_to_fake,max=Math.max(single_left,to_left);if(this.labels.p_from_left+this.labels.p_from_fake>=this.labels.p_to_left){this.$cache.from[0].style.visibility="hidden";this.$cache.to[0].style.visibility="hidden";this.$cache.single[0].style.visibility="visible";if(this.result.from===this.result.to){if(this.target==="from"){this.$cache.from[0].style.visibility="visible";}else if(this.target==="to"){this.$cache.to[0].style.visibility="visible";}else if(!this.target){this.$cache.from[0].style.visibility="visible";}
this.$cache.single[0].style.visibility="hidden";max=to_left;}else{this.$cache.from[0].style.visibility="hidden";this.$cache.to[0].style.visibility="hidden";this.$cache.single[0].style.visibility="visible";max=Math.max(single_left,to_left);}}else{this.$cache.from[0].style.visibility="visible";this.$cache.to[0].style.visibility="visible";this.$cache.single[0].style.visibility="hidden";}
if(min<this.labels.p_min+1){this.$cache.min[0].style.visibility="hidden";}else{this.$cache.min[0].style.visibility="visible";}
if(max>100-this.labels.p_max-1){this.$cache.max[0].style.visibility="hidden";}else{this.$cache.max[0].style.visibility="visible";}}},drawShadow:function(){var o=this.options,c=this.$cache,is_from_min=typeof o.from_min==="number"&&!isNaN(o.from_min),is_from_max=typeof o.from_max==="number"&&!isNaN(o.from_max),is_to_min=typeof o.to_min==="number"&&!isNaN(o.to_min),is_to_max=typeof o.to_max==="number"&&!isNaN(o.to_max),from_min,from_max,to_min,to_max;if(o.type==="single"){if(o.from_shadow&&(is_from_min||is_from_max)){from_min=this.convertToPercent(is_from_min?o.from_min:o.min);from_max=this.convertToPercent(is_from_max?o.from_max:o.max)-from_min;from_min=this.toFixed(from_min-(this.coords.p_handle/100*from_min));from_max=this.toFixed(from_max-(this.coords.p_handle/100*from_max));from_min=from_min+(this.coords.p_handle/2);c.shad_single[0].style.display="block";c.shad_single[0].style.left=from_min+"%";c.shad_single[0].style.width=from_max+"%";}else{c.shad_single[0].style.display="none";}}else{if(o.from_shadow&&(is_from_min||is_from_max)){from_min=this.convertToPercent(is_from_min?o.from_min:o.min);from_max=this.convertToPercent(is_from_max?o.from_max:o.max)-from_min;from_min=this.toFixed(from_min-(this.coords.p_handle/100*from_min));from_max=this.toFixed(from_max-(this.coords.p_handle/100*from_max));from_min=from_min+(this.coords.p_handle/2);c.shad_from[0].style.display="block";c.shad_from[0].style.left=from_min+"%";c.shad_from[0].style.width=from_max+"%";}else{c.shad_from[0].style.display="none";}
if(o.to_shadow&&(is_to_min||is_to_max)){to_min=this.convertToPercent(is_to_min?o.to_min:o.min);to_max=this.convertToPercent(is_to_max?o.to_max:o.max)-to_min;to_min=this.toFixed(to_min-(this.coords.p_handle/100*to_min));to_max=this.toFixed(to_max-(this.coords.p_handle/100*to_max));to_min=to_min+(this.coords.p_handle/2);c.shad_to[0].style.display="block";c.shad_to[0].style.left=to_min+"%";c.shad_to[0].style.width=to_max+"%";}else{c.shad_to[0].style.display="none";}}},callOnStart:function(){if(this.options.onStart&&typeof this.options.onStart==="function"){this.options.onStart(this.result);}},callOnChange:function(){if(this.options.onChange&&typeof this.options.onChange==="function"){this.options.onChange(this.result);}},callOnFinish:function(){if(this.options.onFinish&&typeof this.options.onFinish==="function"){this.options.onFinish(this.result);}},callOnUpdate:function(){if(this.options.onUpdate&&typeof this.options.onUpdate==="function"){this.options.onUpdate(this.result);}},toggleInput:function(){this.$cache.input.toggleClass("irs-hidden-input");},convertToPercent:function(value,no_min){var diapason=this.options.max-this.options.min,one_percent=diapason/100,val,percent;if(!diapason){this.no_diapason=true;return 0;}
if(no_min){val=value;}else{val=value-this.options.min;}
percent=val/one_percent;return this.toFixed(percent);},convertToValue:function(percent){var min=this.options.min,max=this.options.max,min_decimals=min.toString().split(".")[1],max_decimals=max.toString().split(".")[1],min_length,max_length,avg_decimals=0,abs=0;if(percent===0){return this.options.min;}
if(percent===100){return this.options.max;}
if(min_decimals){min_length=min_decimals.length;avg_decimals=min_length;}
if(max_decimals){max_length=max_decimals.length;avg_decimals=max_length;}
if(min_length&&max_length){avg_decimals=(min_length>=max_length)?min_length:max_length;}
if(min<0){abs=Math.abs(min);min=+(min+abs).toFixed(avg_decimals);max=+(max+abs).toFixed(avg_decimals);}
var number=((max-min)/100*percent)+min,string=this.options.step.toString().split(".")[1],result;if(string){number=+number.toFixed(string.length);}else{number=number/this.options.step;number=number*this.options.step;number=+number.toFixed(0);}
if(abs){number-=abs;}
if(string){result=+number.toFixed(string.length);}else{result=this.toFixed(number);}
if(result<this.options.min){result=this.options.min;}else if(result>this.options.max){result=this.options.max;}
return result;},calcWithStep:function(percent){var rounded=Math.round(percent/this.coords.p_step)*this.coords.p_step;if(rounded>100){rounded=100;}
if(percent===100){rounded=100;}
return this.toFixed(rounded);},checkMinInterval:function(p_current,p_next,type){var o=this.options,current,next;if(!o.min_interval){return p_current;}
current=this.convertToValue(p_current);next=this.convertToValue(p_next);if(type==="from"){if(next-current<o.min_interval){current=next-o.min_interval;}}else{if(current-next<o.min_interval){current=next+o.min_interval;}}
return this.convertToPercent(current);},checkMaxInterval:function(p_current,p_next,type){var o=this.options,current,next;if(!o.max_interval){return p_current;}
current=this.convertToValue(p_current);next=this.convertToValue(p_next);if(type==="from"){if(next-current>o.max_interval){current=next-o.max_interval;}}else{if(current-next>o.max_interval){current=next+o.max_interval;}}
return this.convertToPercent(current);},checkDiapason:function(p_num,min,max){var num=this.convertToValue(p_num),o=this.options;if(typeof min!=="number"){min=o.min;}
if(typeof max!=="number"){max=o.max;}
if(num<min){num=min;}
if(num>max){num=max;}
return this.convertToPercent(num);},toFixed:function(num){num=num.toFixed(9);return+num;},_prettify:function(num){if(!this.options.prettify_enabled){return num;}
if(this.options.prettify&&typeof this.options.prettify==="function"){return this.options.prettify(num);}else{return this.prettify(num);}},prettify:function(num){var n=num.toString();return n.replace(/(\d{1,3}(?=(?:\d\d\d)+(?!\d)))/g,"$1"+this.options.prettify_separator);},checkEdges:function(left,width){if(!this.options.force_edges){return this.toFixed(left);}
if(left<0){left=0;}else if(left>100-width){left=100-width;}
return this.toFixed(left);},validate:function(){var o=this.options,r=this.result,v=o.values,vl=v.length,value,i;if(typeof o.min==="string")o.min=+o.min;if(typeof o.max==="string")o.max=+o.max;if(typeof o.from==="string")o.from=+o.from;if(typeof o.to==="string")o.to=+o.to;if(typeof o.step==="string")o.step=+o.step;if(typeof o.from_min==="string")o.from_min=+o.from_min;if(typeof o.from_max==="string")o.from_max=+o.from_max;if(typeof o.to_min==="string")o.to_min=+o.to_min;if(typeof o.to_max==="string")o.to_max=+o.to_max;if(typeof o.keyboard_step==="string")o.keyboard_step=+o.keyboard_step;if(typeof o.grid_num==="string")o.grid_num=+o.grid_num;if(o.max<o.min){o.max=o.min;}
if(vl){o.p_values=[];o.min=0;o.max=vl-1;o.step=1;o.grid_num=o.max;o.grid_snap=true;for(i=0;i<vl;i++){value=+v[i];if(!isNaN(value)){v[i]=value;value=this._prettify(value);}else{value=v[i];}
o.p_values.push(value);}}
if(typeof o.from!=="number"||isNaN(o.from)){o.from=o.min;}
if(typeof o.to!=="number"||isNaN(o.from)){o.to=o.max;}
if(o.type==="single"){if(o.from<o.min){o.from=o.min;}
if(o.from>o.max){o.from=o.max;}}else{if(o.from<o.min||o.from>o.max){o.from=o.min;}
if(o.to>o.max||o.to<o.min){o.to=o.max;}
if(o.from>o.to){o.from=o.to;}}
if(typeof o.step!=="number"||isNaN(o.step)||!o.step||o.step<0){o.step=1;}
if(typeof o.keyboard_step!=="number"||isNaN(o.keyboard_step)||!o.keyboard_step||o.keyboard_step<0){o.keyboard_step=5;}
if(typeof o.from_min==="number"&&o.from<o.from_min){o.from=o.from_min;}
if(typeof o.from_max==="number"&&o.from>o.from_max){o.from=o.from_max;}
if(typeof o.to_min==="number"&&o.to<o.to_min){o.to=o.to_min;}
if(typeof o.to_max==="number"&&o.from>o.to_max){o.to=o.to_max;}
if(r){if(r.min!==o.min){r.min=o.min;}
if(r.max!==o.max){r.max=o.max;}
if(r.from<r.min||r.from>r.max){r.from=o.from;}
if(r.to<r.min||r.to>r.max){r.to=o.to;}}
if(typeof o.min_interval!=="number"||isNaN(o.min_interval)||!o.min_interval||o.min_interval<0){o.min_interval=0;}
if(typeof o.max_interval!=="number"||isNaN(o.max_interval)||!o.max_interval||o.max_interval<0){o.max_interval=0;}
if(o.min_interval&&o.min_interval>o.max-o.min){o.min_interval=o.max-o.min;}
if(o.max_interval&&o.max_interval>o.max-o.min){o.max_interval=o.max-o.min;}},decorate:function(num,original){var decorated="",o=this.options;if(o.prefix){decorated+=o.prefix;}
decorated+=num;if(o.max_postfix){if(o.values.length&&num===o.p_values[o.max]){decorated+=o.max_postfix;if(o.postfix){decorated+=" ";}}else if(original===o.max){decorated+=o.max_postfix;if(o.postfix){decorated+=" ";}}}
if(o.postfix){decorated+=o.postfix;}
return decorated;},updateFrom:function(){this.result.from=this.options.from;this.result.from_percent=this.convertToPercent(this.result.from);if(this.options.values){this.result.from_value=this.options.values[this.result.from];}},updateTo:function(){this.result.to=this.options.to;this.result.to_percent=this.convertToPercent(this.result.to);if(this.options.values){this.result.to_value=this.options.values[this.result.to];}},updateResult:function(){this.result.min=this.options.min;this.result.max=this.options.max;this.updateFrom();this.updateTo();},appendGrid:function(){if(!this.options.grid){return;}
var o=this.options,i,z,total=o.max-o.min,big_num=o.grid_num,big_p=0,big_w=0,small_max=4,local_small_max,small_p,small_w=0,result,html='';this.calcGridMargin();if(o.grid_snap){big_num=total/o.step;big_p=this.toFixed(o.step/(total/100));}else{big_p=this.toFixed(100/big_num);}
if(big_num>4){small_max=3;}
if(big_num>7){small_max=2;}
if(big_num>14){small_max=1;}
if(big_num>28){small_max=0;}
for(i=0;i<big_num+1;i++){local_small_max=small_max;big_w=this.toFixed(big_p*i);if(big_w>100){big_w=100;local_small_max-=2;if(local_small_max<0){local_small_max=0;}}
this.coords.big[i]=big_w;small_p=(big_w-(big_p*(i-1)))/(local_small_max+1);for(z=1;z<=local_small_max;z++){if(big_w===0){break;}
small_w=this.toFixed(big_w-(small_p*z));html+='<span class="irs-grid-pol small" style="left: '+small_w+'%"></span>';}
html+='<span class="irs-grid-pol" style="left: '+big_w+'%"></span>';result=this.convertToValue(big_w);if(o.values.length){result=o.p_values[result];}else{result=this._prettify(result);}
html+='<span class="irs-grid-text js-grid-text-'+i+'" style="left: '+big_w+'%">'+result+'</span>';}
this.coords.big_num=Math.ceil(big_num+1);this.$cache.cont.addClass("irs-with-grid");this.$cache.grid.html(html);this.cacheGridLabels();},cacheGridLabels:function(){var $label,i,num=this.coords.big_num;for(i=0;i<num;i++){$label=this.$cache.grid.find(".js-grid-text-"+i);this.$cache.grid_labels.push($label);}
this.calcGridLabels();},calcGridLabels:function(){var i,label,start=[],finish=[],num=this.coords.big_num;for(i=0;i<num;i++){this.coords.big_w[i]=this.$cache.grid_labels[i].outerWidth(false);this.coords.big_p[i]=this.toFixed(this.coords.big_w[i]/this.coords.w_rs*100);this.coords.big_x[i]=this.toFixed(this.coords.big_p[i]/2);start[i]=this.toFixed(this.coords.big[i]-this.coords.big_x[i]);finish[i]=this.toFixed(start[i]+this.coords.big_p[i]);}
if(this.options.force_edges){if(start[0]<-this.coords.grid_gap){start[0]=-this.coords.grid_gap;finish[0]=this.toFixed(start[0]+this.coords.big_p[0]);this.coords.big_x[0]=this.coords.grid_gap;}
if(finish[num-1]>100+this.coords.grid_gap){finish[num-1]=100+this.coords.grid_gap;start[num-1]=this.toFixed(finish[num-1]-this.coords.big_p[num-1]);this.coords.big_x[num-1]=this.toFixed(this.coords.big_p[num-1]-this.coords.grid_gap);}}
this.calcGridCollision(2,start,finish);this.calcGridCollision(4,start,finish);for(i=0;i<num;i++){label=this.$cache.grid_labels[i][0];label.style.marginLeft=-this.coords.big_x[i]+"%";}},calcGridCollision:function(step,start,finish){var i,next_i,label,num=this.coords.big_num;for(i=0;i<num;i+=step){next_i=i+(step/2);if(next_i>=num){break;}
label=this.$cache.grid_labels[next_i][0];if(finish[i]<=start[next_i]){label.style.visibility="visible";}else{label.style.visibility="hidden";}}},calcGridMargin:function(){if(!this.options.grid_margin){return;}
this.coords.w_rs=this.$cache.rs.outerWidth(false);if(!this.coords.w_rs){return;}
if(this.options.type==="single"){this.coords.w_handle=this.$cache.s_single.outerWidth(false);}else{this.coords.w_handle=this.$cache.s_from.outerWidth(false);}
this.coords.p_handle=this.toFixed(this.coords.w_handle/this.coords.w_rs*100);this.coords.grid_gap=this.toFixed((this.coords.p_handle/2)-0.1);this.$cache.grid[0].style.width=this.toFixed(100-this.coords.p_handle)+"%";this.$cache.grid[0].style.left=this.coords.grid_gap+"%";},update:function(options){if(!this.input){return;}
this.is_update=true;this.options.from=this.result.from;this.options.to=this.result.to;this.options=$.extend(this.options,options);this.validate();this.updateResult(options);this.toggleInput();this.remove();this.init(true);},reset:function(){if(!this.input){return;}
this.updateResult();this.update();},destroy:function(){if(!this.input){return;}
this.toggleInput();this.$cache.input.prop("readonly",false);$.data(this.input,"ionRangeSlider",null);this.remove();this.input=null;this.options=null;}};$.fn.ionRangeSlider=function(options){return this.each(function(){if(!$.data(this,"ionRangeSlider")){$.data(this,"ionRangeSlider",new IonRangeSlider(this,options,plugin_count++));}});};(function(){var lastTime=0;var vendors=['ms','moz','webkit','o'];for(var x=0;x<vendors.length&&!window.requestAnimationFrame;++x){window.requestAnimationFrame=window[vendors[x]+'RequestAnimationFrame'];window.cancelAnimationFrame=window[vendors[x]+'CancelAnimationFrame']||window[vendors[x]+'CancelRequestAnimationFrame'];}
if(!window.requestAnimationFrame)
window.requestAnimationFrame=function(callback,element){var currTime=new Date().getTime();var timeToCall=Math.max(0,16-(currTime-lastTime));var id=window.setTimeout(function(){callback(currTime+timeToCall);},timeToCall);lastTime=currTime+timeToCall;return id;};if(!window.cancelAnimationFrame)
window.cancelAnimationFrame=function(id){clearTimeout(id);};}());}));;

/* /scrummer/static/src/js/libs/external/moment.js defined in bundle 'scrummer.assets' */
;(function(global,factory){typeof exports==='object'&&typeof module!=='undefined'?module.exports=factory():typeof define==='function'&&define.amd?define(factory):global.moment=factory()}(this,(function(){'use strict';var hookCallback;function hooks(){return hookCallback.apply(null,arguments);}
function setHookCallback(callback){hookCallback=callback;}
function isArray(input){return input instanceof Array||Object.prototype.toString.call(input)==='[object Array]';}
function isObject(input){return input!=null&&Object.prototype.toString.call(input)==='[object Object]';}
function isObjectEmpty(obj){var k;for(k in obj){return false;}
return true;}
function isNumber(input){return typeof input==='number'||Object.prototype.toString.call(input)==='[object Number]';}
function isDate(input){return input instanceof Date||Object.prototype.toString.call(input)==='[object Date]';}
function map(arr,fn){var res=[],i;for(i=0;i<arr.length;++i){res.push(fn(arr[i],i));}
return res;}
function hasOwnProp(a,b){return Object.prototype.hasOwnProperty.call(a,b);}
function extend(a,b){for(var i in b){if(hasOwnProp(b,i)){a[i]=b[i];}}
if(hasOwnProp(b,'toString')){a.toString=b.toString;}
if(hasOwnProp(b,'valueOf')){a.valueOf=b.valueOf;}
return a;}
function createUTC(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,true).utc();}
function defaultParsingFlags(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false,parsedDateParts:[],meridiem:null};}
function getParsingFlags(m){if(m._pf==null){m._pf=defaultParsingFlags();}
return m._pf;}
var some;if(Array.prototype.some){some=Array.prototype.some;}else{some=function(fun){var t=Object(this);var len=t.length>>>0;for(var i=0;i<len;i++){if(i in t&&fun.call(this,t[i],i,t)){return true;}}
return false;};}
var some$1=some;function isValid(m){if(m._isValid==null){var flags=getParsingFlags(m);var parsedParts=some$1.call(flags.parsedDateParts,function(i){return i!=null;});var isNowValid=!isNaN(m._d.getTime())&&flags.overflow<0&&!flags.empty&&!flags.invalidMonth&&!flags.invalidWeekday&&!flags.nullInput&&!flags.invalidFormat&&!flags.userInvalidated&&(!flags.meridiem||(flags.meridiem&&parsedParts));if(m._strict){isNowValid=isNowValid&&flags.charsLeftOver===0&&flags.unusedTokens.length===0&&flags.bigHour===undefined;}
if(Object.isFrozen==null||!Object.isFrozen(m)){m._isValid=isNowValid;}
else{return isNowValid;}}
return m._isValid;}
function createInvalid(flags){var m=createUTC(NaN);if(flags!=null){extend(getParsingFlags(m),flags);}
else{getParsingFlags(m).userInvalidated=true;}
return m;}
function isUndefined(input){return input===void 0;}
var momentProperties=hooks.momentProperties=[];function copyConfig(to,from){var i,prop,val;if(!isUndefined(from._isAMomentObject)){to._isAMomentObject=from._isAMomentObject;}
if(!isUndefined(from._i)){to._i=from._i;}
if(!isUndefined(from._f)){to._f=from._f;}
if(!isUndefined(from._l)){to._l=from._l;}
if(!isUndefined(from._strict)){to._strict=from._strict;}
if(!isUndefined(from._tzm)){to._tzm=from._tzm;}
if(!isUndefined(from._isUTC)){to._isUTC=from._isUTC;}
if(!isUndefined(from._offset)){to._offset=from._offset;}
if(!isUndefined(from._pf)){to._pf=getParsingFlags(from);}
if(!isUndefined(from._locale)){to._locale=from._locale;}
if(momentProperties.length>0){for(i in momentProperties){prop=momentProperties[i];val=from[prop];if(!isUndefined(val)){to[prop]=val;}}}
return to;}
var updateInProgress=false;function Moment(config){copyConfig(this,config);this._d=new Date(config._d!=null?config._d.getTime():NaN);if(!this.isValid()){this._d=new Date(NaN);}
if(updateInProgress===false){updateInProgress=true;hooks.updateOffset(this);updateInProgress=false;}}
function isMoment(obj){return obj instanceof Moment||(obj!=null&&obj._isAMomentObject!=null);}
function absFloor(number){if(number<0){return Math.ceil(number)||0;}else{return Math.floor(number);}}
function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;if(coercedNumber!==0&&isFinite(coercedNumber)){value=absFloor(coercedNumber);}
return value;}
function compareArrays(array1,array2,dontConvert){var len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0,i;for(i=0;i<len;i++){if((dontConvert&&array1[i]!==array2[i])||(!dontConvert&&toInt(array1[i])!==toInt(array2[i]))){diffs++;}}
return diffs+lengthDiff;}
function warn(msg){if(hooks.suppressDeprecationWarnings===false&&(typeof console!=='undefined')&&console.warn){console.warn('Deprecation warning: '+msg);}}
function deprecate(msg,fn){var firstTime=true;return extend(function(){if(hooks.deprecationHandler!=null){hooks.deprecationHandler(null,msg);}
if(firstTime){var args=[];var arg;for(var i=0;i<arguments.length;i++){arg='';if(typeof arguments[i]==='object'){arg+='\n['+i+'] ';for(var key in arguments[0]){arg+=key+': '+arguments[0][key]+', ';}
arg=arg.slice(0,-2);}else{arg=arguments[i];}
args.push(arg);}
warn(msg+'\nArguments: '+Array.prototype.slice.call(args).join('')+'\n'+(new Error()).stack);firstTime=false;}
return fn.apply(this,arguments);},fn);}
var deprecations={};function deprecateSimple(name,msg){if(hooks.deprecationHandler!=null){hooks.deprecationHandler(name,msg);}
if(!deprecations[name]){warn(msg);deprecations[name]=true;}}
hooks.suppressDeprecationWarnings=false;hooks.deprecationHandler=null;function isFunction(input){return input instanceof Function||Object.prototype.toString.call(input)==='[object Function]';}
function set(config){var prop,i;for(i in config){prop=config[i];if(isFunction(prop)){this[i]=prop;}else{this['_'+i]=prop;}}
this._config=config;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+'|'+(/\d{1,2}/).source);}
function mergeConfigs(parentConfig,childConfig){var res=extend({},parentConfig),prop;for(prop in childConfig){if(hasOwnProp(childConfig,prop)){if(isObject(parentConfig[prop])&&isObject(childConfig[prop])){res[prop]={};extend(res[prop],parentConfig[prop]);extend(res[prop],childConfig[prop]);}else if(childConfig[prop]!=null){res[prop]=childConfig[prop];}else{delete res[prop];}}}
for(prop in parentConfig){if(hasOwnProp(parentConfig,prop)&&!hasOwnProp(childConfig,prop)&&isObject(parentConfig[prop])){res[prop]=extend({},res[prop]);}}
return res;}
function Locale(config){if(config!=null){this.set(config);}}
var keys;if(Object.keys){keys=Object.keys;}else{keys=function(obj){var i,res=[];for(i in obj){if(hasOwnProp(obj,i)){res.push(i);}}
return res;};}
var keys$1=keys;var defaultCalendar={sameDay:'[Today at] LT',nextDay:'[Tomorrow at] LT',nextWeek:'dddd [at] LT',lastDay:'[Yesterday at] LT',lastWeek:'[Last] dddd [at] LT',sameElse:'L'};function calendar(key,mom,now){var output=this._calendar[key]||this._calendar['sameElse'];return isFunction(output)?output.call(mom,now):output;}
var defaultLongDateFormat={LTS:'h:mm:ss A',LT:'h:mm A',L:'MM/DD/YYYY',LL:'MMMM D, YYYY',LLL:'MMMM D, YYYY h:mm A',LLLL:'dddd, MMMM D, YYYY h:mm A'};function longDateFormat(key){var format=this._longDateFormat[key],formatUpper=this._longDateFormat[key.toUpperCase()];if(format||!formatUpper){return format;}
this._longDateFormat[key]=formatUpper.replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1);});return this._longDateFormat[key];}
var defaultInvalidDate='Invalid date';function invalidDate(){return this._invalidDate;}
var defaultOrdinal='%d';var defaultOrdinalParse=/\d{1,2}/;function ordinal(number){return this._ordinal.replace('%d',number);}
var defaultRelativeTime={future:'in %s',past:'%s ago',s:'a few seconds',m:'a minute',mm:'%d minutes',h:'an hour',hh:'%d hours',d:'a day',dd:'%d days',M:'a month',MM:'%d months',y:'a year',yy:'%d years'};function relativeTime(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return(isFunction(output))?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number);}
function pastFuture(diff,output){var format=this._relativeTime[diff>0?'future':'past'];return isFunction(format)?format(output):format.replace(/%s/i,output);}
var aliases={};function addUnitAlias(unit,shorthand){var lowerCase=unit.toLowerCase();aliases[lowerCase]=aliases[lowerCase+'s']=aliases[shorthand]=unit;}
function normalizeUnits(units){return typeof units==='string'?aliases[units]||aliases[units.toLowerCase()]:undefined;}
function normalizeObjectUnits(inputObject){var normalizedInput={},normalizedProp,prop;for(prop in inputObject){if(hasOwnProp(inputObject,prop)){normalizedProp=normalizeUnits(prop);if(normalizedProp){normalizedInput[normalizedProp]=inputObject[prop];}}}
return normalizedInput;}
var priorities={};function addUnitPriority(unit,priority){priorities[unit]=priority;}
function getPrioritizedUnits(unitsObj){var units=[];for(var u in unitsObj){units.push({unit:u,priority:priorities[u]});}
units.sort(function(a,b){return a.priority-b.priority;});return units;}
function makeGetSet(unit,keepTime){return function(value){if(value!=null){set$1(this,unit,value);hooks.updateOffset(this,keepTime);return this;}else{return get(this,unit);}};}
function get(mom,unit){return mom.isValid()?mom._d['get'+(mom._isUTC?'UTC':'')+unit]():NaN;}
function set$1(mom,unit,value){if(mom.isValid()){mom._d['set'+(mom._isUTC?'UTC':'')+unit](value);}}
function stringGet(units){units=normalizeUnits(units);if(isFunction(this[units])){return this[units]();}
return this;}
function stringSet(units,value){if(typeof units==='object'){units=normalizeObjectUnits(units);var prioritized=getPrioritizedUnits(units);for(var i=0;i<prioritized.length;i++){this[prioritized[i].unit](units[prioritized[i].unit]);}}else{units=normalizeUnits(units);if(isFunction(this[units])){return this[units](value);}}
return this;}
function zeroFill(number,targetLength,forceSign){var absNumber=''+Math.abs(number),zerosToFill=targetLength-absNumber.length,sign=number>=0;return(sign?(forceSign?'+':''):'-')+
Math.pow(10,Math.max(0,zerosToFill)).toString().substr(1)+absNumber;}
var formattingTokens=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;var localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g;var formatFunctions={};var formatTokenFunctions={};function addFormatToken(token,padded,ordinal,callback){var func=callback;if(typeof callback==='string'){func=function(){return this[callback]();};}
if(token){formatTokenFunctions[token]=func;}
if(padded){formatTokenFunctions[padded[0]]=function(){return zeroFill(func.apply(this,arguments),padded[1],padded[2]);};}
if(ordinal){formatTokenFunctions[ordinal]=function(){return this.localeData().ordinal(func.apply(this,arguments),token);};}}
function removeFormattingTokens(input){if(input.match(/\[[\s\S]/)){return input.replace(/^\[|\]$/g,'');}
return input.replace(/\\/g,'');}
function makeFormatFunction(format){var array=format.match(formattingTokens),i,length;for(i=0,length=array.length;i<length;i++){if(formatTokenFunctions[array[i]]){array[i]=formatTokenFunctions[array[i]];}else{array[i]=removeFormattingTokens(array[i]);}}
return function(mom){var output='',i;for(i=0;i<length;i++){output+=array[i]instanceof Function?array[i].call(mom,format):array[i];}
return output;};}
function formatMoment(m,format){if(!m.isValid()){return m.localeData().invalidDate();}
format=expandFormat(format,m.localeData());formatFunctions[format]=formatFunctions[format]||makeFormatFunction(format);return formatFunctions[format](m);}
function expandFormat(format,locale){var i=5;function replaceLongDateFormatTokens(input){return locale.longDateFormat(input)||input;}
localFormattingTokens.lastIndex=0;while(i>=0&&localFormattingTokens.test(format)){format=format.replace(localFormattingTokens,replaceLongDateFormatTokens);localFormattingTokens.lastIndex=0;i-=1;}
return format;}
var match1=/\d/;var match2=/\d\d/;var match3=/\d{3}/;var match4=/\d{4}/;var match6=/[+-]?\d{6}/;var match1to2=/\d\d?/;var match3to4=/\d\d\d\d?/;var match5to6=/\d\d\d\d\d\d?/;var match1to3=/\d{1,3}/;var match1to4=/\d{1,4}/;var match1to6=/[+-]?\d{1,6}/;var matchUnsigned=/\d+/;var matchSigned=/[+-]?\d+/;var matchOffset=/Z|[+-]\d\d:?\d\d/gi;var matchShortOffset=/Z|[+-]\d\d(?::?\d\d)?/gi;var matchTimestamp=/[+-]?\d+(\.\d{1,3})?/;var matchWord=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i;var regexes={};function addRegexToken(token,regex,strictRegex){regexes[token]=isFunction(regex)?regex:function(isStrict,localeData){return(isStrict&&strictRegex)?strictRegex:regex;};}
function getParseRegexForToken(token,config){if(!hasOwnProp(regexes,token)){return new RegExp(unescapeFormat(token));}
return regexes[token](config._strict,config._locale);}
function unescapeFormat(s){return regexEscape(s.replace('\\','').replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4;}));}
function regexEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,'\\$&');}
var tokens={};function addParseToken(token,callback){var i,func=callback;if(typeof token==='string'){token=[token];}
if(isNumber(callback)){func=function(input,array){array[callback]=toInt(input);};}
for(i=0;i<token.length;i++){tokens[token[i]]=func;}}
function addWeekParseToken(token,callback){addParseToken(token,function(input,array,config,token){config._w=config._w||{};callback(input,config._w,config,token);});}
function addTimeToArrayFromToken(token,input,config){if(input!=null&&hasOwnProp(tokens,token)){tokens[token](input,config._a,config,token);}}
var YEAR=0;var MONTH=1;var DATE=2;var HOUR=3;var MINUTE=4;var SECOND=5;var MILLISECOND=6;var WEEK=7;var WEEKDAY=8;var indexOf;if(Array.prototype.indexOf){indexOf=Array.prototype.indexOf;}else{indexOf=function(o){var i;for(i=0;i<this.length;++i){if(this[i]===o){return i;}}
return-1;};}
var indexOf$1=indexOf;function daysInMonth(year,month){return new Date(Date.UTC(year,month+1,0)).getUTCDate();}
addFormatToken('M',['MM',2],'Mo',function(){return this.month()+1;});addFormatToken('MMM',0,0,function(format){return this.localeData().monthsShort(this,format);});addFormatToken('MMMM',0,0,function(format){return this.localeData().months(this,format);});addUnitAlias('month','M');addUnitPriority('month',8);addRegexToken('M',match1to2);addRegexToken('MM',match1to2,match2);addRegexToken('MMM',function(isStrict,locale){return locale.monthsShortRegex(isStrict);});addRegexToken('MMMM',function(isStrict,locale){return locale.monthsRegex(isStrict);});addParseToken(['M','MM'],function(input,array){array[MONTH]=toInt(input)-1;});addParseToken(['MMM','MMMM'],function(input,array,config,token){var month=config._locale.monthsParse(input,token,config._strict);if(month!=null){array[MONTH]=month;}else{getParsingFlags(config).invalidMonth=input;}});var MONTHS_IN_FORMAT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/;var defaultLocaleMonths='January_February_March_April_May_June_July_August_September_October_November_December'.split('_');function localeMonths(m,format){if(!m){return this._months;}
return isArray(this._months)?this._months[m.month()]:this._months[(this._months.isFormat||MONTHS_IN_FORMAT).test(format)?'format':'standalone'][m.month()];}
var defaultLocaleMonthsShort='Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec'.split('_');function localeMonthsShort(m,format){if(!m){return this._monthsShort;}
return isArray(this._monthsShort)?this._monthsShort[m.month()]:this._monthsShort[MONTHS_IN_FORMAT.test(format)?'format':'standalone'][m.month()];}
function handleStrictParse(monthName,format,strict){var i,ii,mom,llc=monthName.toLocaleLowerCase();if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[];for(i=0;i<12;++i){mom=createUTC([2000,i]);this._shortMonthsParse[i]=this.monthsShort(mom,'').toLocaleLowerCase();this._longMonthsParse[i]=this.months(mom,'').toLocaleLowerCase();}}
if(strict){if(format==='MMM'){ii=indexOf$1.call(this._shortMonthsParse,llc);return ii!==-1?ii:null;}else{ii=indexOf$1.call(this._longMonthsParse,llc);return ii!==-1?ii:null;}}else{if(format==='MMM'){ii=indexOf$1.call(this._shortMonthsParse,llc);if(ii!==-1){return ii;}
ii=indexOf$1.call(this._longMonthsParse,llc);return ii!==-1?ii:null;}else{ii=indexOf$1.call(this._longMonthsParse,llc);if(ii!==-1){return ii;}
ii=indexOf$1.call(this._shortMonthsParse,llc);return ii!==-1?ii:null;}}}
function localeMonthsParse(monthName,format,strict){var i,mom,regex;if(this._monthsParseExact){return handleStrictParse.call(this,monthName,format,strict);}
if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[];}
for(i=0;i<12;i++){mom=createUTC([2000,i]);if(strict&&!this._longMonthsParse[i]){this._longMonthsParse[i]=new RegExp('^'+this.months(mom,'').replace('.','')+'$','i');this._shortMonthsParse[i]=new RegExp('^'+this.monthsShort(mom,'').replace('.','')+'$','i');}
if(!strict&&!this._monthsParse[i]){regex='^'+this.months(mom,'')+'|^'+this.monthsShort(mom,'');this._monthsParse[i]=new RegExp(regex.replace('.',''),'i');}
if(strict&&format==='MMMM'&&this._longMonthsParse[i].test(monthName)){return i;}else if(strict&&format==='MMM'&&this._shortMonthsParse[i].test(monthName)){return i;}else if(!strict&&this._monthsParse[i].test(monthName)){return i;}}}
function setMonth(mom,value){var dayOfMonth;if(!mom.isValid()){return mom;}
if(typeof value==='string'){if(/^\d+$/.test(value)){value=toInt(value);}else{value=mom.localeData().monthsParse(value);if(!isNumber(value)){return mom;}}}
dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value));mom._d['set'+(mom._isUTC?'UTC':'')+'Month'](value,dayOfMonth);return mom;}
function getSetMonth(value){if(value!=null){setMonth(this,value);hooks.updateOffset(this,true);return this;}else{return get(this,'Month');}}
function getDaysInMonth(){return daysInMonth(this.year(),this.month());}
var defaultMonthsShortRegex=matchWord;function monthsShortRegex(isStrict){if(this._monthsParseExact){if(!hasOwnProp(this,'_monthsRegex')){computeMonthsParse.call(this);}
if(isStrict){return this._monthsShortStrictRegex;}else{return this._monthsShortRegex;}}else{if(!hasOwnProp(this,'_monthsShortRegex')){this._monthsShortRegex=defaultMonthsShortRegex;}
return this._monthsShortStrictRegex&&isStrict?this._monthsShortStrictRegex:this._monthsShortRegex;}}
var defaultMonthsRegex=matchWord;function monthsRegex(isStrict){if(this._monthsParseExact){if(!hasOwnProp(this,'_monthsRegex')){computeMonthsParse.call(this);}
if(isStrict){return this._monthsStrictRegex;}else{return this._monthsRegex;}}else{if(!hasOwnProp(this,'_monthsRegex')){this._monthsRegex=defaultMonthsRegex;}
return this._monthsStrictRegex&&isStrict?this._monthsStrictRegex:this._monthsRegex;}}
function computeMonthsParse(){function cmpLenRev(a,b){return b.length-a.length;}
var shortPieces=[],longPieces=[],mixedPieces=[],i,mom;for(i=0;i<12;i++){mom=createUTC([2000,i]);shortPieces.push(this.monthsShort(mom,''));longPieces.push(this.months(mom,''));mixedPieces.push(this.months(mom,''));mixedPieces.push(this.monthsShort(mom,''));}
shortPieces.sort(cmpLenRev);longPieces.sort(cmpLenRev);mixedPieces.sort(cmpLenRev);for(i=0;i<12;i++){shortPieces[i]=regexEscape(shortPieces[i]);longPieces[i]=regexEscape(longPieces[i]);}
for(i=0;i<24;i++){mixedPieces[i]=regexEscape(mixedPieces[i]);}
this._monthsRegex=new RegExp('^('+mixedPieces.join('|')+')','i');this._monthsShortRegex=this._monthsRegex;this._monthsStrictRegex=new RegExp('^('+longPieces.join('|')+')','i');this._monthsShortStrictRegex=new RegExp('^('+shortPieces.join('|')+')','i');}
addFormatToken('Y',0,0,function(){var y=this.year();return y<=9999?''+y:'+'+y;});addFormatToken(0,['YY',2],0,function(){return this.year()%100;});addFormatToken(0,['YYYY',4],0,'year');addFormatToken(0,['YYYYY',5],0,'year');addFormatToken(0,['YYYYYY',6,true],0,'year');addUnitAlias('year','y');addUnitPriority('year',1);addRegexToken('Y',matchSigned);addRegexToken('YY',match1to2,match2);addRegexToken('YYYY',match1to4,match4);addRegexToken('YYYYY',match1to6,match6);addRegexToken('YYYYYY',match1to6,match6);addParseToken(['YYYYY','YYYYYY'],YEAR);addParseToken('YYYY',function(input,array){array[YEAR]=input.length===2?hooks.parseTwoDigitYear(input):toInt(input);});addParseToken('YY',function(input,array){array[YEAR]=hooks.parseTwoDigitYear(input);});addParseToken('Y',function(input,array){array[YEAR]=parseInt(input,10);});function daysInYear(year){return isLeapYear(year)?366:365;}
function isLeapYear(year){return(year%4===0&&year%100!==0)||year%400===0;}
hooks.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2000);};var getSetYear=makeGetSet('FullYear',true);function getIsLeapYear(){return isLeapYear(this.year());}
function createDate(y,m,d,h,M,s,ms){var date=new Date(y,m,d,h,M,s,ms);if(y<100&&y>=0&&isFinite(date.getFullYear())){date.setFullYear(y);}
return date;}
function createUTCDate(y){var date=new Date(Date.UTC.apply(null,arguments));if(y<100&&y>=0&&isFinite(date.getUTCFullYear())){date.setUTCFullYear(y);}
return date;}
function firstWeekOffset(year,dow,doy){var
fwd=7+dow-doy,fwdlw=(7+createUTCDate(year,0,fwd).getUTCDay()-dow)%7;return-fwdlw+fwd-1;}
function dayOfYearFromWeeks(year,week,weekday,dow,doy){var localWeekday=(7+weekday-dow)%7,weekOffset=firstWeekOffset(year,dow,doy),dayOfYear=1+7*(week-1)+localWeekday+weekOffset,resYear,resDayOfYear;if(dayOfYear<=0){resYear=year-1;resDayOfYear=daysInYear(resYear)+dayOfYear;}else if(dayOfYear>daysInYear(year)){resYear=year+1;resDayOfYear=dayOfYear-daysInYear(year);}else{resYear=year;resDayOfYear=dayOfYear;}
return{year:resYear,dayOfYear:resDayOfYear};}
function weekOfYear(mom,dow,doy){var weekOffset=firstWeekOffset(mom.year(),dow,doy),week=Math.floor((mom.dayOfYear()-weekOffset-1)/7)+1,resWeek,resYear;if(week<1){resYear=mom.year()-1;resWeek=week+weeksInYear(resYear,dow,doy);}else if(week>weeksInYear(mom.year(),dow,doy)){resWeek=week-weeksInYear(mom.year(),dow,doy);resYear=mom.year()+1;}else{resYear=mom.year();resWeek=week;}
return{week:resWeek,year:resYear};}
function weeksInYear(year,dow,doy){var weekOffset=firstWeekOffset(year,dow,doy),weekOffsetNext=firstWeekOffset(year+1,dow,doy);return(daysInYear(year)-weekOffset+weekOffsetNext)/7;}
addFormatToken('w',['ww',2],'wo','week');addFormatToken('W',['WW',2],'Wo','isoWeek');addUnitAlias('week','w');addUnitAlias('isoWeek','W');addUnitPriority('week',5);addUnitPriority('isoWeek',5);addRegexToken('w',match1to2);addRegexToken('ww',match1to2,match2);addRegexToken('W',match1to2);addRegexToken('WW',match1to2,match2);addWeekParseToken(['w','ww','W','WW'],function(input,week,config,token){week[token.substr(0,1)]=toInt(input);});function localeWeek(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week;}
var defaultLocaleWeek={dow:0,doy:6};function localeFirstDayOfWeek(){return this._week.dow;}
function localeFirstDayOfYear(){return this._week.doy;}
function getSetWeek(input){var week=this.localeData().week(this);return input==null?week:this.add((input-week)*7,'d');}
function getSetISOWeek(input){var week=weekOfYear(this,1,4).week;return input==null?week:this.add((input-week)*7,'d');}
addFormatToken('d',0,'do','day');addFormatToken('dd',0,0,function(format){return this.localeData().weekdaysMin(this,format);});addFormatToken('ddd',0,0,function(format){return this.localeData().weekdaysShort(this,format);});addFormatToken('dddd',0,0,function(format){return this.localeData().weekdays(this,format);});addFormatToken('e',0,0,'weekday');addFormatToken('E',0,0,'isoWeekday');addUnitAlias('day','d');addUnitAlias('weekday','e');addUnitAlias('isoWeekday','E');addUnitPriority('day',11);addUnitPriority('weekday',11);addUnitPriority('isoWeekday',11);addRegexToken('d',match1to2);addRegexToken('e',match1to2);addRegexToken('E',match1to2);addRegexToken('dd',function(isStrict,locale){return locale.weekdaysMinRegex(isStrict);});addRegexToken('ddd',function(isStrict,locale){return locale.weekdaysShortRegex(isStrict);});addRegexToken('dddd',function(isStrict,locale){return locale.weekdaysRegex(isStrict);});addWeekParseToken(['dd','ddd','dddd'],function(input,week,config,token){var weekday=config._locale.weekdaysParse(input,token,config._strict);if(weekday!=null){week.d=weekday;}else{getParsingFlags(config).invalidWeekday=input;}});addWeekParseToken(['d','e','E'],function(input,week,config,token){week[token]=toInt(input);});function parseWeekday(input,locale){if(typeof input!=='string'){return input;}
if(!isNaN(input)){return parseInt(input,10);}
input=locale.weekdaysParse(input);if(typeof input==='number'){return input;}
return null;}
function parseIsoWeekday(input,locale){if(typeof input==='string'){return locale.weekdaysParse(input)%7||7;}
return isNaN(input)?null:input;}
var defaultLocaleWeekdays='Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday'.split('_');function localeWeekdays(m,format){if(!m){return this._weekdays;}
return isArray(this._weekdays)?this._weekdays[m.day()]:this._weekdays[this._weekdays.isFormat.test(format)?'format':'standalone'][m.day()];}
var defaultLocaleWeekdaysShort='Sun_Mon_Tue_Wed_Thu_Fri_Sat'.split('_');function localeWeekdaysShort(m){return(m)?this._weekdaysShort[m.day()]:this._weekdaysShort;}
var defaultLocaleWeekdaysMin='Su_Mo_Tu_We_Th_Fr_Sa'.split('_');function localeWeekdaysMin(m){return(m)?this._weekdaysMin[m.day()]:this._weekdaysMin;}
function handleStrictParse$1(weekdayName,format,strict){var i,ii,mom,llc=weekdayName.toLocaleLowerCase();if(!this._weekdaysParse){this._weekdaysParse=[];this._shortWeekdaysParse=[];this._minWeekdaysParse=[];for(i=0;i<7;++i){mom=createUTC([2000,1]).day(i);this._minWeekdaysParse[i]=this.weekdaysMin(mom,'').toLocaleLowerCase();this._shortWeekdaysParse[i]=this.weekdaysShort(mom,'').toLocaleLowerCase();this._weekdaysParse[i]=this.weekdays(mom,'').toLocaleLowerCase();}}
if(strict){if(format==='dddd'){ii=indexOf$1.call(this._weekdaysParse,llc);return ii!==-1?ii:null;}else if(format==='ddd'){ii=indexOf$1.call(this._shortWeekdaysParse,llc);return ii!==-1?ii:null;}else{ii=indexOf$1.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null;}}else{if(format==='dddd'){ii=indexOf$1.call(this._weekdaysParse,llc);if(ii!==-1){return ii;}
ii=indexOf$1.call(this._shortWeekdaysParse,llc);if(ii!==-1){return ii;}
ii=indexOf$1.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null;}else if(format==='ddd'){ii=indexOf$1.call(this._shortWeekdaysParse,llc);if(ii!==-1){return ii;}
ii=indexOf$1.call(this._weekdaysParse,llc);if(ii!==-1){return ii;}
ii=indexOf$1.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null;}else{ii=indexOf$1.call(this._minWeekdaysParse,llc);if(ii!==-1){return ii;}
ii=indexOf$1.call(this._weekdaysParse,llc);if(ii!==-1){return ii;}
ii=indexOf$1.call(this._shortWeekdaysParse,llc);return ii!==-1?ii:null;}}}
function localeWeekdaysParse(weekdayName,format,strict){var i,mom,regex;if(this._weekdaysParseExact){return handleStrictParse$1.call(this,weekdayName,format,strict);}
if(!this._weekdaysParse){this._weekdaysParse=[];this._minWeekdaysParse=[];this._shortWeekdaysParse=[];this._fullWeekdaysParse=[];}
for(i=0;i<7;i++){mom=createUTC([2000,1]).day(i);if(strict&&!this._fullWeekdaysParse[i]){this._fullWeekdaysParse[i]=new RegExp('^'+this.weekdays(mom,'').replace('.','\.?')+'$','i');this._shortWeekdaysParse[i]=new RegExp('^'+this.weekdaysShort(mom,'').replace('.','\.?')+'$','i');this._minWeekdaysParse[i]=new RegExp('^'+this.weekdaysMin(mom,'').replace('.','\.?')+'$','i');}
if(!this._weekdaysParse[i]){regex='^'+this.weekdays(mom,'')+'|^'+this.weekdaysShort(mom,'')+'|^'+this.weekdaysMin(mom,'');this._weekdaysParse[i]=new RegExp(regex.replace('.',''),'i');}
if(strict&&format==='dddd'&&this._fullWeekdaysParse[i].test(weekdayName)){return i;}else if(strict&&format==='ddd'&&this._shortWeekdaysParse[i].test(weekdayName)){return i;}else if(strict&&format==='dd'&&this._minWeekdaysParse[i].test(weekdayName)){return i;}else if(!strict&&this._weekdaysParse[i].test(weekdayName)){return i;}}}
function getSetDayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN;}
var day=this._isUTC?this._d.getUTCDay():this._d.getDay();if(input!=null){input=parseWeekday(input,this.localeData());return this.add(input-day,'d');}else{return day;}}
function getSetLocaleDayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN;}
var weekday=(this.day()+7-this.localeData()._week.dow)%7;return input==null?weekday:this.add(input-weekday,'d');}
function getSetISODayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN;}
if(input!=null){var weekday=parseIsoWeekday(input,this.localeData());return this.day(this.day()%7?weekday:weekday-7);}else{return this.day()||7;}}
var defaultWeekdaysRegex=matchWord;function weekdaysRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,'_weekdaysRegex')){computeWeekdaysParse.call(this);}
if(isStrict){return this._weekdaysStrictRegex;}else{return this._weekdaysRegex;}}else{if(!hasOwnProp(this,'_weekdaysRegex')){this._weekdaysRegex=defaultWeekdaysRegex;}
return this._weekdaysStrictRegex&&isStrict?this._weekdaysStrictRegex:this._weekdaysRegex;}}
var defaultWeekdaysShortRegex=matchWord;function weekdaysShortRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,'_weekdaysRegex')){computeWeekdaysParse.call(this);}
if(isStrict){return this._weekdaysShortStrictRegex;}else{return this._weekdaysShortRegex;}}else{if(!hasOwnProp(this,'_weekdaysShortRegex')){this._weekdaysShortRegex=defaultWeekdaysShortRegex;}
return this._weekdaysShortStrictRegex&&isStrict?this._weekdaysShortStrictRegex:this._weekdaysShortRegex;}}
var defaultWeekdaysMinRegex=matchWord;function weekdaysMinRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,'_weekdaysRegex')){computeWeekdaysParse.call(this);}
if(isStrict){return this._weekdaysMinStrictRegex;}else{return this._weekdaysMinRegex;}}else{if(!hasOwnProp(this,'_weekdaysMinRegex')){this._weekdaysMinRegex=defaultWeekdaysMinRegex;}
return this._weekdaysMinStrictRegex&&isStrict?this._weekdaysMinStrictRegex:this._weekdaysMinRegex;}}
function computeWeekdaysParse(){function cmpLenRev(a,b){return b.length-a.length;}
var minPieces=[],shortPieces=[],longPieces=[],mixedPieces=[],i,mom,minp,shortp,longp;for(i=0;i<7;i++){mom=createUTC([2000,1]).day(i);minp=this.weekdaysMin(mom,'');shortp=this.weekdaysShort(mom,'');longp=this.weekdays(mom,'');minPieces.push(minp);shortPieces.push(shortp);longPieces.push(longp);mixedPieces.push(minp);mixedPieces.push(shortp);mixedPieces.push(longp);}
minPieces.sort(cmpLenRev);shortPieces.sort(cmpLenRev);longPieces.sort(cmpLenRev);mixedPieces.sort(cmpLenRev);for(i=0;i<7;i++){shortPieces[i]=regexEscape(shortPieces[i]);longPieces[i]=regexEscape(longPieces[i]);mixedPieces[i]=regexEscape(mixedPieces[i]);}
this._weekdaysRegex=new RegExp('^('+mixedPieces.join('|')+')','i');this._weekdaysShortRegex=this._weekdaysRegex;this._weekdaysMinRegex=this._weekdaysRegex;this._weekdaysStrictRegex=new RegExp('^('+longPieces.join('|')+')','i');this._weekdaysShortStrictRegex=new RegExp('^('+shortPieces.join('|')+')','i');this._weekdaysMinStrictRegex=new RegExp('^('+minPieces.join('|')+')','i');}
function hFormat(){return this.hours()%12||12;}
function kFormat(){return this.hours()||24;}
addFormatToken('H',['HH',2],0,'hour');addFormatToken('h',['hh',2],0,hFormat);addFormatToken('k',['kk',2],0,kFormat);addFormatToken('hmm',0,0,function(){return''+hFormat.apply(this)+zeroFill(this.minutes(),2);});addFormatToken('hmmss',0,0,function(){return''+hFormat.apply(this)+zeroFill(this.minutes(),2)+
zeroFill(this.seconds(),2);});addFormatToken('Hmm',0,0,function(){return''+this.hours()+zeroFill(this.minutes(),2);});addFormatToken('Hmmss',0,0,function(){return''+this.hours()+zeroFill(this.minutes(),2)+
zeroFill(this.seconds(),2);});function meridiem(token,lowercase){addFormatToken(token,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),lowercase);});}
meridiem('a',true);meridiem('A',false);addUnitAlias('hour','h');addUnitPriority('hour',13);function matchMeridiem(isStrict,locale){return locale._meridiemParse;}
addRegexToken('a',matchMeridiem);addRegexToken('A',matchMeridiem);addRegexToken('H',match1to2);addRegexToken('h',match1to2);addRegexToken('HH',match1to2,match2);addRegexToken('hh',match1to2,match2);addRegexToken('hmm',match3to4);addRegexToken('hmmss',match5to6);addRegexToken('Hmm',match3to4);addRegexToken('Hmmss',match5to6);addParseToken(['H','HH'],HOUR);addParseToken(['a','A'],function(input,array,config){config._isPm=config._locale.isPM(input);config._meridiem=input;});addParseToken(['h','hh'],function(input,array,config){array[HOUR]=toInt(input);getParsingFlags(config).bigHour=true;});addParseToken('hmm',function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos));array[MINUTE]=toInt(input.substr(pos));getParsingFlags(config).bigHour=true;});addParseToken('hmmss',function(input,array,config){var pos1=input.length-4;var pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1));array[MINUTE]=toInt(input.substr(pos1,2));array[SECOND]=toInt(input.substr(pos2));getParsingFlags(config).bigHour=true;});addParseToken('Hmm',function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos));array[MINUTE]=toInt(input.substr(pos));});addParseToken('Hmmss',function(input,array,config){var pos1=input.length-4;var pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1));array[MINUTE]=toInt(input.substr(pos1,2));array[SECOND]=toInt(input.substr(pos2));});function localeIsPM(input){return((input+'').toLowerCase().charAt(0)==='p');}
var defaultLocaleMeridiemParse=/[ap]\.?m?\.?/i;function localeMeridiem(hours,minutes,isLower){if(hours>11){return isLower?'pm':'PM';}else{return isLower?'am':'AM';}}
var getSetHour=makeGetSet('Hours',true);var baseConfig={calendar:defaultCalendar,longDateFormat:defaultLongDateFormat,invalidDate:defaultInvalidDate,ordinal:defaultOrdinal,ordinalParse:defaultOrdinalParse,relativeTime:defaultRelativeTime,months:defaultLocaleMonths,monthsShort:defaultLocaleMonthsShort,week:defaultLocaleWeek,weekdays:defaultLocaleWeekdays,weekdaysMin:defaultLocaleWeekdaysMin,weekdaysShort:defaultLocaleWeekdaysShort,meridiemParse:defaultLocaleMeridiemParse};var locales={};var localeFamilies={};var globalLocale;function normalizeLocale(key){return key?key.toLowerCase().replace('_','-'):key;}
function chooseLocale(names){var i=0,j,next,locale,split;while(i<names.length){split=normalizeLocale(names[i]).split('-');j=split.length;next=normalizeLocale(names[i+1]);next=next?next.split('-'):null;while(j>0){locale=loadLocale(split.slice(0,j).join('-'));if(locale){return locale;}
if(next&&next.length>=j&&compareArrays(split,next,true)>=j-1){break;}
j--;}
i++;}
return null;}
function loadLocale(name){var oldLocale=null;if(!locales[name]&&(typeof module!=='undefined')&&module&&module.exports){try{oldLocale=globalLocale._abbr;require('./locale/'+name);getSetGlobalLocale(oldLocale);}catch(e){}}
return locales[name];}
function getSetGlobalLocale(key,values){var data;if(key){if(isUndefined(values)){data=getLocale(key);}
else{data=defineLocale(key,values);}
if(data){globalLocale=data;}}
return globalLocale._abbr;}
function defineLocale(name,config){if(config!==null){var parentConfig=baseConfig;config.abbr=name;if(locales[name]!=null){deprecateSimple('defineLocaleOverride','use moment.updateLocale(localeName, config) to change '+'an existing locale. moment.defineLocale(localeName, '+'config) should only be used for creating a new locale '+'See http://momentjs.com/guides/#/warnings/define-locale/ for more info.');parentConfig=locales[name]._config;}else if(config.parentLocale!=null){if(locales[config.parentLocale]!=null){parentConfig=locales[config.parentLocale]._config;}else{if(!localeFamilies[config.parentLocale]){localeFamilies[config.parentLocale]=[];}
localeFamilies[config.parentLocale].push({name:name,config:config});return null;}}
locales[name]=new Locale(mergeConfigs(parentConfig,config));if(localeFamilies[name]){localeFamilies[name].forEach(function(x){defineLocale(x.name,x.config);});}
getSetGlobalLocale(name);return locales[name];}else{delete locales[name];return null;}}
function updateLocale(name,config){if(config!=null){var locale,parentConfig=baseConfig;if(locales[name]!=null){parentConfig=locales[name]._config;}
config=mergeConfigs(parentConfig,config);locale=new Locale(config);locale.parentLocale=locales[name];locales[name]=locale;getSetGlobalLocale(name);}else{if(locales[name]!=null){if(locales[name].parentLocale!=null){locales[name]=locales[name].parentLocale;}else if(locales[name]!=null){delete locales[name];}}}
return locales[name];}
function getLocale(key){var locale;if(key&&key._locale&&key._locale._abbr){key=key._locale._abbr;}
if(!key){return globalLocale;}
if(!isArray(key)){locale=loadLocale(key);if(locale){return locale;}
key=[key];}
return chooseLocale(key);}
function listLocales(){return keys$1(locales);}
function checkOverflow(m){var overflow;var a=m._a;if(a&&getParsingFlags(m).overflow===-2){overflow=a[MONTH]<0||a[MONTH]>11?MONTH:a[DATE]<1||a[DATE]>daysInMonth(a[YEAR],a[MONTH])?DATE:a[HOUR]<0||a[HOUR]>24||(a[HOUR]===24&&(a[MINUTE]!==0||a[SECOND]!==0||a[MILLISECOND]!==0))?HOUR:a[MINUTE]<0||a[MINUTE]>59?MINUTE:a[SECOND]<0||a[SECOND]>59?SECOND:a[MILLISECOND]<0||a[MILLISECOND]>999?MILLISECOND:-1;if(getParsingFlags(m)._overflowDayOfYear&&(overflow<YEAR||overflow>DATE)){overflow=DATE;}
if(getParsingFlags(m)._overflowWeeks&&overflow===-1){overflow=WEEK;}
if(getParsingFlags(m)._overflowWeekday&&overflow===-1){overflow=WEEKDAY;}
getParsingFlags(m).overflow=overflow;}
return m;}
var extendedIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/;var basicIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/;var tzRegex=/Z|[+-]\d\d(?::?\d\d)?/;var isoDates=[['YYYYYY-MM-DD',/[+-]\d{6}-\d\d-\d\d/],['YYYY-MM-DD',/\d{4}-\d\d-\d\d/],['GGGG-[W]WW-E',/\d{4}-W\d\d-\d/],['GGGG-[W]WW',/\d{4}-W\d\d/,false],['YYYY-DDD',/\d{4}-\d{3}/],['YYYY-MM',/\d{4}-\d\d/,false],['YYYYYYMMDD',/[+-]\d{10}/],['YYYYMMDD',/\d{8}/],['GGGG[W]WWE',/\d{4}W\d{3}/],['GGGG[W]WW',/\d{4}W\d{2}/,false],['YYYYDDD',/\d{7}/]];var isoTimes=[['HH:mm:ss.SSSS',/\d\d:\d\d:\d\d\.\d+/],['HH:mm:ss,SSSS',/\d\d:\d\d:\d\d,\d+/],['HH:mm:ss',/\d\d:\d\d:\d\d/],['HH:mm',/\d\d:\d\d/],['HHmmss.SSSS',/\d\d\d\d\d\d\.\d+/],['HHmmss,SSSS',/\d\d\d\d\d\d,\d+/],['HHmmss',/\d\d\d\d\d\d/],['HHmm',/\d\d\d\d/],['HH',/\d\d/]];var aspNetJsonRegex=/^\/?Date\((\-?\d+)/i;function configFromISO(config){var i,l,string=config._i,match=extendedIsoRegex.exec(string)||basicIsoRegex.exec(string),allowTime,dateFormat,timeFormat,tzFormat;if(match){getParsingFlags(config).iso=true;for(i=0,l=isoDates.length;i<l;i++){if(isoDates[i][1].exec(match[1])){dateFormat=isoDates[i][0];allowTime=isoDates[i][2]!==false;break;}}
if(dateFormat==null){config._isValid=false;return;}
if(match[3]){for(i=0,l=isoTimes.length;i<l;i++){if(isoTimes[i][1].exec(match[3])){timeFormat=(match[2]||' ')+isoTimes[i][0];break;}}
if(timeFormat==null){config._isValid=false;return;}}
if(!allowTime&&timeFormat!=null){config._isValid=false;return;}
if(match[4]){if(tzRegex.exec(match[4])){tzFormat='Z';}else{config._isValid=false;return;}}
config._f=dateFormat+(timeFormat||'')+(tzFormat||'');configFromStringAndFormat(config);}else{config._isValid=false;}}
function configFromString(config){var matched=aspNetJsonRegex.exec(config._i);if(matched!==null){config._d=new Date(+matched[1]);return;}
configFromISO(config);if(config._isValid===false){delete config._isValid;hooks.createFromInputFallback(config);}}
hooks.createFromInputFallback=deprecate('value provided is not in a recognized ISO format. moment construction falls back to js Date(), '+'which is not reliable across all browsers and versions. Non ISO date formats are '+'discouraged and will be removed in an upcoming major release. Please refer to '+'http://momentjs.com/guides/#/warnings/js-date/ for more info.',function(config){config._d=new Date(config._i+(config._useUTC?' UTC':''));});function defaults(a,b,c){if(a!=null){return a;}
if(b!=null){return b;}
return c;}
function currentDateArray(config){var nowValue=new Date(hooks.now());if(config._useUTC){return[nowValue.getUTCFullYear(),nowValue.getUTCMonth(),nowValue.getUTCDate()];}
return[nowValue.getFullYear(),nowValue.getMonth(),nowValue.getDate()];}
function configFromArray(config){var i,date,input=[],currentDate,yearToUse;if(config._d){return;}
currentDate=currentDateArray(config);if(config._w&&config._a[DATE]==null&&config._a[MONTH]==null){dayOfYearFromWeekInfo(config);}
if(config._dayOfYear){yearToUse=defaults(config._a[YEAR],currentDate[YEAR]);if(config._dayOfYear>daysInYear(yearToUse)){getParsingFlags(config)._overflowDayOfYear=true;}
date=createUTCDate(yearToUse,0,config._dayOfYear);config._a[MONTH]=date.getUTCMonth();config._a[DATE]=date.getUTCDate();}
for(i=0;i<3&&config._a[i]==null;++i){config._a[i]=input[i]=currentDate[i];}
for(;i<7;i++){config._a[i]=input[i]=(config._a[i]==null)?(i===2?1:0):config._a[i];}
if(config._a[HOUR]===24&&config._a[MINUTE]===0&&config._a[SECOND]===0&&config._a[MILLISECOND]===0){config._nextDay=true;config._a[HOUR]=0;}
config._d=(config._useUTC?createUTCDate:createDate).apply(null,input);if(config._tzm!=null){config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm);}
if(config._nextDay){config._a[HOUR]=24;}}
function dayOfYearFromWeekInfo(config){var w,weekYear,week,weekday,dow,doy,temp,weekdayOverflow;w=config._w;if(w.GG!=null||w.W!=null||w.E!=null){dow=1;doy=4;weekYear=defaults(w.GG,config._a[YEAR],weekOfYear(createLocal(),1,4).year);week=defaults(w.W,1);weekday=defaults(w.E,1);if(weekday<1||weekday>7){weekdayOverflow=true;}}else{dow=config._locale._week.dow;doy=config._locale._week.doy;var curWeek=weekOfYear(createLocal(),dow,doy);weekYear=defaults(w.gg,config._a[YEAR],curWeek.year);week=defaults(w.w,curWeek.week);if(w.d!=null){weekday=w.d;if(weekday<0||weekday>6){weekdayOverflow=true;}}else if(w.e!=null){weekday=w.e+dow;if(w.e<0||w.e>6){weekdayOverflow=true;}}else{weekday=dow;}}
if(week<1||week>weeksInYear(weekYear,dow,doy)){getParsingFlags(config)._overflowWeeks=true;}else if(weekdayOverflow!=null){getParsingFlags(config)._overflowWeekday=true;}else{temp=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy);config._a[YEAR]=temp.year;config._dayOfYear=temp.dayOfYear;}}
hooks.ISO_8601=function(){};function configFromStringAndFormat(config){if(config._f===hooks.ISO_8601){configFromISO(config);return;}
config._a=[];getParsingFlags(config).empty=true;var string=''+config._i,i,parsedInput,tokens,token,skipped,stringLength=string.length,totalParsedInputLength=0;tokens=expandFormat(config._f,config._locale).match(formattingTokens)||[];for(i=0;i<tokens.length;i++){token=tokens[i];parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0];if(parsedInput){skipped=string.substr(0,string.indexOf(parsedInput));if(skipped.length>0){getParsingFlags(config).unusedInput.push(skipped);}
string=string.slice(string.indexOf(parsedInput)+parsedInput.length);totalParsedInputLength+=parsedInput.length;}
if(formatTokenFunctions[token]){if(parsedInput){getParsingFlags(config).empty=false;}
else{getParsingFlags(config).unusedTokens.push(token);}
addTimeToArrayFromToken(token,parsedInput,config);}
else if(config._strict&&!parsedInput){getParsingFlags(config).unusedTokens.push(token);}}
getParsingFlags(config).charsLeftOver=stringLength-totalParsedInputLength;if(string.length>0){getParsingFlags(config).unusedInput.push(string);}
if(config._a[HOUR]<=12&&getParsingFlags(config).bigHour===true&&config._a[HOUR]>0){getParsingFlags(config).bigHour=undefined;}
getParsingFlags(config).parsedDateParts=config._a.slice(0);getParsingFlags(config).meridiem=config._meridiem;config._a[HOUR]=meridiemFixWrap(config._locale,config._a[HOUR],config._meridiem);configFromArray(config);checkOverflow(config);}
function meridiemFixWrap(locale,hour,meridiem){var isPm;if(meridiem==null){return hour;}
if(locale.meridiemHour!=null){return locale.meridiemHour(hour,meridiem);}else if(locale.isPM!=null){isPm=locale.isPM(meridiem);if(isPm&&hour<12){hour+=12;}
if(!isPm&&hour===12){hour=0;}
return hour;}else{return hour;}}
function configFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore;if(config._f.length===0){getParsingFlags(config).invalidFormat=true;config._d=new Date(NaN);return;}
for(i=0;i<config._f.length;i++){currentScore=0;tempConfig=copyConfig({},config);if(config._useUTC!=null){tempConfig._useUTC=config._useUTC;}
tempConfig._f=config._f[i];configFromStringAndFormat(tempConfig);if(!isValid(tempConfig)){continue;}
currentScore+=getParsingFlags(tempConfig).charsLeftOver;currentScore+=getParsingFlags(tempConfig).unusedTokens.length*10;getParsingFlags(tempConfig).score=currentScore;if(scoreToBeat==null||currentScore<scoreToBeat){scoreToBeat=currentScore;bestMoment=tempConfig;}}
extend(config,bestMoment||tempConfig);}
function configFromObject(config){if(config._d){return;}
var i=normalizeObjectUnits(config._i);config._a=map([i.year,i.month,i.day||i.date,i.hour,i.minute,i.second,i.millisecond],function(obj){return obj&&parseInt(obj,10);});configFromArray(config);}
function createFromConfig(config){var res=new Moment(checkOverflow(prepareConfig(config)));if(res._nextDay){res.add(1,'d');res._nextDay=undefined;}
return res;}
function prepareConfig(config){var input=config._i,format=config._f;config._locale=config._locale||getLocale(config._l);if(input===null||(format===undefined&&input==='')){return createInvalid({nullInput:true});}
if(typeof input==='string'){config._i=input=config._locale.preparse(input);}
if(isMoment(input)){return new Moment(checkOverflow(input));}else if(isDate(input)){config._d=input;}else if(isArray(format)){configFromStringAndArray(config);}else if(format){configFromStringAndFormat(config);}else{configFromInput(config);}
if(!isValid(config)){config._d=null;}
return config;}
function configFromInput(config){var input=config._i;if(input===undefined){config._d=new Date(hooks.now());}else if(isDate(input)){config._d=new Date(input.valueOf());}else if(typeof input==='string'){configFromString(config);}else if(isArray(input)){config._a=map(input.slice(0),function(obj){return parseInt(obj,10);});configFromArray(config);}else if(typeof(input)==='object'){configFromObject(config);}else if(isNumber(input)){config._d=new Date(input);}else{hooks.createFromInputFallback(config);}}
function createLocalOrUTC(input,format,locale,strict,isUTC){var c={};if(locale===true||locale===false){strict=locale;locale=undefined;}
if((isObject(input)&&isObjectEmpty(input))||(isArray(input)&&input.length===0)){input=undefined;}
c._isAMomentObject=true;c._useUTC=c._isUTC=isUTC;c._l=locale;c._i=input;c._f=format;c._strict=strict;return createFromConfig(c);}
function createLocal(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,false);}
var prototypeMin=deprecate('moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/',function(){var other=createLocal.apply(null,arguments);if(this.isValid()&&other.isValid()){return other<this?this:other;}else{return createInvalid();}});var prototypeMax=deprecate('moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/',function(){var other=createLocal.apply(null,arguments);if(this.isValid()&&other.isValid()){return other>this?this:other;}else{return createInvalid();}});function pickBy(fn,moments){var res,i;if(moments.length===1&&isArray(moments[0])){moments=moments[0];}
if(!moments.length){return createLocal();}
res=moments[0];for(i=1;i<moments.length;++i){if(!moments[i].isValid()||moments[i][fn](res)){res=moments[i];}}
return res;}
function min(){var args=[].slice.call(arguments,0);return pickBy('isBefore',args);}
function max(){var args=[].slice.call(arguments,0);return pickBy('isAfter',args);}
var now=function(){return Date.now?Date.now():+(new Date());};function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._milliseconds=+milliseconds+
seconds*1e3+
minutes*6e4+
hours*1000*60*60;this._days=+days+
weeks*7;this._months=+months+
quarters*3+
years*12;this._data={};this._locale=getLocale();this._bubble();}
function isDuration(obj){return obj instanceof Duration;}
function absRound(number){if(number<0){return Math.round(-1*number)*-1;}else{return Math.round(number);}}
function offset(token,separator){addFormatToken(token,0,0,function(){var offset=this.utcOffset();var sign='+';if(offset<0){offset=-offset;sign='-';}
return sign+zeroFill(~~(offset/60),2)+separator+zeroFill(~~(offset)%60,2);});}
offset('Z',':');offset('ZZ','');addRegexToken('Z',matchShortOffset);addRegexToken('ZZ',matchShortOffset);addParseToken(['Z','ZZ'],function(input,array,config){config._useUTC=true;config._tzm=offsetFromString(matchShortOffset,input);});var chunkOffset=/([\+\-]|\d\d)/gi;function offsetFromString(matcher,string){var matches=(string||'').match(matcher);if(matches===null){return null;}
var chunk=matches[matches.length-1]||[];var parts=(chunk+'').match(chunkOffset)||['-',0,0];var minutes=+(parts[1]*60)+toInt(parts[2]);return minutes===0?0:parts[0]==='+'?minutes:-minutes;}
function cloneWithOffset(input,model){var res,diff;if(model._isUTC){res=model.clone();diff=(isMoment(input)||isDate(input)?input.valueOf():createLocal(input).valueOf())-res.valueOf();res._d.setTime(res._d.valueOf()+diff);hooks.updateOffset(res,false);return res;}else{return createLocal(input).local();}}
function getDateOffset(m){return-Math.round(m._d.getTimezoneOffset()/15)*15;}
hooks.updateOffset=function(){};function getSetOffset(input,keepLocalTime){var offset=this._offset||0,localAdjust;if(!this.isValid()){return input!=null?this:NaN;}
if(input!=null){if(typeof input==='string'){input=offsetFromString(matchShortOffset,input);if(input===null){return this;}}else if(Math.abs(input)<16){input=input*60;}
if(!this._isUTC&&keepLocalTime){localAdjust=getDateOffset(this);}
this._offset=input;this._isUTC=true;if(localAdjust!=null){this.add(localAdjust,'m');}
if(offset!==input){if(!keepLocalTime||this._changeInProgress){addSubtract(this,createDuration(input-offset,'m'),1,false);}else if(!this._changeInProgress){this._changeInProgress=true;hooks.updateOffset(this,true);this._changeInProgress=null;}}
return this;}else{return this._isUTC?offset:getDateOffset(this);}}
function getSetZone(input,keepLocalTime){if(input!=null){if(typeof input!=='string'){input=-input;}
this.utcOffset(input,keepLocalTime);return this;}else{return-this.utcOffset();}}
function setOffsetToUTC(keepLocalTime){return this.utcOffset(0,keepLocalTime);}
function setOffsetToLocal(keepLocalTime){if(this._isUTC){this.utcOffset(0,keepLocalTime);this._isUTC=false;if(keepLocalTime){this.subtract(getDateOffset(this),'m');}}
return this;}
function setOffsetToParsedOffset(){if(this._tzm!=null){this.utcOffset(this._tzm);}else if(typeof this._i==='string'){var tZone=offsetFromString(matchOffset,this._i);if(tZone!=null){this.utcOffset(tZone);}
else{this.utcOffset(0,true);}}
return this;}
function hasAlignedHourOffset(input){if(!this.isValid()){return false;}
input=input?createLocal(input).utcOffset():0;return(this.utcOffset()-input)%60===0;}
function isDaylightSavingTime(){return(this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset());}
function isDaylightSavingTimeShifted(){if(!isUndefined(this._isDSTShifted)){return this._isDSTShifted;}
var c={};copyConfig(c,this);c=prepareConfig(c);if(c._a){var other=c._isUTC?createUTC(c._a):createLocal(c._a);this._isDSTShifted=this.isValid()&&compareArrays(c._a,other.toArray())>0;}else{this._isDSTShifted=false;}
return this._isDSTShifted;}
function isLocal(){return this.isValid()?!this._isUTC:false;}
function isUtcOffset(){return this.isValid()?this._isUTC:false;}
function isUtc(){return this.isValid()?this._isUTC&&this._offset===0:false;}
var aspNetRegex=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/;var isoRegex=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;function createDuration(input,key){var duration=input,match=null,sign,ret,diffRes;if(isDuration(input)){duration={ms:input._milliseconds,d:input._days,M:input._months};}else if(isNumber(input)){duration={};if(key){duration[key]=input;}else{duration.milliseconds=input;}}else if(!!(match=aspNetRegex.exec(input))){sign=(match[1]==='-')?-1:1;duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(absRound(match[MILLISECOND]*1000))*sign};}else if(!!(match=isoRegex.exec(input))){sign=(match[1]==='-')?-1:1;duration={y:parseIso(match[2],sign),M:parseIso(match[3],sign),w:parseIso(match[4],sign),d:parseIso(match[5],sign),h:parseIso(match[6],sign),m:parseIso(match[7],sign),s:parseIso(match[8],sign)};}else if(duration==null){duration={};}else if(typeof duration==='object'&&('from'in duration||'to'in duration)){diffRes=momentsDifference(createLocal(duration.from),createLocal(duration.to));duration={};duration.ms=diffRes.milliseconds;duration.M=diffRes.months;}
ret=new Duration(duration);if(isDuration(input)&&hasOwnProp(input,'_locale')){ret._locale=input._locale;}
return ret;}
createDuration.fn=Duration.prototype;function parseIso(inp,sign){var res=inp&&parseFloat(inp.replace(',','.'));return(isNaN(res)?0:res)*sign;}
function positiveMomentsDifference(base,other){var res={milliseconds:0,months:0};res.months=other.month()-base.month()+
(other.year()-base.year())*12;if(base.clone().add(res.months,'M').isAfter(other)){--res.months;}
res.milliseconds=+other-+(base.clone().add(res.months,'M'));return res;}
function momentsDifference(base,other){var res;if(!(base.isValid()&&other.isValid())){return{milliseconds:0,months:0};}
other=cloneWithOffset(other,base);if(base.isBefore(other)){res=positiveMomentsDifference(base,other);}else{res=positiveMomentsDifference(other,base);res.milliseconds=-res.milliseconds;res.months=-res.months;}
return res;}
function createAdder(direction,name){return function(val,period){var dur,tmp;if(period!==null&&!isNaN(+period)){deprecateSimple(name,'moment().'+name+'(period, number) is deprecated. Please use moment().'+name+'(number, period). '+'See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info.');tmp=val;val=period;period=tmp;}
val=typeof val==='string'?+val:val;dur=createDuration(val,period);addSubtract(this,dur,direction);return this;};}
function addSubtract(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=absRound(duration._days),months=absRound(duration._months);if(!mom.isValid()){return;}
updateOffset=updateOffset==null?true:updateOffset;if(milliseconds){mom._d.setTime(mom._d.valueOf()+milliseconds*isAdding);}
if(days){set$1(mom,'Date',get(mom,'Date')+days*isAdding);}
if(months){setMonth(mom,get(mom,'Month')+months*isAdding);}
if(updateOffset){hooks.updateOffset(mom,days||months);}}
var add=createAdder(1,'add');var subtract=createAdder(-1,'subtract');function getCalendarFormat(myMoment,now){var diff=myMoment.diff(now,'days',true);return diff<-6?'sameElse':diff<-1?'lastWeek':diff<0?'lastDay':diff<1?'sameDay':diff<2?'nextDay':diff<7?'nextWeek':'sameElse';}
function calendar$1(time,formats){var now=time||createLocal(),sod=cloneWithOffset(now,this).startOf('day'),format=hooks.calendarFormat(this,sod)||'sameElse';var output=formats&&(isFunction(formats[format])?formats[format].call(this,now):formats[format]);return this.format(output||this.localeData().calendar(format,this,createLocal(now)));}
function clone(){return new Moment(this);}
function isAfter(input,units){var localInput=isMoment(input)?input:createLocal(input);if(!(this.isValid()&&localInput.isValid())){return false;}
units=normalizeUnits(!isUndefined(units)?units:'millisecond');if(units==='millisecond'){return this.valueOf()>localInput.valueOf();}else{return localInput.valueOf()<this.clone().startOf(units).valueOf();}}
function isBefore(input,units){var localInput=isMoment(input)?input:createLocal(input);if(!(this.isValid()&&localInput.isValid())){return false;}
units=normalizeUnits(!isUndefined(units)?units:'millisecond');if(units==='millisecond'){return this.valueOf()<localInput.valueOf();}else{return this.clone().endOf(units).valueOf()<localInput.valueOf();}}
function isBetween(from,to,units,inclusivity){inclusivity=inclusivity||'()';return(inclusivity[0]==='('?this.isAfter(from,units):!this.isBefore(from,units))&&(inclusivity[1]===')'?this.isBefore(to,units):!this.isAfter(to,units));}
function isSame(input,units){var localInput=isMoment(input)?input:createLocal(input),inputMs;if(!(this.isValid()&&localInput.isValid())){return false;}
units=normalizeUnits(units||'millisecond');if(units==='millisecond'){return this.valueOf()===localInput.valueOf();}else{inputMs=localInput.valueOf();return this.clone().startOf(units).valueOf()<=inputMs&&inputMs<=this.clone().endOf(units).valueOf();}}
function isSameOrAfter(input,units){return this.isSame(input,units)||this.isAfter(input,units);}
function isSameOrBefore(input,units){return this.isSame(input,units)||this.isBefore(input,units);}
function diff(input,units,asFloat){var that,zoneDelta,delta,output;if(!this.isValid()){return NaN;}
that=cloneWithOffset(input,this);if(!that.isValid()){return NaN;}
zoneDelta=(that.utcOffset()-this.utcOffset())*6e4;units=normalizeUnits(units);if(units==='year'||units==='month'||units==='quarter'){output=monthDiff(this,that);if(units==='quarter'){output=output/3;}else if(units==='year'){output=output/12;}}else{delta=this-that;output=units==='second'?delta/1e3:units==='minute'?delta/6e4:units==='hour'?delta/36e5:units==='day'?(delta-zoneDelta)/864e5:units==='week'?(delta-zoneDelta)/6048e5:delta;}
return asFloat?output:absFloor(output);}
function monthDiff(a,b){var wholeMonthDiff=((b.year()-a.year())*12)+(b.month()-a.month()),anchor=a.clone().add(wholeMonthDiff,'months'),anchor2,adjust;if(b-anchor<0){anchor2=a.clone().add(wholeMonthDiff-1,'months');adjust=(b-anchor)/(anchor-anchor2);}else{anchor2=a.clone().add(wholeMonthDiff+1,'months');adjust=(b-anchor)/(anchor2-anchor);}
return-(wholeMonthDiff+adjust)||0;}
hooks.defaultFormat='YYYY-MM-DDTHH:mm:ssZ';hooks.defaultFormatUtc='YYYY-MM-DDTHH:mm:ss[Z]';function toString(){return this.clone().locale('en').format('ddd MMM DD YYYY HH:mm:ss [GMT]ZZ');}
function toISOString(){var m=this.clone().utc();if(0<m.year()&&m.year()<=9999){if(isFunction(Date.prototype.toISOString)){return this.toDate().toISOString();}else{return formatMoment(m,'YYYY-MM-DD[T]HH:mm:ss.SSS[Z]');}}else{return formatMoment(m,'YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]');}}
function inspect(){if(!this.isValid()){return'moment.invalid(/* '+this._i+' */)';}
var func='moment';var zone='';if(!this.isLocal()){func=this.utcOffset()===0?'moment.utc':'moment.parseZone';zone='Z';}
var prefix='['+func+'("]';var year=(0<this.year()&&this.year()<=9999)?'YYYY':'YYYYYY';var datetime='-MM-DD[T]HH:mm:ss.SSS';var suffix=zone+'[")]';return this.format(prefix+year+datetime+suffix);}
function format(inputString){if(!inputString){inputString=this.isUtc()?hooks.defaultFormatUtc:hooks.defaultFormat;}
var output=formatMoment(this,inputString);return this.localeData().postformat(output);}
function from(time,withoutSuffix){if(this.isValid()&&((isMoment(time)&&time.isValid())||createLocal(time).isValid())){return createDuration({to:this,from:time}).locale(this.locale()).humanize(!withoutSuffix);}else{return this.localeData().invalidDate();}}
function fromNow(withoutSuffix){return this.from(createLocal(),withoutSuffix);}
function to(time,withoutSuffix){if(this.isValid()&&((isMoment(time)&&time.isValid())||createLocal(time).isValid())){return createDuration({from:this,to:time}).locale(this.locale()).humanize(!withoutSuffix);}else{return this.localeData().invalidDate();}}
function toNow(withoutSuffix){return this.to(createLocal(),withoutSuffix);}
function locale(key){var newLocaleData;if(key===undefined){return this._locale._abbr;}else{newLocaleData=getLocale(key);if(newLocaleData!=null){this._locale=newLocaleData;}
return this;}}
var lang=deprecate('moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.',function(key){if(key===undefined){return this.localeData();}else{return this.locale(key);}});function localeData(){return this._locale;}
function startOf(units){units=normalizeUnits(units);switch(units){case'year':this.month(0);case'quarter':case'month':this.date(1);case'week':case'isoWeek':case'day':case'date':this.hours(0);case'hour':this.minutes(0);case'minute':this.seconds(0);case'second':this.milliseconds(0);}
if(units==='week'){this.weekday(0);}
if(units==='isoWeek'){this.isoWeekday(1);}
if(units==='quarter'){this.month(Math.floor(this.month()/3)*3);}
return this;}
function endOf(units){units=normalizeUnits(units);if(units===undefined||units==='millisecond'){return this;}
if(units==='date'){units='day';}
return this.startOf(units).add(1,(units==='isoWeek'?'week':units)).subtract(1,'ms');}
function valueOf(){return this._d.valueOf()-((this._offset||0)*60000);}
function unix(){return Math.floor(this.valueOf()/1000);}
function toDate(){return new Date(this.valueOf());}
function toArray(){var m=this;return[m.year(),m.month(),m.date(),m.hour(),m.minute(),m.second(),m.millisecond()];}
function toObject(){var m=this;return{years:m.year(),months:m.month(),date:m.date(),hours:m.hours(),minutes:m.minutes(),seconds:m.seconds(),milliseconds:m.milliseconds()};}
function toJSON(){return this.isValid()?this.toISOString():null;}
function isValid$1(){return isValid(this);}
function parsingFlags(){return extend({},getParsingFlags(this));}
function invalidAt(){return getParsingFlags(this).overflow;}
function creationData(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict};}
addFormatToken(0,['gg',2],0,function(){return this.weekYear()%100;});addFormatToken(0,['GG',2],0,function(){return this.isoWeekYear()%100;});function addWeekYearFormatToken(token,getter){addFormatToken(0,[token,token.length],0,getter);}
addWeekYearFormatToken('gggg','weekYear');addWeekYearFormatToken('ggggg','weekYear');addWeekYearFormatToken('GGGG','isoWeekYear');addWeekYearFormatToken('GGGGG','isoWeekYear');addUnitAlias('weekYear','gg');addUnitAlias('isoWeekYear','GG');addUnitPriority('weekYear',1);addUnitPriority('isoWeekYear',1);addRegexToken('G',matchSigned);addRegexToken('g',matchSigned);addRegexToken('GG',match1to2,match2);addRegexToken('gg',match1to2,match2);addRegexToken('GGGG',match1to4,match4);addRegexToken('gggg',match1to4,match4);addRegexToken('GGGGG',match1to6,match6);addRegexToken('ggggg',match1to6,match6);addWeekParseToken(['gggg','ggggg','GGGG','GGGGG'],function(input,week,config,token){week[token.substr(0,2)]=toInt(input);});addWeekParseToken(['gg','GG'],function(input,week,config,token){week[token]=hooks.parseTwoDigitYear(input);});function getSetWeekYear(input){return getSetWeekYearHelper.call(this,input,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy);}
function getSetISOWeekYear(input){return getSetWeekYearHelper.call(this,input,this.isoWeek(),this.isoWeekday(),1,4);}
function getISOWeeksInYear(){return weeksInYear(this.year(),1,4);}
function getWeeksInYear(){var weekInfo=this.localeData()._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy);}
function getSetWeekYearHelper(input,week,weekday,dow,doy){var weeksTarget;if(input==null){return weekOfYear(this,dow,doy).year;}else{weeksTarget=weeksInYear(input,dow,doy);if(week>weeksTarget){week=weeksTarget;}
return setWeekAll.call(this,input,week,weekday,dow,doy);}}
function setWeekAll(weekYear,week,weekday,dow,doy){var dayOfYearData=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy),date=createUTCDate(dayOfYearData.year,0,dayOfYearData.dayOfYear);this.year(date.getUTCFullYear());this.month(date.getUTCMonth());this.date(date.getUTCDate());return this;}
addFormatToken('Q',0,'Qo','quarter');addUnitAlias('quarter','Q');addUnitPriority('quarter',7);addRegexToken('Q',match1);addParseToken('Q',function(input,array){array[MONTH]=(toInt(input)-1)*3;});function getSetQuarter(input){return input==null?Math.ceil((this.month()+1)/3):this.month((input-1)*3+this.month()%3);}
addFormatToken('D',['DD',2],'Do','date');addUnitAlias('date','D');addUnitPriority('date',9);addRegexToken('D',match1to2);addRegexToken('DD',match1to2,match2);addRegexToken('Do',function(isStrict,locale){return isStrict?locale._ordinalParse:locale._ordinalParseLenient;});addParseToken(['D','DD'],DATE);addParseToken('Do',function(input,array){array[DATE]=toInt(input.match(match1to2)[0],10);});var getSetDayOfMonth=makeGetSet('Date',true);addFormatToken('DDD',['DDDD',3],'DDDo','dayOfYear');addUnitAlias('dayOfYear','DDD');addUnitPriority('dayOfYear',4);addRegexToken('DDD',match1to3);addRegexToken('DDDD',match3);addParseToken(['DDD','DDDD'],function(input,array,config){config._dayOfYear=toInt(input);});function getSetDayOfYear(input){var dayOfYear=Math.round((this.clone().startOf('day')-this.clone().startOf('year'))/864e5)+1;return input==null?dayOfYear:this.add((input-dayOfYear),'d');}
addFormatToken('m',['mm',2],0,'minute');addUnitAlias('minute','m');addUnitPriority('minute',14);addRegexToken('m',match1to2);addRegexToken('mm',match1to2,match2);addParseToken(['m','mm'],MINUTE);var getSetMinute=makeGetSet('Minutes',false);addFormatToken('s',['ss',2],0,'second');addUnitAlias('second','s');addUnitPriority('second',15);addRegexToken('s',match1to2);addRegexToken('ss',match1to2,match2);addParseToken(['s','ss'],SECOND);var getSetSecond=makeGetSet('Seconds',false);addFormatToken('S',0,0,function(){return~~(this.millisecond()/100);});addFormatToken(0,['SS',2],0,function(){return~~(this.millisecond()/10);});addFormatToken(0,['SSS',3],0,'millisecond');addFormatToken(0,['SSSS',4],0,function(){return this.millisecond()*10;});addFormatToken(0,['SSSSS',5],0,function(){return this.millisecond()*100;});addFormatToken(0,['SSSSSS',6],0,function(){return this.millisecond()*1000;});addFormatToken(0,['SSSSSSS',7],0,function(){return this.millisecond()*10000;});addFormatToken(0,['SSSSSSSS',8],0,function(){return this.millisecond()*100000;});addFormatToken(0,['SSSSSSSSS',9],0,function(){return this.millisecond()*1000000;});addUnitAlias('millisecond','ms');addUnitPriority('millisecond',16);addRegexToken('S',match1to3,match1);addRegexToken('SS',match1to3,match2);addRegexToken('SSS',match1to3,match3);var token;for(token='SSSS';token.length<=9;token+='S'){addRegexToken(token,matchUnsigned);}
function parseMs(input,array){array[MILLISECOND]=toInt(('0.'+input)*1000);}
for(token='S';token.length<=9;token+='S'){addParseToken(token,parseMs);}
var getSetMillisecond=makeGetSet('Milliseconds',false);addFormatToken('z',0,0,'zoneAbbr');addFormatToken('zz',0,0,'zoneName');function getZoneAbbr(){return this._isUTC?'UTC':'';}
function getZoneName(){return this._isUTC?'Coordinated Universal Time':'';}
var proto=Moment.prototype;proto.add=add;proto.calendar=calendar$1;proto.clone=clone;proto.diff=diff;proto.endOf=endOf;proto.format=format;proto.from=from;proto.fromNow=fromNow;proto.to=to;proto.toNow=toNow;proto.get=stringGet;proto.invalidAt=invalidAt;proto.isAfter=isAfter;proto.isBefore=isBefore;proto.isBetween=isBetween;proto.isSame=isSame;proto.isSameOrAfter=isSameOrAfter;proto.isSameOrBefore=isSameOrBefore;proto.isValid=isValid$1;proto.lang=lang;proto.locale=locale;proto.localeData=localeData;proto.max=prototypeMax;proto.min=prototypeMin;proto.parsingFlags=parsingFlags;proto.set=stringSet;proto.startOf=startOf;proto.subtract=subtract;proto.toArray=toArray;proto.toObject=toObject;proto.toDate=toDate;proto.toISOString=toISOString;proto.inspect=inspect;proto.toJSON=toJSON;proto.toString=toString;proto.unix=unix;proto.valueOf=valueOf;proto.creationData=creationData;proto.year=getSetYear;proto.isLeapYear=getIsLeapYear;proto.weekYear=getSetWeekYear;proto.isoWeekYear=getSetISOWeekYear;proto.quarter=proto.quarters=getSetQuarter;proto.month=getSetMonth;proto.daysInMonth=getDaysInMonth;proto.week=proto.weeks=getSetWeek;proto.isoWeek=proto.isoWeeks=getSetISOWeek;proto.weeksInYear=getWeeksInYear;proto.isoWeeksInYear=getISOWeeksInYear;proto.date=getSetDayOfMonth;proto.day=proto.days=getSetDayOfWeek;proto.weekday=getSetLocaleDayOfWeek;proto.isoWeekday=getSetISODayOfWeek;proto.dayOfYear=getSetDayOfYear;proto.hour=proto.hours=getSetHour;proto.minute=proto.minutes=getSetMinute;proto.second=proto.seconds=getSetSecond;proto.millisecond=proto.milliseconds=getSetMillisecond;proto.utcOffset=getSetOffset;proto.utc=setOffsetToUTC;proto.local=setOffsetToLocal;proto.parseZone=setOffsetToParsedOffset;proto.hasAlignedHourOffset=hasAlignedHourOffset;proto.isDST=isDaylightSavingTime;proto.isLocal=isLocal;proto.isUtcOffset=isUtcOffset;proto.isUtc=isUtc;proto.isUTC=isUtc;proto.zoneAbbr=getZoneAbbr;proto.zoneName=getZoneName;proto.dates=deprecate('dates accessor is deprecated. Use date instead.',getSetDayOfMonth);proto.months=deprecate('months accessor is deprecated. Use month instead',getSetMonth);proto.years=deprecate('years accessor is deprecated. Use year instead',getSetYear);proto.zone=deprecate('moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/',getSetZone);proto.isDSTShifted=deprecate('isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information',isDaylightSavingTimeShifted);function createUnix(input){return createLocal(input*1000);}
function createInZone(){return createLocal.apply(null,arguments).parseZone();}
function preParsePostFormat(string){return string;}
var proto$1=Locale.prototype;proto$1.calendar=calendar;proto$1.longDateFormat=longDateFormat;proto$1.invalidDate=invalidDate;proto$1.ordinal=ordinal;proto$1.preparse=preParsePostFormat;proto$1.postformat=preParsePostFormat;proto$1.relativeTime=relativeTime;proto$1.pastFuture=pastFuture;proto$1.set=set;proto$1.months=localeMonths;proto$1.monthsShort=localeMonthsShort;proto$1.monthsParse=localeMonthsParse;proto$1.monthsRegex=monthsRegex;proto$1.monthsShortRegex=monthsShortRegex;proto$1.week=localeWeek;proto$1.firstDayOfYear=localeFirstDayOfYear;proto$1.firstDayOfWeek=localeFirstDayOfWeek;proto$1.weekdays=localeWeekdays;proto$1.weekdaysMin=localeWeekdaysMin;proto$1.weekdaysShort=localeWeekdaysShort;proto$1.weekdaysParse=localeWeekdaysParse;proto$1.weekdaysRegex=weekdaysRegex;proto$1.weekdaysShortRegex=weekdaysShortRegex;proto$1.weekdaysMinRegex=weekdaysMinRegex;proto$1.isPM=localeIsPM;proto$1.meridiem=localeMeridiem;function get$1(format,index,field,setter){var locale=getLocale();var utc=createUTC().set(setter,index);return locale[field](utc,format);}
function listMonthsImpl(format,index,field){if(isNumber(format)){index=format;format=undefined;}
format=format||'';if(index!=null){return get$1(format,index,field,'month');}
var i;var out=[];for(i=0;i<12;i++){out[i]=get$1(format,i,field,'month');}
return out;}
function listWeekdaysImpl(localeSorted,format,index,field){if(typeof localeSorted==='boolean'){if(isNumber(format)){index=format;format=undefined;}
format=format||'';}else{format=localeSorted;index=format;localeSorted=false;if(isNumber(format)){index=format;format=undefined;}
format=format||'';}
var locale=getLocale(),shift=localeSorted?locale._week.dow:0;if(index!=null){return get$1(format,(index+shift)%7,field,'day');}
var i;var out=[];for(i=0;i<7;i++){out[i]=get$1(format,(i+shift)%7,field,'day');}
return out;}
function listMonths(format,index){return listMonthsImpl(format,index,'months');}
function listMonthsShort(format,index){return listMonthsImpl(format,index,'monthsShort');}
function listWeekdays(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,'weekdays');}
function listWeekdaysShort(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,'weekdaysShort');}
function listWeekdaysMin(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,'weekdaysMin');}
getSetGlobalLocale('en',{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(number){var b=number%10,output=(toInt(number%100/10)===1)?'th':(b===1)?'st':(b===2)?'nd':(b===3)?'rd':'th';return number+output;}});hooks.lang=deprecate('moment.lang is deprecated. Use moment.locale instead.',getSetGlobalLocale);hooks.langData=deprecate('moment.langData is deprecated. Use moment.localeData instead.',getLocale);var mathAbs=Math.abs;function abs(){var data=this._data;this._milliseconds=mathAbs(this._milliseconds);this._days=mathAbs(this._days);this._months=mathAbs(this._months);data.milliseconds=mathAbs(data.milliseconds);data.seconds=mathAbs(data.seconds);data.minutes=mathAbs(data.minutes);data.hours=mathAbs(data.hours);data.months=mathAbs(data.months);data.years=mathAbs(data.years);return this;}
function addSubtract$1(duration,input,value,direction){var other=createDuration(input,value);duration._milliseconds+=direction*other._milliseconds;duration._days+=direction*other._days;duration._months+=direction*other._months;return duration._bubble();}
function add$1(input,value){return addSubtract$1(this,input,value,1);}
function subtract$1(input,value){return addSubtract$1(this,input,value,-1);}
function absCeil(number){if(number<0){return Math.floor(number);}else{return Math.ceil(number);}}
function bubble(){var milliseconds=this._milliseconds;var days=this._days;var months=this._months;var data=this._data;var seconds,minutes,hours,years,monthsFromDays;if(!((milliseconds>=0&&days>=0&&months>=0)||(milliseconds<=0&&days<=0&&months<=0))){milliseconds+=absCeil(monthsToDays(months)+days)*864e5;days=0;months=0;}
data.milliseconds=milliseconds%1000;seconds=absFloor(milliseconds/1000);data.seconds=seconds%60;minutes=absFloor(seconds/60);data.minutes=minutes%60;hours=absFloor(minutes/60);data.hours=hours%24;days+=absFloor(hours/24);monthsFromDays=absFloor(daysToMonths(days));months+=monthsFromDays;days-=absCeil(monthsToDays(monthsFromDays));years=absFloor(months/12);months%=12;data.days=days;data.months=months;data.years=years;return this;}
function daysToMonths(days){return days*4800/146097;}
function monthsToDays(months){return months*146097/4800;}
function as(units){var days;var months;var milliseconds=this._milliseconds;units=normalizeUnits(units);if(units==='month'||units==='year'){days=this._days+milliseconds/864e5;months=this._months+daysToMonths(days);return units==='month'?months:months/12;}else{days=this._days+Math.round(monthsToDays(this._months));switch(units){case'week':return days/7+milliseconds/6048e5;case'day':return days+milliseconds/864e5;case'hour':return days*24+milliseconds/36e5;case'minute':return days*1440+milliseconds/6e4;case'second':return days*86400+milliseconds/1000;case'millisecond':return Math.floor(days*864e5)+milliseconds;default:throw new Error('Unknown unit '+units);}}}
function valueOf$1(){return(this._milliseconds+
this._days*864e5+
(this._months%12)*2592e6+
toInt(this._months/12)*31536e6);}
function makeAs(alias){return function(){return this.as(alias);};}
var asMilliseconds=makeAs('ms');var asSeconds=makeAs('s');var asMinutes=makeAs('m');var asHours=makeAs('h');var asDays=makeAs('d');var asWeeks=makeAs('w');var asMonths=makeAs('M');var asYears=makeAs('y');function get$2(units){units=normalizeUnits(units);return this[units+'s']();}
function makeGetter(name){return function(){return this._data[name];};}
var milliseconds=makeGetter('milliseconds');var seconds=makeGetter('seconds');var minutes=makeGetter('minutes');var hours=makeGetter('hours');var days=makeGetter('days');var months=makeGetter('months');var years=makeGetter('years');function weeks(){return absFloor(this.days()/7);}
var round=Math.round;var thresholds={s:45,m:45,h:22,d:26,M:11};function substituteTimeAgo(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture);}
function relativeTime$1(posNegDuration,withoutSuffix,locale){var duration=createDuration(posNegDuration).abs();var seconds=round(duration.as('s'));var minutes=round(duration.as('m'));var hours=round(duration.as('h'));var days=round(duration.as('d'));var months=round(duration.as('M'));var years=round(duration.as('y'));var a=seconds<thresholds.s&&['s',seconds]||minutes<=1&&['m']||minutes<thresholds.m&&['mm',minutes]||hours<=1&&['h']||hours<thresholds.h&&['hh',hours]||days<=1&&['d']||days<thresholds.d&&['dd',days]||months<=1&&['M']||months<thresholds.M&&['MM',months]||years<=1&&['y']||['yy',years];a[2]=withoutSuffix;a[3]=+posNegDuration>0;a[4]=locale;return substituteTimeAgo.apply(null,a);}
function getSetRelativeTimeRounding(roundingFunction){if(roundingFunction===undefined){return round;}
if(typeof(roundingFunction)==='function'){round=roundingFunction;return true;}
return false;}
function getSetRelativeTimeThreshold(threshold,limit){if(thresholds[threshold]===undefined){return false;}
if(limit===undefined){return thresholds[threshold];}
thresholds[threshold]=limit;return true;}
function humanize(withSuffix){var locale=this.localeData();var output=relativeTime$1(this,!withSuffix,locale);if(withSuffix){output=locale.pastFuture(+this,output);}
return locale.postformat(output);}
var abs$1=Math.abs;function toISOString$1(){var seconds=abs$1(this._milliseconds)/1000;var days=abs$1(this._days);var months=abs$1(this._months);var minutes,hours,years;minutes=absFloor(seconds/60);hours=absFloor(minutes/60);seconds%=60;minutes%=60;years=absFloor(months/12);months%=12;var Y=years;var M=months;var D=days;var h=hours;var m=minutes;var s=seconds;var total=this.asSeconds();if(!total){return'P0D';}
return(total<0?'-':'')+'P'+
(Y?Y+'Y':'')+
(M?M+'M':'')+
(D?D+'D':'')+
((h||m||s)?'T':'')+
(h?h+'H':'')+
(m?m+'M':'')+
(s?s+'S':'');}
var proto$2=Duration.prototype;proto$2.abs=abs;proto$2.add=add$1;proto$2.subtract=subtract$1;proto$2.as=as;proto$2.asMilliseconds=asMilliseconds;proto$2.asSeconds=asSeconds;proto$2.asMinutes=asMinutes;proto$2.asHours=asHours;proto$2.asDays=asDays;proto$2.asWeeks=asWeeks;proto$2.asMonths=asMonths;proto$2.asYears=asYears;proto$2.valueOf=valueOf$1;proto$2._bubble=bubble;proto$2.get=get$2;proto$2.milliseconds=milliseconds;proto$2.seconds=seconds;proto$2.minutes=minutes;proto$2.hours=hours;proto$2.days=days;proto$2.weeks=weeks;proto$2.months=months;proto$2.years=years;proto$2.humanize=humanize;proto$2.toISOString=toISOString$1;proto$2.toString=toISOString$1;proto$2.toJSON=toISOString$1;proto$2.locale=locale;proto$2.localeData=localeData;proto$2.toIsoString=deprecate('toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)',toISOString$1);proto$2.lang=lang;addFormatToken('X',0,0,'unix');addFormatToken('x',0,0,'valueOf');addRegexToken('x',matchSigned);addRegexToken('X',matchTimestamp);addParseToken('X',function(input,array,config){config._d=new Date(parseFloat(input,10)*1000);});addParseToken('x',function(input,array,config){config._d=new Date(toInt(input));});hooks.version='2.17.1';setHookCallback(createLocal);hooks.fn=proto;hooks.min=min;hooks.max=max;hooks.now=now;hooks.utc=createUTC;hooks.unix=createUnix;hooks.months=listMonths;hooks.isDate=isDate;hooks.locale=getSetGlobalLocale;hooks.invalid=createInvalid;hooks.duration=createDuration;hooks.isMoment=isMoment;hooks.weekdays=listWeekdays;hooks.parseZone=createInZone;hooks.localeData=getLocale;hooks.isDuration=isDuration;hooks.monthsShort=listMonthsShort;hooks.weekdaysMin=listWeekdaysMin;hooks.defineLocale=defineLocale;hooks.updateLocale=updateLocale;hooks.locales=listLocales;hooks.weekdaysShort=listWeekdaysShort;hooks.normalizeUnits=normalizeUnits;hooks.relativeTimeRounding=getSetRelativeTimeRounding;hooks.relativeTimeThreshold=getSetRelativeTimeThreshold;hooks.calendarFormat=getCalendarFormat;hooks.prototype=proto;return hooks;})));;

/* /scrummer/static/src/js/libs/external/waypoint.js defined in bundle 'scrummer.assets' */
(function(){'use strict'
var keyCounter=0
var allWaypoints={}
function Waypoint(options){if(!options){throw new Error('No options passed to Waypoint constructor')}
if(!options.element){throw new Error('No element option passed to Waypoint constructor')}
if(!options.handler){throw new Error('No handler option passed to Waypoint constructor')}
this.key='waypoint-'+keyCounter
this.options=Waypoint.Adapter.extend({},Waypoint.defaults,options)
this.element=this.options.element
this.adapter=new Waypoint.Adapter(this.element)
this.callback=options.handler
this.axis=this.options.horizontal?'horizontal':'vertical'
this.enabled=this.options.enabled
this.triggerPoint=null
this.group=Waypoint.Group.findOrCreate({name:this.options.group,axis:this.axis})
this.context=Waypoint.Context.findOrCreateByElement(this.options.context)
if(Waypoint.offsetAliases[this.options.offset]){this.options.offset=Waypoint.offsetAliases[this.options.offset]}
this.group.add(this)
this.context.add(this)
allWaypoints[this.key]=this
keyCounter+=1}
Waypoint.prototype.queueTrigger=function(direction){this.group.queueTrigger(this,direction)}
Waypoint.prototype.trigger=function(args){if(!this.enabled){return}
if(this.callback){this.callback.apply(this,args)}}
Waypoint.prototype.destroy=function(){this.context.remove(this)
this.group.remove(this)
delete allWaypoints[this.key]}
Waypoint.prototype.disable=function(){this.enabled=false
return this}
Waypoint.prototype.enable=function(){this.context.refresh()
this.enabled=true
return this}
Waypoint.prototype.next=function(){return this.group.next(this)}
Waypoint.prototype.previous=function(){return this.group.previous(this)}
Waypoint.invokeAll=function(method){var allWaypointsArray=[]
for(var waypointKey in allWaypoints){allWaypointsArray.push(allWaypoints[waypointKey])}
for(var i=0,end=allWaypointsArray.length;i<end;i++){allWaypointsArray[i][method]()}}
Waypoint.destroyAll=function(){Waypoint.invokeAll('destroy')}
Waypoint.disableAll=function(){Waypoint.invokeAll('disable')}
Waypoint.enableAll=function(){Waypoint.Context.refreshAll()
for(var waypointKey in allWaypoints){allWaypoints[waypointKey].enabled=true}
return this}
Waypoint.refreshAll=function(){Waypoint.Context.refreshAll()}
Waypoint.viewportHeight=function(){return window.innerHeight||document.documentElement.clientHeight}
Waypoint.viewportWidth=function(){return document.documentElement.clientWidth}
Waypoint.adapters=[]
Waypoint.defaults={context:window,continuous:true,enabled:true,group:'default',horizontal:false,offset:0}
Waypoint.offsetAliases={'bottom-in-view':function(){return this.context.innerHeight()-this.adapter.outerHeight()},'right-in-view':function(){return this.context.innerWidth()-this.adapter.outerWidth()}}
window.Waypoint=Waypoint}());(function(){'use strict'
function requestAnimationFrameShim(callback){window.setTimeout(callback,1000/60)}
var keyCounter=0
var contexts={}
var Waypoint=window.Waypoint
var oldWindowLoad=window.onload
function Context(element){this.element=element
this.Adapter=Waypoint.Adapter
this.adapter=new this.Adapter(element)
this.key='waypoint-context-'+keyCounter
this.didScroll=false
this.didResize=false
this.oldScroll={x:this.adapter.scrollLeft(),y:this.adapter.scrollTop()}
this.waypoints={vertical:{},horizontal:{}}
element.waypointContextKey=this.key
contexts[element.waypointContextKey]=this
keyCounter+=1
if(!Waypoint.windowContext){Waypoint.windowContext=true
Waypoint.windowContext=new Context(window)}
this.createThrottledScrollHandler()
this.createThrottledResizeHandler()}
Context.prototype.add=function(waypoint){var axis=waypoint.options.horizontal?'horizontal':'vertical'
this.waypoints[axis][waypoint.key]=waypoint
this.refresh()}
Context.prototype.checkEmpty=function(){var horizontalEmpty=this.Adapter.isEmptyObject(this.waypoints.horizontal)
var verticalEmpty=this.Adapter.isEmptyObject(this.waypoints.vertical)
var isWindow=this.element==this.element.window
if(horizontalEmpty&&verticalEmpty&&!isWindow){this.adapter.off('.waypoints')
delete contexts[this.key]}}
Context.prototype.createThrottledResizeHandler=function(){var self=this
function resizeHandler(){self.handleResize()
self.didResize=false}
this.adapter.on('resize.waypoints',function(){if(!self.didResize){self.didResize=true
Waypoint.requestAnimationFrame(resizeHandler)}})}
Context.prototype.createThrottledScrollHandler=function(){var self=this
function scrollHandler(){self.handleScroll()
self.didScroll=false}
this.adapter.on('scroll.waypoints',function(){if(!self.didScroll||Waypoint.isTouch){self.didScroll=true
Waypoint.requestAnimationFrame(scrollHandler)}})}
Context.prototype.handleResize=function(){Waypoint.Context.refreshAll()}
Context.prototype.handleScroll=function(){var triggeredGroups={}
var axes={horizontal:{newScroll:this.adapter.scrollLeft(),oldScroll:this.oldScroll.x,forward:'right',backward:'left'},vertical:{newScroll:this.adapter.scrollTop(),oldScroll:this.oldScroll.y,forward:'down',backward:'up'}}
for(var axisKey in axes){var axis=axes[axisKey]
var isForward=axis.newScroll>axis.oldScroll
var direction=isForward?axis.forward:axis.backward
for(var waypointKey in this.waypoints[axisKey]){var waypoint=this.waypoints[axisKey][waypointKey]
if(waypoint.triggerPoint===null){continue}
var wasBeforeTriggerPoint=axis.oldScroll<waypoint.triggerPoint
var nowAfterTriggerPoint=axis.newScroll>=waypoint.triggerPoint
var crossedForward=wasBeforeTriggerPoint&&nowAfterTriggerPoint
var crossedBackward=!wasBeforeTriggerPoint&&!nowAfterTriggerPoint
if(crossedForward||crossedBackward){waypoint.queueTrigger(direction)
triggeredGroups[waypoint.group.id]=waypoint.group}}}
for(var groupKey in triggeredGroups){triggeredGroups[groupKey].flushTriggers()}
this.oldScroll={x:axes.horizontal.newScroll,y:axes.vertical.newScroll}}
Context.prototype.innerHeight=function(){if(this.element==this.element.window){return Waypoint.viewportHeight()}
return this.adapter.innerHeight()}
Context.prototype.remove=function(waypoint){delete this.waypoints[waypoint.axis][waypoint.key]
this.checkEmpty()}
Context.prototype.innerWidth=function(){if(this.element==this.element.window){return Waypoint.viewportWidth()}
return this.adapter.innerWidth()}
Context.prototype.destroy=function(){var allWaypoints=[]
for(var axis in this.waypoints){for(var waypointKey in this.waypoints[axis]){allWaypoints.push(this.waypoints[axis][waypointKey])}}
for(var i=0,end=allWaypoints.length;i<end;i++){allWaypoints[i].destroy()}}
Context.prototype.refresh=function(){var isWindow=this.element==this.element.window
var contextOffset=isWindow?undefined:this.adapter.offset()
var triggeredGroups={}
var axes
this.handleScroll()
axes={horizontal:{contextOffset:isWindow?0:contextOffset.left,contextScroll:isWindow?0:this.oldScroll.x,contextDimension:this.innerWidth(),oldScroll:this.oldScroll.x,forward:'right',backward:'left',offsetProp:'left'},vertical:{contextOffset:isWindow?0:contextOffset.top,contextScroll:isWindow?0:this.oldScroll.y,contextDimension:this.innerHeight(),oldScroll:this.oldScroll.y,forward:'down',backward:'up',offsetProp:'top'}}
for(var axisKey in axes){var axis=axes[axisKey]
for(var waypointKey in this.waypoints[axisKey]){var waypoint=this.waypoints[axisKey][waypointKey]
var adjustment=waypoint.options.offset
var oldTriggerPoint=waypoint.triggerPoint
var elementOffset=0
var freshWaypoint=oldTriggerPoint==null
var contextModifier,wasBeforeScroll,nowAfterScroll
var triggeredBackward,triggeredForward
if(waypoint.element!==waypoint.element.window){elementOffset=waypoint.adapter.offset()[axis.offsetProp]}
if(typeof adjustment==='function'){adjustment=adjustment.apply(waypoint)}
else if(typeof adjustment==='string'){adjustment=parseFloat(adjustment)
if(waypoint.options.offset.indexOf('%')>-1){adjustment=Math.ceil(axis.contextDimension*adjustment/100)}}
contextModifier=axis.contextScroll-axis.contextOffset
waypoint.triggerPoint=Math.floor(elementOffset+contextModifier-adjustment)
wasBeforeScroll=oldTriggerPoint<axis.oldScroll
nowAfterScroll=waypoint.triggerPoint>=axis.oldScroll
triggeredBackward=wasBeforeScroll&&nowAfterScroll
triggeredForward=!wasBeforeScroll&&!nowAfterScroll
if(!freshWaypoint&&triggeredBackward){waypoint.queueTrigger(axis.backward)
triggeredGroups[waypoint.group.id]=waypoint.group}
else if(!freshWaypoint&&triggeredForward){waypoint.queueTrigger(axis.forward)
triggeredGroups[waypoint.group.id]=waypoint.group}
else if(freshWaypoint&&axis.oldScroll>=waypoint.triggerPoint){waypoint.queueTrigger(axis.forward)
triggeredGroups[waypoint.group.id]=waypoint.group}}}
Waypoint.requestAnimationFrame(function(){for(var groupKey in triggeredGroups){triggeredGroups[groupKey].flushTriggers()}})
return this}
Context.findOrCreateByElement=function(element){return Context.findByElement(element)||new Context(element)}
Context.refreshAll=function(){for(var contextId in contexts){contexts[contextId].refresh()}}
Context.findByElement=function(element){return contexts[element.waypointContextKey]}
window.onload=function(){if(oldWindowLoad){oldWindowLoad()}
Context.refreshAll()}
Waypoint.requestAnimationFrame=function(callback){var requestFn=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||requestAnimationFrameShim
requestFn.call(window,callback)}
Waypoint.Context=Context}());(function(){'use strict'
function byTriggerPoint(a,b){return a.triggerPoint-b.triggerPoint}
function byReverseTriggerPoint(a,b){return b.triggerPoint-a.triggerPoint}
var groups={vertical:{},horizontal:{}}
var Waypoint=window.Waypoint
function Group(options){this.name=options.name
this.axis=options.axis
this.id=this.name+'-'+this.axis
this.waypoints=[]
this.clearTriggerQueues()
groups[this.axis][this.name]=this}
Group.prototype.add=function(waypoint){this.waypoints.push(waypoint)}
Group.prototype.clearTriggerQueues=function(){this.triggerQueues={up:[],down:[],left:[],right:[]}}
Group.prototype.flushTriggers=function(){for(var direction in this.triggerQueues){var waypoints=this.triggerQueues[direction]
var reverse=direction==='up'||direction==='left'
waypoints.sort(reverse?byReverseTriggerPoint:byTriggerPoint)
for(var i=0,end=waypoints.length;i<end;i+=1){var waypoint=waypoints[i]
if(waypoint.options.continuous||i===waypoints.length-1){waypoint.trigger([direction])}}}
this.clearTriggerQueues()}
Group.prototype.next=function(waypoint){this.waypoints.sort(byTriggerPoint)
var index=Waypoint.Adapter.inArray(waypoint,this.waypoints)
var isLast=index===this.waypoints.length-1
return isLast?null:this.waypoints[index+1]}
Group.prototype.previous=function(waypoint){this.waypoints.sort(byTriggerPoint)
var index=Waypoint.Adapter.inArray(waypoint,this.waypoints)
return index?this.waypoints[index-1]:null}
Group.prototype.queueTrigger=function(waypoint,direction){this.triggerQueues[direction].push(waypoint)}
Group.prototype.remove=function(waypoint){var index=Waypoint.Adapter.inArray(waypoint,this.waypoints)
if(index>-1){this.waypoints.splice(index,1)}}
Group.prototype.first=function(){return this.waypoints[0]}
Group.prototype.last=function(){return this.waypoints[this.waypoints.length-1]}
Group.findOrCreate=function(options){return groups[options.axis][options.name]||new Group(options)}
Waypoint.Group=Group}());(function(){'use strict'
var $=window.jQuery
var Waypoint=window.Waypoint
function JQueryAdapter(element){this.$element=$(element)}
$.each(['innerHeight','innerWidth','off','offset','on','outerHeight','outerWidth','scrollLeft','scrollTop'],function(i,method){JQueryAdapter.prototype[method]=function(){var args=Array.prototype.slice.call(arguments)
return this.$element[method].apply(this.$element,args)}})
$.each(['extend','inArray','isEmptyObject'],function(i,method){JQueryAdapter[method]=$[method]})
Waypoint.adapters.push({name:'jquery',Adapter:JQueryAdapter})
Waypoint.Adapter=JQueryAdapter}());(function(){'use strict'
var Waypoint=window.Waypoint
function createExtension(framework){return function(){var waypoints=[]
var overrides=arguments[0]
if(framework.isFunction(arguments[0])){overrides=framework.extend({},arguments[1])
overrides.handler=arguments[0]}
this.each(function(){var options=framework.extend({},overrides,{element:this})
if(typeof options.context==='string'){options.context=framework(this).closest(options.context)[0]}
waypoints.push(new Waypoint(options))})
return waypoints}}
if(window.jQuery){window.jQuery.fn.waypoint=createExtension(window.jQuery)}
if(window.Zepto){window.Zepto.fn.waypoint=createExtension(window.Zepto)}}());;

/* /scrummer/static/src/js/libs/external/lity.js defined in bundle 'scrummer.assets' */
(function(window,factory){if(typeof define==='function'&&define.amd){define(['jquery'],function($){return factory(window,$);});}else if(typeof module==='object'&&typeof module.exports==='object'){module.exports=factory(window,require('jquery'));}else{window.lity=factory(window,window.jQuery||window.Zepto);}}(typeof window!=="undefined"?window:this,function(window,$){'use strict';var document=window.document;var _win=$(window);var _deferred=$.Deferred;var _html=$('html');var _instances=[];var _attrAriaHidden='aria-hidden';var _dataAriaHidden='lity-'+_attrAriaHidden;var _focusableElementsSelector='a[href],area[href],input:not([disabled]),select:not([disabled]),textarea:not([disabled]),button:not([disabled]),iframe,object,embed,[contenteditable],[tabindex]:not([tabindex^="-"])';var _defaultOptions={esc:true,handler:null,handlers:{image:imageHandler,video:videoHandler,audio:audioHandler,inline:inlineHandler,youtube:youtubeHandler,vimeo:vimeoHandler,googlemaps:googlemapsHandler,facebookvideo:facebookvideoHandler,iframe:iframeHandler},template:`<div class="lity"role="dialog"aria-label="Dialog Window (Press escape to close)"tabindex="-1"><div class="lity-wrap"data-lity-close role="document"><div class="lity-container"><div class="lity-actions"><a class="btn-floating btn-flat white-text waves-effect"data-lity-fullscreen><i class="mdi mdi-fullscreen"/></a><a class="btn-floating btn-flat white-text waves-effect"data-lity-close><i class="mdi mdi-close"/></a></div><div class="lity-content"></div><div class="lity-loader"aria-hidden="true">Loading...</div></div></div></div>`};var _imageRegexp=/(^data:image\/)|(\.(png|jpe?g|gif|svg|webp|bmp|ico|tiff?)(\?\S*)?$)/i;var _videoRegexp=/(^data:video\/)|(\.(mp4|webm?)(\?\S*)?$)/i;var _audioRegexp=/(^data:audio\/)|(\.(ogg|mp3|wav?)(\?\S*)?$)/i;var _youtubeRegex=/(youtube(-nocookie)?\.com|youtu\.be)\/(watch\?v=|v\/|u\/|embed\/?)?([\w-]{11})(.*)?/i;var _vimeoRegex=/(vimeo(pro)?\.com)\/(?:[^\d]+)?(\d+)\??(.*)?$/;var _googlemapsRegex=/((maps|www)\.)?google\.([^\/\?]+)\/?((maps\/?)?\?)(.*)/i;var _facebookvideoRegex=/(facebook\.com)\/([a-z0-9_-]*)\/videos\/([0-9]*)(.*)?$/i;var _transitionEndEvent=(function(){var el=document.createElement('div');var transEndEventNames={WebkitTransition:'webkitTransitionEnd',MozTransition:'transitionend',OTransition:'oTransitionEnd otransitionend',transition:'transitionend'};for(var name in transEndEventNames){if(el.style[name]!==undefined){return transEndEventNames[name];}}
return false;})();function transitionEnd(element){var deferred=_deferred();if(!_transitionEndEvent||!element.length){deferred.resolve();}else{element.one(_transitionEndEvent,deferred.resolve);setTimeout(deferred.resolve,500);}
return deferred.promise();}
function settings(currSettings,key,value){if(arguments.length===1){return $.extend({},currSettings);}
if(typeof key==='string'){if(typeof value==='undefined'){return typeof currSettings[key]==='undefined'?null:currSettings[key];}
currSettings[key]=value;}else{$.extend(currSettings,key);}
return this;}
function parseQueryParams(params){var pos=params.indexOf('?');if(pos>-1){params=params.substr(pos+1);}
var pairs=decodeURI(params.split('#')[0]).split('&');var obj={},p;for(var i=0,n=pairs.length;i<n;i++){if(!pairs[i]){continue;}
p=pairs[i].split('=');obj[p[0]]=p[1];}
return obj;}
function appendQueryParams(url,params){if(!params){return url;}
if('string'===$.type(params)){params=parseQueryParams(params);}
if(url.indexOf('?')>-1){var split=url.split('?');url=split.shift();params=$.extend({},parseQueryParams(split[0]),params)}
return url+'?'+$.param(params);}
function transferHash(originalUrl,newUrl){var pos=originalUrl.indexOf('#');if(-1===pos){return newUrl;}
if(pos>0){originalUrl=originalUrl.substr(pos);}
return newUrl+originalUrl;}
function iframe(iframeUrl,instance,queryParams,hashUrl){instance&&instance.element().addClass('lity-iframe');if(queryParams){iframeUrl=appendQueryParams(iframeUrl,queryParams);}
if(hashUrl){iframeUrl=transferHash(hashUrl,iframeUrl);}
return'<div class="lity-iframe-container"><iframe frameborder="0" allowfullscreen src="'+iframeUrl+'"/></div>';}
function error(msg){return $('<span class="lity-error"/>').append(msg);}
function imageHandler(target,instance){var desc=(instance.opener()&&instance.opener().data('lity-desc'))||'Image with no description';var img=$('<img src="'+target+'" alt="'+desc+'"/>');var deferred=_deferred();var failed=function(){deferred.reject(error('Failed loading image'));};img.on('load',function(){if(this.naturalWidth===0){return failed();}
deferred.resolve(img);}).on('error',failed);return deferred.promise();}
imageHandler.test=function(target){return _imageRegexp.test(target);};function videoHandler(target,instance){var video=$('<video controls>'+'<source src="'+target+'" type="video/mp4">'+'Your browser does not support the video tag.'+'</video>');var deferred=_deferred();var failed=function(){deferred.reject(error('Failed loading video'));};video.on('loadeddata',function(){if(this.naturalWidth===0){return failed();}
deferred.resolve(video);}).on('error',failed);return deferred.promise();}
videoHandler.test=function(target,instance){let opener=instance.opener();if((opener.data('lity-options')||opener.data('lity')||{}).handler==="video"){return true;}
return _videoRegexp.test(target);};function audioHandler(target,instance){var audio=$('<audio controls>'+'<source src="'+target+'" type="'+'">'+'Your browser does not support the video tag.'+'</audio>');var deferred=_deferred();var failed=function(){deferred.reject(error('Failed loading video'));};audio.on('loadeddata',function(){if(this.naturalWidth===0){return failed();}
deferred.resolve(audio);}).on('error',failed);return deferred.promise();}
audioHandler.test=function(target,instance){let opener=instance.opener();if((opener.data('lity-options')||opener.data('lity')||{}).handler==="audio"){return true;}
return _audioRegexp.test(target);};function inlineHandler(target,instance){var el,placeholder,hasHideClass;try{el=$(target);}catch(e){return false;}
if(!el.length){return false;}
placeholder=$('<i style="display:none !important"/>');hasHideClass=el.hasClass('lity-hide');instance.element().one('lity:remove',function(){placeholder.before(el).remove();if(hasHideClass&&!el.closest('.lity-content').length){el.addClass('lity-hide');}});return el.removeClass('lity-hide').after(placeholder);}
function youtubeHandler(target,instance){var matches=_youtubeRegex.exec(target);if(!matches){return false;}
return iframe('https://www.youtube'+(matches[2]||'')+'.com/embed/'+matches[4]+'?autoplay=1',instance,matches[5],target);}
function vimeoHandler(target,instance){var matches=_vimeoRegex.exec(target);if(!matches){return false;}
return iframe('https://player.vimeo.com/video/'+matches[3]+'?autoplay=1',instance,matches[4],target);}
function facebookvideoHandler(target,instance){var matches=_facebookvideoRegex.exec(target);if(!matches){return false;}
if(0!==target.indexOf('http')){target='https:'+target;}
return iframe('https://www.facebook.com/plugins/video.php?href='+target+'&autoplay=1',instance,matches[4],target);}
function googlemapsHandler(target,instance){var matches=_googlemapsRegex.exec(target);if(!matches){return false;}
return iframe('https://www.google.'+matches[3]+'/maps?'+matches[6],instance,{output:matches[6].indexOf('layer=c')>0?'svembed':'embed'},target);}
function iframeHandler(target,instance){return iframe(target,instance);}
function winHeight(){return document.documentElement.clientHeight?document.documentElement.clientHeight:Math.round(_win.height());}
function keydown(e){var current=currentInstance();if(!current){return;}
if(e.keyCode===27&&!!current.options('esc')){current.close();}
if(e.keyCode===9){handleTabKey(e,current);}}
function handleTabKey(e,instance){var focusableElements=instance.element().find(_focusableElementsSelector);var focusedIndex=focusableElements.index(document.activeElement);if(e.shiftKey&&focusedIndex<=0){focusableElements.get(focusableElements.length-1).focus();e.preventDefault();}else if(!e.shiftKey&&focusedIndex===focusableElements.length-1){focusableElements.get(0).focus();e.preventDefault();}}
function resize(){$.each(_instances,function(i,instance){instance.resize();});}
function registerInstance(instanceToRegister){if(1===_instances.unshift(instanceToRegister)){_html.addClass('lity-active');_win.on({resize:resize,keydown:keydown});}
$('body > *').not(instanceToRegister.element()).addClass('lity-hidden').each(function(){var el=$(this);if(undefined!==el.data(_dataAriaHidden)){return;}
el.data(_dataAriaHidden,el.attr(_attrAriaHidden)||null);}).attr(_attrAriaHidden,'true');}
function removeInstance(instanceToRemove){var show;instanceToRemove.element().attr(_attrAriaHidden,'true');if(1===_instances.length){_html.removeClass('lity-active');_win.off({resize:resize,keydown:keydown});}
_instances=$.grep(_instances,function(instance){return instanceToRemove!==instance;});if(!!_instances.length){show=_instances[0].element();}else{show=$('.lity-hidden');}
show.removeClass('lity-hidden').each(function(){var el=$(this),oldAttr=el.data(_dataAriaHidden);if(!oldAttr){el.removeAttr(_attrAriaHidden);}else{el.attr(_attrAriaHidden,oldAttr);}
el.removeData(_dataAriaHidden);});}
function currentInstance(){if(0===_instances.length){return null;}
return _instances[0];}
function factory(target,instance,handlers,preferredHandler){var handler='inline',content;var currentHandlers=$.extend({},handlers);if(preferredHandler&&currentHandlers[preferredHandler]){content=currentHandlers[preferredHandler](target,instance);handler=preferredHandler;}else{$.each(['inline','iframe'],function(i,name){delete currentHandlers[name];currentHandlers[name]=handlers[name];});$.each(currentHandlers,function(name,currentHandler){if(!currentHandler){return true;}
if(currentHandler.test&&!currentHandler.test(target,instance)){return true;}
content=currentHandler(target,instance);if(false!==content){handler=name;return false;}});}
return{handler:handler,content:content||''};}
function Lity(target,options,opener,activeElement){var self=this;var result;var isReady=false;var isClosed=false;var element;var content;options=$.extend({},_defaultOptions,options);element=$(options.template);self.element=function(){return element;};self.opener=function(){return opener;};self.content=function(){return content;};self.options=$.proxy(settings,self,options);self.handlers=$.proxy(settings,self,options.handlers);self.resize=function(){if(!isReady||isClosed){return;}
let actionsHeight=this.element().find(".lity-actions").height();content.css('max-height',winHeight()-actionsHeight+'px').trigger('lity:resize',[self]);};self.close=function(){if(!isReady||isClosed){return;}
isClosed=true;removeInstance(self);var deferred=_deferred();if(activeElement&&(document.activeElement===element[0]||$.contains(element[0],document.activeElement))){try{activeElement.focus();}catch(e){}}
content.trigger('lity:close',[self]);element.removeClass('lity-opened').addClass('lity-closed');transitionEnd(content.add(element)).always(function(){content.trigger('lity:remove',[self]);element.remove();element=undefined;deferred.resolve();});return deferred.promise();};self.fullscreen=function(){content.trigger('lity:fullscreen',[self]);element.toggleClass('lity-fullscreen');};result=factory(target,self,options.handlers,options.handler);element.attr(_attrAriaHidden,'false').addClass('lity-loading lity-opened lity-'+result.handler).appendTo('body').focus().on('click','[data-lity-close]',function(e){if($(e.target).is('[data-lity-close]')||!$(e.target).parentsUntil('[data-lity-close]','.lity-container').is(".lity-container")){self.close();}}).on('click','[data-lity-fullscreen]',function(e){if($(e.target).is('[data-lity-fullscreen]')||!$(e.target).parentsUntil('[data-lity-fullscreen]','.lity-container').is(".lity-container")){self.fullscreen();}}).trigger('lity:open',[self]);registerInstance(self);$.when(result.content).always(ready);function ready(result){let actionsHeight=element.find(".lity-actions").height();content=$(result).css('max-height',winHeight()-actionsHeight+'px');element.find('.lity-loader').each(function(){var loader=$(this);transitionEnd(loader).always(function(){loader.remove();});});element.removeClass('lity-loading').find('.lity-content').empty().append(content);isReady=true;content.trigger('lity:ready',[self]);}}
function lity(target,options,opener){if(!target.preventDefault){opener=$(opener);}else{target.preventDefault();opener=$(this);target=opener.data('lity-target')||opener.attr('href')||opener.attr('src');}
var instance=new Lity(target,$.extend({},opener.data('lity-options')||opener.data('lity'),options),opener,document.activeElement);if(!target.preventDefault){return instance;}}
lity.version='3.0.0-dev';lity.options=$.proxy(settings,lity,_defaultOptions);lity.handlers=$.proxy(settings,lity,_defaultOptions.handlers);lity.current=currentInstance;lity.iframe=iframe;$(document).on('click.lity','[data-lity]',lity);return lity;}));;

/* /scrummer/static/src/js/libs/materialNoteOverrides.js defined in bundle 'scrummer.assets' */
(function($){$.fn.ckTooltip=function(options){var timeout=null,counter=null,started=false,counterInterval=null,margin=5;var defaults={delay:350};options=$.extend(defaults,options);return this.each(function(){var origin=$(this);var tooltip_text=$('<span></span>').text(origin.attr('data-tooltip'));var newTooltip=$('<div></div>');newTooltip.addClass('material-tooltip').append(tooltip_text);newTooltip.appendTo($('body'));var backdrop=$('<div></div>').addClass('backdrop');backdrop.appendTo(newTooltip);backdrop.css({top:0,left:0});$.event.special.destroyed={remove:function(o){if(o.handler){o.handler();}}};$(this).bind('destroyed',function(){newTooltip.remove();});$(this).on({mouseenter:function(e){var tooltip_delay=origin.data("delay");tooltip_delay=(tooltip_delay===undefined||tooltip_delay==='')?options.delay:tooltip_delay;counter=0;counterInterval=setInterval(function(){counter+=10;if(counter>=tooltip_delay&&started===false){started=true;newTooltip.css({display:'block',left:'0px',top:'0px'});newTooltip.children('span').text(origin.attr('data-tooltip'));var originWidth=origin.outerWidth();var originHeight=origin.outerHeight();var tooltipPosition=origin.attr('data-position');var tooltipHeight=newTooltip.outerHeight();var tooltipWidth=newTooltip.outerWidth();var tooltipVerticalMovement='0px';var tooltipHorizontalMovement='0px';var scale_factor=8;if(tooltipPosition==="top"){newTooltip.css({top:origin.offset().top-tooltipHeight-margin,left:origin.offset().left+originWidth/2-tooltipWidth/2});tooltipVerticalMovement='-10px';backdrop.css({borderRadius:'14px 14px 0 0',transformOrigin:'50% 90%',marginTop:tooltipHeight,marginLeft:(tooltipWidth/2)-(backdrop.width()/2)});}
else if(tooltipPosition==="left"){newTooltip.css({top:origin.offset().top+originHeight/2-tooltipHeight/2,left:origin.offset().left-tooltipWidth-margin});tooltipHorizontalMovement='-10px';backdrop.css({width:'14px',height:'14px',borderRadius:'14px 0 0 14px',transformOrigin:'95% 50%',marginTop:tooltipHeight/2,marginLeft:tooltipWidth});}
else if(tooltipPosition==="right"){newTooltip.css({top:origin.offset().top+originHeight/2-tooltipHeight/2,left:origin.offset().left+originWidth+margin});tooltipHorizontalMovement='+10px';backdrop.css({width:'14px',height:'14px',borderRadius:'0 14px 14px 0',transformOrigin:'5% 50%',marginTop:tooltipHeight/2,marginLeft:'0px'});}
else{newTooltip.css({top:origin.offset().top+origin.outerHeight()+margin,left:origin.offset().left+originWidth/2-tooltipWidth/2});tooltipVerticalMovement='+10px';backdrop.css({marginLeft:(tooltipWidth/2)-(backdrop.width()/2)});}
scale_factor=tooltipWidth/8;if(scale_factor<8){scale_factor=8;}
if(tooltipPosition==="right"||tooltipPosition==="left"){scale_factor=tooltipWidth/10;if(scale_factor<6)
scale_factor=6;}
newTooltip.velocity({opacity:1,marginTop:tooltipVerticalMovement,marginLeft:tooltipHorizontalMovement},{duration:150,queue:false});backdrop.css({display:'block'}).velocity({opacity:1},{duration:50,delay:0,queue:false}).velocity({scale:scale_factor},{duration:150,delay:0,queue:false,easing:'easeInOutQuad'});}},10);},mouseleave:function(){clearInterval(counterInterval);counter=0;newTooltip.velocity({opacity:0,marginTop:0,marginLeft:0},{duration:150,queue:false,delay:50});backdrop.velocity({opacity:0,scale:1},{duration:150,delay:50,queue:false,complete:function(){backdrop.css('display','none');newTooltip.css('display','none');started=false;}});}});});};}(jQuery));;

/* /scrummer/static/src/js/libs/Sortable.js defined in bundle 'scrummer.assets' */
odoo.define('sortable',function(require){"use strict";if(typeof window=="undefined"||typeof window.document=="undefined"){return function(){throw new Error("Sortable.js requires a window with a document");}}
var dragEl,parentEl,ghostEl,cloneEl,rootEl,nextEl,scrollEl,scrollParentEl,lastEl,lastCSS,lastParentCSS,oldIndex,newIndex,activeGroup,autoScroll={},tapEvt,touchEvt,moved,RSPACE=/\s+/g,expando='Sortable'+(new Date).getTime(),win=window,document=win.document,parseInt=win.parseInt,supportDraggable=!!('draggable'in document.createElement('div')),supportCssPointerEvents=(function(el){el=document.createElement('x');el.style.cssText='pointer-events:auto';return el.style.pointerEvents==='auto';})(),_silent=false,abs=Math.abs,slice=[].slice,touchDragOverListeners=[],_autoScroll=_throttle(function(evt,options,rootEl){if(rootEl&&options.scroll){var el,rect,sens=options.scrollSensitivity,speed=options.scrollSpeed,x=evt.clientX,y=evt.clientY,winWidth=window.innerWidth,winHeight=window.innerHeight,vx,vy;if(scrollParentEl!==rootEl){scrollEl=options.scroll;scrollParentEl=rootEl;if(scrollEl===true){scrollEl=rootEl;do{if((scrollEl.offsetWidth<scrollEl.scrollWidth)||(scrollEl.offsetHeight<scrollEl.scrollHeight)){break;}}while(scrollEl=scrollEl.parentNode);}}
if(scrollEl){el=scrollEl;rect=scrollEl.getBoundingClientRect();vx=(abs(rect.right-x)<=sens)-(abs(rect.left-x)<=sens);vy=(abs(rect.bottom-y)<=sens)-(abs(rect.top-y)<=sens);}
if(!(vx||vy)){vx=(winWidth-x<=sens)-(x<=sens);vy=(winHeight-y<=sens)-(y<=sens);(vx||vy)&&(el=win);}
if(autoScroll.vx!==vx||autoScroll.vy!==vy||autoScroll.el!==el){autoScroll.el=el;autoScroll.vx=vx;autoScroll.vy=vy;clearInterval(autoScroll.pid);if(el){autoScroll.pid=setInterval(function(){if(el===win){win.scrollTo(win.pageXOffset+vx*speed,win.pageYOffset+vy*speed);}else{vy&&(el.scrollTop+=vy*speed);vx&&(el.scrollLeft+=vx*speed);}},24);}}}},30),_prepareGroup=function(options){var group=options.group;if(!group||typeof group!='object'){group=options.group={name:group};}
['pull','put'].forEach(function(key){if(!(key in group)){group[key]=true;}});options.groups=' '+group.name+(group.put.join?' '+group.put.join(' '):'')+' ';};function Sortable(el,options){if(!(el&&el.nodeType&&el.nodeType===1)){throw'Sortable: `el` must be HTMLElement, and not '+{}.toString.call(el);}
this.el=el;this.options=options=_extend({},options);el[expando]=this;var defaults={group:Math.random(),sort:true,disabled:false,store:null,handle:null,scroll:true,scrollSensitivity:30,scrollSpeed:10,draggable:/[uo]l/i.test(el.nodeName)?'li':'>*',ghostClass:'sortable-ghost',chosenClass:'sortable-chosen',ignore:'a, img',filter:null,animation:0,setData:function(dataTransfer,dragEl){dataTransfer.setData('Text',dragEl.textContent);},dropBubble:false,dragoverBubble:false,dataIdAttr:'data-id',delay:0,forceFallback:false,fallbackClass:'sortable-fallback',fallbackOnBody:false};for(var name in defaults){!(name in options)&&(options[name]=defaults[name]);}
_prepareGroup(options);for(var fn in this){if(fn.charAt(0)==='_'){this[fn]=this[fn].bind(this);}}
this.nativeDraggable=options.forceFallback?false:supportDraggable;_on(el,'mousedown',this._onTapStart);_on(el,'touchstart',this._onTapStart);if(this.nativeDraggable){_on(el,'dragover',this);_on(el,'dragenter',this);}
touchDragOverListeners.push(this._onDragOver);options.store&&this.sort(options.store.get(this));}
Sortable.prototype={constructor:Sortable,_onTapStart:function(evt){var _this=this,el=this.el,options=this.options,type=evt.type,touch=evt.touches&&evt.touches[0],target=(touch||evt).target,originalTarget=target,filter=options.filter;if(type==='mousedown'&&evt.button!==0||options.disabled){return;}
target=_closest(target,options.draggable,el);if(!target){return;}
oldIndex=_index(target,options.draggable);if(typeof filter==='function'){if(filter.call(this,evt,target,this)){_dispatchEvent(_this,originalTarget,'filter',target,el,oldIndex);evt.preventDefault();return;}}
else if(filter){filter=filter.split(',').some(function(criteria){criteria=_closest(originalTarget,criteria.trim(),el);if(criteria){_dispatchEvent(_this,criteria,'filter',target,el,oldIndex);return true;}});if(filter){evt.preventDefault();return;}}
if(options.handle&&!_closest(originalTarget,options.handle,el)){return;}
this._prepareDragStart(evt,touch,target);},_prepareDragStart:function(evt,touch,target){var _this=this,el=_this.el,options=_this.options,ownerDocument=el.ownerDocument,dragStartFn;if(target&&!dragEl&&(target.parentNode===el)){tapEvt=evt;rootEl=el;dragEl=target;parentEl=dragEl.parentNode;nextEl=dragEl.nextSibling;activeGroup=options.group;dragStartFn=function(){_this._disableDelayedDrag();dragEl.draggable=true;_toggleClass(dragEl,_this.options.chosenClass,true);_this._triggerDragStart(touch);};options.ignore.split(',').forEach(function(criteria){_find(dragEl,criteria.trim(),_disableDraggable);});_on(ownerDocument,'mouseup',_this._onDrop);_on(ownerDocument,'touchend',_this._onDrop);_on(ownerDocument,'touchcancel',_this._onDrop);if(options.delay){_on(ownerDocument,'mouseup',_this._disableDelayedDrag);_on(ownerDocument,'touchend',_this._disableDelayedDrag);_on(ownerDocument,'touchcancel',_this._disableDelayedDrag);_on(ownerDocument,'mousemove',_this._disableDelayedDrag);_on(ownerDocument,'touchmove',_this._disableDelayedDrag);_this._dragStartTimer=setTimeout(dragStartFn,options.delay);}else{dragStartFn();}}},_disableDelayedDrag:function(){var ownerDocument=this.el.ownerDocument;clearTimeout(this._dragStartTimer);_off(ownerDocument,'mouseup',this._disableDelayedDrag);_off(ownerDocument,'touchend',this._disableDelayedDrag);_off(ownerDocument,'touchcancel',this._disableDelayedDrag);_off(ownerDocument,'mousemove',this._disableDelayedDrag);_off(ownerDocument,'touchmove',this._disableDelayedDrag);},_triggerDragStart:function(touch){if(touch){tapEvt={target:dragEl,clientX:touch.clientX,clientY:touch.clientY};this._onDragStart(tapEvt,'touch');}
else if(!this.nativeDraggable){this._onDragStart(tapEvt,true);}
else{_on(dragEl,'dragend',this);_on(rootEl,'dragstart',this._onDragStart);}
try{if(document.selection){document.selection.empty();}else{window.getSelection().removeAllRanges();}}catch(err){}},_dragStarted:function(){if(rootEl&&dragEl){_toggleClass(dragEl,this.options.ghostClass,true);Sortable.active=this;_dispatchEvent(this,rootEl,'start',dragEl,rootEl,oldIndex);}},_emulateDragOver:function(){if(touchEvt){if(this._lastX===touchEvt.clientX&&this._lastY===touchEvt.clientY){return;}
this._lastX=touchEvt.clientX;this._lastY=touchEvt.clientY;if(!supportCssPointerEvents){_css(ghostEl,'display','none');}
var target=document.elementFromPoint(touchEvt.clientX,touchEvt.clientY),parent=target,groupName=' '+this.options.group.name+'',i=touchDragOverListeners.length;if(parent){do{if(parent[expando]&&parent[expando].options.groups.indexOf(groupName)>-1){while(i--){touchDragOverListeners[i]({clientX:touchEvt.clientX,clientY:touchEvt.clientY,target:target,rootEl:parent});}
break;}
target=parent;}
while(parent=parent.parentNode);}
if(!supportCssPointerEvents){_css(ghostEl,'display','');}}},_onTouchMove:function(evt){if(tapEvt){if(!Sortable.active){this._dragStarted();}
this._appendGhost();var touch=evt.touches?evt.touches[0]:evt,dx=touch.clientX-tapEvt.clientX,dy=touch.clientY-tapEvt.clientY,translate3d=evt.touches?'translate3d('+dx+'px,'+dy+'px,0)':'translate('+dx+'px,'+dy+'px)';moved=true;touchEvt=touch;_css(ghostEl,'webkitTransform',translate3d);_css(ghostEl,'mozTransform',translate3d);_css(ghostEl,'msTransform',translate3d);_css(ghostEl,'transform',translate3d);evt.preventDefault();}},_appendGhost:function(){if(!ghostEl){var rect=dragEl.getBoundingClientRect(),css=_css(dragEl),options=this.options,ghostRect;ghostEl=dragEl.cloneNode(true);_toggleClass(ghostEl,options.ghostClass,false);_toggleClass(ghostEl,options.fallbackClass,true);_css(ghostEl,'top',rect.top-parseInt(css.marginTop,10));_css(ghostEl,'left',rect.left-parseInt(css.marginLeft,10));_css(ghostEl,'width',rect.width);_css(ghostEl,'height',rect.height);_css(ghostEl,'opacity','0.8');_css(ghostEl,'position','fixed');_css(ghostEl,'zIndex','100000');_css(ghostEl,'pointerEvents','none');options.fallbackOnBody&&document.body.appendChild(ghostEl)||rootEl.appendChild(ghostEl);ghostRect=ghostEl.getBoundingClientRect();_css(ghostEl,'width',rect.width*2-ghostRect.width);_css(ghostEl,'height',rect.height*2-ghostRect.height);}},_onDragStart:function(evt,useFallback){var dataTransfer=evt.dataTransfer,options=this.options;this._offUpEvents();if(activeGroup.pull=='clone'){cloneEl=dragEl.cloneNode(true);_css(cloneEl,'display','none');rootEl.insertBefore(cloneEl,dragEl);}
if(useFallback){if(useFallback==='touch'){_on(document,'touchmove',this._onTouchMove);_on(document,'touchend',this._onDrop);_on(document,'touchcancel',this._onDrop);}else{_on(document,'mousemove',this._onTouchMove);_on(document,'mouseup',this._onDrop);}
this._loopId=setInterval(this._emulateDragOver,50);}
else{if(dataTransfer){dataTransfer.effectAllowed='move';options.setData&&options.setData.call(this,dataTransfer,dragEl);}
_on(document,'drop',this);setTimeout(this._dragStarted,0);}},_onDragOver:function(evt){var el=this.el,target,dragRect,revert,options=this.options,group=options.group,groupPut=group.put,isOwner=(activeGroup===group),canSort=options.sort;if(evt.preventDefault!==void 0){evt.preventDefault();!options.dragoverBubble&&evt.stopPropagation();}
moved=true;if(activeGroup&&!options.disabled&&(isOwner?canSort||(revert=!rootEl.contains(dragEl)):activeGroup.pull&&groupPut&&((activeGroup.name===group.name)||(groupPut.indexOf&&~groupPut.indexOf(activeGroup.name))))&&(evt.rootEl===void 0||evt.rootEl===this.el)){_autoScroll(evt,options,this.el);if(_silent){return;}
target=_closest(evt.target,options.draggable,el);dragRect=dragEl.getBoundingClientRect();if(revert){_cloneHide(true);if(cloneEl||nextEl){rootEl.insertBefore(dragEl,cloneEl||nextEl);}
else if(!canSort){rootEl.appendChild(dragEl);}
return;}
if((el.children.length===0)||(el.children[0]===ghostEl)||(el===evt.target)&&(target=_ghostIsLast(el,evt))){if(target){if(target.animated){return;}
targetRect=target.getBoundingClientRect();}
_cloneHide(isOwner);if(_onMove(rootEl,el,dragEl,dragRect,target,targetRect)!==false){if(!dragEl.contains(el)){el.appendChild(dragEl);parentEl=el;}
this._animate(dragRect,dragEl);target&&this._animate(targetRect,target);}}
else if(target&&!target.animated&&target!==dragEl&&(target.parentNode[expando]!==void 0)){if(lastEl!==target){lastEl=target;lastCSS=_css(target);lastParentCSS=_css(target.parentNode);}
var targetRect=target.getBoundingClientRect(),width=targetRect.right-targetRect.left,height=targetRect.bottom-targetRect.top,floating=/left|right|inline/.test(lastCSS.cssFloat+lastCSS.display)||(lastParentCSS.display=='flex'&&lastParentCSS['flex-direction'].indexOf('row')===0),isWide=(target.offsetWidth>dragEl.offsetWidth),isLong=(target.offsetHeight>dragEl.offsetHeight),halfway=(floating?(evt.clientX-targetRect.left)/width:(evt.clientY-targetRect.top)/height)>0.5,nextSibling=target.nextElementSibling,moveVector=_onMove(rootEl,el,dragEl,dragRect,target,targetRect),after;if(moveVector!==false){_silent=true;setTimeout(_unsilent,30);_cloneHide(isOwner);if(moveVector===1||moveVector===-1){after=(moveVector===1);}
else if(floating){var elTop=dragEl.offsetTop,tgTop=target.offsetTop;if(elTop===tgTop){after=(target.previousElementSibling===dragEl)&&!isWide||halfway&&isWide;}else{after=tgTop>elTop;}}else{after=(nextSibling!==dragEl)&&!isLong||halfway&&isLong;}
if(!dragEl.contains(el)){if(after&&!nextSibling){el.appendChild(dragEl);}else{target.parentNode.insertBefore(dragEl,after?nextSibling:target);}}
parentEl=dragEl.parentNode;this._animate(dragRect,dragEl);this._animate(targetRect,target);}}}},_animate:function(prevRect,target){var ms=this.options.animation;if(ms){var currentRect=target.getBoundingClientRect();_css(target,'transition','none');_css(target,'transform','translate3d('
+(prevRect.left-currentRect.left)+'px,'
+(prevRect.top-currentRect.top)+'px,0)');target.offsetWidth;_css(target,'transition','all '+ms+'ms');_css(target,'transform','translate3d(0,0,0)');clearTimeout(target.animated);target.animated=setTimeout(function(){_css(target,'transition','');_css(target,'transform','');target.animated=false;},ms);}},_offUpEvents:function(){var ownerDocument=this.el.ownerDocument;_off(document,'touchmove',this._onTouchMove);_off(ownerDocument,'mouseup',this._onDrop);_off(ownerDocument,'touchend',this._onDrop);_off(ownerDocument,'touchcancel',this._onDrop);},_onDrop:function(evt){var el=this.el,options=this.options;clearInterval(this._loopId);clearInterval(autoScroll.pid);clearTimeout(this._dragStartTimer);_off(document,'mousemove',this._onTouchMove);if(this.nativeDraggable){_off(document,'drop',this);_off(el,'dragstart',this._onDragStart);}
this._offUpEvents();if(evt){if(moved){evt.preventDefault();!options.dropBubble&&evt.stopPropagation();}
ghostEl&&ghostEl.parentNode.removeChild(ghostEl);if(dragEl){if(this.nativeDraggable){_off(dragEl,'dragend',this);}
_disableDraggable(dragEl);_toggleClass(dragEl,this.options.ghostClass,false);_toggleClass(dragEl,this.options.chosenClass,false);if(rootEl!==parentEl){newIndex=_index(dragEl,options.draggable);if(newIndex>=0){_dispatchEvent(null,parentEl,'sort',dragEl,rootEl,oldIndex,newIndex);_dispatchEvent(this,rootEl,'sort',dragEl,rootEl,oldIndex,newIndex);_dispatchEvent(null,parentEl,'add',dragEl,rootEl,oldIndex,newIndex);_dispatchEvent(this,rootEl,'remove',dragEl,rootEl,oldIndex,newIndex);}}
else{cloneEl&&cloneEl.parentNode.removeChild(cloneEl);if(dragEl.nextSibling!==nextEl){newIndex=_index(dragEl,options.draggable);if(newIndex>=0){_dispatchEvent(this,rootEl,'update',dragEl,rootEl,oldIndex,newIndex);_dispatchEvent(this,rootEl,'sort',dragEl,rootEl,oldIndex,newIndex);}}}
if(Sortable.active){if(newIndex==null||newIndex===-1){newIndex=oldIndex;}
_dispatchEvent(this,parentEl,'end',dragEl,rootEl,oldIndex,newIndex);this.save();}}}
this._nulling();},_nulling:function(){rootEl=dragEl=parentEl=ghostEl=nextEl=cloneEl=scrollEl=scrollParentEl=tapEvt=touchEvt=moved=newIndex=lastEl=lastCSS=activeGroup=Sortable.active=null;},handleEvent:function(evt){var type=evt.type;if(type==='dragover'||type==='dragenter'){if(dragEl){this._onDragOver(evt);_globalDragOver(evt);}}
else if(type==='drop'||type==='dragend'){this._onDrop(evt);}},toArray:function(){var order=[],el,children=this.el.children,i=0,n=children.length,options=this.options;for(;i<n;i++){el=children[i];if(_closest(el,options.draggable,this.el)){order.push(el.getAttribute(options.dataIdAttr)||_generateId(el));}}
return order;},sort:function(order){var items={},rootEl=this.el;this.toArray().forEach(function(id,i){var el=rootEl.children[i];if(_closest(el,this.options.draggable,rootEl)){items[id]=el;}},this);order.forEach(function(id){if(items[id]){rootEl.removeChild(items[id]);rootEl.appendChild(items[id]);}});},save:function(){var store=this.options.store;store&&store.set(this);},closest:function(el,selector){return _closest(el,selector||this.options.draggable,this.el);},option:function(name,value){var options=this.options;if(value===void 0){return options[name];}else{options[name]=value;if(name==='group'){_prepareGroup(options);}}},destroy:function(){var el=this.el;el[expando]=null;_off(el,'mousedown',this._onTapStart);_off(el,'touchstart',this._onTapStart);if(this.nativeDraggable){_off(el,'dragover',this);_off(el,'dragenter',this);}
Array.prototype.forEach.call(el.querySelectorAll('[draggable]'),function(el){el.removeAttribute('draggable');});touchDragOverListeners.splice(touchDragOverListeners.indexOf(this._onDragOver),1);this._onDrop();this.el=el=null;}};function _cloneHide(state){if(cloneEl&&(cloneEl.state!==state)){_css(cloneEl,'display',state?'none':'');!state&&cloneEl.state&&rootEl.insertBefore(cloneEl,dragEl);cloneEl.state=state;}}
function _closest(el,selector,ctx){if(el){ctx=ctx||document;do{if((selector==='>*'&&el.parentNode===ctx)||_matches(el,selector)){return el;}}
while(el!==ctx&&(el=el.parentNode));}
return null;}
function _globalDragOver(evt){if(evt.dataTransfer){evt.dataTransfer.dropEffect='move';}
evt.preventDefault();}
function _on(el,event,fn){el.addEventListener(event,fn,false);}
function _off(el,event,fn){el.removeEventListener(event,fn,false);}
function _toggleClass(el,name,state){if(el){if(el.classList){el.classList[state?'add':'remove'](name);}
else{var className=(' '+el.className+' ').replace(RSPACE,' ').replace(' '+name+' ',' ');el.className=(className+(state?' '+name:'')).replace(RSPACE,' ');}}}
function _css(el,prop,val){var style=el&&el.style;if(style){if(val===void 0){if(document.defaultView&&document.defaultView.getComputedStyle){val=document.defaultView.getComputedStyle(el,'');}
else if(el.currentStyle){val=el.currentStyle;}
return prop===void 0?val:val[prop];}
else{if(!(prop in style)){prop='-webkit-'+prop;}
style[prop]=val+(typeof val==='string'?'':'px');}}}
function _find(ctx,tagName,iterator){if(ctx){var list=ctx.getElementsByTagName(tagName),i=0,n=list.length;if(iterator){for(;i<n;i++){iterator(list[i],i);}}
return list;}
return[];}
function _dispatchEvent(sortable,rootEl,name,targetEl,fromEl,startIndex,newIndex){var evt=document.createEvent('Event'),options=(sortable||rootEl[expando]).options,onName='on'+name.charAt(0).toUpperCase()+name.substr(1);evt.initEvent(name,true,true);evt.to=rootEl;evt.from=fromEl||rootEl;evt.item=targetEl||rootEl;evt.clone=cloneEl;evt.oldIndex=startIndex;evt.newIndex=newIndex;rootEl.dispatchEvent(evt);if(options[onName]){options[onName].call(sortable,evt);}}
function _onMove(fromEl,toEl,dragEl,dragRect,targetEl,targetRect){var evt,sortable=fromEl[expando],onMoveFn=sortable.options.onMove,retVal;evt=document.createEvent('Event');evt.initEvent('move',true,true);evt.to=toEl;evt.from=fromEl;evt.dragged=dragEl;evt.draggedRect=dragRect;evt.related=targetEl||toEl;evt.relatedRect=targetRect||toEl.getBoundingClientRect();fromEl.dispatchEvent(evt);if(onMoveFn){retVal=onMoveFn.call(sortable,evt);}
return retVal;}
function _disableDraggable(el){el.draggable=false;}
function _unsilent(){_silent=false;}
function _ghostIsLast(el,evt){var lastEl=el.lastElementChild,rect=lastEl.getBoundingClientRect();return((evt.clientY-(rect.top+rect.height)>5)||(evt.clientX-(rect.right+rect.width)>5))&&lastEl;}
function _generateId(el){var str=el.tagName+el.className+el.src+el.href+el.textContent,i=str.length,sum=0;while(i--){sum+=str.charCodeAt(i);}
return sum.toString(36);}
function _index(el,selector){var index=0;if(!el||!el.parentNode){return-1;}
while(el&&(el=el.previousElementSibling)){if(el.nodeName.toUpperCase()!=='TEMPLATE'){index++;}}
return index;}
function _matches(el,selector){if(el){selector=selector.split('.');var tag=selector.shift().toUpperCase(),re=new RegExp('\\s('+selector.join('|')+')(?=\\s)','g');return((tag===''||el.nodeName.toUpperCase()==tag)&&(!selector.length||((' '+el.className+' ').match(re)||[]).length==selector.length));}
return false;}
function _throttle(callback,ms){var args,_this;return function(){if(args===void 0){args=arguments;_this=this;setTimeout(function(){if(args.length===1){callback.call(_this,args[0]);}else{callback.apply(_this,args);}
args=void 0;},ms);}};}
function _extend(dst,src){if(dst&&src){for(var key in src){if(src.hasOwnProperty(key)){dst[key]=src[key];}}}
return dst;}
Sortable.utils={on:_on,off:_off,css:_css,find:_find,is:function(el,selector){return!!_closest(el,selector,el);},extend:_extend,throttle:_throttle,closest:_closest,toggleClass:_toggleClass,index:_index};Sortable.create=function(el,options){return new Sortable(el,options);};Sortable.version='1.4.2';return Sortable;});;

/* /scrummer/static/src/js/libs/pluralize.js defined in bundle 'scrummer.assets' */
odoo.define('pluralize',function(require){var pluralRules=[];var singularRules=[];var uncountables={};var irregularPlurals={};var irregularSingles={};function toTitleCase(str){return str.charAt(0).toUpperCase()+str.substr(1).toLowerCase();}
function sanitizeRule(rule){if(typeof rule==='string'){return new RegExp('^'+rule+'$','i');}
return rule;}
function restoreCase(word,token){if(word===token){return token;}
if(word===word.toUpperCase()){return token.toUpperCase();}
if(word[0]===word[0].toUpperCase()){return toTitleCase(token);}
return token.toLowerCase();}
function interpolate(str,args){return str.replace(/\$(\d{1,2})/g,function(match,index){return args[index]||'';});}
function sanitizeWord(token,word,collection){if(!token.length||uncountables.hasOwnProperty(token)){return word;}
var len=collection.length;while(len--){var rule=collection[len];if(rule[0].test(word)){return word.replace(rule[0],function(match,index,word){var result=interpolate(rule[1],arguments);if(match===''){return restoreCase(word[index-1],result);}
return restoreCase(match,result);});}}
return word;}
function replaceWord(replaceMap,keepMap,rules){return function(word){var token=word.toLowerCase();if(keepMap.hasOwnProperty(token)){return restoreCase(word,token);}
if(replaceMap.hasOwnProperty(token)){return restoreCase(word,replaceMap[token]);}
return sanitizeWord(token,word,rules);};}
function pluralize(word,count,inclusive){var pluralized=count===1?pluralize.singular(word):pluralize.plural(word);return(inclusive?count+' ':'')+pluralized;}
pluralize.plural=replaceWord(irregularSingles,irregularPlurals,pluralRules);pluralize.singular=replaceWord(irregularPlurals,irregularSingles,singularRules);pluralize.addPluralRule=function(rule,replacement){pluralRules.push([sanitizeRule(rule),replacement]);};pluralize.addSingularRule=function(rule,replacement){singularRules.push([sanitizeRule(rule),replacement]);};pluralize.addUncountableRule=function(word){if(typeof word==='string'){uncountables[word.toLowerCase()]=true;return;}
pluralize.addPluralRule(word,'$0');pluralize.addSingularRule(word,'$0');};pluralize.addIrregularRule=function(single,plural){plural=plural.toLowerCase();single=single.toLowerCase();irregularSingles[single]=plural;irregularPlurals[plural]=single;};[['I','we'],['me','us'],['he','they'],['she','they'],['them','them'],['myself','ourselves'],['yourself','yourselves'],['itself','themselves'],['herself','themselves'],['himself','themselves'],['themself','themselves'],['is','are'],['was','were'],['has','have'],['this','these'],['that','those'],['echo','echoes'],['dingo','dingoes'],['volcano','volcanoes'],['tornado','tornadoes'],['torpedo','torpedoes'],['genus','genera'],['viscus','viscera'],['stigma','stigmata'],['stoma','stomata'],['dogma','dogmata'],['lemma','lemmata'],['schema','schemata'],['anathema','anathemata'],['ox','oxen'],['axe','axes'],['die','dice'],['yes','yeses'],['foot','feet'],['eave','eaves'],['goose','geese'],['tooth','teeth'],['quiz','quizzes'],['human','humans'],['proof','proofs'],['carve','carves'],['valve','valves'],['looey','looies'],['thief','thieves'],['groove','grooves'],['pickaxe','pickaxes'],['whiskey','whiskies']].forEach(function(rule){return pluralize.addIrregularRule(rule[0],rule[1]);});[[/s?$/i,'s'],[/([^aeiou]ese)$/i,'$1'],[/(ax|test)is$/i,'$1es'],[/(alias|[^aou]us|tlas|gas|ris)$/i,'$1es'],[/(e[mn]u)s?$/i,'$1s'],[/([^l]ias|[aeiou]las|[emjzr]as|[iu]am)$/i,'$1'],[/(alumn|syllab|octop|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,'$1i'],[/(alumn|alg|vertebr)(?:a|ae)$/i,'$1ae'],[/(seraph|cherub)(?:im)?$/i,'$1im'],[/(her|at|gr)o$/i,'$1oes'],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|automat|quor)(?:a|um)$/i,'$1a'],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)(?:a|on)$/i,'$1a'],[/sis$/i,'ses'],[/(?:(kni|wi|li)fe|(ar|l|ea|eo|oa|hoo)f)$/i,'$1$2ves'],[/([^aeiouy]|qu)y$/i,'$1ies'],[/([^ch][ieo][ln])ey$/i,'$1ies'],[/(x|ch|ss|sh|zz)$/i,'$1es'],[/(matr|cod|mur|sil|vert|ind|append)(?:ix|ex)$/i,'$1ices'],[/(m|l)(?:ice|ouse)$/i,'$1ice'],[/(pe)(?:rson|ople)$/i,'$1ople'],[/(child)(?:ren)?$/i,'$1ren'],[/eaux$/i,'$0'],[/m[ae]n$/i,'men'],['thou','you']].forEach(function(rule){return pluralize.addPluralRule(rule[0],rule[1]);});[[/s$/i,''],[/(ss)$/i,'$1'],[/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)(?:sis|ses)$/i,'$1sis'],[/(^analy)(?:sis|ses)$/i,'$1sis'],[/(wi|kni|(?:after|half|high|low|mid|non|night|[^\w]|^)li)ves$/i,'$1fe'],[/(ar|(?:wo|[ae])l|[eo][ao])ves$/i,'$1f'],[/ies$/i,'y'],[/\b([pl]|zomb|(?:neck|cross)?t|coll|faer|food|gen|goon|group|lass|talk|goal|cut)ies$/i,'$1ie'],[/\b(mon|smil)ies$/i,'$1ey'],[/(m|l)ice$/i,'$1ouse'],[/(seraph|cherub)im$/i,'$1'],[/(x|ch|ss|sh|zz|tto|go|cho|alias|[^aou]us|tlas|gas|(?:her|at|gr)o|ris)(?:es)?$/i,'$1'],[/(e[mn]u)s?$/i,'$1'],[/(movie|twelve)s$/i,'$1'],[/(cris|test|diagnos)(?:is|es)$/i,'$1is'],[/(alumn|syllab|octop|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,'$1us'],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|quor)a$/i,'$1um'],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)a$/i,'$1on'],[/(alumn|alg|vertebr)ae$/i,'$1a'],[/(cod|mur|sil|vert|ind)ices$/i,'$1ex'],[/(matr|append)ices$/i,'$1ix'],[/(pe)(rson|ople)$/i,'$1rson'],[/(child)ren$/i,'$1'],[/(eau)x?$/i,'$1'],[/men$/i,'man']].forEach(function(rule){return pluralize.addSingularRule(rule[0],rule[1]);});['advice','adulthood','agenda','aid','alcohol','ammo','athletics','bison','blood','bream','buffalo','butter','carp','cash','chassis','chess','clothing','commerce','cod','cooperation','corps','digestion','debris','diabetes','energy','equipment','elk','excretion','expertise','flounder','fun','gallows','garbage','graffiti','headquarters','health','herpes','highjinks','homework','housework','information','jeans','justice','kudos','labour','literature','machinery','mackerel','mail','media','mews','moose','music','news','pike','plankton','pliers','pollution','premises','rain','research','rice','salmon','scissors','series','sewage','shambles','shrimp','species','staff','swine','trout','traffic','transporation','tuna','wealth','welfare','whiting','wildebeest','wildlife','you',/pox$/i,/ois$/i,/deer$/i,/fish$/i,/sheep$/i,/measles$/i,/[^aeiou]ese$/i].forEach(pluralize.addUncountableRule);return pluralize;});;

/* /scrummer/static/src/js/libs/my-jquery-extensions.js defined in bundle 'scrummer.assets' */
'use strict';jQuery.fn.getDataFromAncestor=function(dataAttr,oldest="body"){const el=$(this[0]);return(el.is(oldest)||el.data(dataAttr)!==undefined||el.parent().length==0)?(el.data(dataAttr)||null):el.parent().getDataFromAncestor(dataAttr);};$.fn.insertAt=function(elements,index){if(index>=this.children().size()){this.append(elements);}else{var before=this.children().eq(index);$(elements).insertBefore(before);}
return this;};$.fn.serializeObject=function(){var o={};var a=this.serializeArray();$.each(a,function(){if(!isNaN(Number(this.value))){this.value=Number(this.value);}
if(o[this.name]!==undefined){if(!o[this.name].push){o[this.name]=[o[this.name]];}
o[this.name].push(this.value||'');}else{o[this.name]=this.value||'';}});return o;};$.fn.scrollToElement=function(element,duration=500){this.animate({scrollTop:element.offset().top
-this.offset().top
+this.scrollTop()
-Math.round(this.height()/2)
+element.outerHeight()},duration);};$.fn.highlight=function(){this.css("position","relative");let overlay=$('<div class="overlay agile-main-color"></div>');this.append(overlay);overlay.animate({opacity:0.1},1000,function(){$(this).remove();});};$.fn.responsive=function(){var medias=[window.matchMedia('(max-width: 600px)'),window.matchMedia('(min-width: 601px) and (max-width: 992px)'),window.matchMedia('(min-width: 993px)')];var current_class;var classes={0:"s",1:"m",2:"l"};var size_class=()=>{for(var i=0;i<medias.length;i++){if(medias[i].matches){return classes[i];}}};var set_size_class=()=>{var sc=size_class();if(sc!==current_class){current_class=sc;rearange(sc);}};var rearange=(sc)=>{this.find(".responsive").each((i,n)=>{let node=$(n);let id=node.data("responsiveId");let anchor=this.find(`responsive[data-id=${id}].${sc}`);if(anchor.length>1){throw new Error("Found multiple anchors for responsive jQuery element");}
node.insertAfter(anchor);})};medias.forEach(m=>{m.addListener(set_size_class);});rearange(size_class())};let guid=function(){function s4(){return Math.floor((1+Math.random())*0x10000).toString(16).substring(1);}
return function(){return s4()+s4()+'-'+s4()+'-'+s4()+'-'+s4()+'-'+s4()+s4()+s4();};};$.fn.new_autocomplete=function(options){var defaults={data:{},delay:200,limit:Infinity,onAutocomplete:null,onRendered:null,minLength:1};options=$.extend(defaults,options);return this.each(function(){var $input=$(this);var customDataEnabled=typeof options.customData==="function";var getData=function(val){if(customDataEnabled){return options.customData(val);}
return options.data;}
var data=options.data;var count=0,activeIndex=0,oldVal,searching,$inputDiv=$input.closest('.input-field');if(customDataEnabled||!$.isEmptyObject(data)){var $autocomplete=$('<ul class="autocomplete-content dropdown-content"></ul>');var $oldAutocomplete;if($inputDiv.length){$oldAutocomplete=$inputDiv.children('.autocomplete-content.dropdown-content').first();if(!$oldAutocomplete.length){$inputDiv.append($autocomplete);$inputDiv.addClass("autocomplete");}}else{$oldAutocomplete=$input.next('.autocomplete-content.dropdown-content');if(!$oldAutocomplete.length){$input.after($autocomplete);}}
if($oldAutocomplete.length){$autocomplete=$oldAutocomplete;}
var highlight=function(string,$el){var img=$el.find('img');var matchStart=$el.text().toLowerCase().indexOf(""+string.toLowerCase()+""),matchEnd=matchStart+string.length-1,beforeMatch=$el.text().slice(0,matchStart),matchText=$el.text().slice(matchStart,matchEnd+1),afterMatch=$el.text().slice(matchEnd+1);$el.html("<span>"+beforeMatch+"<span class='highlight'>"+matchText+"</span>"+afterMatch+"</span>");if(img.length){$el.prepend(img);}};var resetCurrentElement=function(){activeIndex=0;$autocomplete.find('.active').removeClass('active');};var removeAutocomplete=function(){$autocomplete.empty();resetCurrentElement();};var _delay=function(handler,delay){function handlerProxy(){return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments);}
var instance=this;return setTimeout(handlerProxy,delay||0);};var _inputTimeout=function(){var timestamp=Date.now();$input.data("async-stamp",timestamp);var val=$input.val().toLowerCase();clearTimeout(searching);searching=_delay(function(){var equalValues=oldVal===val;if(!equalValues){removeAutocomplete();if(val.length>=options.minLength){$inputDiv=$input.closest(".autocomplete");$inputDiv.addClass("autocomplete-loading");$.when(getData(val)).then(function(data){if($input.data("async-stamp")!=timestamp){return;}
for(var id in data){if(customDataEnabled||data.hasOwnProperty(id)&&data[id].name.toLowerCase().indexOf(val)!==-1){if(!data[id].id){console.error("Missing ID in new_autocomplete data");}
if(count>=options.limit){break;}
var autocompleteOption=$('<li></li>');if(count===0){autocompleteOption.addClass("active");}
autocompleteOption.data("id",id);if(!!data[id].imgurl){autocompleteOption.append('<img src="'+data[id].imgurl+'" class="right circle"><span>'+data[id].name+'</span>');}else{autocompleteOption.append('<span>'+data[id].name+'</span>');}
$autocomplete.append(autocompleteOption);highlight(val,autocompleteOption);count++;}}
if(typeof options.onRendered==="function"){options.onRendered.call(this,$input.val(),$autocomplete);}
$inputDiv.removeClass("autocomplete-loading");});}}
oldVal=val;},options.delay);};$input.off('blur.autocomplete').on('blur.autocomplete',function(){removeAutocomplete();oldVal=undefined;});$input.off('keyup.autocomplete focus.autocomplete').on('keyup.autocomplete focus.autocomplete',function(e){let val=$input.val();count=0;if(e.which===13||e.which===38||e.which===40||oldVal===val){return;}
_inputTimeout()});$input.off('keydown.autocomplete').on('keydown.autocomplete',function(e){var keyCode=e.which,liElement,numItems=$autocomplete.children('li').length,$active=$autocomplete.children('.active').first();if(keyCode===13&&activeIndex>=0){liElement=$autocomplete.children('li').eq(activeIndex);if(liElement.length){liElement.trigger('mousedown.autocomplete');e.preventDefault();}
return;}
if(e.which===27){removeAutocomplete();e.preventDefault();e.stopImmediatePropagation();return;}
if(keyCode===38||keyCode===40){e.preventDefault();if(numItems===0){oldVal=undefined;_inputTimeout();return;}
if(keyCode===38&&activeIndex>0){activeIndex--;}
if(keyCode===40&&activeIndex<numItems-1){activeIndex++;}
$active.removeClass('active');if(activeIndex>=0){$autocomplete.children('li').eq(activeIndex).addClass('active');}}});$autocomplete.off('mousedown.autocomplete touchstart.autocomplete').on('mousedown.autocomplete touchstart.autocomplete','li',function(){var text=$(this).text().trim();var autocompleteOptionId=$(this).data("id");$input.val(text);$input.data("autocompleteOptionId",autocompleteOptionId);$input.trigger('change');removeAutocomplete();if(typeof options.onAutocomplete==="function"){options.onAutocomplete.call(this,text,autocompleteOptionId);}});}else{$input.off('keyup.autocomplete focus.autocomplete');}});};var materialChipsDefaults={data:[],placeholder:'',secondaryPlaceholder:'',autocompleteOptions:{minLength:0},beforeDeleteHook:function(elem){return $.when();},beforeAddHook:function(elem){return $.when();},};$(document).ready(function(){$(document).on('click','.chip .close',function(e){var $chips=$(this).closest('.chips');if($chips.attr('data-initialized')){return;}
$(this).closest('.chip').remove();});});$.fn.new_material_chip=function(options){var self=this;this.$el=$(this);this.$document=$(document);this.SELS={CHIPS:'.chips',CHIP:'.chip',INPUT:'input',DELETE:'.material-icons',SELECTED_CHIP:'.selected'};if('data'===options){return this.$el.data('chips');}
var autocomplete_options=$.extend({},materialChipsDefaults.autocompleteOptions,options.autocompleteOptions);var curr_options=$.extend({},materialChipsDefaults,options);curr_options.autocompleteOptions=autocomplete_options;self.hasCustomAutocomplete=typeof curr_options.autocompleteOptions.customData==="function";self.hasAutocomplete=self.hasCustomAutocomplete||!$.isEmptyObject(curr_options.autocompleteOptions.data);this.init=function(){var i=0;var chips;self.$el.each(function(){var $chips=$(this);var chipId=Materialize.guid();self.chipId=chipId;if(!curr_options.data){curr_options.data={};}
$chips.data('chips',curr_options.data);$chips.attr('data-index',i);$chips.attr('data-initialized',true);if(!$chips.hasClass(self.SELS.CHIPS)){$chips.addClass('chips');}
self.chips($chips,chipId);i++;});};this.handleEvents=function(){var SELS=self.SELS;self.$document.off('click.chips-focus',SELS.CHIPS).on('click.chips-focus',SELS.CHIPS,function(e){$(e.target).find(SELS.INPUT).focus();});self.$document.off('click.chips-select',SELS.CHIP).on('click.chips-select',SELS.CHIP,function(e){var $chip=$(e.target);if($chip.length){var wasSelected=$chip.hasClass('selected');var $chips=$chip.closest(SELS.CHIPS);$(SELS.CHIP).removeClass('selected');if(!wasSelected){self.selectChip($chip.index(),$chips);}}});self.$document.off('keydown.chips').on('keydown.chips',function(e){if($(e.target).is('input, textarea')){return;}
var $chip=self.$document.find(SELS.CHIP+SELS.SELECTED_CHIP);var $chips=$chip.closest(SELS.CHIPS);var length=$chip.siblings(SELS.CHIP).length;var index;if(!$chip.length){return;}
if(e.which===8||e.which===46){e.preventDefault();index=$chip.index();curr_options.beforeDeleteHook($chip).then(function(){self.deleteChip(index,$chips);var selectIndex=null;if(index+1<length){selectIndex=index;}else if(index===length||index+1===length){selectIndex=length-1;}
if(selectIndex<0)selectIndex=null;if(null!==selectIndex){self.selectChip(selectIndex,$chips);}
if(!length)$chips.find('input').focus();});}else if(e.which===37){index=$chip.index()-1;if(index<0){return;}
$(SELS.CHIP).removeClass('selected');self.selectChip(index,$chips);}else if(e.which===39){index=$chip.index()+1;$(SELS.CHIP).removeClass('selected');if(index>length){$chips.find('input').focus();return;}
self.selectChip(index,$chips);}});self.$document.off('focusin.chips',SELS.CHIPS+' '+SELS.INPUT).on('focusin.chips',SELS.CHIPS+' '+SELS.INPUT,function(e){var $currChips=$(e.target).closest(SELS.CHIPS);$currChips.addClass('focus');$currChips.siblings('label, .prefix').addClass('active');$(SELS.CHIP).removeClass('selected');});self.$document.off('focusout.chips',SELS.CHIPS+' '+SELS.INPUT).on('focusout.chips',SELS.CHIPS+' '+SELS.INPUT,function(e){var $currChips=$(e.target).closest(SELS.CHIPS);$currChips.removeClass('focus');if($currChips.data('chips')===undefined||!Object.keys($currChips.data('chips')).length){$currChips.siblings('label').removeClass('active');}
$currChips.siblings('.prefix').removeClass('active');});self.$document.off('keydown.chips-add',SELS.CHIPS+' '+SELS.INPUT).on('keydown.chips-add',SELS.CHIPS+' '+SELS.INPUT,function(e){var $target=$(e.target);var $chips=$target.closest(SELS.CHIPS);var chipsLength=$chips.children(SELS.CHIP).length;if(13===e.which){if(self.hasAutocomplete&&($chips.find('.autocomplete-content.dropdown-content').length&&$chips.find('.autocomplete-content.dropdown-content').children().length||$chips.hasClass("autocomplete-loading"))){return;}
e.preventDefault();self.addChip({name:$target.val(),id:$target.data("autocompleteOptionId")},$chips);$target.val('');$target.data("autocompleteOptionId",false);return;}
if((8===e.keyCode||37===e.keyCode)&&''===$target.val()&&chipsLength){e.preventDefault();self.selectChip(chipsLength-1,$chips);$target.blur();return;}});self.$document.off('click.chips-delete',SELS.CHIPS+' '+SELS.DELETE).on('click.chips-delete',SELS.CHIPS+' '+SELS.DELETE,function(e){var $target=$(e.target);var $chips=$target.closest(SELS.CHIPS);var $chip=$target.closest(SELS.CHIP);e.stopPropagation();curr_options.beforeDeleteHook($chip).then(function(){self.deleteChip($chip.index(),$chips);$chips.find('input').focus();});});};this.chips=function($chips,chipId){$chips.empty();var chipsData=$chips.data('chips')
for(var chipId in chipsData){var chip=chipsData[chipId];$chips.append(self.renderChip(chip));}
$chips.append($('<input id="'+chipId+'" class="input" placeholder="">'));self.setPlaceholder($chips);var label=$chips.next('label');if(label.length){label.attr('for',chipId);if($chips.data('chips')!==undefined&&Object.keys($chips.data('chips')).length){label.addClass('active');}}
var input=$('#'+chipId);if(self.hasAutocomplete){curr_options.autocompleteOptions.onAutocomplete=function(val){self.addChip({name:val,id:input.data("autocompleteOptionId")},$chips);input.data("autocompleteOptionId",false);input.focus();input.val('');};curr_options.autocompleteOptions.onRendered=function(val,$autocomplete){if(val.length===0)return;var exists=false;var chipsData=$chips.data('chips');for(var chipId in chipsData){var chip=chipsData[chipId];if(chip.name===val){exists=true;}}
if(!exists){var createTagOption=$('<li class="new"><span>'+val+'</span></li>');$autocomplete.append(createTagOption);}};input.new_autocomplete(curr_options.autocompleteOptions);}};this.renderChip=function(elem){if(!elem.name){console.error("Cannot add chip without name");return;}
var $renderedChip=$('<div class="chip"></div>');$renderedChip.data("id",elem.id);$renderedChip.text(elem.name);if(elem.image){$renderedChip.prepend($('<img />').attr('src',elem.image));}
$renderedChip.append($('<i class="material-icons close">close</i>'));return $renderedChip;};this.setPlaceholder=function($chips){if($chips.data('chips')!==undefined&&!Object.keys($chips.data('chips')).length&&curr_options.placeholder){$chips.find('input').prop('placeholder',curr_options.placeholder);}else if(($chips.data('chips')===undefined||!!Object.keys($chips.data('chips')).length)&&curr_options.secondaryPlaceholder){$chips.find('input').prop('placeholder',curr_options.secondaryPlaceholder);}};this.isValid=function($chips,elem){var chips=$chips.data('chips');var exists=false;for(var chipId in chips){var chip=chips[chipId];if(chip.name===elem.name){exists=true;return;}}
return''!==elem.name&&!exists;};this.addChip=function(elem,$chips){if(!self.isValid($chips,elem)){return;}
curr_options.beforeAddHook(elem).then(function(elemUpdate){$.extend(elem,elemUpdate);var $renderedChip=self.renderChip(elem);var newData={};var oldData=$chips.data('chips');for(var id in oldData){newData[id]=oldData[id];}
if(!elem.id){console.error("Chip element does not have an ID");}
newData[elem.id]=elem;$chips.data('chips',newData);$renderedChip.insertBefore($chips.find('input'));$chips.trigger('chip.add',elem);self.setPlaceholder($chips);});};this.deleteChip=function(chipIndex,$chips){var $chip=$chips.find('.chip').eq(chipIndex);var chipId=$chip.data("id");var chip=$chips.data('chips')[chipId];$chip.remove();var newData={};var oldData=$chips.data('chips');for(var id in oldData){if(id!=chipId){newData[id]=oldData[id];}}
$chips.data('chips',newData);$chips.trigger('chip.delete',chip);self.setPlaceholder($chips);};this.selectChip=function(chipIndex,$chips){var $chip=$chips.find('.chip').eq(chipIndex);if($chip&&false===$chip.hasClass('selected')){$chip.addClass('selected');$chips.trigger('chip.select',$chips.data('chips')[chipIndex]);}};this.getChipsElement=function(index,$chips){return $chips.eq(index);};this.init();this.handleEvents();};if(Array.prototype.equals)
console.warn("Overriding existing Array.prototype.equals. Possible causes: New API defines the method, there's a framework conflict or you've got double inclusions in your code.");Array.prototype.equals=function(array){if(!array)
return false;if(this.length!=array.length)
return false;for(var i=0,l=this.length;i<l;i++){if(this[i]instanceof Array&&array[i]instanceof Array){if(!this[i].equals(array[i]))
return false;}
else if(this[i]!=array[i]){return false;}}
return true;}
Object.defineProperty(Array.prototype,"equals",{enumerable:false});;

/* /scrummer/static/src/js/libs/jquery-validate.js defined in bundle 'scrummer.assets' */
odoo.define('jquery-validator',function(require){var _t=require('web.core')._t;jQuery.validator.setDefaults({messages:{required:_t("This field is required."),remote:_t("Please fix this field."),email:_t("Please enter a valid email address."),url:_t("Please enter a valid URL."),date:_t("Please enter a valid date."),dateISO:_t("Please enter a valid date (ISO)."),number:_t("Please enter a valid number."),digits:_t("Please enter only digits."),equalTo:_t("Please enter the same value again."),maxlength:$.validator.format(_t("Please enter no more than {0} characters.")),minlength:$.validator.format(_t("Please enter at least {0} characters.")),rangelength:$.validator.format(_t("Please enter a value between {0} and {1} characters long.")),range:$.validator.format(_t("Please enter a value between {0} and {1}.")),max:$.validator.format(_t("Please enter a value less than or equal to {0}.")),min:$.validator.format(_t("Please enter a value greater than or equal to {0}.")),step:$.validator.format(_t("Please enter a multiple of {0}."))},ignore:"",validClass:"",errorElement:'div',errorPlacement:function(error,element){var placement=$(element).data('error');if(placement){$(placement).append(error)}else{error.insertAfter(element);}}});});;

/* /scrummer/static/src/js/main.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.main',function(require){"use strict";const AgileLayout=require('scrummer.layout');const core=require('web.core');core.action_registry.add('scrummer',AgileLayout.AgileLayout);});;

/* /scrummer/static/src/js/app_cache.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.app_cache',function(require){"use strict";const data=require('scrummer.data');const DependencyCache=require('scrummer.dependency_cache');const DataServiceFactory=require('scrummer.data_service_factory');data.cache.add("xmlidToResId",DependencyCache.AbstractDependency.extend({resolve(){this._require_obj("params",["xmlId"]);this.getDataSet("ir.model.data").call("xmlid_to_res_id",[this.params.xmlId]).then(this.deferred.resolve,this.deferred.reject);},}));data.cache.add("model_info",DependencyCache.AbstractDependency.extend({resolve(){this._require_obj("params",["model"]);data.session.rpc("/scrummer/model/info",{model_name:this.params.model}).then((model)=>{model.fields_list=Object.keys(model.fields);this.deferred.resolve(model);},this.deferred.reject);},}));data.cache.add("project.type.task_types_priorities",DependencyCache.AbstractDependency.extend({resolve(){this._require_obj("params",["id"]);data.session.rpc(`/scrummer/web/data/project/${this.params.id}/task_types_and_priorities`).then(this.deferred.resolve,this.deferred.reject);}}));data.cache.add("default_task_type_priorities",DependencyCache.AbstractDependency.extend({resolve(){$.when(this.cache.get("default_task_type_id"),DataServiceFactory.get("project.task.priority").getAllRecords(true),DataServiceFactory.get("project.task.type2").getAllRecords(true)).then((taskTypeId,priorities,types)=>{const result=[];types.get(taskTypeId).priority_ids.forEach((p_id)=>result.push(priorities.get(p_id)));this.deferred.resolve(result);});}}));data.cache.add("default_task_type_id",DependencyCache.AbstractDependency.extend({resolve(){$.when(this.cache.get("default_task_type_id"),DataServiceFactory.get("project.task.priority").getAllRecords(true),DataServiceFactory.get("project.task.type2").getAllRecords(true)).then((taskTypeId,priorities,types)=>{const result=[];types.get(taskTypeId).priority_ids.forEach((p_id)=>result.push(priorities.get(p_id)));this.deferred.resolve(result);});}}));data.cache.add("project.workflow",DependencyCache.AbstractDependency.extend({resolve(){this._require_obj("params",["id"]);data.session.rpc(`/scrummer/web/data/workflow/${this.params.id}`).then((workflow)=>{workflow.stageToState={};for(const state_id in workflow.states){const state=workflow.states[state_id];workflow.stageToState[state.stage_id]=state_id;}
this.deferred.resolve(workflow);});}}));data.cache.add("board_for_project",DependencyCache.AbstractDependency.extend({resolve(){this._require_obj("params",["id"]);this.getDataSet("project.project").read_slice(["name","board_ids"],{domain:[['id','=',this.params.id]]}).then((response)=>{const project=response[0];this.deferred.resolve(project.board_ids[0]);});}}));data.cache.add("projects_in_board",DependencyCache.AbstractDependency.extend({resolve(){this._require_obj("params",["id"]);this._require_obj("params",["team_id"]);this.getDataSet("project.project").read_slice(["name"],{domain:this.cache.get("current_user").then((user)=>[["board_ids","=",this.params.id],["id","in",user.team_ids[this.params.team_id].project_ids],])}).then((projects)=>{const map=new Map();projects.forEach((project)=>map.set(project.id,project));this.deferred.resolve(map);});}}));data.cache.add("team_members",DependencyCache.AbstractDependency.extend({resolve(){this._require_obj("params",["teamId"]);DataServiceFactory.get("project.agile.team").getRecord(this.params.teamId).then((team)=>{DataServiceFactory.get("res.users").getRecords(team.member_ids).then(this.deferred.resolve,this.deferred.reject);});}}));data.cache.add("current_user",DependencyCache.AbstractDependency.extend({resolve(){data.session.rpc("/scrummer/session_user").then((user)=>{user.imageUrl=data.getImage("res.users",user.id,user.write_date);this.deferred.resolve(user);},this.deferred.reject);}}));data.cache.add("get_user",DependencyCache.AbstractDependency.extend({resolve(){this._require_obj("params",["id"]);const cacheMiss=()=>{this.cache.get("model_info",{model:'res.users'}).then((model)=>{this.getDataSet(model.name).read_ids([this.params.id],model.fields_list).then((result)=>{const user=result[0];this.deferred.resolve(user);},this.deferred.reject);});};this.cache.get("current_user").then((session_user)=>{if(!Array.isArray(session_user.team_id)){cacheMiss();}
this.cache.get("team_members",{teamId:session_user.team_id[0]}).then((members)=>{const user=members.find((e)=>e.id===this.params.id);if(user){this.deferred.resolve(user);}else{cacheMiss();}});});}}));data.cache.add("get_message_subtypes",DependencyCache.AbstractDependency.extend({resolve(){this._require_obj("params",["res_model"]);const priorityIdsPromise=this.getDataSet("mail.message.subtype").id_search("",[["res_model","=",this.params.res_model]]);priorityIdsPromise.then((ids)=>{DataServiceFactory.get("mail.message.subtype").getRecords(ids).then((records)=>{this.deferred.resolve(records);},this.deferred.reject);},this.deferred.reject);}}));data.cache.add("project.task.link.relation.nameOrderMaps",DependencyCache.AbstractDependency.extend({resolve(){DataServiceFactory.get("project.task.link.relation").getAllRecords().then((relations)=>{const nameToOrderMap=new Map();const orderToNameMap=new Map();relations.forEach((relation)=>{nameToOrderMap.set(relation.name,relation.sequence);orderToNameMap.set(relation.sequence,relation.name);});this.deferred.resolve(nameToOrderMap,orderToNameMap);},this.deferred.reject);}}));data.xmlidToResId=function(xmlId){return data.cache.get("xmlidToResId",{xmlId});};data.getMessageSubtypes=function(res_model){return data.cache.get("get_message_subtypes",{res_model});};});;

/* /scrummer/static/src/js/framework/core.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.core',function(require){"use strict";const Bus=require('web.Bus');const bus=new Bus();return{bus,};});;

/* /scrummer/static/src/js/framework/mixins.js defined in bundle 'scrummer.assets' */
"use strict";odoo.define('scrummer.mixins',function(){const RequireMixin={_require_prop(property,message=""){if(!(property in this)||this[property]===null){throw new Error(`Property ${property}must be specified!${message}`);}},_require_method(method,message=""){if(typeof this[method]!=="function"){throw new Error(`Method ${method}must be defined!${message}`);}},_require_obj(object,properties=[],message=""){if(typeof this[object]!=="object"){throw new Error(`Object ${object}must be specified!${message}`);}
properties.forEach(this._require_prop.bind(this[object]));},};const MenuItemsMixin={menuItems:[],menuItemsContainer:false,init(){this.menuItems=this.menuItems.sort((x,y)=>x.sequence>y.sequence);},start(){for(const item of this.menuItems){const callback=typeof item.callback==="function"?item.callback:this[item.callback];if(typeof callback!=="function"){throw new Error("menuItem.callback must be function or name of method");}
this.$(`.${item.class}`).unbind("click");this.$(`.${item.class}`).click(callback.bind(this));}
this.updateMenuVisibility();},updateMenuVisibility(){this.menuItemsContainer&&this.$(this.menuItemsContainer).hide();for(const item of this.menuItems){const isHidden=typeof item.hidden==="function"?item.hidden.call(this):typeof this[item.hidden]==="function"?this[item.hidden].call(this):item.hidden;$.when(isHidden).then((hidden)=>{if(hidden){this.$(`.${item.class}`).hide();}else{this.$(`.${item.class}`).show();this.menuItemsContainer&&this.$(this.menuItemsContainer).show();}});}}};return{RequireMixin,MenuItemsMixin};});;

/* /scrummer/static/src/js/framework/data/dataset.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.dataset',function(require){"use strict";const web_data=require('web.data');web_data.DataSetSearch.include({id_search:function(name,domain,operator,limit,order){return $.when(name,domain,operator,limit,order).then((name,domain,operator,limit,order)=>this._model.call('id_search',{name:name||'',args:domain||false,operator:operator||'ilike',context:this.get_context(),limit:limit||0,order:order||''}));},create:function(data,options={}){return this._model.call('create',[data],{context:this.get_context(options.context)}).done(()=>this.trigger('dataset_changed',data,options));},});const datasets=new Map();const get=function(dataset){if(datasets.has(dataset)){return datasets.get(dataset);}
const ds=new web_data.DataSetSearch(null,dataset);ds._read_slice=ds.read_slice;ds.read_slice=function(fields,options={}){const{domain,offset,limit,sort,context}=options;return $.when(fields,domain,offset,limit,sort,context).then((fields,domain,offset,limit,sort,context)=>this._read_slice(fields,Object.assign(options,{domain,offset,limit,sort,context})));}.bind(ds);ds._name_search=ds.name_search;ds.name_search=function(name,domain,operator,limit){return $.when(domain,operator,limit).then((domain,operator,limit)=>this._name_search(name,domain,operator,limit));}.bind(ds);datasets.set(dataset,ds);return ds;};return{get};});;

/* /scrummer/static/src/js/framework/data/dependency_cache.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.dependency_cache',function(require){"use strict";const core=require('web.core');const AgileMixins=require('scrummer.mixins');const DataSet=require('scrummer.dataset');const DependencyCache=core.Class.extend({init(){this.deps={};},orderedStringify(obj){const copy={};if(typeof obj!=="object"){return"";}
Object.keys(obj).sort((a,b)=>a>b).forEach((key)=>{copy[key]=obj[key];});return JSON.stringify(copy);},invokeOnceFactory(Dependency,options){const invoked=new Map();return(params)=>{const optionsStringified=this.orderedStringify(params);if(!invoked.get(optionsStringified)){const dep=new Dependency(this,options,params);invoked.set(optionsStringified,dep);dep.resolve();}
return invoked.get(optionsStringified).promise();};},add(name,dependency,options){this.deps[name]=this.invokeOnceFactory(dependency,options);},get(name,params){return this.deps[name](params);},has(name){return name in this.deps;}});const AbstractDependency=core.Class.extend(AgileMixins.RequireMixin,{init(cache,options,params){Object.assign(this,options);this.cache=cache;this.params=params;this.deferred=$.Deferred();this.getDataSet=DataSet.get;},resolve(){throw new Error("Not implemented!");},promise(){return this.deferred.promise();}});return{DependencyCache,AbstractDependency,};});;

/* /scrummer/static/src/js/framework/data/data.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.data',function(require){"use strict";const DataSet=require('scrummer.dataset');const bus=require('bus.bus');const session=require('web.session');const Syncer=require('web.syncer').Syncer;const DependencyCache=require('scrummer.dependency_cache');const cache=new DependencyCache.DependencyCache();const getImage=function(model,id,last_update,field="image_small"){return session.url('/web/image',{model,id,field,unique:(last_update||'').replace(/[^0-9]/g,'')});};const getTaskLinks=function(taskId){return session.rpc(`/scrummer/web/data/task/${taskId}/get_task_links`,{context:{task_id:taskId}});};window.data={cache,getDataSet:DataSet.get,getImage,getTaskLinks,session,bus,sync:new Syncer()};return window.data;});;

/* /scrummer/static/src/js/framework/data/data_service.js defined in bundle 'scrummer.assets' */
"use strict";odoo.define('scrummer.DataService',function(require){const core=require('scrummer.core');const data=require('scrummer.data');const web_core=require('web.core');const AgileMixins=require('scrummer.mixins');const concurrency=require('web.concurrency');function generate_uuid(){let uuid="";for(let i=0;i<32;i++){const random=Math.random()*16|0;if(i===8||i===12||i===16||i===20){uuid+="-";}
uuid+=(i===12?4:i===16?(random&3)|8:random).toString(16);}
return uuid;}
const DataService=web_core.Class.extend(AgileMixins.RequireMixin,{__dataService:true,readonly:true,init(options){Object.assign(this,options);this._require_prop("model");this.modelMetaLoaded=data.cache.get("model_info",{model:this.model}).then((model)=>{this.modelMeta=model;this.onModelMetaLoaded();});this.dataset=data.getDataSet(this.model);this.records=new Map();this.mutex=new concurrency.Mutex();},onModelMetaLoaded(){if(this.modelMeta.sync){this.subscribeToChanges();}},_filterRecords(ids,toMap){if(!ids){return toMap?new Map(this.records):[...this.records.values()];}
if(toMap){const result=new Map();ids.forEach((id)=>result.set(id,this.records.get(id)));return result;}
const result=[];ids.forEach((id)=>result.push(this.records.get(id)));return result;},_getRecords(ids,toMap){const misses=ids.filter((id)=>!this.records.has(id));if(misses.length){return this.modelMetaLoaded.then(()=>this.dataset.read_ids(misses,this.modelMeta.fields_list).then((records)=>{records.forEach((record)=>{this.records.set(record.id,this.wrapRecord(record));});return this._filterRecords(ids,toMap);}));}
const result=[];ids.forEach((id)=>result.push(this.records.get(id)));return $.when(this._filterRecords(ids,toMap));},getRecords(ids,toMap){return this.mutex.exec(()=>this._getRecords(ids,toMap));},getAllRecords(toMap=false,fetchAgain=false){return this.mutex.exec(()=>{if(!this.allRecordsPromise||fetchAgain){this.allRecordsPromise=this.modelMetaLoaded.then(()=>{const cachedIds=[...this.records.keys()];return this.dataset.read_slice(this.modelMeta.fields_list,{domain:[['id','not in',cachedIds]]}).then((records)=>{records.forEach((record)=>{this.records.set(record.id,this.wrapRecord(record));});return this._filterRecords(null,toMap);});});}
return this.allRecordsPromise;});},getRecord(id){return this.mutex.exec(()=>{const def=$.Deferred();if(this.records.has(id)){def.resolve(this.records.get(id));}else{this._getRecords([id]).then((res)=>{def.resolve(res[0]);});}
return def.promise();});},updateRecord(ids){return this.mutex.exec(()=>this.dataset.read_ids(ids,this.modelMeta.fields_list).then((records)=>{for(const record of records){if(this.records.has(record.id)){const proxy=this.records.get(record.id);proxy.update(record);}else{console.error("Calling update on record that isn't being cached. Use getRecord first.");}}
return $.when();}));},wrapRecord(record){const fields=this.modelMeta.fields;const readonly=this.readonly;const service=this;let editPromise=false;record._source=record;record._previous=null;record._custom={};record._uuid=generate_uuid();record.copy=function(){const previous=Object.assign({},this._source);delete previous._previous;delete previous._source;return previous;};record.update=function(values){this._previous=this.copy();this._source=Object.assign(this._source,values);};return new Proxy(record,{set(trapTarget,key,value,receiver){if(key==="id"){throw new TypeError("You are not allowed to change records id",arguments);}
if(readonly&&!["_previous","_source"].includes(key)){throw new TypeError("DataService is declared as readonly, you can not write to it's records",arguments);}
const field=fields[key]||{};if(Object.keys(fields).includes(key)){const writeValue=field.type==="many2one"&&Array.isArray(value)?value[0]:value;const receiverValue=field.type==="many2one"?receiver[key][0]:receiver[key];if(writeValue===receiverValue){return Reflect.set(trapTarget,value,receiver);}
!field.readonly&&service.dataset.write(trapTarget.id,{[key]:writeValue}).fail((r)=>console.error(`Error ${service.dataset.model}[${trapTarget.id}]:${key}-${value}`,r));return Reflect.set(trapTarget,key,trapTarget[key],receiver);}
return Reflect.set(trapTarget,key,value,receiver);},get(trapTarget,key,receiver){if(key==="promise"){return;}
const proxyRecord=trapTarget;if(key==="_is_dataservice"){return true;}
if(key==="_edit"){return function(promise){if(promise==="check"){return editPromise&&editPromise.state()==="pending";}else if(typeof promise!=='undefined'){editPromise=promise;}
return editPromise;};}
if(!(key in receiver)){return new Proxy(()=>{},{apply:function(functionTarget,thisArg,argumentList){let context=service.dataset.get_context().eval();if(argumentList.length>0){const argument=argumentList[argumentList.length-1];if(argument.context){context=Object.assign(argument.context,context);argumentList.length--;}}
return service.dataset._model.call(key,[[proxyRecord.id],...argumentList],{context:context});}});}
return Reflect.get(trapTarget,key,receiver);}});},subscribeToChanges(){data.sync.subscribe(odoo.session_info.db+":"+this.model,(notification)=>{const id=notification[0][2];const payload=notification[1];switch(notification[1].method){case"write":{this.recordUpdated(id,payload.data,payload);break;}
case"create":{this.recordCreated(id,payload.data,payload);break;}
case"unlink":{const task=this.records.get(id);if(task){this.records.delete(id);payload.data=task;this.recordDeleted(id,payload);}
break;}}});},recordUpdated(id,vals,payload){const record=this.records.get(id);if(record){record.update(vals);core.bus.trigger(this.model+":write",id,vals,payload,record);}},recordCreated(id,vals,payload){core.bus.trigger(this.model+":create",id,vals,payload);},recordDeleted(id,payload){core.bus.trigger(this.model+":unlink",id,payload);},addFields(fields){if(this.records.size){const newFields=fields.filter((field)=>!this.fields.includes(field));this.fields.push.apply(this.fields,newFields);this.dataset.read_slice(newFields,{domain:[["id","in",[...this.records.keys()]]]}).then((updates)=>{updates.forEach((update)=>{const record=this.records.get(update.id);Object.assign(record._source,update);});});}},setReadonly(readonly){if(typeof readonly!=="undefined"){this.readonly=readonly;}
return this;}});return DataService;});;

/* /scrummer/static/src/js/framework/data/data_service_factory.js defined in bundle 'scrummer.assets' */
"use strict";odoo.define('scrummer.data_service_factory',function(require){const DataService=require('scrummer.DataService');const custom_registry=new Map();const cached_data_services=new Map();const DataServiceFactory={custom_registry,get(modelName,readonly){if(!cached_data_services.has(modelName)){const DataServiceClass=custom_registry.has(modelName)?custom_registry.get(modelName):DataService;const newDataServiceInstance=new DataServiceClass({model:modelName});newDataServiceInstance.setReadonly(readonly);cached_data_services.set(modelName,newDataServiceInstance);}
return cached_data_services.get(modelName);}};window.DataServiceFactory=DataServiceFactory;return DataServiceFactory;});;

/* /scrummer/static/src/js/framework/hash_service.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.hash_service',function(require){"use strict";const core=require('web.core');const mixins=require('web.mixins');const HashService=core.Class.extend(mixins.EventDispatcherMixin,{init(){mixins.EventDispatcherMixin.init.call(this);$(window).hashchange((e)=>{e.preventDefault();this.set_from_hash(location.hash);});this.__properties={};this.set_from_hash(location.hash);},set(key,value,quiet=false){if(this.__properties[key]!==value){const tmp=this.__properties[key];this.__properties[key]=value;if(tmp!==value&&!quiet){this.trigger("change:"+key,{oldValue:tmp,newValue:value});}}},delete(key){if(key in this.__properties){const tmp=this.__properties[key];delete this.__properties[key];if(tmp){this.trigger("change:"+key,{oldValue:tmp,newValue:null});}
this.hashToUrl(this.__properties,false);}},get(key){return this.__properties[key];},setHash(key,value=true,storeToHistory=true,quiet=false){this.set(key,value,quiet);this.hashToUrl(this.__properties,storeToHistory);},extract_hash(url){return url.slice(url.indexOf("#"));},set_from_hash(newHash){const oldHashObject=this.__properties;const newHashObject=this.parseHash(newHash);for(const key in oldHashObject){if(!(key in newHashObject)){this.delete(key);}}
for(const key in newHashObject){if(oldHashObject[key]!==newHashObject[key]){this.set(key,newHashObject[key]);}}},parseHash(hashString){const hash={};if(hashString){const hashParts=hashString.substring(1).split("&");for(const part of hashParts){if(part.includes("=")){const[key,value]=part.split("=");hash[key]=value;}else{hash[part]=true;}}}
return hash;},hashToUrl(hashObject,storeToHistory=true){if(storeToHistory){location.hash="#"+$.param(hashObject);}else{history.replaceState(null,null,"#"+$.param(hashObject));}}});window.hash_service=new HashService();return window.hash_service;});;

/* /scrummer/static/src/js/framework/storage_service.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.storage_service',function(require){"use strict";const core=require('web.core');const mixins=require('web.mixins');const StorageService=core.Class.extend(mixins.EventDispatcherMixin,{init(prefix){mixins.EventDispatcherMixin.init.call(this);this.prefix=prefix+"_";},set(key,val){const keyWithPrefix=this.prefix+key;const currentVal=window.localStorage.getItem(keyWithPrefix);const value=typeof val==="object"?JSON.stringify(val):val;if(currentVal!==value){const tmp=currentVal;window.localStorage.setItem(keyWithPrefix,value);if(tmp!==value){this.trigger("change:"+key,this,{oldValue:tmp,newValue:value});}}},delete(key){const keyWithPrefix=this.prefix+key;const currentVal=window.localStorage.getItem(keyWithPrefix);if(currentVal!==null){const tmp=this.currentVal;window.localStorage.removeItem(keyWithPrefix);if(typeof tmp!=="undefined"&&tmp!==null){this.trigger("change:"+key,this,{oldValue:tmp,newValue:null});}}},get(key){const keyWithPrefix=this.prefix+key;const currentVal=window.localStorage.getItem(keyWithPrefix);return this._isJsonString(currentVal)?JSON.parse(currentVal):currentVal;},_isJsonString(str){try{JSON.parse(str);}catch(e){return false;}
return true;}});return new StorageService("scrummer");});;

/* /scrummer/static/src/js/framework/web_client.js defined in bundle 'scrummer.assets' */
"use strict";odoo.define('web.web_client',function(require){const WebClient=require('web.WebClient');const web_client=new WebClient();web_client._title_changed=function(){};web_client.do_push_state=function(state){this.trigger('state_pushed',state);};web_client.toggle_fullscreen=function(){};web_client.current_action_updated=function(){};web_client.show_application=function(){return web_client.action_manager.do_action("scrummer");};$(function(){web_client.setElement($(document.body));web_client.start();});return web_client;});;

/* /scrummer/static/src/js/framework/helper_methods.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.helpers',function(require){"use strict";const _t=require("web.core")._t;require("web.dom_ready");const time={parse:function(val){let ret=0;const time_map={m:1,h:60,d:480,w:2400,y:124800};try{const time_parts=val.split(" ");time_parts.forEach(function(time_part,index,array){if(time_part.length){const number_part=time_part.slice(0,-1);const last_char=time_part.slice(-1);if(time_map[last_char]&&!isNaN(number_part)&&parseInt(number_part,10)>0){ret+=number_part*time_map[last_char];}else if(index===array.length-1&&!isNaN(time_part)&&parseInt(time_part,10)>0){ret+=parseInt(time_part,10);}else{throw new Error();}}});}catch(err){throw new Error(_t("Wrong time duration format!"));}
return ret/60;},format:function(val){let temp_val=val*60;const ret_array=[];const time_map_inverse={124800:"y",2400:"w",480:"d",60:"h",1:"m"};const time_chunks=Object.keys(time_map_inverse).sort(function(a,b){return b-a;});for(const p in time_chunks){const chunk=parseInt(time_chunks[p],10);const chunk_count=temp_val/chunk>>0;if(chunk_count){ret_array.push(chunk_count+time_map_inverse[chunk]);}
temp_val%=chunk;}
return ret_array.join(" ");},valid:function(val){try{this.parse(val);return true;}catch(e){return false;}},parseOrFalse:function(val){try{return this.parse(val);}catch(e){return false;}}};$.validator.addMethod("scrummer.time",function(value,element){return this.optional(element)||time.valid(value);},"Please specify correct form, e.g. 1d 3h 15m");return{time,};});;

/* /scrummer/static/src/js/framework/dialog.js defined in bundle 'scrummer.assets' */
'use strict';odoo.define('scrummer.dialog',function(){return{confirm(title,message,okText="ok",cancelText="cancel"){const def=new $.Deferred();const modal=$("<div id='"+Date.now()+"' class='modal dialog'>"+"<div class='modal-content'><h4>"+title+"</h4><p>"+message+"</p></div>"+"</div>");const modalFooter=$("<div class='modal-footer'></div>");modalFooter.appendTo(modal);const ok=$("<a class='modal-action waves-effect waves-green btn-flat'>"+okText+"</a>");const cancel=$("<a class='modal-action modal-close waves-effect waves-green btn-flat'>"+cancelText+"</a>");modalFooter.append(ok).append(cancel);$("body").append(modal);modal.materialModal({dismissible:false,complete:function(){if(!modal.ok){def.reject();}
modal.remove();}});modal.materialModal("open");ok.click(()=>{modal.ok=true;def.resolve();modal.materialModal("close");});return def.promise();}};});;

/* /scrummer/static/src/js/framework/config.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.config',function(require){"use strict";const bus=require('scrummer.core').bus;const medias=[window.matchMedia('(max-width: 600px)'),window.matchMedia('(min-width: 601px) and (max-width: 992px)'),window.matchMedia('(min-width: 993px)')];function size_class(){for(let i=0;i<medias.length;i++){if(medias[i].matches){return i;}}}
const config={debug:$.deparam($.param.querystring()).debug,device:{size_class:size_class(),SIZES:{S:0,M:1,L:2}}};function set_size_class(){const sc=size_class();if(sc!==config.device.size_class){config.device.size_class=sc;bus.trigger('size_class',sc);}}
medias.forEach((m)=>m.addListener(set_size_class));return config;});;

/* /scrummer/static/src/js/framework/toast.js defined in bundle 'scrummer.assets' */
"use strict";odoo.define('scrummer.toast',function(require){const web_core=require('web.core');const _t=web_core._t;const hash_service=require('scrummer.hash_service');const ScrummerData=require('scrummer.data');const Materialize=window.Materialize;return{duration:5000,toast(content,imageUrl,button,callback=null,duration=this.duration,type=""){const toastContainer=$("<div class='toast-container'/>");if(imageUrl){const toastUserImage=$('<div class="toast-left"><img alt="" class="user-image circle" src="'+imageUrl+'"></div>');toastContainer.append(toastUserImage);}
const toastContent=$('<div class="toast-content"></div>');toastContent.append(content);toastContainer.append(toastContent);if(button){const btn=$('<div class="toast-right"><button class="btn-flat toast-action white-text">'+button.text+'</button></div>');btn.click(button.callback);toastContainer.append(btn);}
Materialize.toast(toastContainer,duration,("agile-toast "+type).trim(),callback);},toastTask(user,task,method){const action={create:_t("created"),write:_t("updated"),unlink:_t("deleted"),};const toastContent=$('<div class="toast-content"><p><span class="toast-user-name">'+user.name+'</span> '+action[method]+' '+task.priority_id[1]+' '+task.type_id[1]+' <span class="toast-task-name">'+task.key+' - '+task.name+'</span></p></div>');this.toast(toastContent,ScrummerData.getImage("res.users",user.id,user.write_date),{text:"open",callback:()=>{hash_service.set("task",task.id);hash_service.set("view","task");hash_service.set("page","board");}});}};});;

/* /scrummer/static/src/js/views/view_manager.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.view_manager',function(require){"use strict";const hash_service=require('scrummer.hash_service');const SubheaderWidget=require('scrummer.subheader').SubheaderWidget;const AgileBaseWidget=require('scrummer.BaseWidgets').AgileBaseWidget;const TaskView=require('scrummer.view.task').TaskView;const web_core=require('web.core');const _t=web_core._t;const ViewManager=AgileBaseWidget.extend({key:"view",template:"scrummer.view_manager",custom_events:{set_title:'_onSetTitle',init_action_menu:function(evt){this.initActionMenu(evt.data.items);},rerender_view:function(){this.rerender_view();}},init(parent,options={}){this._super(parent,options);Object.assign(this,options);this._require_prop("key");this._require_prop("defaultView");this.build_view_registry();this.instantiate_views();this.register_events();},instantiate_views(){hash_service.on("change:"+this.key,this,(options)=>options.newValue&&this.set_view(options.newValue));hash_service.on("change:board",this,(options)=>options.newValue&&this.set_view(hash_service.get("view")));},register_events(){this.on("loading:start",this,()=>{this.$(".progress").addClass("active");this.$(".view-content").removeClass("loaded");});this.on("loading:stop",this,()=>{this.$(".progress").removeClass("active");this.$(".view-content").addClass("loaded");});},renderElement(){this._super();if(hash_service.get(this.key)){this.set_view(hash_service.get(this.key));}else{hash_service.setHash(this.key,this.defaultView,false);}
this.subheader=new SubheaderWidget(this);this.subheader.appendTo(this.$("#subheader-wrapper"));},set_view(view_name){if(this.view_registry.get(view_name)){this.current_view=view_name;const ViewWidget=this.view_registry.get(view_name);if(!ViewWidget.toString().includes("OdooClass")){throw new Error("Widget does not exist");}
let old=null;if(this.widget&&typeof this.widget.destroy==="function"){old=this.widget;this.removeActionMenu();if(typeof this.widget.removeNavSearch==="function"){this.widget.removeNavSearch();}}
this.trigger("loading:start");this.widget=new ViewWidget(this);this.widget.appendTo(this.$("widget.view-content").empty());this.widget._is_added_to_DOM.then(()=>{if(old){old.destroy();}
this.trigger("loading:stop");});}else{hash_service.setHash(this.key,this.defaultView,false);console.error(_t("View ")+view_name+_t(" does not exist!"));}},rerender_view(){this.set_view(this.current_view);},build_view_registry(){this.view_registry=new Map();this.view_registry.set("task",TaskView);},initActionMenu(menuItems){if(jQuery.isFunction(menuItems)){const callback=menuItems;const el=$("<div/>");el.appendTo(this.$(".actions-menu"));const actionMenuPromise=callback(el);if(jQuery.isFunction(actionMenuPromise.promise)){actionMenuPromise.always((widget)=>{if(widget===this.widget){this.$(".actions-menu").empty();}});}else{throw new Error("openRightSide callback should return promise");}
return;}
if(!Array.isArray(menuItems)){throw new Error("menuItems must be an array");}
for(const item of menuItems){if(item.widget&&item.widget.__AGILE_BASE_WIDGET){item.widget.appendTo(this.$(".actions-menu"));}else{const node=$('<a class="btn-floating btn-large btn-flat waves-effect"></a>');let html="";if(item.icon){html+="<i class='mdi mdi-"+item.icon+" large'></i>";}else{html+=item.title;}
node[0].innerHTML=html;node.click(item.action);node.appendTo(this.$(".actions-menu"));}}},removeActionMenu(){this.$(".actions-menu").empty();},_onSetTitle(evt){this._is_rendered.then(()=>{this.subheader.setTitle(evt.data.title);});}});return ViewManager;});;

/* /scrummer/static/src/js/views/page_manager.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.page_manager',function(require){"use strict";const web_core=require('web.core');const ScrummerData=require('scrummer.data');const _t=web_core._t;const core=require('scrummer.core');const bus=core.bus;const hash_service=require('scrummer.hash_service');const AgileBaseWidget=require('scrummer.BaseWidgets').AgileBaseWidget;const DashboardPage=require('scrummer.page.dashboard').DashboardPage;const BoardPage=require('scrummer.page.board');const PageManager=AgileBaseWidget.extend({key:"page",id:"middle",_name:"Page Manager",init(parent,options={}){this._super(parent,options);Object.assign(this,options);this._require_prop("key");this._require_prop("defaultView");this.build_view_registry();this.instantiate_views();},instantiate_views(){hash_service.on("change:"+this.key,this,(options)=>this.set_view(options.newValue));},renderElement(){this._super();this.$el.prepend($("<div id='middle-offset'/>"));if(hash_service.get(this.key)){this.set_view(hash_service.get(this.key));}else{hash_service.setHash(this.key,this.defaultView,false);}},set_view(view_name,options={}){if(this.view_registry.get(view_name)){this.current_view=view_name;const ViewWidget=this.view_registry.get(view_name);if(!ViewWidget.toString().includes("OdooClass")){throw new Error(_t("Widget does not exist"));}
if(this.widget&&typeof this.widget.destroy==="function"){this.widget.destroy();}
this.widget=new ViewWidget(this,options);this.widget.appendTo(this.$el);}else{hash_service.setHash(this.key,this.defaultView,false);console.error(_t("View ")+view_name+_t(" does not exist!"));}},rerender_view(options){this.set_view(this.current_view,options);},willStart(){return $.when(this._super(),ScrummerData.cache.get("current_user").then((user)=>{this.user=user;}));},start(){bus.on('team:changed',null,()=>{this.set_view("dashboard");});return this._super();},build_view_registry(){this.view_registry=new Map();this.view_registry.set("dashboard",DashboardPage);this.view_registry.set("board",BoardPage);}});return PageManager;});;

/* /scrummer/static/src/js/views/backlog.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.view.backlog',function(require){"use strict";const data=require('scrummer.data');const DataServiceFactory=require('scrummer.data_service_factory');const AgileViewWidget=require('scrummer.BaseWidgets').AgileViewWidget;const AgileModals=require('scrummer.widget.modal');const AbstractModelList=require('scrummer.abstract_model_list');const ModelList=require('scrummer.model_list');const TaskWidget=require('scrummer.widget.task').TaskWidget;const hash_service=require('scrummer.hash_service');const pluralize=require('pluralize');const web_core=require('web.core');const qweb=web_core.qweb;const _t=web_core._t;const core=require('scrummer.core');const AgileToast=require('scrummer.toast');const Sortable=require('sortable');const dialog=require('scrummer.dialog');const mixins=require('scrummer.mixins');const Waypoint=window.Waypoint;const TOP=_t("Top");const BOTTOM=_t("Bottom");const task_service=DataServiceFactory.get("project.task",false);const project_service=DataServiceFactory.get("project.project");const SimpleBacklogTaskItem=ModelList.SimpleTaskItem.extend(mixins.MenuItemsMixin,{_name:"BacklogTaskItem",events:{'click':function(evt){if(evt.isDefaultPrevented()){return;}
this._onItemClicked(evt);},},menuItems:[{class:"assign-to-me",icon:"mdi-account-check",image:function(){return this.currentUser.imageUrl;},text:_t("Assign To Me"),callback:'_onAssignToMeClick',sequence:1,hidden(){return this.record.user_id&&this.record.user_id[0]===data.session.uid;}},{class:"unassign",icon:"mdi-account-minus",text:_t("Unassign"),callback:'_onUnassignClick',sequence:2,hidden(){return!(this.record.user_id&&this.record.user_id[0]===data.session.uid);}},{class:"edit-item",icon:"mdi-pencil",text:_t("Edit"),callback:'_onEditItemClick',sequence:3,},{class:"add-sub-item",icon:"mdi-subdirectory-arrow-right",text:_t("Add Sub Item"),callback:'_onAddSubItemClick',sequence:4,hidden(){return!this.task_type.allow_sub_tasks;},},{class:"add-link",icon:"mdi-link",text:_t("Add Link"),callback:'_onAddLinkClick',sequence:5,},{class:"add-comment",icon:"mdi-comment-account",text:_t("Add Comment"),callback:'_onAddCommentClick',sequence:6,},{class:"delete",icon:"mdi-delete",text:_t("Delete"),callback:'_onDelete',sequence:7,},],init(){this._super.apply(this,arguments);mixins.MenuItemsMixin.init.call(this);},start(){mixins.MenuItemsMixin.start.call(this);this.$(".task-menu, .dropdown-content a").click((evt)=>{evt.preventDefault();});return this._super();},addedToDOM(){this._super();this.$('.dropdown-button').dropdown();},rerenderWidget(){this.renderElement();this.start();this.addedToDOM();},_onItemClicked(){this.trigger_up("open_right_side",{WidgetClass:TaskWidget,options:{id:this.record.id,isQuickDetailView:true}});},_onAssignToMeClick(){this.record.user_id=data.session.uid;},_onUnassignClick(){this.record.user_id=false;},_onEditItemClick(){this.trigger_up("open_new_item_modal",{currentProjectId:this.record.project_id[0],focus:"name",edit:this.record,});},_onAddSubItemClick(){this.trigger_up("open_new_item_modal",{parent_id:this.record.id,currentProjectId:this.record.project_id[0]});},_onAddLinkClick(){this.trigger_up("open_link_modal",{id:this.record.id});},_onAddCommentClick(){const modal=new AgileModals.CommentItemModal(this,{task:this.record,});modal.appendTo($("body"));},_onDelete(){dialog.confirm(_t("Delete task"),_t("Are you sure you want to delete this task?"),_t("yes")).done(()=>{this.record.unlink();});},});const BacklogList=AbstractModelList.ModelList.extend({_name:"BacklogList",pageSize:10,init(parent,options){this._super(parent,options);this.size=this.pageSize;this._require_prop("task_ids","Field task_ids is array containing ids of all tasks in backlog");this._require_prop("taskWidgetItemCache","JavaScript Map object where key is id, and value is cached widget item.");this._require_prop("_getNewListWidget","A function that accepts list id in and returns ModelList widget instance");this.allFilteredTaskIds=this.getAllTaskIds();},getAllTaskIds(){return this.task_ids;},loadItems(){return task_service.getRecords(this.getSlicedBacklogTaskIds(this.getFilteredTaskIds(this.allFilteredTaskIds))).then((tasks)=>{this.data=tasks;});},shouldLoadMore(){return this.allFilteredTaskIds.length>this.list.size;},getFilteredTaskIds(filtered_task_ids){return filtered_task_ids?this.getAllTaskIds().filter((id)=>filtered_task_ids.includes(id)):this.getAllTaskIds();},getSlicedBacklogTaskIds(backlog_task_ids){return backlog_task_ids.slice(0,this.size);},loadMoreItems(){this.size+=10;const sliced_task_ids=this.getSlicedBacklogTaskIds(this.getFilteredTaskIds(this.allFilteredTaskIds));this.trigger_up("loading_more_items_started");task_service.getRecords(sliced_task_ids).then((tasks)=>{this.data=tasks;return tasks;}).then((tasks)=>{tasks.forEach(this.addItem.bind(this));this.trigger_up("loading_more_items_finished");this.trigger_up("backlog_list_changed",{size:this.list.size,total:this.allFilteredTaskIds.length});});},addItem(item){if(this.list.has(item.id)){return;}
!this.getAllTaskIds().includes(item.id)&&this.getAllTaskIds().push(item.id);!this.allFilteredTaskIds.includes(item.id)&&this.allFilteredTaskIds.push(item.id);const cachedWidget=this.taskWidgetItemCache.get(item.id);const retVal=this._super(cachedWidget||item);cachedWidget||this.taskWidgetItemCache.set(item.id,retVal);this.trigger_up("backlog_list_changed",{size:this.list.size,total:this.allFilteredTaskIds.length});return retVal;},removeItem(id){const removed=this._super.apply(this,arguments);this.allFilteredTaskIds.includes(id)&&this.allFilteredTaskIds.splice(this.allFilteredTaskIds.indexOf(id),1);if(removed){this.trigger_up("backlog_list_changed",{size:this.list.size,total:this.allFilteredTaskIds.length});}
return removed;},addedToDOM(){this.$el.waypoint({handler:(direction)=>{if(direction==="down"&&this.shouldLoadMore()){this.loadMoreItems();}},context:"#backlog-view",offset:'bottom-in-view'});},applyFilter(filteredTaskIds){this.size=10;this.allFilteredTaskIds=this.getFilteredTaskIds(filteredTaskIds);for(const id of this.list.keys()){if(!this.allFilteredTaskIds.includes(id)){this.removeItem(id,false);}}
if(this.shouldLoadMore()&&!this.loadingMoreItems){this.loadMoreItems();}}});const NonBacklogList=AbstractModelList.ModelList.extend({_name:"NonBacklogList",init(){this._super.apply(this,arguments);this._require_prop("_getNewListWidget","A function that accepts list id in and returns ModelList widget instance");this._require_prop("taskWidgetItemCache","JavaScript Map object where key is id, and value is cached widget item.");this._require_prop("allFilteredTaskIds","This is the array of ids that will be used for general filtering of tasks in list.");},loadItems(){return task_service.getRecords(this.getAllTaskIds()).then((tasks)=>{this.data=tasks;});},getAllTaskIds(){if(!this.generalFilteredTaskIds){this.generalFilteredTaskIds=this.task_ids.filter((id)=>this.allFilteredTaskIds.includes(id));}
return this.generalFilteredTaskIds;},getFilteredTaskIds(filtered_task_ids){const allTaskIds=this.getAllTaskIds();return typeof filtered_task_ids==="undefined"?allTaskIds:filtered_task_ids.filter((id)=>allTaskIds.includes(id));},shouldTaskBeAdded(item){if(hash_service.get("project")){const project_id=parseInt(hash_service.get("project"),10);const task_project_id=item._class==="ModelListItem"?item.record.project_id:item.project_id;return isNaN(project_id)||(task_project_id&&project_id===task_project_id[0]);}
return true;},addItem(item){if(!this.shouldTaskBeAdded(item)){return;}
if(this.list.has(item.id)){return this.list.get(item.id);}
const cachedWidget=this.taskWidgetItemCache.get(item.id);const retVal=this._super(cachedWidget||item);cachedWidget||this.taskWidgetItemCache.set(item.id,retVal);this.trigger_up("non_backlog_list_changed",{size:this.list.size,total:(this.allFilteredTaskIds||this.getAllTaskIds()).length,id:this.attributes['data-id']});return retVal;},removeItem(){const removed=this._super.apply(this,arguments);if(removed){this.trigger_up("non_backlog_list_changed",{size:this.list.size,total:(this.allFilteredTaskIds||this.getAllTaskIds()).length,id:this.attributes['data-id']});}},applyFilter(filteredTaskIds){this.allFilteredTaskIds=this.getFilteredTaskIds(filteredTaskIds);const taskIDsToBeAdded=this.getAllTaskIds().filter((id)=>this.allFilteredTaskIds.includes(id)&&!this.list.has(id));task_service.getRecords(taskIDsToBeAdded).then((records)=>records.forEach((record)=>this.addItem(record)));for(const id of this.list.keys()){!this.allFilteredTaskIds.includes(id)&&this.removeItem(id,false);}}});const AbstractBacklogView=AgileViewWidget.extend({title:_t("Backlog"),template:"scrummer.view.backlog",_name:"BacklogView",menuItems:[{class:"add-new-item",icon:"mdi-library-books",text:_t("Add new item"),callback:'_onAddNewItemClick'},],shouldRenderDragShortcuts:true,custom_events:Object.assign({},AgileViewWidget.prototype.custom_events||{},{drag_start:'_onDragStart',drag_end:'_onDragEnd',backlog_list_changed:'_onBacklogListChanged',open_link_modal:'_onOpenLinkModal',open_new_item_modal:'_onOpenNewItemModal',loading_more_items_started:'_onLoadingMoreItemsStarted',loading_more_items_finished:'_onLoadingMoreItemsFinished',}),init(parent,options){this._super(parent,options);this.board_id=parseInt(hash_service.get("board"),10);this.task_id=hash_service.get("task")&&parseInt(hash_service.get("task"),10);this.filterQuery="";this.taskWidgetItemMap=new Map();this.backlogLength=10;window.data=data;window.blv=this;},removeNavSearch(){core.bus.trigger("search:remove");},prepareUser(){return data.cache.get("current_user").then((user)=>{this.user=user;});},prepareProjects(){return project_service.dataset.id_search("",this.setupProjectIds().then(this.getProjectDomain.bind(this))).then((ids)=>project_service.getRecords(ids)).then((projects)=>{this.projects=projects;});},prepareBoard(){return DataServiceFactory.get("project.agile.board").getRecord(this.board_id).then((board)=>{this.board=board;});},loadDependencies(){return this.prepareBoard().then(()=>this.prepareUser()).then(()=>this.prepareProjects());},willStart(){const prepared=$.when(this._super(),this.loadDependencies());return $.when(prepared.then(()=>this.getFilteredTaskIds()),prepared.then(()=>task_service.dataset.id_search(this.filterQuery,this.getBacklogTaskDomain(),false,false,"agile_order").then((ids)=>{this.backlogTaskIds=ids;})));},getBacklogTaskDomain(){const domain=[["project_id","in",this.project_ids],["wkf_state_type","!=","done"]];if(this.boardTaskTypeFilterExists()){domain.push(["type_id","in",this.board.backlog_task_type_ids]);}
return $.when(domain);},getProjectDomain(){return[["board_ids","in",this.board_id],["id","in",this.project_ids],["workflow_id","!=",false]];},getApplyFilterDomain(){const domain=["|","|",["key","ilike",this.filterQuery],["description","ilike",this.filterQuery],["name","ilike",this.filterQuery],["project_id","in",this.project_ids],];if(this.boardTaskTypeFilterExists()){domain.push(["type_id","in",this.board.backlog_task_type_ids]);}
return $.when(domain);},_getTaskItemClass(){throw new Error("You should return class of non-abstract BacklogTaskItem");},renderElement(){this._super();this.backlogTaskList=new BacklogList(this,{model:"project.task",taskWidgetItemCache:this.taskWidgetItemMap,task_ids:this.backlogTaskIds,_getNewListWidget:this._getNewListWidget.bind(this),ModelItem:this._getTaskItemClass(),name:"backlog",sortable:{group:"backlog"},});const backlogData={count:"0 issues",estimates:{todo:0,inProgress:0,done:0}};this.backlogNode=$(qweb.render("scrummer.backlog",backlogData).trim());this.backlogNode.insertAfter(this.$("#backlog-view .section"));this.backlogTaskList.insertBefore(this.$(".list-preloader"));this.$(".list-preloader").hide();},_getNewListWidget(list_id){throw new Error("This method must be implemented");},start(){this._is_added_to_DOM.then(()=>{core.bus.trigger("search:show",(input)=>{this.applyFilter(input.val());});});this.bindEventListeners();return this._super();},bindEventListeners(){this.$('.tooltipped').tooltip({delay:50});core.bus.on("project.task:write",this,this._onProjectTaskWrite);core.bus.on("project.task:create",this,this._onProjectTaskCreate);core.bus.on("project.task:unlink",this,this._onProjectTaskUnlink);},setNewTaskOrder(task){throw new Error("Not implemented");},getFilteredTaskIds(){return task_service.dataset.id_search("",this.getApplyFilterDomain(),false,false,"agile_order").then((task_ids)=>{this.allFilteredTaskIds=task_ids;return task_ids;});},applyFilter(q){if(q===this.queryFilter){return;}
if(typeof q==="string"){this.filterQuery=q;}
this.getFilteredTaskIds().then(this.handleFilter.bind(this));},handleFilter(task_ids){this.backlogTaskList.applyFilter(task_ids);},allTaskIds(){return this.backlogTaskList.task_ids.slice();},getTaskListOfTaskWidget(taskWidget){throw new Error("Not implemented!");},isTaskInBacklog(task){throw new Error("Not implemented!");},addTaskToNonBacklogList(task){throw new Error("Not implemented!");},removeTask(id,removeFromCache=false,syncerMeta){const taskWidget=this.taskWidgetItemMap.get(id);if(!taskWidget){return false;}
this.getTaskListOfTaskWidget(taskWidget).removeItem(id);if(removeFromCache){this.taskWidgetItemMap.delete(id);}
if(syncerMeta){if(syncerMeta.user_id.id!==data.session.uid&&syncerMeta.indirect===false){AgileToast.toastTask(syncerMeta.user_id,syncerMeta.data,syncerMeta.method);}}
return true;},boardTaskTypeFilterExists(){return this.board.backlog_task_type_ids&&this.board.backlog_task_type_ids.length>0;},isBoardAllowedTaskType(type_id){return this.boardTaskTypeFilterExists()?this.board.backlog_task_type_ids.includes(type_id):true;},addTask(id,syncerMeta){$.when(task_service.getRecord(id)).then((task)=>{if(!this.project_ids.includes(task.project_id[0])){return;}
if(!this.isBoardAllowedTaskType(task.type_id[0])){return;}
const taskWidget=this.isTaskInBacklog(task)?this.backlogTaskList.addItem(task):this.addTaskToNonBacklogList(task);if(!taskWidget){return;}
this.taskWidgetItemMap.has(task.id)||this.taskWidgetItemMap.set(task.id,taskWidget);if(syncerMeta){if(syncerMeta.user_id.id!==data.session.uid&&syncerMeta.indirect===false){AgileToast.toastTask(syncerMeta.user_id,task,syncerMeta.method);}}});},setupProjectIds(){return data.cache.get("current_user").then((user)=>{const hashProjectId=parseInt(hash_service.get("project"),10);if(typeof hash_service.get("project")!=="undefined"&&isNaN(hashProjectId)){throw new Error("Project id in URL must be a number");}
this.project_ids=[hashProjectId];return data.cache.get("projects_in_board",{'id':this.board_id,team_id:user.team_id[0]}).then((projectMap)=>{if(hashProjectId&&projectMap.has(hashProjectId)){return;}else if(hashProjectId){hash_service.delete("project");}
const project_ids=[];for(const project of projectMap){project_ids.push(project[0]);}
this.project_ids=project_ids;});});},prepareShortcuts(list_id){throw new Error("You should either implement this method or disable shortcuts by setting shouldRenderDragShortcuts to false");},renderDragShortcuts(shortcutPlace,shortcuts,sourceList){this.shortcutContainer=$(`<div class="shortcut-container"></div>`);for(const shortcut of shortcuts){if(shortcut.positioner){const positionerNode=$(`<div class="shortcut-positioner"/>`);this.renderDragShortcutNode(shortcut,sourceList,TOP).appendTo(positionerNode);const positionerNodeName=$(`<div class="shortcut-positioner-name">${shortcut.name}</div>`);positionerNodeName.appendTo(positionerNode);this.renderDragShortcutNode(shortcut,sourceList,BOTTOM).appendTo(positionerNode);positionerNode.appendTo(this.shortcutContainer);}else{const shortcutNode=this.renderDragShortcutNode(shortcut,sourceList);shortcutNode.appendTo(this.shortcutContainer);}}
shortcutPlace.append(this.shortcutContainer);},renderDragShortcutNode(shortcut,sourceList,position){const name=position||shortcut.name;const positionData=position?`data-shortcut-position="${position}"`:"";const shortcutNode=$(`<div class="shortcut-item agile-main-color lighten-5"${positionData}data-shortcut-id="${shortcut.id}">${name}</div>`);shortcutNode[0].addEventListener("dragenter",(evt)=>{$(evt.target).addClass("hover");},false);shortcutNode[0].addEventListener("dragleave",(evt)=>{$(evt.target).removeClass("hover");},false);Sortable.create(shortcutNode[0],{group:"backlog",onAdd:function(evt){if(position){if(position===TOP){sourceList.moveToTop(evt);}else if(position===BOTTOM){sourceList.moveToBottom(evt);}}else{this.dragShortcutCallback(evt.item,sourceList,shortcut);}}.bind(this)});return shortcutNode;},dragShortcutCallback(item,sourceList,shortcut){const taskId=parseInt(item.dataset.id,10);const itemWidget=this.taskWidgetItemMap.get(taskId);const newListWidget=sourceList._getNewListWidget(shortcut.id);const newPosition=shortcut.id?newListWidget.list.size:0;itemWidget.set_list(newListWidget,sourceList.getNewOrder(0,newPosition,shortcut.id,false));},_onProjectTaskWrite(id,vals,payload,record){const editPromise=record&&record._edit("check")?record._edit():$.when();editPromise.then(()=>{this.removeTask(id,true);this.addTask(id,payload);if(this.rightSideWidget&&this.rightSideWidget.id===id){this.trigger("open_right_side",{data:{WidgetClass:TaskWidget,options:{id,isQuickDetailView:true}}});}});},_onProjectTaskCreate(id,vals,payload){this.addTask(id,payload);},_onProjectTaskUnlink(id,payload){this.removeTask(id,true,payload);if(this.rightSideWidget&&this.rightSideWidget.id===id){this.rightSideWidget.destroy(true);delete this.rightSideWidget;}},_onDragStart(evt){if(this.shouldRenderDragShortcuts){const shortcutPlace=this.$("#backlog-view");const shortcuts=this.prepareShortcuts(evt.target.$el.data("id"));this.renderDragShortcuts(shortcutPlace,shortcuts,evt.target);}},_onDragEnd(evt){this.shortcutContainer&&this.shortcutContainer.remove();if(!evt.data.sortableEvent.target||evt.data.sortableEvent.target.classList.contains("shortcut-item")){evt.data.sortableEvent.preventDefault();}},_onBacklogListChanged(evt){this.backlogNode.find(".task-count").text((evt.data.size||0)+" of "+evt.data.total+" "+pluralize("issue",evt.data.total));Waypoint.refreshAll();},_onOpenLinkModal(evt){if(!evt.data.id){throw new Error("Event payload must contain id of task for wich link should be created");}
task_service.getRecord(evt.data.id).then((record)=>{if(!record){throw new Error("Task doens't exist");}
const modal=new AgileModals.LinkItemModal(this,{task:record,task_ids:[...this.allTaskIds()],});modal.appendTo($("body"));});},_onOpenNewItemModal(evt){const options={projects:this.projects};Object.assign(options,evt.data);const newItemModal=new AgileModals.NewItemModal(this,options);newItemModal.appendTo($("body"));},_onLoadingMoreItemsStarted(){this.loadingMoreItems=true;this.$(".list-preloader").show();},_onLoadingMoreItemsFinished(){this.loadingMoreItems=false;if(this.backlogTaskList.shouldLoadMore()&&this.$(".master-list").height()/this.$el.height()<1.1){this.backlogTaskList.loadMoreItems();}else{this.$(".list-preloader").hide();}},_onAddNewItemClick(){const defaults={project:this.projects.find((p)=>p.id===hash_service.get("project"))};this.trigger_up("open_new_item_modal",{currentProjectId:parseInt(hash_service.get("project"),10)||null,focus:"name",defaults,beforeHook:this.setNewTaskOrder.bind(this),});}});return{AbstractBacklogView,BacklogList,SimpleBacklogTaskItem,NonBacklogList};});;

/* /scrummer/static/src/js/views/kanban_table.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.view.kanban_table',function(require){"use strict";const ScrummerData=require('scrummer.data');const core=require('scrummer.core');const BaseWidgets=require('scrummer.BaseWidgets');const TaskWidget=require('scrummer.widget.task').TaskWidget;const AgileModals=require('scrummer.widget.modal');const storage_service=require('scrummer.storage_service');const hash_service=require('scrummer.hash_service');require('sortable');const pluralize=require('pluralize');const DataServiceFactory=require('scrummer.data_service_factory');const task_service=DataServiceFactory.get("project.task",false);const AgileToast=require('scrummer.toast');const dialog=require('scrummer.dialog');const mixins=require('scrummer.mixins');const web_core=require('web.core');const qweb=web_core.qweb;const _t=web_core._t;const INDEX_NOT_FOUND=-1;function getFieldId(record,field){return Array.isArray(record[field])?record[field][0]:record[field];}
function getFieldName(record,field){return Array.isArray(record[field])?record[field][1]:record[field];}
class SwimlaneDefinition{constructor(kanbanTable,field=null,text,undefinedHeaderName=_t("Undefined"),headerTemplate="scrummer.kanban_table.swimlane.header.simple"){this.kanbanTable=kanbanTable;this.field=field;this.text=text;this.undefinedHeaderName=undefinedHeaderName;this.headerTemplate=headerTemplate;this.swimlaneNoHeaderTemplate="scrummer.kanban_table.swimlane";this.swimlaneTemplate="scrummer.kanban_table.swimlane.collapsible";this.columnTemplate="scrummer.kanban_table.column";}
mapper(card){if(this.field){return getFieldId(card,this.field);}
return null;}
compare(x,y){return x===null||x===false?1:y===null||y===false?-1:x-y;}
header(card){function pluralizedCount(){const count=this.recordCount();return count+" "+pluralize('issue',count);}
if(this.field===null){return null;}else if(!card[this.field]){return{headerData:{name:this.undefinedHeaderName},pluralizedCount};}
return{headerData:{name:getFieldName(card,this.field)},pluralizedCount};}
filter(card){return true;}
begin(){return this;}
resolve(){return this;}}
class AsyncSwimlaneDefinition extends SwimlaneDefinition{mapper(card){if(this.state!=="in_transaction"){throw new Error("SwimlaneDefinition mapper called without call to begin method");}}
filter(card){if(this.state!=="in_transaction"){throw new Error("SwimlaneDefinition filter called without call to begin method");}
return super.filter(card);}
begin(){this.state="in_transaction";return this;}
resolve(){this.state="resolved";return this;}}
class StorySwimlaneDefinition extends AsyncSwimlaneDefinition{constructor(kanbanTable){super(kanbanTable,'story',_t("User Story"),_t("Other issues"),"scrummer.kanban_table.swimlane.header.story");}
begin(){super.begin();this.parent_ids=[];this.parentDeferredMap={};return this;}
_getParentPromise(id){if(!this.parentDeferredMap[id]){this.parentDeferredMap[id]=new $.Deferred();}
this.parent_ids.includes(id)||this.parent_ids.push(id);return this.parentDeferredMap[id].promise();}
mapper(task){super.mapper(task);if(!task.parent_id){return null;}
const parentPromise=this._getParentPromise(task.parent_id[0]);return parentPromise.then((parentTask)=>{return parentTask.is_user_story?parentTask.id:null;});}
filter(task){return Boolean(!(task.is_user_story&&task.child_ids.find((t)=>this.kanbanTable.data.ids.includes(t))));}
header(task){if(!task.parent_id){const header=super.header(task);header.headerData.name=this.undefinedHeaderName;header._overrideTemplate="scrummer.kanban_table.swimlane.header.simple";return header;}
return this._getParentPromise(task.parent_id[0]).then((parentTask)=>({task:parentTask,count(){const count=this.recordCount();return count+" "+pluralize('sub-task',count);},afterRender:(element)=>{element.find(".task-key").click(()=>{this.kanbanTable.trigger_up("open_task",{id:parentTask.id});});}}));}
resolve(){super.resolve();this.kanbanTable.loadRecords(this.parent_ids).then((records)=>{for(const record of records){this.parentDeferredMap[record.id].resolve(record);}});return this;}}
const AbstractCard=BaseWidgets.AgileBaseWidget.extend(mixins.MenuItemsMixin,{_name:"AbstractCard",template:"scrummer.kanban_table.card",customCardTitle:null,customCardFooter:null,init(parent,options){Object.assign(this,options);this._super(parent,options);this._require_obj("record",["id"]);mixins.MenuItemsMixin.init.call(this);},renderElement(){this._super();this.customCardTitle&&this.$(".card-title").append(qweb.render(this.customCardTitle,{widget:this}));this.customCardFooter&&this.$(".footer-content").append(qweb.render(this.customCardFooter,{widget:this}));},start(){mixins.MenuItemsMixin.start.call(this);this._is_added_to_DOM.then(()=>{this.$('.dropdown-button').dropdown();this.$('.tooltipped').tooltip();});return this._super();},image_url(){return false;},image_tooltip(){return false;},index(){return this.$el.index();}});const TaskCard=AbstractCard.extend({menuItems:[{class:"assign-to-me",icon:"mdi-account-check",text:_t("Assign To Me"),callback:'_onAssignToMeClick',sequence:1,hidden(){return this.record.user_id&&this.record.user_id[0]===ScrummerData.session.uid;}},{class:"unassign",icon:"mdi-account-minus",text:_t("Unassign"),callback:'_onUnassignClick',sequence:2,hidden(){return!(this.record.user_id&&this.record.user_id[0]===ScrummerData.session.uid);}},{class:"edit-item",icon:"mdi-pencil",text:_t("Edit"),callback:'_onEditItemClick',sequence:3,},{class:"add-sub-item",icon:"mdi-subdirectory-arrow-right",text:_t("Add Sub Item"),callback:'_onAddSubItemClick',sequence:4,hidden(){return!this.task_type.allow_sub_tasks;},},{class:"add-link",icon:"mdi-link",text:_t("Add Link"),callback:'_onAddLinkClick',sequence:5,},{class:"work-log",icon:"mdi-worker",text:_t("Log Work"),callback:'_onWorkLogClick',sequence:6,},{class:"add-comment",icon:"mdi-comment-account",text:_t("Add Comment"),callback:'_onAddCommentClick',sequence:7,},{class:"delete",icon:"mdi-delete",text:_t("Delete"),callback:'_onDelete',sequence:8,},],customCardTitle:"scrummer.kanban_table.card.task.title",customCardFooter:"scrummer.kanban_table.card.task.footer",init(parent,options){this._super(parent,options);this.task=this.record;},willStart(){return this._super().then(()=>$.when(ScrummerData.cache.get("current_user").then((user)=>ScrummerData.cache.get("team_members",{teamId:user.team_id[0]})).then((members)=>{this.user=members.find((e)=>this.task.user_id&&e.id===this.task.user_id[0]);}),DataServiceFactory.get("project.task.type2").getRecord(this.task.type_id[0]).then((task_type)=>{this.task_type=task_type;})));},start(){this.$(".task-key").unbind("click");this.$(".task-key").click(()=>{this.trigger_up("open_task",{id:this.task.id});});return this._super();},image_url(){return this.user?ScrummerData.getImage("res.users",this.user.id,this.user.write_date):"/scrummer/static/img/unassigned.png";},image_tooltip(){return this.user?this.user.name:_t("Unassigned");},_onWorkLogClick(){const modal=new AgileModals.WorkLogModal(this.getParent(),{task:this.task,userId:ScrummerData.session.uid});modal.appendTo($("body"));},_onAddLinkClick(){const modal=new AgileModals.LinkItemModal(this.getParent(),{task:this.task,});modal.appendTo($("body"));},_onAddCommentClick(){const modal=new AgileModals.CommentItemModal(this.getParent(),{task:this.task,});modal.appendTo($("body"));},_onAddSubItemClick(){const newItemModal=new AgileModals.NewItemModal(this.getParent(),{currentProjectId:this.task.project_id[0],parent_id:this.task.id,});newItemModal.appendTo($("body"));},_onEditItemClick(){const newItemModal=new AgileModals.NewItemModal(this.getParent(),{currentProjectId:this.task.project_id[0],edit:this.task,});newItemModal.appendTo($("body"));},_onAssignToMeClick(){this.task.user_id=ScrummerData.session.uid;},_onUnassignClick(){this.task.user_id=false;},_onDelete(){dialog.confirm(_t("Delete task"),_t("Are you sure you want to delete this task?"),_t("yes")).done(()=>{this.task.unlink();});},});const AbstractKanbanTable=BaseWidgets.AgileBaseWidget.extend({_name:"KanbanTable",template:"scrummer.kanban_table",kanbanTableOptionsID:null,init(parent,options){Object.assign(this,options);this._super(parent,options);this.swimlanes=this.initSwimlaneDefinitions();this._require_prop("swimlanes","This property specifies fields used to group cards in swimlanes. "+"Fields are stored in ES6 Map."+"Key is field name, value is instance of SwimlaneDefinition ES6 class");this._require_prop("dataService","An instance of implementation of DataService from scrummer.DataService module.");this._require_prop("stageField","This property tells table what is the field of card model that workflow is wrapped around.");this._require_prop("kanbanTableOptionsID","This property is used to identify key of options object in local storage");this._require_obj("data",['board','workflow','ids'],"Check code comments for propper format of data");this._require_obj("Card",["Card"],"Card object with Card property must point to concrete implementation of AbstractCard class.");this.records=[];this.cardWidgetsMap=new Map();this.kanbanOptions=storage_service.get("kto"+this.kanbanTableOptionsID)||{};this.swimlane=this.swimlane||this.kanbanOptions.swimlane||null;},initSwimlaneDefinitions(){return new Map([[null,new SwimlaneDefinition(this,null,_t("No swimlanes"))],]);},willStart(){return $.when(ScrummerData.cache.get("current_user"),this._super.apply(arguments),this.loadRecords(this.data.ids)).then((user)=>{this.current_user=user;this.loadData();return this.prepareSwimlaneData();});},loadRecords(ids){return this.dataService.getRecords(ids).then((records)=>{this.records.push.apply(this.records,records);return records;});},loadRecord(id){return this.dataService.getRecord(id).then((record)=>{this.records.push(record);return record;});},loadData(){const columns_map=this.data.board.columns;this.data.sorted_columns=Object.keys(columns_map).map((key)=>columns_map[key]).sort((a,b)=>a.order-b.order);this.states={};this.data.board.stateToStatus={};this.data.workflow.global_states={in:[],out:[]};for(const status_id in this.data.board.status){const status=this.data.board.status[status_id];const state=this.data.workflow.states[status.state_id];const column=this.data.sorted_columns.find((col)=>status.column_id===col.id);state.global_in&&this.data.workflow.global_states.in.push(state);state.global_out&&this.data.workflow.global_states.out.push(state);this.data.board.stateToStatus[state.id]=status;(column.status=column.status||[]).push(status);this.states[state.id]=state;}},renderElement(){this._super();this.$(".column-headers").append(this.renderHeaders());this.renderSwimlanes(this.$(".swimlanes"));},prepareSwimlaneData(){const swimlaneDefinition=this.swimlanes.get(this.swimlane).begin();this.data.swimlanes=new Map();const promises=[];function recordCount(){return this.records.length;}
for(const record_id of this.data.ids){const record=this.records.find((r)=>r.id===record_id);promises.push($.when(swimlaneDefinition.mapper(record),swimlaneDefinition.filter(record)).then((group,passIt)=>{if(passIt){if(this.data.swimlanes.has(group)){this.data.swimlanes.get(group).records.push(record);}else{const swimlaneData={records:[record]};this.data.swimlanes.set(group,swimlaneData);return $.when(swimlaneDefinition.header(record)).then((header)=>{if(header){header.recordCount=recordCount.bind(swimlaneData);}
swimlaneData.header=header;});}}}));}
swimlaneDefinition.resolve();return $.when(...promises);},getActiveSwimlane(){return this.swimlanes.get(this.swimlane);},renderHeaders(){const result=[];for(const column of this.data.sorted_columns){result.push(`<li class="column"data-id="${column.id}">${column.name}</li>`);}
return result;},renderSwimlanes(placeholder){const result=[];if(this.data.swimlanes.size<1){return;}else if(this.data.swimlanes.size===1&&[...this.data.swimlanes.keys()][0]===null){this.data.swimlanes.forEach((data,id)=>{result.push(this.renderSwimlane(data,id,false,placeholder));});}else{const swimlaneDefinition=this.swimlanes.get(this.swimlane);const sortedSwimlanes=[...this.data.swimlanes.keys()].sort(swimlaneDefinition.compare);sortedSwimlanes.forEach((id)=>{const data=this.data.swimlanes.get(id);result.push(this.renderSwimlane(data,id,true,placeholder));});}
return result;},renderSwimlane(data,id,renderHeader=true,placeholder){let node=null;const swimlaneDefinition=this.swimlanes.get(this.swimlane);if(renderHeader){node=$(qweb.render(swimlaneDefinition.swimlaneTemplate).trim());const headerTemplate=data.header._overrideTemplate||swimlaneDefinition.headerTemplate;const header=$(qweb.render(headerTemplate,data.header).trim());node.find(".collapsible-header").append(header);if(typeof data.header.afterRender==="function"){data.header.afterRender(header);}}else{node=$(qweb.render(swimlaneDefinition.swimlaneNoHeaderTemplate).trim());}
node.attr("data-swimlane-id",id);placeholder.append(node);const recordsByStageFieldId=new Map();data.records.forEach((record)=>{const recordStageFieldId=this.getStageFieldId(record);recordsByStageFieldId.has(recordStageFieldId)?recordsByStageFieldId.get(recordStageFieldId).push(record):recordsByStageFieldId.set(recordStageFieldId,[record]);});for(const column of this.data.sorted_columns){const column_cards=[];recordsByStageFieldId.forEach((records,stageFieldId)=>{if(column.status&&column.status.some((e)=>this.data.workflow.states[e.state_id].stage_id===stageFieldId)){column_cards.push(...records);}});this.renderColumn(column,column_cards,node.find(".columns"));}
return node;},renderColumn(column,records,placeholder){const swimlaneDefinition=this.swimlanes.get(this.swimlane);const node=$(qweb.render(swimlaneDefinition.columnTemplate,column));placeholder.append(node);const sorted_records=records.sort((a,b)=>a.agile_order-b.agile_order);for(const record of sorted_records){const cardWidget=this.renderCard(record);cardWidget.appendTo(node).then(()=>{cardWidget.start();});}
const tableThis=this;node.sortable({start:function(evt,data){const cardNode=$(data.helper);const swimlaneId=cardNode.getDataFromAncestor("swimlane-id",".swimlane");const columnId=cardNode.getDataFromAncestor("column-id");const cardId=cardNode.getDataFromAncestor("card-id");this.swimlaneNode=swimlaneId===null?tableThis.$(`.swimlane:not([data-swimlane-id])`):tableThis.$(`.swimlane[data-swimlane-id=${swimlaneId}]`);let preventStopEvent=this.preventStopEvent;for(let columnNode of $.makeArray(this.swimlaneNode.find(`.column:not([data-column-id=${columnId}])`))){columnNode=$(columnNode);const columnNodeId=columnNode.data("column-id");const columnOverlay=tableThis.generateOverlay(columnNodeId,cardId);columnOverlay.find(".state").on("drop",(event,ui)=>{const droppedCardNode=$(ui.helper);const droppedCardId=droppedCardNode.data("card-id");const targetDataset=event.target.dataset;const newState=tableThis.data.workflow.states[targetDataset.stateId];const newStatus=tableThis.data.board.stateToStatus[newState.id];const isTransitionGlobal=targetDataset.transitionId==="global";const transition=tableThis.data.workflow.transitions[targetDataset.transitionId];const cardWidget=tableThis.cardWidgetsMap.get(droppedCardId);const stage_id=parseInt(newState.stage_id,10);if(!isTransitionGlobal&&transition.user_confirmation){tableThis.openStageChangeModal(newState.stage_id,cardWidget);}else{cardWidget.record[tableThis.stageField]=stage_id;}
preventStopEvent=true;});columnOverlay.prependTo(columnNode);}},stop:function(event,ui){this.swimlaneNode.find(".column-overlay").remove();if(this.preventStopEvent){delete this.preventStopEvent;return;}}});return node;},renderCard(record){if(this.cardWidgetsMap.has(record.id)){return this.cardWidgetsMap.get(record.id);}
const cardWidget=new this.Card.Card(this,{record});this.cardWidgetsMap.set(record.id,cardWidget);return cardWidget;},getStageFieldId(record){return getFieldId(record,this.stageField);},getStageFieldName(record){return getFieldName(record,this.stageField);},getWorkflowState(stageFieldId,workflow_id){for(const state_id in this.data.workflow.states){const state=this.data.workflow.states[state_id];if(state.workflow_id===workflow_id&&state[this.stageField]===stageFieldId){return state;}}},getColumnFromStageField(stageFieldId){for(const column of this.data.sorted_columns){for(const status of column.status){if(this.data.workflow.states[status.state_id].stage_id===stageFieldId){return column;}}}},generateOverlay:function(columnId,recordId){const record=this.records.find((r)=>r.id===recordId);const stageFieldId=this.getStageFieldId(record);const currentState=this.getWorkflowState(stageFieldId,record.workflow_id[0]);const availableTransitions=this.getAvailableTransitions(currentState,this.data.workflow,record);const overlay=$(`<div class="column-overlay"data-column-id="${columnId}"></div>`);if(this.data.board.columns[columnId].status){for(const status of this.data.board.columns[columnId].status){const state=this.data.workflow.states[status.state_id];const transition=availableTransitions.find((t)=>t.dst===state.id);if(transition){const stateNode=$(`<div class="state agile-main-color lighten-5"data-state-id="${state.id}"data-transition-id="${transition.id}">${state.name}</div>`);stateNode.droppable({classes:{"ui-droppable-hover":"hover"},});stateNode.appendTo(overlay);}}}
return overlay;},getAvailableTransitions(currentState,workflow){const transitions=currentState.out_transitions.map((t_id)=>workflow.transitions[t_id]);if(currentState.global_out){for(const state_id in workflow.states){const state=workflow.states[state_id];if(state.id!==currentState.id&&state.workflow_id===currentState.workflow_id){transitions.push(this.generateFakeTransition(workflow,currentState,state));}}}else{workflow.global_states.in.filter((state)=>state.id!==currentState.id&&state.workflow_id===currentState.workflow_id).forEach((state)=>{transitions.push(this.generateFakeTransition(workflow,currentState,state));});}
return transitions;},generateFakeTransition(workflow,src,dst){return{description:"",dst:dst.id,id:"global",name:dst.name,src:src.id,user_confirmation:false,workflow_id:workflow.id};},openStageChangeModal(newStageId,cardWidget,confirmedCallback){const state=this.getWorkflowState(newStageId,cardWidget.record.workflow_id[0]);const modal=new AgileModals.TaskStageConfirmationModal(this,{taskId:cardWidget.record.id,stageId:newStageId,stageName:state.name,userName:cardWidget.record.user_id?cardWidget.record.user_id[1]:_t("Unassigned"),afterHook:(result)=>{typeof confirmedCallback==="function"&&confirmedCallback(result);}});modal.appendTo($("body"));},getCard(id){return this.cardWidgetsMap.get(id);},addCard(id,syncerMeta,highlight=true){return this._doAddCard(id,syncerMeta,highlight,INDEX_NOT_FOUND);},insertCardAt(id,index,syncerMeta,highlight=true){return this._doAddCard(id,syncerMeta,highlight,index);},shouldCardBeAdded(record){return true;},_doAddCard(id,syncerMeta,highlight,index){return this.dataService.getRecord(id).then((record)=>{if(record&&this.shouldCardBeAdded(record)){const swimlaneDefinition=this.swimlanes.get(this.swimlane).begin();const def=$.when(swimlaneDefinition.mapper(record),swimlaneDefinition.filter(record)).then((group,passIt)=>{if(passIt){if(this.data.swimlanes.has(group)){this.data.swimlanes.get(group).records.push(record);const column=this.getColumnFromStageField(this.getStageFieldId(record));if(!column){return;}
const node=group===null?this.$(`.swimlane:not([data-swimlane-id])${" "}div[data-column-id="${column.id}"]`):this.$(`.swimlane[data-swimlane-id=${group}]${" "}div[data-column-id="${column.id}"]`);const cardWidget=this.renderCard(record);if(index>INDEX_NOT_FOUND){cardWidget.insertAt(node,index).then(()=>{cardWidget.start();});}else{cardWidget.appendTo(node).then(()=>{cardWidget.start();});}
const swimlaneNode=group===null?this.$('.swimlane:not([data-swimlane-id])'):this.$(`.swimlane[data-swimlane-id=${group}]`);const count=this.data.swimlanes.get(group).records.length;swimlaneNode.find(".swimlane-header .count").text(count+" "+pluralize('issue',count));if(syncerMeta.indirect===false){cardWidget._is_added_to_DOM.then(()=>{node.scrollToElement(cardWidget.$el);highlight&&cardWidget.$el.highlight();});}}else{const swimlaneData={records:[record]};this.data.swimlanes.set(group,swimlaneData);const recordCount=function(){return this.records.length;};return $.when(swimlaneDefinition.header(record)).then((header)=>{if(header){header.recordCount=recordCount.bind(swimlaneData);}
swimlaneData.header=header;const lastSwimlane=this.$(".swimlane").last();const newSwimlaneNode=this.renderSwimlane(swimlaneData,group,Boolean(header),lastSwimlane);if(this.$(".swimlane").length===0){this.$(".swimlanes").append(newSwimlaneNode);}else if(lastSwimlane.data("swimlane-id")){const sortedSwimlanes=[...this.data.swimlanes.keys()].sort(swimlaneDefinition.compare);const i=sortedSwimlanes.indexOf(group);this.$(".swimlanes").insertAt(newSwimlaneNode,i);}else{newSwimlaneNode.insertBefore(lastSwimlane);}
newSwimlaneNode.find('.collapsible').collapsible();});}
if(syncerMeta){if(syncerMeta.user_id.id!==ScrummerData.session.uid&&syncerMeta.indirect===false){AgileToast.toastTask(syncerMeta.user_id,record,syncerMeta.method);}}}});swimlaneDefinition.resolve();return def;}});},removeCard(id,removeFromCache=false,syncerMeta){const cardWidget=this.cardWidgetsMap.get(id);if(!cardWidget){return false;}
if(removeFromCache){const swimlaneDefinition=this.swimlanes.get(this.swimlane).begin();const previousMapped=cardWidget.record._previous?swimlaneDefinition.mapper(cardWidget.record._previous):null;$.when(previousMapped,swimlaneDefinition.mapper(cardWidget.record),swimlaneDefinition.filter(cardWidget.record)).then((previousGroup,group,passIt)=>{if(previousGroup!==null){const swimlaneData=this.data.swimlanes.get(previousGroup);swimlaneData.records=swimlaneData.records.filter((e)=>e.id!==cardWidget.record.id);const swimlaneNode=previousGroup===null?this.$('.swimlane:not([data-swimlane-id])'):this.$(`.swimlane[data-swimlane-id=${previousGroup}]`);if(swimlaneData.records.length===0){this.data.swimlanes.delete(previousGroup);swimlaneNode.remove();}else{const count=swimlaneData.records.length;swimlaneNode.find(".swimlane-header .count").text(count+" "+pluralize('issue',count));}}});cardWidget.destroy();this.cardWidgetsMap.delete(id);}else{cardWidget.$el.detach();}
if(syncerMeta){if(syncerMeta.user_id.id!==ScrummerData.session.uid&&syncerMeta.indirect===false){AgileToast.toastTask(syncerMeta.user_id,syncerMeta.data,syncerMeta.method);}}},getCardState(id){throw new Error("Not implemented");},resolveCardIndex(card,delta){return INDEX_NOT_FOUND;},setSwimlane(name,store=true){this.kanbanOptions.swimlane=name;store&&storage_service.set("kto"+this.kanbanTableOptionsID,this.kanbanOptions);this.prepareSwimlaneData().then(()=>{this.$(".swimlanes").empty();this.renderSwimlanes(this.$(".swimlanes"));this.$('.collapsible').collapsible();});},addedToDOM(){this.$('.collapsible').collapsible();}});const TaskTable=AbstractKanbanTable.extend({Card:{Card:TaskCard},dataService:task_service,stageField:"stage_id",init(parent,options){this._super(parent,options);if(!Array.isArray(this.data.board.task_types)){throw new Error("TaskTable requires board to define task_type as Array");}},initSwimlaneDefinitions(){const defs=this._super();defs.set('user_id',new SwimlaneDefinition(this,'user_id',_t("Assignee"),_t("Unassigned")));defs.set('priority_id',new SwimlaneDefinition(this,'priority_id',_t("Priority"),_t("Without priority")));defs.set('project_id',new SwimlaneDefinition(this,'project_id',_t("Project"),_t("Without project")));defs.set('epic_id',new SwimlaneDefinition(this,'epic_id',_t("Epic"),_t("Without epic")));defs.set('story',new StorySwimlaneDefinition(this));return defs;},loadData(){this._super();this.board_project_ids=Object.keys(this.data.board.projects).map((k)=>parseInt(k,10));},getCardState(id){return this.cardWidgetsMap.get(id).task.wkf_state_id;},shouldCardBeAdded(task){const team_project_ids=this.current_user.team_ids[this.current_user.team_id[0]].project_ids;const hash_project_id=parseInt(hash_service.get("project"),10);const task_project_id=task.project_id[0];if(hash_project_id&&task_project_id!==hash_project_id){return false;}
if(!team_project_ids.includes(task_project_id)){return false;}
if(!this.board_project_ids.includes(task_project_id)){return false;}
if(this.data.board.task_types.length&&!this.data.board.task_types.includes(task.type_id[0])){return false;}
return true;},resolveCardIndex(id,delta){const card=this.cardWidgetsMap.get(id);if(!card){return INDEX_NOT_FOUND;}
const swimlane=this.getActiveSwimlane();const swimlane_field=swimlane.field===null?false:swimlane.field==='story'?'parent_id':swimlane.field;const isUpdated=function(fieldName){if(!(fieldName in delta)){return false;}
const left=getFieldId(delta[fieldName]);const right=fieldName in card.record._previous?getFieldId(card.record._previous[fieldName]):false;return left!==right;};const isUpdatedStageField=function(){return isUpdated(this.stageField);}.bind(this);if(swimlane_field===null){return isUpdatedStageField();}
if(isUpdated(swimlane.field)){return INDEX_NOT_FOUND;}
if(isUpdatedStageField()){return INDEX_NOT_FOUND;}
return card.index();},});const AbstractKanbanTableView=BaseWidgets.AgileViewWidget.extend({_name:"KanbanTableView",template:"scrummer.view.kanban_table",emptyTitle:_t("No data in kanban table"),emptyTemplate:"scrummer.view.kanban_table.empty",init(parent,options){Object.assign(this,options);this._super(parent,options);this._require_obj("KanbanTable",["KanbanTable"],"KanbanTable object with KanbanTable property must point to concrete implementation of AbstractKanbanTable class.");},openSettings(){if(this.kanbanTable.swimlane){this.$("#modal-settings select").val(this.kanbanTable.swimlane).material_select();}
const modalNode=this.$("#modal-settings");modalNode.materialModal("open");},destroy(){this._super();if($(".lean-overlay").size()){$(".lean-overlay").remove();}},isEmpty(){throw new Error("Not implemented");},getTitle(){console.warn("This should be overridden in concrete implementation");return _t("Kanban table");},willStart(){return $.when(this._super(),ScrummerData.cache.get("current_user").then((user)=>{this.user=user;}));},renderElement(){if(this.isEmpty()){this.setTitle(this.emptyTitle);}else{this.title=this.getTitle();}
this._super();if(!this.isEmpty()){this.kanbanTable=new this.KanbanTable.KanbanTable(this,this.generateKanbanTableOptions());this.$("#kanban-table-view").append(this.renderSettingsModal());this.kanbanTable.appendTo(this.$("#kanban-table-view"));this.setTitle(this.getTitle());this.trigger_up("init_action_menu",this.getActionMenu());}},generateKanbanTableOptions(){return{data:this.data};},renderSettingsModal(){const swimlanes=[];for(const[key,obj]of this.kanbanTable.swimlanes.entries()){swimlanes.push({value:key,text:obj.text});}
return qweb.render("scrummer.view.kanban_table.settings_modal",{swimlanes});},_getSwimlaneOptions(){return this.kanbanTable.swimlanes;},getActionMenu(){return{items:[{icon:"settings",action:this.openSettings.bind(this)}]};},start(){this._is_added_to_DOM.then(()=>{this.$('select').material_select();});const modalNode=this.$("#modal-settings");this.$("#modal-settings .modal-save").click((evt)=>{if(this.kanbanTable.swimlane!==this.$("#modal-settings select :selected").attr("value")){this.kanbanTable.swimlane=this.$("#modal-settings select :selected").attr("value");this.kanbanTable.setSwimlane(this.kanbanTable.swimlane);}
modalNode.materialModal("close");});modalNode.materialModal();return this._super();}});const TaskKanbanTableView=AbstractKanbanTableView.extend({custom_events:Object.assign({},AbstractKanbanTableView.prototype.custom_events,{open_task:"_onOpenTask",}),_onOpenTask:function(evt){this.trigger_up("open_right_side",{WidgetClass:TaskWidget,options:{id:evt.data.id,isQuickDetailView:true}});},addedToDOM(){core.bus.on("project.task:write",this,this._onProjectTaskWrite);core.bus.on("project.task:create",this,this._onProjectTaskCreate);core.bus.on("project.task:unlink",this,this._onProjectTaskUnlink);return this._super();},_onProjectTaskWrite(id,delta,payload,record){if(!this.kanbanTable){return;}
const editPromise=record&&record._edit("check")?record._edit():$.when();editPromise.then(()=>{const cardIndex=this.kanbanTable.resolveCardIndex(id,delta);this.kanbanTable.removeCard(id,true);return this.kanbanTable.insertCardAt(id,cardIndex,payload).then(()=>{if(this.rightSideWidget&&this.rightSideWidget.id===id){this.trigger("open_right_side",{data:{WidgetClass:TaskWidget,options:{id,isQuickDetailView:true}}});}});});},_onProjectTaskCreate(id,vals,payload){if(!this.kanbanTable){return;}
this.kanbanTable.addCard(id,payload);},_onProjectTaskUnlink(id,payload){if(!this.kanbanTable){return;}
this.kanbanTable.removeCard(id,true,payload);if(this.rightSideWidget&&this.rightSideWidget.id===id){this.rightSideWidget.destroy(true);delete this.rightSideWidget;}},});return{AbstractKanbanTableView,AbstractKanbanTable,AbstractCard,TaskCard,TaskKanbanTableView,TaskTable,SwimlaneDefinition,AsyncSwimlaneDefinition,StorySwimlaneDefinition,};});;

/* /scrummer/static/src/js/views/task.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.view.task',function(require){"use strict";const ScrummerData=require('scrummer.data');const DataServiceFactory=require('scrummer.data_service_factory');const BaseWidgets=require('scrummer.BaseWidgets');const hash_service=require('scrummer.hash_service');const TaskWidget=require('scrummer.widget.task').TaskWidget;const AgileModals=require('scrummer.widget.modal');const AgileToast=require('scrummer.toast');const core=require('scrummer.core');const web_core=require('web.core');const qweb=web_core.qweb;const _t=web_core._t;const dialog=require('scrummer.dialog');const WorkflowTransitionsWidget=BaseWidgets.AgileBaseWidget.extend({id:"workflow-transition-widget",init(parent,options){Object.assign(this,options);this._super(parent,options);this._require_obj("taskWidget");this.workflowId=this.taskWidget._model.workflow_id[0];this.taskStageId=this.taskWidget._model.stage_id[0];this.size=this.size||2;},willStart(){return $.when(this._super(),ScrummerData.cache.get("project.workflow",{id:this.workflowId}).then((workflow)=>{this.workflow=workflow;}),ScrummerData.cache.get("current_user").then((user)=>{this.current_user=user;}));},renderElement(){this._super();this.setCurrentStage();},setSize(size){this.size=size;this.setCurrentStage();},setCurrentStage(stageId){if(stageId){this.taskStageId=stageId;}
this.outTransitions=this.getAllowedTransitions();this.renderButtons();},getAllowedTransitions(){return this.workflow.states[this.workflow.stageToState[this.taskStageId]].out_transitions.map((transitionId)=>this.workflow.transitions[transitionId]);},renderButtons(){this.$el.empty();if(this.outTransitions.length>this.size+1){for(let i=0;i<this.size;i++){this.$el.append(this.generateButton(this.outTransitions[i]));}
const overflow=this.outTransitions.slice(this.size);this.$el.append(this.generateOverflow(overflow));this.$('.dropdown-button').dropdown();}else{this.outTransitions.forEach((trId)=>{this.$el.append(this.generateButton(trId));});}},generateButton(transition,overflow){const newState=this.workflow.states[transition.dst];const button=overflow?this.renderOverflowElement(transition.name):this.renderButton(transition.name);button.click(()=>{if(transition.user_confirmation){this.openStageChangeModal(newState.stage_id,newState.name,this.taskWidget,()=>{this.updateStage(newState);});return;}
this.taskWidget._model.stage_id=newState.stage_id;this.updateStage(newState);});return button;},generateOverflow(overflow){const wrapper=$("<div style='display: inline-block;'/>");wrapper.append($("<a class='dropdown-button btn' data-activates='workflow-transition-widget-overflow'>...<i class='mdi mdi-chevron-down'/></a>"));const list=$("<ul id='workflow-transition-widget-overflow' class='dropdown-content'>");wrapper.append(list);overflow.forEach((trId)=>{const elem=$("<li/>");elem.append(this.generateButton(trId,true));list.append(elem);});return wrapper;},renderButton(text){return $("<a class='waves-effect waves-light btn'>"+text+"</a>");},renderOverflowElement(text){return $("<a class='waves-effect waves-light'>"+text+"</a>");},updateStage(state){this.setCurrentStage(state.stage_id);},openStageChangeModal(newStageId,newStateName,taskWidget){let userName=false;if(taskWidget._model.user_id){if(taskWidget._model.user_id instanceof Array){userName=taskWidget._model.user_id[1];}else{userName=taskWidget._model.user_id.name;}}
const modal=new AgileModals.TaskStageConfirmationModal(this,{taskId:taskWidget.id,stageId:newStageId,stageName:newStateName,userName:userName,});modal.appendTo($("body"));},addedToDOM(){this._super();this.$('.dropdown-button').dropdown();},});const TaskView=BaseWidgets.AgileViewWidget.extend({title:"Task View",_name:"TaskView",template:"scrummer.view.task",menuItems:[{class:"assign-to-me",icon:"mdi-account-check",text:_t("Assign To Me"),callback:'_onAssignToMeClick',sequence:1,hidden(){const taskWidget=this.taskWidget;return taskWidget.data_service.getRecord(taskWidget.id).then((task)=>task.user_id&&task.user_id[0]===ScrummerData.session.uid);}},{class:"unassign",icon:"mdi-account-minus",text:_t("Unassign"),callback:'_onUnassignClick',sequence:2,hidden(){const taskWidget=this.taskWidget;return taskWidget.data_service.getRecord(taskWidget.id).then((task)=>!(task.user_id&&task.user_id[0]===ScrummerData.session.uid));},},{class:"edit-item",icon:"mdi-pencil",text:_t("Edit"),callback:'_onEditItemClick',sequence:3,},{class:"add-sub-item",icon:"mdi-subdirectory-arrow-right",text:_t("Add Sub Item"),callback:'_onAddSubItemClick',sequence:4,hidden(){const taskWidget=this.taskWidget;return taskWidget.data_service.getRecord(taskWidget.id).then((task)=>DataServiceFactory.get("project.task.type2").getRecord(task.type_id[0]).then((task_type)=>!task_type.allow_sub_tasks));},},{class:"add-link",icon:"mdi-link",text:_t("Add Link"),callback:'_onAddLinkClick',sequence:5,},{class:"work-log",icon:"mdi-worker",text:_t("Log Work"),callback:'_onWorkLogClick',sequence:6,},{class:"add-comment",icon:"mdi-comment-account",text:_t("Add Comment"),callback:'_onAddCommentClick',sequence:7,},{class:"delete",icon:"mdi-delete",text:_t("Delete task"),callback:'_onDelete',sequence:8,},],init(parent,options){this._super(parent,options);this.taskId=parseInt(hash_service.get("task"),10);if(!this.taskId){throw new Error(_t("Task id must be set in Task view"));}
this.renderTask();hash_service.on("change:task",this,()=>this.loadTask(parseInt(hash_service.get("task"),10)));},renderTask(id,data){if(id){this.taskId=id;}
if(this.taskWidget&&typeof this.taskWidget.destroy==="function"){this.taskWidget.destroy();}
this.taskWidget=new TaskWidget(this,{id:this.taskId,template:"scrummer.view.task_widget",data,highlightNewWidget:this.scrollAndHighlight});this.taskWidget._is_rendered.then(this.afterTaskRender.bind(this));},loadTask(id,data){this.renderTask(id,data);this.taskWidget.appendTo(this.$el);},afterTaskRender(){const title=$(qweb.render("scrummer.view.task.title",{widget:this.taskWidget}));title.find(".task-key").click((e)=>{const taskId=$(e.currentTarget).attr("task-id");hash_service.setHash("task",taskId);hash_service.setHash("view","task");hash_service.setHash("page","board");});this.setTitle(title,this.taskWidget._model.key+" "+this.taskWidget.name);this.taskWidget.$el.responsive();if(this.workflowTaskWidget){this.workflowTaskWidget.destroy();}
window.wtw=this.workflowTaskWidget=new WorkflowTransitionsWidget(this,{taskWidget:this.taskWidget});this.updateMenuVisibility();this.trigger_up("init_action_menu",{items:[{widget:this.workflowTaskWidget}]});},renderElement(){this._super();this.taskWidget.appendTo(this.$el);},scrollAndHighlight(widget){widget._is_added_to_DOM.then(()=>{$("#middle-content").scrollToElement(widget.$el);widget.$el.highlight();});},start(){core.bus.on("project.task:write",this,(id,vals,payload,record)=>{if(id===this.taskId){const editPromise=record._edit("check")?record._edit():$.when();editPromise.then(()=>{this.loadTask(record.id,record);});if(payload){if(payload.user_id.id!==ScrummerData.session.uid&&payload.indirect===false){AgileToast.toastTask(payload.user_id,record,payload.method);}}}});core.bus.on("project.task:unlink",this,(id,payload)=>{});return this._super();},addedToDOM(){this.$('.tooltipped').tooltip();this.$('.collapsible').collapsible();this.$(".message-body").expander({slicePoint:140,expandEffect:"fadeIn",collapseEffect:"fadeOut"});},_onAssignToMeClick(){this.taskWidget._model.user_id=ScrummerData.session.uid;},_onUnassignClick(){this.taskWidget._model.user_id=false;},_onEditItemClick(){const newItemModal=new AgileModals.NewItemModal(this,{currentProjectId:this.taskWidget._model.project_id[0],focus:"name",edit:this.taskWidget._model,});newItemModal.appendTo($("body"));},_onAddSubItemClick(){const newItemModal=new AgileModals.NewItemModal(this,{currentProjectId:this.taskWidget._model.project_id[0],parent_id:this.taskWidget._model.id,});newItemModal.appendTo($("body"));},_onAddLinkClick(){const modal=new AgileModals.LinkItemModal(this,{task:this.taskWidget._model,});modal.appendTo($("body"));},_onWorkLogClick(){const modal=new AgileModals.WorkLogModal(this,{task:this.taskWidget._model,userId:ScrummerData.session.uid,});modal.appendTo($("body"));},_onAddCommentClick(){const modal=new AgileModals.CommentItemModal(this,{task:this.taskWidget._model,});modal.appendTo($("body"));},_onDelete(){dialog.confirm(_t("Delete task"),_t("Are you sure you want to delete this task?"),_t("yes")).done(()=>{this.taskWidget._model.unlink();});},});return{TaskView,WorkflowTransitionsWidget};});;

/* /scrummer/static/src/js/views/pages/dashboard.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.page.dashboard',function(require){"use strict";const ModelList=require('scrummer.model_list');const AbstractModelList=require('scrummer.abstract_model_list');const qweb=require('web.core').qweb;const _t=require('web.core')._t;const AgileBaseWidgets=require('scrummer.BaseWidgets');const hash_service=require('scrummer.hash_service');const SubheaderWidget=require('scrummer.subheader').SubheaderWidget;const data=require('scrummer.data');const pluralize=require('pluralize');const ActivityStream=require('scrummer.activity_stream').ActivityStream;const AssignedToMeMenuItem=ModelList.SimpleTaskItem.extend({start(){this.$(".task-menu").hide();this.$(".task-key").click(()=>{hash_service.setHash("project",this.record.project_id[0]);});return this._super();}});AssignedToMeMenuItem.sort_by="agile_order";const AssignedToMe=AgileBaseWidgets.AgileBaseWidget.extend({_name:"AssignedToMe",template:'scrummer.dashboard.assigned_to_me',init(parent,options){this._super(parent,options);this.estimates={todo:0,in_progress:0,done:0,};this.assignedToMeList=new AbstractModelList.ModelList(this,{template:"scrummer.backlog.task_list",model:"project.task",ModelItem:AssignedToMeMenuItem,emptyPlaceholder:$("<div>"+_t("You havent commited to any task in this team.")+"</div>"),fields:["name","agile_order","story_points","project_id","key","color","priority_id","parent_id","parent_key","type_id","user_id","priority_scrummer_icon_color","priority_scrummer_icon","type_scrummer_icon_color","type_scrummer_icon","wkf_state_type"],domain:$.when(data.xmlidToResId("scrummer.project_task_type_epic"),data.cache.get("current_user")).then((type_epic,user)=>[["user_id","=",data.session.uid],["type_id","!=",type_epic],["project_id","in",user.team_ids[user.team_id[0]].project_ids]]),_name:"Assigned to me",attributes:{"data-id":this.id}});},renderElement(){this._super();this.assignedToMeList.appendTo(this.$el);this.assignedToMeList._is_rendered.then(()=>{const items=this.assignedToMeList.data;this.$(".list-preloader").remove();this.$(".list-count").text(items.length+" "+pluralize('issue',items.length));for(const task of items){this.estimates[task.wkf_state_type]+=task.story_points;}
this.$(".estimates .estimate.todo").html(this.estimates.todo);this.$(".estimates .estimate.in_progress").html(this.estimates.in_progress);this.$(".estimates .estimate.done").html(this.estimates.done);this.$(".estimates").show();});this.assignedToMeList._is_added_to_DOM.then(()=>{this.assignedToMeList.$('.tooltipped').tooltip({delay:50});});}});const ProjectItem=AbstractModelList.AbstractModelListItem.extend({_name:"ProjectItem",template:"scrummer.list.project_item",init(parent,options){this._super(parent,options);},start(){this.$("a.project-key").click(()=>{hash_service.setHash("project",this.record.id,false);hash_service.setHash("page","board",false);});return this._super();},image_url(){return data.getImage("project.project",this.record.id,this.record.__last_update);}});ProjectItem.sort_by="agile_order";const DashboardPage=AgileBaseWidgets.AgileViewWidget.extend({title:_t("Dashboard"),_name:"Dashboard",template:"scrummer.page.dashboard",menuItemsContainer:false,init(parent,options){this._super(parent,options);},start(){const allTasks=$("<a class='list-header-right'>Team backlog</a>");this.$("#project-list").parent().find("div.list-title").append(allTasks);allTasks.click(()=>{hash_service.delete("project");hash_service.setHash("page","board");});this.projectList._is_added_to_DOM.then(()=>{this.$('.list-preloader.projects').remove();});this.trigger_up('menu.removed');},renderElement(){this._super();this.projectList=new AbstractModelList.ModelList(this,{model:"project.project",emptyPlaceholder:$(qweb.render("scrummer.dashboard.project-list.empty",{})),fields:["name","image_key","user_id","key","state","partner_id","todo_estimation","in_progress_estimation","done_estimation","__last_update"],domain:$.when(data.cache.get("current_user")).then((user)=>[["id","in",user.team_ids[user.team_id[0]].project_ids],["workflow_id","!=",false]]),ModelItem:ProjectItem});this.projectList.appendTo(this.$("#project-list"));this.assignedToMeList=new AssignedToMe(this);this.assignedToMeList.appendTo(this.$("#assigned-to-me"));this.activityStream=new ActivityStream(this,{showMessageName:true,withShadow:true,listTitle:_t("Activity Stream"),});this.activityStream.appendTo(this.$("#activity-stream"));this.subheader=new SubheaderWidget(this);this.subheader.appendTo(this.$("#subheader-wrapper"));},});return{DashboardPage,AssignedToMe,AssignedToMeMenuItem,ProjectItem};});;

/* /scrummer/static/src/js/views/pages/board.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.page.board',function(require){"use strict";const AgileContainerWidget=require('scrummer.BaseWidgets').AgileContainerWidget;const hash_service=require('scrummer.hash_service');const storage_service=require('scrummer.storage_service');const AgileMenu=require('scrummer.menu');const data=require('scrummer.data');const ViewManager=require('scrummer.view_manager');const BoardChooser=require('scrummer.board_chooser').BoardChooser;const crash_manager=require('web.crash_manager');const web_core=require('web.core');const _t=web_core._t;const BoardPage=AgileContainerWidget.extend({template:"scrummer.page.board",_name:"BoardPage",custom_events:{board_type_changed:function(){this.rerender_widget(['boardDeferred']);}},init(parent,options){this._super(parent,options);this.trigger_up('menu.added');window.bp=this;},willStart(){return this._super().then(()=>{this.boardDeferred=$.Deferred();this.getBoard(this.boardDeferred);return this.boardDeferred.promise();});},handleNoBoard(){crash_manager.show_error({type:_t("Configuration error"),message:_t("You don't have access to any board."),data:{debug:""}});hash_service.setHash("page","dashboard");},getBoard(deferred){data.cache.get("current_user").then((user)=>{const board=hash_service.get("board")||storage_service.get("board");if(user.board_ids.includes(parseInt(board,10))){this.board=board;if(hash_service.get("board")!==board){hash_service.set("board",board);}
if(storage_service.get("board")!==board){storage_service.set("board",board);}}
if(!this.board){const project_id=hash_service.get("project");if(project_id){data.cache.get("board_for_project",{id:project_id}).then((board_id)=>{if(!board_id){this.handleNoBoard();return;}
this.board=board_id;this.fetchBoard(board_id).done(deferred.resolve);hash_service.set("board",this.board);});}else{data.getDataSet("project.agile.board").read_slice([],{domain:[["is_default","=",true]]}).then((boards)=>{if(boards.length===0){this.handleNoBoard();deferred.reject();return;}
this.board_data=boards[0];hash_service.set("board",this.board_data.id);storage_service.set("board",this.board_data.id);deferred.resolve();});}}
if(this.board){this.fetchBoard(this.board).done(deferred.resolve);}});},fetchBoard(board_id){const getBoardDef=$.Deferred();data.getDataSet("project.agile.board").read_ids([parseInt(board_id,10)]).then((boards)=>{if(boards.length===0){hash_service.delete("board");storage_service.delete("board");this.getBoard(this.boardDeferred);getBoardDef.reject();return;}
this.board_data=boards[0];getBoardDef.resolve();});return getBoardDef.promise();},start(){this._is_added_to_DOM.then(()=>{$('.button-collapse').sideNav({menuWidth:300,edge:'left',});});this.trigger_up('menu.added');return this._super();},destroy(){hash_service.delete("task");hash_service.delete("view");hash_service.delete("board");$('.button-collapse').sideNav('hide');return this._super();},build_widget_list(){this.add_widget({'id':'menu_widget','widget':AgileMenu.AgileViewMenu,'replace':'widget.aside-left','args':{viewKey:"view",template:"scrummer.menu",boardType:this.board_data.type,}});this.add_widget({'id':'board_chooser','widget':BoardChooser,'replace':'widget.board-chooser',});this.add_widget({'id':'view_manager_widget','widget':ViewManager,'replace':'widget.view_manager','args':{defaultView:this.board_data.type,_name:"view_manager_widget",}});}});return BoardPage;});;

/* /scrummer/static/src/js/widgets/attachments.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.attachments',(require)=>{"use strict";const scrummer_data=require('scrummer.data');const BaseWidgets=require('scrummer.BaseWidgets');const AbstractModelList=require('scrummer.abstract_model_list');const dialog=require('scrummer.dialog');const _t=require('web.core')._t;const Waves=window.Waves;const AttachmentsItem=AbstractModelList.AbstractModelListItem.extend({template:"scrummer.attachments.item",max_upload_size:25*1024*1024,init(parent,options){this._super(parent,options);this.record=this.record||{};if(!this.record.downloadable){this._require_obj("record",['file','res_model','res_id','convertTimeout']);this.record.name=this.record.file.name;this._fileUploadedDef=$.Deferred();this.fileUploaded=this._fileUploadedDef.promise();}},willStart(){const superPromise=this._super();if(this.record.downloadable){return $.when(superPromise,this.prepareUserImage());}
return superPromise;},prepareUserImage(){return scrummer_data.cache.get("get_user",{id:this.record.create_uid[0]}).then((user)=>{this.user_image_url=scrummer_data.getImage("res.users",user.id,user.write_date);});},renderElement(){this._super();if(this.record.downloadable){this.$el.addClass("downloadable");this.$el.addClass("complete");}},start(){if(this.record.downloadable){this.$(".delete").click(this.remove.bind(this));}else{this.loadFile(this.record.file);this.$(".abort").click(this.destroy.bind(this));this.$(".retry").click(()=>{this.$el.removeClass("with-error");this.loadFile(this.record.file);});}
this.$(".tooltipped").tooltip();return this._super();},loadFile(file){if(file.size>this.max_upload_size){this.$el.addClass("with-error");const maxUploadMB=(this.max_upload_size/1024)/1024;this.setError(_t("File exceed the maximum file size of ")+maxUploadMB+"MB");this.setProgress(0);this.$(".retry").hide();return false;}
this.setStatus(_t("Preparing file..."));this.setProgress(false);const fileReader=new FileReader();const self=this;fileReader.onloadend=(upload)=>{let data=upload.target.result;data=data.split(',')[1];self.uploadFile(data);};fileReader.readAsDataURL(file);},setError(error){this.$(".error").text(error);},setStatus(status){this.$(".status").text(status);},setProgress(progress){if(progress===false){this.$(".progress").empty().append($('<div class="indeterminate"/>'));}else if(Number(progress)===progress&&progress>=0&&progress<=1){this.$(".progress").empty().append($('<div class="determinate" style="width: '+(progress*100)+'%"/>'));}else{throw new Error("Illegal argument");}},uploadFile(file_base64){if(this.record.file.size===false){this.setError(_t("Browser couldn't load file"));}else{this.setStatus(_t("Uploading file..."));scrummer_data.getDataSet("ir.attachment").create({res_id:this.record.res_id,res_model:this.record.res_model,name:this.record.file.name,datas:file_base64,datas_fname:this.record.file.name}).then(this.onFileUploaded.bind(this),this.onFileUploadError.bind(this));}},onFileUploaded(id){this._fileUploadedDef.resolve(arguments);this.setId(id);this.setProgress(1);this.$(".delete").click(this.remove.bind(this));this.$el.addClass("complete");this.attachmentLoaded=scrummer_data.getDataSet("ir.attachment").read_ids([id],["name","datas_fname","local_url","create_uid","create_date",]);setTimeout(this.convertToLink.bind(this),this.record.convertTimeout);},onFileUploadError(){this._fileUploadedDef.reject(arguments);this.setProgress(0);this.$el.addClass("with-error");this.setError(_t("Error while uploading file"));},convertToLink(){this.attachmentLoaded.then((result)=>{const attachment=result[0];Object.assign(this.record,attachment);this.record.downloadable=true;this.$el.addClass("downloadable");this.$(".name").html(`<a href="${this.record.local_url}"download="${this.record.datas_fname}"target="_blank">${this.record.name}</a>`);this.prepareUserImage().then(()=>{const image=$(`<img src="${this.user_image_url}"class="circle valign image tooltipped"
data-position="bottom"data-delay="50"data-tooltip="${this.record.create_uid[1]} @ ${this.record.create_date}"/>`);image.insertBefore(this.$(".meta"));image.tooltip();});});},remove(){dialog.confirm(_t("Delete attachment"),_t("Are you sure you want to delete this attachment?"),_t("yes")).done(()=>{this.dataset.unlink([this.record.id]).then(()=>{this.trigger_up("remove_attachment",{id:this.record.id});});});},destroy(){if(this.__destroying){this._super();}else{this.__destroying=true;this.$el.addClass("fade-out");const self=this;this.$el.one('webkitAnimationEnd oanimationend msAnimationEnd animationend',()=>self.destroy());}}});AttachmentsItem.sort_by="create_date";const AttachmentsWidget=BaseWidgets.AgileBaseWidget.extend({template:"scrummer.attachments",multiple:true,convertTimeout:3000,custom_events:{'remove_attachment':function(evt){this.attachmentsList.removeItem(evt.data.id);}},init(parent,options){Object.assign(this,options);this._super(parent,options);this._require_prop("res_id");this._require_prop("res_model");this._require_prop("attachments");this.attachments.forEach((e)=>{e.downloadable=true;});},renderElement(){this._super();this.$(".attachments-input").attr("multiple",this.multiple);this.attachmentsList=new AbstractModelList.ModelList(this,{model:"ir.attachment",data:this.attachments,ModelItem:AttachmentsItem,});this.attachmentsList.appendTo(this.$el);},start(){this.initDragAndDrop();this.$(".upload-files").click(()=>this.$(".attachments-input").trigger("click"));this.$(".attachments-input").change((e)=>this.uploadFiles(e.target.files));return this._super();},initDragAndDrop(){let dragCounter=0;const removeTimeout=setTimeout(()=>this.$el.removeClass('waves-effect'),700);let captureDragover=false;const finalizeWave=()=>{Waves.calm(this.$el[0]);this.$el.removeClass('is-dragover');};this.$el.on('drag dragstart dragend dragover dragenter dragleave drop',(e)=>{e.preventDefault();e.stopPropagation();}).on('dragover dragenter dragstart',(e)=>{this.$el.addClass('is-dragover');if((e.type==="dragenter"||e.type==="dragstart")&&dragCounter++===0){captureDragover=true;}
if(e.type==="dragover"&&captureDragover){captureDragover=false;clearTimeout(removeTimeout);this.$el.addClass('waves-effect');window.Waves.ripple(this.$el[0],{wait:999999,position:{x:e.originalEvent.layerX,y:e.originalEvent.layerY}});}}).on('dragleave dragend drop',(e)=>{if(e.type==="dragleave"&&--dragCounter===0){finalizeWave();}}).on('drop',(e)=>{finalizeWave();const droppedFiles=e.originalEvent.dataTransfer.files;this.uploadFiles(droppedFiles);dragCounter=0;});},uploadFiles(fileList){if(fileList.length>0){const attachmentPromises=[];this.trigger_up("attachment_upload_started");for(const file of fileList){const item=this.attachmentsList.addItem({file:file,res_id:this.res_id,res_model:this.res_model,convertTimeout:this.convertTimeout,dataset:scrummer_data.getDataSet("ir.attachment"),order_field:AttachmentsItem.sort_by});attachmentPromises.push(item.fileUploaded);}
$.when(...attachmentPromises).always(()=>this.trigger_up("attachment_upload_finished"));}},getIds(){return[...this.attachmentsList.list.keys()].filter((x)=>x);}});return{AttachmentsWidget,AttachmentsItem};});;

/* /scrummer/static/src/js/widgets/base_widget.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.BaseWidgets',function(require){"use strict";const Widget=require('web.Widget');const mixins=require('scrummer.mixins');const core=require('web.core');const _t=core._t;const AgileBaseWidget=Widget.extend(mixins.RequireMixin,{__AGILE_BASE_WIDGET:true,init(parent,options={}){this._super(parent);this.__is_rendered=$.Deferred();this._is_rendered=this.__is_rendered.promise();this.__is_added_to_DOM=$.Deferred();this._is_added_to_DOM=this.__is_added_to_DOM.promise();this._destroyed=$.Deferred();},show(){this.$el.removeClass('oe_hidden');},hide(){this.$el.addClass('oe_hidden');},changeParent(parent){if(this.getParent()===parent){return;}
if(this.$el){this.$el.remove();}
this.setParent(parent);},renderElement(){this._super();this.$el.attr(this.attributes);},attachTo:function(target){const self=this;this.setElement(target.$el||target);return this.willStart().then(function(){self.resolveRenderAndDOM();return self.start();});},insertAt:function(target,index){const self=this;return this.__widgetRenderAndInsert(function(t){t.insertAt(self.$el,index);},target);},willStart(){if(this.__willStartCalled){throw new Error("You should not call willStart by yourself. Use _is_rendered promise to know when data is loaded.");}
this.__willStartCalled=true;return this._super();},__widgetRenderAndInsert(insertion,target){if(this.__willStartCalled){this._is_rendered.then(()=>{insertion(target);});return $.when();}
return this.willStart().then(()=>{this.renderElement();insertion(target);this.resolveRenderAndDOM();return this.start();});},resolveRenderAndDOM(){this.__is_rendered.resolve();if(!this.__parentedDestroyed&&this.getParent().__AGILE_BASE_WIDGET){this.getParent()._is_added_to_DOM.then(()=>{this.__is_added_to_DOM.resolve();});}},addedToDOM(){},destroy(){this._super();this._destroyed.resolve(arguments);},start(){const ret=this._super();this._is_added_to_DOM.then(()=>{this.addedToDOM();});return ret;},rerender_widget(deferredsToClear=[]){this.emptyWidget();for(const field of deferredsToClear){delete this[field];}
this.__willStartCalled=false;this.willStart().then(()=>{this.renderElement();return this.start();});},emptyWidget(){for(const children of this.getChildren()){children.destroy();}}});const AgileViewWidget=AgileBaseWidget.extend(mixins.MenuItemsMixin,{menuItemsContainer:'.fixed-action-btn',custom_events:{set_title:'_onSetTitle',open_right_side:'_onOpenRightSide',},init(parent,options){this._super(parent,options);this.options=options;mixins.MenuItemsMixin.init.call(this);},renderElement(){this._super();if(!this.title){console.error("Title not set");this.title=_t("Project Agile");}
const floatingButton=$(core.qweb.render("scrummer.view.floating-action-button",{widget:this}).trim());this.$el.append(floatingButton);this.setTitle(this.title);},setTitle(title,stringTitle){if(title){this.title=title;$("title").html(stringTitle||this.title);this.trigger_up("set_title",{title:this.title});}},_onSetTitle(evt){if(this.subheader){this.subheader.setTitle(evt.data.title);}},_onOpenRightSide(evt){const WidgetClass=evt.data.WidgetClass;const widgetOptions=evt.data.options;this.$el.addClass("with-right");if(this.rightSideWidget){this.rightSideWidget.destroy({preventClosing:true});}
this.rightSideWidget=new WidgetClass(this,widgetOptions);this.rightSideWidget.appendTo(this.$("#right-detail-view").empty());this.rightSideWidget._destroyed.then((args)=>{if(typeof args[0]!=="object"||!args[0].preventClosing){this.$el.removeClass("with-right");delete this.rightSideWidget;}});},start(){mixins.MenuItemsMixin.start.call(this);return this._super();},updateMenuVisibility(){mixins.MenuItemsMixin.updateMenuVisibility.call(this);},});const AgileContainerWidget=AgileBaseWidget.extend({init(parent,options){this._super(parent,options);this.widgetDefinitions=[];this.widget={};},renderElement(){this._super();this.build_widget_list();this.build_widgets();},build_widgets(){for(const def of this.widgetDefinitions){this.render_widget(def);}},render_widget(def){if(typeof def.condition==="undefined"||(typeof def.condition==="function"&&def.condition.call(this))||def.condition){const args=typeof def.args==='function'?def.args(this):def.args;const w=new def.widget(this,args||{});if(def.replace){w.replace(this.$(def.replace));}else if(def.append){w.appendTo(this.$(def.append));}else if(def.prepend){w.prependTo(this.$(def.prepend));}else{w.appendTo(this.$el);}
this.widget[def.id]=w;}},build_widget_list(){},add_widget(widgetDefinition){this.widgetDefinitions.push(widgetDefinition);},rerender_widget(widgetDefinitions){this.widgetDefinitions=[];this._super(widgetDefinitions);}});const DataWidget=AgileBaseWidget.extend({init(parent,options={}){Object.assign(this,options);this._super(parent,options);this._model=this.data;delete this.data;this._require_prop("id");this.useDataService=this.data_service&&this.data_service.__dataService;if(this.useDataService){this.dataset=this.data_service.dataset;}else{this._require_prop("dataset");this.wrapModel();}},willStart(){return this._super().then(()=>{if(this.useDataService){return this.data_service.getRecord(this.id).then((record)=>{this._model=record;this.__model=record._source;this.name=record.name;});}else if(typeof this._model==="object"){return $.when();}
return this.dataset.read_ids([this.id],this.fields).then((result)=>{this._model=result[0];this.name=this._model.name;});});},wrapModel(){this._is_rendered.then(()=>{const model=this._model;model.__widget=this;const keys=Object.keys(model);this._model=new Proxy(model,{set(trapTarget,key,value,receiver){if(!keys.includes(key)||key==="__widget"||key==="id"){throw new TypeError("Trying to write non-existing property",arguments);}
const widget=trapTarget.__widget;const writeValue=Array.isArray(value)?value[0]:value;const displayValue=Array.isArray(value)?value[1]:value;widget.dataset.write(trapTarget.id,{[key]:writeValue}).fail((r)=>console.error(`Error ${trapTarget.__widget.dataset.model}[${trapTarget.id}]:${key}-${value}`,r));widget.$(`[data-field="${key}"].field_value`).text(displayValue);return Reflect.set(trapTarget,key,value,receiver);},get(trapTarget,key,receiver){const widget=trapTarget.__widget;const targetModel=trapTarget;if(!(key in receiver)){return new Proxy(()=>{},{apply:function(target,thisArg,argumentList){return widget.dataset._model.call(key,[[targetModel.id],...argumentList],{context:widget.dataset.get_context().eval()});}});}
return Reflect.get(trapTarget,key,receiver);}});this.__model=new Proxy(model,{set(trapTarget,key,value,receiver){if(!keys.includes(key)||key==="__widget"||key==="id"){throw new TypeError("Trying to write non-existing property");}
const widget=trapTarget.__widget;const displayValue=Array.isArray(value)?value[1]:value;widget.$(`[data-field="${key}"].field_value`).text(displayValue);return Reflect.set(trapTarget,key,value,receiver);}});});},start(){this.$("[data-widget-editable=true]").attr('contenteditable','true').on('keypress',(e)=>{if(e.which===13){e.preventDefault();$(e.target).blur();}}).blur((evt)=>{const target=$(evt.target);const field=target.data("field");if(!field){throw new Error("DataWidget data-field attribute must be set when using data-widget-editable!");}
const oldVal=this._model[field];const newValue=target.text().trim();if(oldVal!==newValue){this.dataset.write(this.id,{[field]:newValue}).fail((e)=>{console.error("Error while saving data: ",e);});}});return this._super();},_make_descriptive(){const attrs=_.extend({},this.attributes||{});if(this.domID){attrs.domID=this.domID;}
if(this.className){attrs.class=this.className;}
return $(this.make(this.tagName,attrs));},unlink(){return this.dataset.unlink([this.id]).fail((r)=>console.error(`Error while deleting record:${this.dataset.model},${this.id}`,r));}});return{AgileBaseWidget,AgileViewWidget,AgileContainerWidget,DataWidget};});;

/* /scrummer/static/src/js/widgets/header.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.header',function(require){"use strict";const AgileBaseWidgets=require('scrummer.BaseWidgets');const AgileMenu=require('scrummer.menu');const data=require('scrummer.data');const bus=require('scrummer.core').bus;const hash_service=require('scrummer.hash_service');const HeaderWidget=AgileBaseWidgets.AgileBaseWidget.extend({template:"scrummer.layout.header",_name:"HeaderWidget",events:{"click .team-option":"_onTeamOptionClick"},willStart(){return $.when(this._super(),data.cache.get("current_user").then((user)=>{this.user=user;}));},renderElement(){this.data=data;this._super();this.menuTopWidget=new AgileMenu.AgileTopMenu(this,{viewKey:"page"});this.menuTopWidget.appendTo(this.$(".nav-middle"));},addedToDOM(){this._super();this.$('.notification-button').dropdown({inDuration:300,outDuration:225,constrain_width:false,hover:true,gutter:0,belowOrigin:true,alignment:'left'});this.$('.user-button').dropdown({inDuration:300,outDuration:225,constrain_width:false,hover:true,gutter:0,belowOrigin:true,alignment:'right'});this.$('.team-dropdown-button').closest(".dropdown-content").css("display","block");let buttonWidth=this.$('.team-dropdown-button').outerWidth();if($('.team-dropdown-button').find("i.mdi").outerWidth()===0){buttonWidth+=20;}
this.$('.team-dropdown-button').closest(".dropdown-content").css("display","");this.$('.team-dropdown-button').dropdown({inDuration:300,outDuration:225,constrain_width:false,hover:true,gutter:buttonWidth,belowOrigin:false,alignment:'right'});},start(){bus.on("search:show",this,(keydownEvent,callback)=>{this.$(".nav-wrapper").addClass("with-search");$(".nav-search > div").show();const searchInput=$(".nav-search input");searchInput.keydown(function(evt){clearTimeout(this.searchDelayTimeout);if(evt.keyCode===13){keydownEvent($(this));}else{this.searchDelayTimeout=setTimeout(()=>{keydownEvent($(this));},1000);}});if(typeof callback==="function"){return callback(searchInput);}});bus.on("search:remove",this,()=>{this.$(".nav-wrapper").removeClass("with-search");this.$(".nav-search > div").hide();this.$(".nav-search input").off();});this.$(".search-button").click(()=>{this.$(".nav-wrapper").toggleClass("search-open");});this.$(".back-to-odoo").click((e)=>{e.preventDefault();let href="/web";href+=data.session.debug?"?debug="+data.session.debug:"";window.location.href=href;});return this._super();},_onTeamOptionClick(e){const team_id=$(e.currentTarget).getDataFromAncestor("id");const team=this.user.team_ids[team_id];if(this.user.team_id[0]!==team.id){this.user.team_id[0]=team.id;this.$(".team-name").html(team.name);hash_service.delete("view");hash_service.setHash("page","dashboard",true,true);hash_service.delete("project");data.getDataSet("res.users").call('change_team',[[data.session.uid],team.id]).then(()=>{bus.trigger("team:changed",team.id);});}},});return{HeaderWidget};});;

/* /scrummer/static/src/js/widgets/menu.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.menu',function(require){"use strict";const AgileBaseWidgets=require('scrummer.BaseWidgets');const AgileContainerWidget=AgileBaseWidgets.AgileContainerWidget;const hash_service=require('scrummer.hash_service');const core=require('web.core');const _t=core._t;window.qweb=core.qweb;const AgileMenuItem=AgileContainerWidget.extend({_name:"AgileMenuItem",template:"scrummer.menu.menuitem",init(parent,options){this._super(parent,options);Object.assign(this,options);},build_widgets(){if(this.children instanceof Array&&this.children){for(const def of this.children.sort((a,b)=>a.args.sequence-b.args.sequence)){def.args.viewKey=def.args.viewKey?def.args.viewKey:this.viewKey;this.render_widget(def);}}}});const AgileHorizontalMenuItem=AgileMenuItem.extend({_name:"AgileHorizontalMenuItem",template:"scrummer.menu.menuitem.horisontal",start(){this.$el.find("a").click(()=>hash_service.setHash(this.viewKey,this.view));return this._super();}});const AgileVerticalMenuItem=AgileMenuItem.extend({_name:"AgileVerticalMenuItem",init(parent,options){if(options.children&&options.children.length>0){this.template="scrummer.menu.category";}
if(options.parent){this.template="scrummer.menu.subitem";}
this._super(parent,options);},start(){if(!this.children||this.children.length===0){this.$("a").click(()=>{hash_service.setHash(this.viewKey,this.view);$('.button-collapse').sideNav('hide');});}
return this._super();}});const AgileVerticalFromTopMenuItem=AgileMenuItem.extend({_name:"AgileVerticalFromTopMenuItem",template:"scrummer.menu.menuitem.overflow",init(parent,options){if(options.children&&options.children.length>0){this.template="scrummer.menu.category";}
if(options.parent){this.template="scrummer.menu.subitem";}
this._super(parent,options);},start(){if(!this.children||this.children.length===0){this.$("a").click(()=>hash_service.setHash(this.viewKey,this.view));}
return this._super();}});const AgileMenu=AgileContainerWidget.extend({_name:"AgileMenu",init(parent,options={}){Object.assign(this,options);this._super(parent,options);},build_widget_list(){throw new Error("You must implement build_widget_list() method in your implementation of AgileMenu class.");},build_widgets(){const map=new Map();for(const def of this.widgetDefinitions){if(map.has(def.args.id)){throw new Error("Duplicate id in menu widget: "+def.args.id);}
map.set(def.args.id,def);}
for(const def of map.values()){if("args"in def&&def.args.parent){const parent=map.get(def.args.parent);if(typeof parent==="undefined"){throw new Error("Menu item definition: Parent id not found: "+def.args.parent);}
if(parent.args.children instanceof Array){parent.args.children.push(def);}else{parent.args.children=[def];}}}
const widgets=[...map.values()].filter((def)=>typeof def.args.parent==="undefined"||def.args.parent===null).sort((a,b)=>a.args.sequence-b.args.sequence);for(const def of widgets){def.args.viewKey=def.args.viewKey?def.args.viewKey:this.viewKey;this.render_widget(def);}},});const AgileViewMenu=AgileMenu.extend({_name:"AgileViewMenu",init(parent,options){this._super(parent,options);this._require_prop("boardType");},build_widget_list(){this.add_widget({id:'dashboard',widget:AgileVerticalFromTopMenuItem,append:"ul#nav-mobile",'args':{id:"dashboard",view:"dashboard",icon:"view-dashboard",name:_t("Dashboard"),viewKey:"page",sequence:0.5,}});},start(){this.$('.collapsible').collapsible();this.$('select').not('.disabled').material_select();return this._super();}});const AgileTopMenu=AgileMenu.extend({_name:"AgileTopMenu",tagName:"ul",build_widget_list(){this.add_widget({'name':'dashboard','widget':AgileHorizontalMenuItem,'args':{id:"dashboard",view:"dashboard",name:_t("Dashboard"),sequence:1,}});}});return{AgileMenu,AgileViewMenu,AgileTopMenu,AgileMenuItem,AgileHorizontalMenuItem,AgileVerticalMenuItem,AgileVerticalFromTopMenuItem};});;

/* /scrummer/static/src/js/widgets/layout.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.layout',function(require){"use strict";const core=require('scrummer.core');const _t=require('web.core')._t;const qweb=require('web.core').qweb;const data=require('scrummer.data');const web_client=require('web.web_client');const PageManager=require('scrummer.page_manager');const AgileContainerWidget=require('scrummer.BaseWidgets').AgileContainerWidget;const AgileHeader=require('scrummer.header');const AgileLayout=AgileContainerWidget.extend({template:"scrummer.layout",failTemplate:"scrummer.layout.fail",custom_events:{'menu.added':function(){if(this._is_added_to_DOM.state()==="resolved"){this.$el.addClass("with-menu");}else{this.className=this.className?this.className.concat(" with-menu"):"with-menu";}},'menu.removed':function(){if(this._is_added_to_DOM.state()==="resolved"){this.$el.removeClass("with-menu");}},},_name:"layout",init(parent,options){this._super(parent,options);web_client.loading.destroy();core.layout=this;},build_widget_list(){this.add_widget({'id':'header_widget','widget':AgileHeader.HeaderWidget,'replace':'widget.header',});this.add_widget({'id':'page_manager_widget','widget':PageManager,'replace':'widget.page_manager','args':{defaultView:"dashboard",_name:'page_manager_widget'}});},willStart(){return $.when(this._super(),data.cache.get("current_user").then((user)=>{this.user=user;}));},renderElement(){if(!this.shouldLoad()){const $el=$(qweb.render(this.failTemplate,this.generateLoadingErrors()).trim());this.replaceElement($el);return;}
return this._super();},shouldLoad(){return this.user.team_id;},generateLoadingErrors(){const errors=[{name:"no_agile_team",title:_t("Agile team missing"),message:_t("You don't belong to any agile team, please contact your Administrator.")}];return{errors};},start(){const appNode=document.getElementsByClassName("o_content")[0];const self=this;const observer=new MutationObserver((mutations)=>{mutations.forEach(function(mutation){if(mutation.addedNodes[0].id==="agile_layout"||mutation.addedNodes[0].id==="agile_layout_fail"){self.actionAddedToDOM();observer.disconnect();}});});observer.observe(appNode,{childList:true});return this._super();},actionAddedToDOM(){this.__is_added_to_DOM.resolve();this.$el.addClass(this.className);this.materializeInit();},materializeInit(){$('body').addClass('loaded');window.Waves.init({duration:500,delay:1000});},});return{AgileLayout};});;

/* /scrummer/static/src/js/widgets/abstract_model_list.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.abstract_model_list',function(require){"use strict";const data=require('scrummer.data');const DataServiceFactory=require('scrummer.data_service_factory');const AgileContainerWidget=require('scrummer.BaseWidgets').AgileContainerWidget;const AgileBaseWidget=require('scrummer.BaseWidgets').AgileBaseWidget;const Sortable=require('sortable');const dialog=require('scrummer.dialog');const crash_manager=require('web.crash_manager');const core=require('web.core');const _t=core._t;const ModelList=AgileContainerWidget.extend({_name:"ModelList",emptyPlaceholder:null,className:"model-list",useDataService:false,custom_events:{change_parent:'_onChangeParent',change_order:'_onChangeOrder',remove_item:'_onRemoveItem'},init(parent,options={}){Object.assign(this,options);this._super(parent,options);this._require_prop("model");this._require_prop("ModelItem");this.getDatasetDefaults(options);},getDatasetDefaults(options){this.fields=options.fields||this.ModelItem.default_fields||["name","agile_order"];this.domain=options.domain||[];this.context=options.context||[];this.offset=options.offset||0;this.limit=options.limit||false;this.queryString=options.queryString||"";this.dataset=data.getDataSet(this.model);if(this.useDataService){this.data_service=DataServiceFactory.get(this.model);this.hasCustomFilter=Boolean(options.domain||options.context||options.offset||options.limit||options.queryString);}},loadItems(){const def=$.Deferred();if(Array.isArray(this.data)){def.resolve();}else if(this.useDataService){if(this.hasCustomFilter){return this.data_service.dataset.id_search(this.queryString,this.domain,'ilike',this.limit).then((ids)=>this.data_service.getRecords(ids).then((records)=>{this.data=records;def.resolve();}));}
return this.data_service.getAllRecords().then((records)=>{this.data=records;def.resolve();});}else{$.when(this.fields,this.domain,this.offset,this.limit,this.context).then((fields,domain,offset,limit,context)=>{this.dataset.read_slice(fields,{domain,offset,limit,context}).then((r)=>{this.data=r;def.resolve(r);}).fail((e)=>def.reject(e));});}
return def;},willStart(){return $.when(this._super(),this.loadItems());},addItem(item,attributes){if(typeof item[this.ModelItem.sort_by]==="function"){throw new Error("ModelItem doesn't have set sort_by property.");}
if(item._class==="ModelListItem"){if(item.id){this.list.set(item.id,item);}
if(!this.__parentedChildren.find((e)=>e.id===item.id)){item.setParent(this);this._appendInOrder(item,item[this.ModelItem.sort_by]);}
this.trigger_up("add_item",{widget:item,itemData:item.record});return item;}
const widgetOptions={id:item.id,record:item,attributes:{"data-id":item.id},dataset:this.dataset,order_field:this.ModelItem.sort_by,};Object.assign(widgetOptions,this.itemExtensions);attributes&&Object.assign(widgetOptions.attributes,attributes);const modelItem=new this.ModelItem(this,widgetOptions);this.list.set(item.id,modelItem);this._appendInOrder(modelItem,item[this.ModelItem.sort_by]);this.$el.removeClass("empty");this.trigger_up("add_item",{widget:modelItem,itemData:item});return modelItem;},removeItem(id,destroy=true,silently=false){const itemWidget=this.list.get(id);if(!itemWidget){return false;}
itemWidget.setParent(null);const itemData=itemWidget.record;destroy?itemWidget.destroy():itemWidget.$el.detach();this.list.delete(id);if(!silently){this.trigger_up("remove_item",{itemData});}
if(!this.list.size){this.$el.addClass("empty");}
return true;},moveToTop(evt){const widget_id=$(evt.item).data("id");const itemWidget=this.list.get(widget_id);if(!itemWidget){return;}
if(evt.oldIndex!==0){itemWidget.set_order(this.getNewOrder(evt.oldIndex,0,this.id,true),true);}},moveToBottom(evt){const widget_id=$(evt.item).data("id");const itemWidget=this.list.get(widget_id);if(!itemWidget){return;}
if(evt.oldIndex!==this.__parentedChildren.length-1){itemWidget.set_order(this.getNewOrder(evt.oldIndex,this.__parentedChildren.length-1,this.id,true),true);}},onDragStart(evt){try{this.trigger_up("drag_start");}catch(e){this._handleError(e);}},onDragEnd(evt){try{this.trigger_up("drag_end",{sortableEvent:evt});if(evt.defaultPrevented){return;}
const widget_id=$(evt.item).data("id");const itemWidget=this.list.get(widget_id);if(!itemWidget){return;}
const from_list_id=$(evt.from).data("id");const to_list_id=$(evt.to).data("id");if(from_list_id===to_list_id){if(evt.oldIndex!==evt.newIndex){itemWidget.set_order(this.getNewOrder(evt.oldIndex,evt.newIndex,to_list_id,true),true);}}else{const newListWidget=this._getNewListWidget(to_list_id);itemWidget.set_list(newListWidget,this.getNewOrder(evt.oldIndex,evt.newIndex,to_list_id));}}catch(e){this._handleError(e);}},renderElement(){this._super();if(this.emptyPlaceholder){this.emptyPlaceholder.addClass("empty-placeholder");this.$el.append(this.emptyPlaceholder);this.$el.addClass("empty");}
this.list=new Map();for(const item of this.data){this.addItem(item);}
if("sortable"in this&&this.sortable){this._is_added_to_DOM.then(()=>{this.$el.attr("data-sortable",this.sortable.group);Sortable.create(this.$el.get(0),{group:this.sortable.group,onStart:this.onDragStart.bind(this),onEnd:this.onDragEnd.bind(this)});});}},_setNewItemList(itemWidget,newListWidget){this.removeItem(itemWidget.id,false);newListWidget.addItem(itemWidget);},getNewOrder(oldIndex,newIndex,new_list_id,sameList=false){const itemsInNewList=this._getNewListWidget(new_list_id).__parentedChildren;if(!itemsInNewList.length){return 1;}
if(newIndex===0){const currentFirstOrder=itemsInNewList[0][this.ModelItem.sort_by];return currentFirstOrder>0?currentFirstOrder/2:currentFirstOrder-1;}
if(sameList&&newIndex===itemsInNewList.length-1){return itemsInNewList[newIndex][this.ModelItem.sort_by]+1;}
if(newIndex===itemsInNewList.length){return itemsInNewList[newIndex-1][this.ModelItem.sort_by]+1;}
if(sameList&&oldIndex<newIndex){return(itemsInNewList[newIndex][this.ModelItem.sort_by]+itemsInNewList[newIndex+1][this.ModelItem.sort_by])/2;}
return(itemsInNewList[newIndex-1][this.ModelItem.sort_by]+itemsInNewList[newIndex][this.ModelItem.sort_by])/2;},_getNewListWidget(){throw new Error("You must implement this method");},_sortWidgets(){if(!this.ModelItem.sort_by&&!this.ModelItem.reverse){return;}
const widgets=this.__parentedChildren.sort(function(a,b){return typeof a[this.ModelItem.sort_by]==="string"?a[this.ModelItem.sort_by].localeCompare(b[this.ModelItem.sort_by]):a[this.ModelItem.sort_by]-b[this.ModelItem.sort_by];}.bind(this));this.__parentedChildren=this.ModelItem.reverse?widgets.reverse():widgets;},_appendInOrder(itemWidget,order){if(order){itemWidget[this.ModelItem.sort_by]=order;this._sortWidgets();}
const existingDOMnode=this.$("*[data-id='"+itemWidget.id+"']");if(existingDOMnode.size()){existingDOMnode.remove();}
const index=this.__parentedChildren.findIndex((e)=>e.id===itemWidget.id);if(index===0){itemWidget.prependTo(this.$el);}else if(index===(this.__parentedChildren.length-1)){itemWidget.appendTo(this.$el);}else{const priorWidget=this.__parentedChildren[index-1];$.when(priorWidget._is_rendered,this._is_rendered).then(()=>{itemWidget.insertAfter(priorWidget.$el);});}},_onChangeParent(evt){evt.stopped=true;this.list.set(evt.data.id,evt.data.item);this._sortWidgets();},_onChangeOrder(evt){evt.stopped=true;if(evt.data.itemWidget.$el){evt.data.itemWidget.$el.remove();}
this._appendInOrder(evt.data.itemWidget,evt.data.order);},_onRemoveItem(evt){this.removeItem(evt.data.id);evt.target=this;},_handleError(error){const traceback=error?error.stack:'';crash_manager.show_error({type:_t("Odoo Client Error"),message:error.message,data:{debug:_t('Traceback:')+"\n"+traceback},});}});const AbstractModelListItem=AgileBaseWidget.extend({_name:"AbstractModelListItem",_class:"ModelListItem",init(parent,options){Object.assign(this,options);this._super(parent,options);this._require_prop("order_field","Make sure that ModelListItem implementation sets order_field");this.removeConfirmation&&this._require_obj("removeConfirmation",['title','message']);},changeParent(parent){this._super(parent);this.trigger_up("change_parent",{id:this.id,item:this});},setId(id){this.id=id;this.$el.attr("data-id",id);this.trigger_up("change_parent",{id:this.id,item:this});},set_order(order,write=false){this.trigger_up("change_order",{itemWidget:this,order});if(write){this.dataset.write(this.id,{[this.order_field]:order});}},set_list(listWidget,order){this.changeParent(listWidget);this.set_order(order);},remove(){if(this.removeConfirmation){dialog.confirm(this.removeConfirmation.title,this.removeConfirmation.message,this.removeConfirmation.okText,this.removeConfirmation.cancelText).done(()=>{this._unlink();});}else{this._unlink();}},_unlink(){this.dataset.unlink([this.id]).then(()=>{this.trigger_up("remove_item",{id:this.id,itemData:this.record});});}});return{ModelList,AbstractModelListItem,};});;

/* /scrummer/static/src/js/widgets/model_list.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.model_list',function(require){"use strict";const data=require('scrummer.data');const AbstractModelList=require('scrummer.abstract_model_list');const AgileModals=require('scrummer.widget.modal');const core=require("web.core");const _t=core._t;const hash_service=require('scrummer.hash_service');const DataServiceFactory=require('scrummer.data_service_factory');const SimpleTaskItem=AbstractModelList.AbstractModelListItem.extend({_name:"SimpleTaskItem",template:"scrummer.task.simple_task_item",image_url(){return this.record.user_id?data.getImage("res.users",this.record.user_id[0],this.user_last_update):"/scrummer/static/img/unassigned.png";},image_tooltip(){return this.record.user_id?this.record.user_id[1]:_t("Unassigned");},willStart(){return $.when(this._super(),data.cache.get("current_user").then((user)=>{this.currentUser=user;}),DataServiceFactory.get("project.task.type2").getAllRecords(true).then((task_types)=>{if(Number.isInteger(this.record)){return DataServiceFactory.get("project.task").getRecord(this.record).then((record)=>{this.record=record;this.task_type=task_types.get(this.record.type_id[0]);});}
this.task_type=task_types.get(this.record.type_id[0]);}));},start(){this.$(".task-key").click((e)=>{e.preventDefault();e.stopPropagation();const taskId=$(e.currentTarget).attr("task-id");hash_service.setHash("task",taskId);hash_service.setHash("view","task");hash_service.setHash("page","board");});if(typeof this.remove==="function"){this.$(".remove-item").click(this.remove.bind(this));}
return this._super();},addedToDOM(){this._super();this.$('.tooltipped').tooltip({delay:50});},removeParent(){this.$(".parent-key").hide();}});SimpleTaskItem.sort_by="agile_order";const MessageItem=AbstractModelList.AbstractModelListItem.extend({_name:"MessageItem",template:"scrummer.task.comment",init(parent,options){this._super(parent,options);this._require_obj("taskModel",["id","key","name"]);},willStart(){return $.when(this._super(),data.cache.get("current_user").then((user)=>{this.currentUser=user;}));},image_url(){return data.getImage("res.partner",this.record.author_id[0],this.record.author_last_update);},addedToDOM(){this._super();this.$('.tooltipped').tooltip({delay:50});},canEdit(){return this.currentUser.partner_id[0]===this.record.author_id[0];},renderElement(){this._super();if(this.record.date!==this.record.write_date){this.setWriteDate();}},setWriteDate(){this.$(".activity-item-write-date").remove();const tooltipString=this.record.author_id[1]+_t(" at ")+this.record.write_date;const writeDateNode=$('<span class="activity-item-write-date tooltipped" data-position="bottom" data-delay="50" data-tooltip="'+tooltipString+'"/>');writeDateNode.insertAfter(this.$(".activity-item-date"));writeDateNode.tooltip();},start(){this.$(".remove-activity").click(this.remove.bind(this));this.$(".edit-activity").click(()=>{const modal=new AgileModals.CommentItemModal(this,{task:this.taskModel,edit:this.record,afterHook:(comment)=>{Object.assign(this.record,comment);this.$(".activity-body").html(comment.body);this.setWriteDate();}});modal.appendTo($("body"));});}});MessageItem.sort_by="date";MessageItem.reverse=true;return{SimpleTaskItem,MessageItem};});;

/* /scrummer/static/src/js/widgets/board_chooser.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.board_chooser',function(require){"use strict";const ScrummerData=require('scrummer.data');const AbstractModelList=require('scrummer.abstract_model_list');const AgileBaseWidget=require('scrummer.BaseWidgets').AgileBaseWidget;const storage_service=require('scrummer.storage_service');const DataServiceFactory=require('scrummer.data_service_factory');const hash_service=require('scrummer.hash_service');const _t=require('web.core')._t;const crash_manager=require('web.crash_manager');const BoardListItem=AgileBaseWidget.extend({_name:"BoardListItem",template:"scrummer.list.board_chooser_item",init(parent,options){this._super(parent,options);Object.assign(this,options);},start(){if(this.id===hash_service.get("board")){this.destroy();}else{this.$("a").click(()=>{this.selectBoard();});}
return this._super();},selectBoard(){this.trigger_up("set_board",{id:this.record.id});this.destroy();}});BoardListItem.sort_by="id";const BoardChooser=AgileBaseWidget.extend({_name:"BoardChooser",template:"scrummer.board_chooser",custom_events:{'set_board':'_onSetBoard',},_onSetBoard(evt){this.setBoard(evt.data.id);},init(parent,options){Object.assign(this,options);this._super(parent,options);this.current_board=parseInt(hash_service.get("board"),10);this.current_project=parseInt(hash_service.get("project"),10);},willStart(){return $.when(this._super(),ScrummerData.cache.get("current_user").then((user)=>{this.user=user;}),this.current_project&&DataServiceFactory.get("project.project").getRecord(this.current_project).then((project)=>{this.project=project;})).then(()=>{const board_service=DataServiceFactory.get("project.agile.board");const project_ids=this.current_project?[this.current_project]:this.user.team_ids[this.user.team_id[0]].project_ids;const board_filter=["|","&",["visibility","=","global"],["project_ids","in",project_ids],"|","&","&",["visibility","=","team"],["team_id","=",this.user.team_id[0]],["project_ids","in",project_ids],"&","&",["visibility","=","user"],["user_id","=",this.user.id],["project_ids","in",project_ids],];return board_service.dataset.id_search("",board_filter).then((board_ids)=>board_service.getRecords(board_ids,true).then((records)=>{this.boards=records;if(this.boards.size===0){const msgPart=this.project?_t("Project ")+this.project.name+" does not have":_t("None of the projects have");crash_manager.show_error({type:_t("Configuration error"),message:msgPart+_t(" board associated with it."),data:{debug:""}});hash_service.setHash("page","dashboard");return $.Deferred().reject();}
if(!this.boards.has(this.current_board)&&this.boards.size>0){this.setBoard([...this.boards.keys()][0]);}else{this.board=this.boards.get(this.current_board);}}));});},setBoard(id){storage_service.set("board",id);const boardTypeChanged=typeof this.board==="undefined"||this.board.type!==this.boards.get(id).type;hash_service.setHash("board",id,true,boardTypeChanged);if(this.board){this.boardList.addItem(this.board);}
this.board=this.boards.get(id);if(boardTypeChanged){hash_service.delete("view");this.trigger_up("board_type_changed");}
this.$("a.available-boards").html(this.board.name+' <i class="mdi mdi-menu-down right"></i>');},start(){this.boardList._is_added_to_DOM.then(()=>{$('.dropdown-button').dropdown({inDuration:300,outDuration:125,constrain_width:true,hover:false,alignment:'left',gutter:0,belowOrigin:true});});},renderElement(){this._super();const data=[...this.boards.values()];this.boardList=new AbstractModelList.ModelList(this,{model:"project.agile.board",data,tagName:"ul",id:"board-chooser-dropdown",className:"dropdown-content",ModelItem:BoardListItem});this.boardList.insertAfter(this.$(".available-boards"));},project_image_url(){return this.current_project?ScrummerData.getImage("project.project",this.current_project,this.project.write_date):ScrummerData.getImage("project.agile.team",this.user.team_id[0]);}});return{BoardChooser,BoardListItem};});;

/* /scrummer/static/src/js/widgets/task_widget.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.widget.task',function(require){"use strict";const data=require('scrummer.data');const ModelList=require('scrummer.model_list');const AbstractModelList=require('scrummer.abstract_model_list');const BaseWidgets=require('scrummer.BaseWidgets');const TaskLinks=require('scrummer.widget.task.links').TaskLinks;const AgileModals=require('scrummer.widget.modal');const helpers=require('scrummer.helpers');const Attachments=require('scrummer.attachments');const DataServiceFactory=require('scrummer.data_service_factory');const web_core=require("web.core");const _t=web_core._t;const dialog=require('scrummer.dialog');const mixins=require('scrummer.mixins');const ActivityStream=require('scrummer.activity_stream').ActivityStream;const hash_service=require('scrummer.hash_service');const TimeSheetListItem=AbstractModelList.AbstractModelListItem.extend({template:"scrummer.task.timesheets.line",removeConfirmation:{title:_t("Delete worklog"),message:_t("Are you sure that you want to delete this workflow?"),okText:_t("Yes")},init(parent,options){this._super(parent,options);this.formated_time=helpers.time.format(this.record.unit_amount);},canEdit(){return this.record.user_id[0]===data.session.uid;},addedToDOM(){this._super();this.$('.tooltipped').tooltip({delay:50});},start(){this.$(".remove-timesheet").click(this.remove.bind(this));this.$(".edit-timesheet").click(()=>{const modal=new AgileModals.WorkLogModal(this,{task:this.task,userId:data.session.uid,edit:this.record,afterHook:(workLog)=>{this.updateWorklog(workLog);}});modal.appendTo($("body"));});return this._super();},updateWorklog(){const oldUnitAmount=this.record._previous.unit_amount;this.formated_time=helpers.time.format(this.record.unit_amount);this.$(".formated_time").text(this.formated_time);this.$(".date").text(this.record.date);this.$(".name").text(this.record.name);this.trigger_up("worklog_updated",{ammount:this.record.unit_amount-oldUnitAmount});},});TimeSheetListItem.sort_by="date";const TaskWidget=BaseWidgets.DataWidget.extend(mixins.MenuItemsMixin,{_name:"TaskWidget",template:"scrummer.task",menuItems:[{class:"assign-to-me",icon:"mdi-account-check",text:_t("Assign To Me"),callback:'_onAssignToMeClick',sequence:1,hidden(){return this.data_service.getRecord(this.id).then((task)=>task.user_id&&task.user_id[0]===data.session.uid);},},{class:"unassign",icon:"mdi-account-minus",text:_t("Unassign"),callback:'_onUnassignClick',sequence:2,hidden(){return this.data_service.getRecord(this.id).then((task)=>!(task.user_id&&task.user_id[0]===data.session.uid));},},{class:"edit-item",icon:"mdi-pencil",text:_t("Edit"),callback:'_onEditItemClick',sequence:3,},{class:"add-sub-item",icon:"mdi-subdirectory-arrow-right",text:_t("Add Sub Item"),callback:'_onAddSubItemClick',sequence:4,hidden(){return this.data_service.getRecord(this.id).then((task)=>DataServiceFactory.get("project.task.type2").getRecord(task.type_id[0]).then((task_type)=>!task_type.allow_sub_tasks));},},{class:"add-link",icon:"mdi-link",text:_t("Add Link"),callback:'_onAddLinkClick',sequence:5,},{class:"work-log",icon:"mdi-worker",text:_t("Log Work"),callback:'_onWorkLogClick',sequence:6,},{class:"add-comment",icon:"mdi-comment-account",text:_t("Add Comment"),callback:'_onAddCommentClick',sequence:7,},{class:"delete",icon:"mdi-delete",text:_t("Delete"),callback:'_onDelete',sequence:8,},],custom_events:Object.assign({},BaseWidgets.DataWidget.prototype.custom_events||{},{"attachment_upload_started":"_onAttachmentUploadStarted","attachment_upload_finished":"_onAttachmentUploadFinished",}),init(parent,options){mixins.MenuItemsMixin.init.call(this);this.data_service=DataServiceFactory.get("project.task",false);this._super(parent,options);this.taskLinksWidget=new TaskLinks(this,{task_id:this.id});this.helpers=helpers;},isBeingEdited(){return this._model._edit("check");},startEditing(){this.editingPromise=$.Deferred();this._model._edit(this.editingPromise);},stopEditing(writed=true){writed?this.editingPromise.resolve():this.editingPromise.reject();},willStart(){const superPromise=this._super();this.subtasksPromise=$.Deferred();this.timesheetsPromise=$.Deferred();this.tagsPromise=$.Deferred();this.attachmentsPromise=$.Deferred();superPromise.then(()=>{this.data_service.getRecords(this._model.child_ids).then(this.subtasksPromise.resolve,this.subtasksPromise.reject);DataServiceFactory.get("account.analytic.line").getRecords(this._model.timesheet_ids).then(this.timesheetsPromise.resolve,this.timesheetsPromise.reject);if(this._model.tag_ids.length>0){data.getDataSet("project.tags").read_ids(this._model.tag_ids,["name","color"]).then(this.tagsPromise.resolve,this.tagsPromise.reject);}else{this.tagsPromise.reject();}
data.getDataSet("ir.attachment").read_ids(this._model.attachment_ids,["name","datas_fname","local_url","create_uid","create_date","mimetype"]).then(this.attachmentsPromise.resolve,this.attachmentsPromise.reject);});return superPromise.then(()=>DataServiceFactory.get("project.task.type2").getRecord(this._model.type_id[0]).then((task_type)=>{this.task_type=task_type;}));},renderElement(){this.project_image=data.getImage("project.project",this._model.project_id[0],this._model.project_last_update);this._super();this.subtasksPromise.then((result)=>{this.subtaskList=new AbstractModelList.ModelList(this,{template:"scrummer.backlog.task_list",model:"project.task",ModelItem:ModelList.SimpleTaskItem,itemExtensions:{template:"scrummer.task.task_widget_task_item",},_name:"Task Sub-tasks",data:result,attributes:{"data-id":this.id},});this.subtaskList.appendTo(this.$(".collapsible li.subtasks .collapsible-body"));if(result.length<1){this.$(".collapsible li.subtasks").hide();}});this.tagsPromise.then((result)=>{const tagContainer=this.$("[data-field='tag_ids']");for(const tag of result){tagContainer.append($(`<span class="tag o_tag_color_${tag.color}">${tag.name}</span>`));}
this.$("[data-field-name='tag_ids']").show();});this.timesheetsPromise.then((result)=>{this.timesheetList=new AbstractModelList.ModelList(this,{_name:"Task Timesheets",template:"scrummer.task.timesheets",model:"account.analytic.line",custom_events:{remove_item:function(evt){this.trigger_up("worklog_updated",{ammount:evt.data.itemData.unit_amount*-1});this.removeItem(evt.data.id,true,true);}},ModelItem:TimeSheetListItem,itemExtensions:{task:this._model,},data:result,attributes:{"data-id":this.id}});this.timesheetList.appendTo(this.$(".collapsible li.timesheets .collapsible-body"));if(result.length<1){this.$(".collapsible li.timesheets").hide();}});this.activityStream=new ActivityStream(this,{showMessageName:true,task_ids:[this.id]});this.activityStream.appendTo(this.$(".collapsible li.comments .collapsible-body"));this.taskLinksWidget.appendTo(this.$(".collapsible li.links .collapsible-body"));this.taskLinksWidget._is_rendered.then(()=>{if(this.taskLinksWidget.links.length>0){this.$(".collapsible li.links").show();}});this.attachmentsPromise.then((attachments)=>{this.attachmentsData=attachments;const placeholderNode=this.$(".collapsible li.attachments .collapsible-body");this.attachmentsWidget=new Attachments.AttachmentsWidget(this,{attachments,res_id:this.id,res_model:"project.task"});this.attachmentsWidget.appendTo(placeholderNode);});this.task_type.allow_story_points||this.$("[data-field-name=story_points]").hide();this._model.date_deadline||this.$("[data-field-name=date_deadline]").hide();this._model.planned_hours||this.$("[data-field-name=planned_hours]").hide();this._model.resolution_id||this.$("[data-field-name=resolution_id]").hide();},start(){mixins.MenuItemsMixin.start.call(this);if(this.isQuickDetailView){this.trigger_up("init_action_menu",{items:(el)=>{const slider=$('<div id="right-slide-controller"><input type="text" name="Right part width" value=""/></div>');slider.appendTo(el);const values=["15/85","30/70","50/50","70/30","85/15"];let from=0;const leftFlexGrow=$(".slide-wrapper .slide-part")[0].style.flexGrow;if(leftFlexGrow){while(!values[from].startsWith(leftFlexGrow.toString())){from++;}}else{from=2;}
slider.find("input").ionRangeSlider({values,from,grid:false,hide_min_max:true,hide_from_to:true,onChange(evtData){const parts=evtData.from_value.split("/");$(".slide-wrapper .slide-part")[0].style.flexGrow=parseInt(parts[0],10);$(".slide-wrapper .slide-part")[1].style.flexGrow=parseInt(parts[1],10);},});const removeActionMenu=$.Deferred();this._destroyed.promise().then(()=>{slider.remove();removeActionMenu.resolve(this);});return removeActionMenu.promise();}});this.$(".task-key").click((e)=>{const taskId=$(e.currentTarget).attr("task-id");hash_service.setHash("task",taskId,false);hash_service.setHash("view","task",false);hash_service.setHash("page","board");});}
this._is_added_to_DOM.then(()=>{this.$('.collapsible').collapsible();this.$('.dropdown-button').dropdown();this.$('.dropify').dropify();});this.$(".we").on('click',function(){const input=$('<input />',{'type':'text','name':'unique','value':$(this).find('span').html()});const saveDiscardSpan=$('<span class="we-save-discard"><i class="mdi mdi-check"></i><i class="mdi mdi-close"></i></span>');$(this).empty().append(input).append(saveDiscardSpan);input.focus();input.blur(function(){$(this).parent().empty().append($('<span />').html($(this).val()));});});this.$(".card-close").click(()=>this.destroy(true));this.$("#task-description .btn-edit").click(this.editDescription.bind(this));this.$("#task-description .btn-save").hide().click(this.saveDescription.bind(this));this.$("#task-description .btn-discard").hide().click(this.discardDescription.bind(this));if(!(this._model.effective_hours&&this._model.effective_hours>0)){this.$("[data-field-name=effective_hours]").hide();}
if(!(this._model.planned_hours&&this._model.planned_hours>0)){this.$("[data-field-name=planned_hours]").hide();}
if(!this._model.date_deadline){this.$("[data-field-name=date_deadline]").hide();}
window.task=this;return this._super();},editDescription(){this.startEditing();this.originalDescription=this.$('.materialnote').html();this.$('.materialnote').materialnote({height:100,defaultBackColor:'#fff',focus:true});this.$("#task-description .btn-edit").hide();this.$("#task-description .btn-save").show();this.$("#task-description .btn-discard").show();},saveDescription(){this.stopEditing(false);const description=this.$('.materialnote').code();this._model.description=description;this.$('.materialnote').destroy();this.$("#task-description .btn-edit").show();this.$("#task-description .btn-save").hide();this.$("#task-description .btn-discard").hide();},discardDescription(){this.$('.materialnote').code(this.originalDescription);delete this.originalDescription;this.$('.materialnote').destroy();this.$("#task-description .btn-edit").show();this.$("#task-description .btn-save").hide();this.$("#task-description .btn-discard").hide();this.stopEditing();},highlightNewWidget(newWidget){newWidget._is_added_to_DOM.then(()=>{this.$el.parent().scrollToElement(newWidget.$el);newWidget.$el.highlight();});},removeParent(){this.$(".parent-key").hide();},_onAssignToMeClick(){this._model.user_id=data.session.uid;},_onUnassignClick(){this._model.user_id=false;},_onEditItemClick(){const newItemModal=new AgileModals.NewItemModal(this,{currentProjectId:this._model.project_id[0],edit:this._model,});newItemModal.appendTo($("body"));},_onAddSubItemClick(){const newItemModal=new AgileModals.NewItemModal(this,{currentProjectId:this._model.project_id[0],parent_id:this._model.id,});newItemModal.appendTo($("body"));},_onAddLinkClick(){const modal=new AgileModals.LinkItemModal(this,{task:this._model,});modal.appendTo($("body"));},_onWorkLogClick(){const modal=new AgileModals.WorkLogModal(this,{task:this._model,userId:data.session.uid,});modal.appendTo($("body"));},_onAddCommentClick(){const modal=new AgileModals.CommentItemModal(this,{task:this._model,});modal.appendTo($("body"));},_onDelete(){dialog.confirm(_t("Delete task"),_t("Are you sure you want to delete this task?"),_t("yes")).done(()=>{this._model.unlink();});},_onAttachmentUploadStarted(){this.startEditing();},_onAttachmentUploadFinished(){this.data_service.updateRecord([this.id]).then(()=>this.stopEditing());}});return{TaskWidget,TimeSheetListItem};});;

/* /scrummer/static/src/js/widgets/task_links.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.widget.task.links',function(require){"use strict";const ScrummerData=require('scrummer.data');const ModelList=require('scrummer.model_list');const AbstractModelList=require('scrummer.abstract_model_list');const BaseWidgets=require('scrummer.BaseWidgets');const LinkGroupWidget=BaseWidgets.AgileBaseWidget.extend({template:"scrummer.task.link.group",_name:"LinkGroupWidget",init(parent,options){this._super(parent,options);Object.assign(this,options);this._require_prop("relation");this._require_prop("links");this.taskLinkList=new AbstractModelList.ModelList(this,{model:"project.task",ModelItem:ModelList.SimpleTaskItem,itemExtensions:{template:"scrummer.task.task_widget_task_item",},_name:"Link Group Widget",data:this.links,attributes:{"data-relation-name":this.relation}});},renderElement(){this._super();this.taskLinkList.appendTo(this.$(".collection"));},addLink(link){this.links.push(link);return this.taskLinkList.addItem(link.related_task,{"data-link-id":link.id});},removeLink(id){const link=this.links.find((l)=>l.id===id);if(!link){return false;}
this.links=this.links.filter((l)=>l.id!==id);ScrummerData.getDataSet("project.task.link").unlink([link.id]);}});const TaskLinks=BaseWidgets.AgileBaseWidget.extend({_name:"TaskLinks",init(parent,options){this._super(parent,options);Object.assign(this,options);this._require_prop("task_id");},willStart(){return this._super().then(()=>{const linksPromise=ScrummerData.getTaskLinks(this.task_id).then((links)=>{this.links=links;});const relationsPromise=ScrummerData.cache.get("project.task.link.relation.nameOrderMaps").then((nameToOrderMap,orderToNameMap)=>{this.nameToOrderMap=nameToOrderMap;this.orderToNameMap=orderToNameMap;});return $.when(linksPromise,relationsPromise);});},renderElement(){this._super();this.groups=window.groups=new Map();for(const relationOrder of[...this.orderToNameMap.keys()].sort()){const relation=this.orderToNameMap.get(relationOrder);const linkGroup=new LinkGroupWidget(this,{relation,links:[]});this.groups.set(relation,linkGroup);linkGroup.appendTo(this.$el);linkGroup.$el.hide();}
for(const link of this.links){this.addLink(link,false);}},addLink(link,addToList=true){if(addToList){this.links.push(link);}
const linkGroup=this.groups.get(link.relation_name);linkGroup.$el.show();return linkGroup.addLink(link);}});return{TaskLinks,LinkGroupWidget};});;

/* /scrummer/static/src/js/widgets/modal_widget.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.widget.modal',function(require){"use strict";const BaseWidgets=require('scrummer.BaseWidgets');const DataServiceFactory=require('scrummer.data_service_factory');const scrummer_data=require('scrummer.data');const helpers=require('scrummer.helpers');const Many2One=require('scrummer.widget.many2one').Many2One;const Many2ManyTags=require('scrummer.widget.many2many_tags').Many2ManyTags;const _t=require("web.core")._t;const Attachments=require('scrummer.attachments');const hash_service=require('scrummer.hash_service');const Materialize=window.Materialize;const ModalWidget=BaseWidgets.AgileBaseWidget.extend({validateOptions:{},init(parent,options){this._super(parent,options);Object.assign(this,options);this.defaults=typeof this.defaults==="object"?Object.assign({},this.getDefaults(),this.defaults):this.getDefaults();this.setEditingState();},prepareSelection(options){const{field,data,key="id",value="name",mdi,iconColor,selectedValue,changeHandler}=options;const optionNodes=[];const array=Array.isArray(data)?data:Object.keys(data).map((k)=>data[k]);for(const element of array){const option=$('<option value="'+element[key]+'">'+element[value].trim()+'</option>');if(mdi){option.data("mdi",element[mdi]);}
if(iconColor){option.data("iconColor",element[iconColor]);}
optionNodes.push(option);}
const selectionNode=this.$("form [name='"+field+"']");selectionNode.find("option:not(:first)").remove();selectionNode.removeClass().append(...optionNodes);if(selectedValue){selectionNode.val(selectedValue);if(changeHandler){changeHandler.bind(selectionNode[0])();}}
selectionNode.material_select();selectionNode.off().change(function(){$(this).valid();if(changeHandler){changeHandler.bind(this)();}});},setEditingState(){},setDefaultState(){},start(){const form=this.$("form");if(form.data("validator")){Object.assign(form.data("validator").settings,this.getValidateOptions());}else{form.validate(this.getValidateOptions());}
form.submit((e)=>{e.preventDefault();if(!this.submitting){return;}
this.submitting=false;if(!$(e.target).valid()){return;}
const formData=$(e.target).serializeObject();this.$("[data-is-dirty='false']").each(function(){delete formData[this.name];});this.loadData(formData);if(typeof this.beforeHook==="function"){this.beforeHook(formData);}
if(Object.keys(formData).length){const submitDef=this.submit(formData,$(e.target));if(typeof this.afterHook==="function"){$.when(submitDef).then((result)=>{this.afterHook(result,formData,$(e.target));});}}
this.closeModal();});this.$(".modal-submit").click(this.confirmationHandler.bind(this));return this._super();},beforeCloseModal(){return true;},closeModal(){if(this.beforeCloseModal()){this.$el.materialModal("close");}},destroy(){this.setDefaultState();return this._super.apply(this,arguments);},getDefaults(){return{};},loadData(data){},confirmationHandler(){this.submitting=true;this.$("form").submit();},getValidateOptions(){return{ignore:".note-editable"};},submit(){console.warn("Modal form submit method not implemented!");},addedToDOM(){const modalWidgetThis=this;this.$el.materialModal({dismissible:false,ready:modalWidgetThis.modalReady.bind(this),complete:modalWidgetThis.destroy.bind(this),});this.$(".planned_hours_help").tooltip({tooltip:"Combine: w-weeks, d-days, h-hours, m-minutes. (1 day means 8 hours) Separate with space.",position:"left",});this.$el.materialModal("open");this.$(".materialnote").materialnote({toolbar:this.materialnoteToolbar,height:100,defaultBackColor:'#fff',focus:true,});this.$('.datepicker').pickadate({selectMonths:true,selectYears:15,today:'Today',clear:'Clear',close:'Ok',format:'yyyy-mm-dd',closeOnSelect:false});if(this.edit){this.populateMaterialNote();}
this.$el.on("keydown.modal",(e)=>{if(e.keyCode===27){this.closeModal();}});return this._super();},modalReady(){Materialize.updateTextFields();if(this.focus){this.$("form [name="+this.focus+"]").focus();}},renderElement(){this._super();if(this.edit){this.populateFieldValues();}},populateFieldValues(){throw new Error("In order to open modal in edit mode, populateFieldValues should be overriden.");},populateMaterialNote(){throw new Error("In order to open modal in edit mode with materialNote, populateMaterialNote should be overriden.");},materialnoteToolbar:[['style',['style','bold','italic','underline','strikethrough','clear']],['fonts',['fontsize','fontname']],['color',['color']],['undo',['undo','redo']],['ckMedia',['ckImageUploader','ckVideoEmbeeder']],['misc',['link','table','hr','codeview','fullscreen']],['para',['ul','ol','paragraph','leftButton','centerButton','rightButton','justifyButton','outdentButton','indentButton']],['height',['lineheight']]],});const NewItemModal=ModalWidget.extend({template:"scrummer.widget.modal.new_item",focus:"name",init(parent,options){this._super(parent,options);this.board_id=parseInt(hash_service.get("board"),10);this._require_prop("board_id","board_id is not set in url");if(this.edit){if(!this.edit._is_dataservice){throw new Error("edit option must be instance of dataservice!");}
this.currentProjectId=this.edit.project_id[0];if(this.edit.parent_id){this.parent_id=this.edit.parent_id[0];}}},willStart(){const superPromise=this._super().then(DataServiceFactory.get("project.agile.board").getRecord(this.board_id).then((board)=>{this.board=board;}));if(this.is_sub_item()){return superPromise.then(()=>DataServiceFactory.get("project.task").getRecord(this.parent_id).then((parent)=>{this.parent=parent;}));}
return superPromise;},is_sub_item:function(){return this.parent_id;},renderElement(){this._super();if(this.edit&&!this.edit.date_deadline){this.$("input[name='date_deadline']").val("");}
const thisModal=this;this.projectMany2one=new Many2One(this,{label:_t("Project"),model:"project.project",field_name:"project_id",className:"s12 m6 l6",domain:scrummer_data.cache.get("current_user").then((user)=>[["board_ids","=",this.board_id],["id","in",user.team_ids[user.team_id[0]].project_ids],]),changeHandler(evt){thisModal.currentProjectId=parseInt(evt.target.value,10);thisModal.projectChanged();},default:this.edit&&this.edit.project_id?{id:this.edit.project_id[0],name:this.edit.project_id[1]}:this.parent&&this.parent.project_id?{id:this.parent.project_id[0],name:this.parent.project_id[1]}:this.defaults&&this.defaults.project?this.defaults.project:null});this.projectMany2one.appendTo(this.$("#project_id_placeholder"));if(this.edit){this.resolutionMany2one=new Many2One(this,{label:_t("Resolution"),model:"project.task.resolution",field_name:"resolution_id",default:this.edit.resolution_id?{id:this.edit.resolution_id[0],name:this.edit.resolution_id[1]}:null,});this.resolutionMany2one.appendTo(this.$("#resolution_id_placeholder"));}
const tagsOptions={comodel:"project.tags",};this.edit&&Object.assign(tagsOptions,{res_ids:this.edit.tag_ids,});this.tagsMany2Many=new Many2ManyTags(this,tagsOptions);this.tagsMany2Many.appendTo(this.$("#tags_placeholder"));if(this.edit){this.$("#project_id_placeholder, #resolution_id_placeholder, #tags_placeholder").addClass("col s12 m4 l4");}else{this.$("#project_id_placeholder, #tags_placeholder").addClass("col s12 m6 l6");}},loadData(task){if(!(task.date_deadline&&task.date_deadline.length)){task.date_deadline=false;}
task.tag_ids=[[6,false,this.tagsMany2Many.val().map((id)=>parseInt(id,10))]];task.description=this.$(".materialnote").code();task.story_points=task.story_points?task.story_points:0;if(this.is_sub_item()&&!this.edit){task.sprint_id=this.parent.sprint_id?this.parent.sprint_id[0]:false;task.agile_order=this.parent.agile_order+0.01;}
const planned_hours_raw=this.$("input[name='planned_hours']").val();try{if(planned_hours_raw){task.planned_hours=helpers.time.parse(planned_hours_raw);}}catch(e){console.error(e);return;}},getValidateOptions(){return{...this._super(),...{rules:{type_id:"required",priority_id:"required",project_id:"required",name:"required",story_points:"number",planned_hours:"scrummer.time",date_deadline:"date",},messages:{story_points:_t("Estimate should be in story points (number)")}}};},submit(task){if(this.is_sub_item()&&!this.edit){task.parent_id=this.parent.id;}
if(this.edit){return this.edit.write(task);}
return scrummer_data.getDataSet("project.task").create(task);},start(){if(this.currentProjectId){this.projectChanged();}else{this.prepareSelection({field:"type_id",data:[],mdi:"scrummer_icon",iconColor:"scrummer_icon_color",});this.preparePriority();}
if(this.is_sub_item()&&!this.edit){this.$("#add-task-modal-project").attr("readonly",1);this.$("#new_item_modal_parent_name").val(this.parent.name);this.$(".modal-content h4").html("<i class='mdi mdi-subdirectory-arrow-right'/> Add subtask");}else{this.$(".parent").hide();}
return this._super();},addedToDOM(){if(this.edit){this.$(".materialnote").parent().hide();}
return this._super();},getAllowedTypes(){const allowedTypes={};const task_types=this.parent?this.types[this.parent.type_id[0]].type_ids:this.project_types;const table_allowed_task_types=this.board.table_task_type_ids;if(table_allowed_task_types&&table_allowed_task_types.length>0){for(const type_id of task_types){if(table_allowed_task_types.includes(type_id)){allowedTypes[type_id]=this.types[type_id];}}}else{for(const type_id of task_types){allowedTypes[type_id]=this.types[type_id];}}
return allowedTypes;},getSelectedType(allowedTypes){return this.edit?this.edit.type_id[0]:Object.keys(allowedTypes).length===1?Object.keys(allowedTypes)[0]:this.currentProjectId?this.project.default_task_type_id[0]:null;},projectChanged(){const thisModal=this;$.when(DataServiceFactory.get("project.project",true).getRecord(this.currentProjectId),scrummer_data.cache.get("project.type.task_types_priorities",{id:this.currentProjectId})).then((project,result)=>{Object.assign(this,result);this.project=project;const allowedTypes=this.getAllowedTypes();const selectedType=this.getSelectedType(allowedTypes);this.prepareSelection({field:"type_id",data:allowedTypes,mdi:"scrummer_icon",iconColor:"scrummer_icon_color",selectedValue:selectedType,changeHandler:function(){thisModal.preparePriority(this.value);this.value&&thisModal.types[this.value].allow_story_points?thisModal.$(".estimate").show():thisModal.$(".estimate").hide();}});const selectedPriority=this.edit?this.edit.priority_id[0]:null;this.preparePriority(selectedType,selectedPriority);});},preparePriority(type_id,priority_id){if(!type_id){this.prepareSelection({field:"priority_id",data:[]});return;}
const prioritiesForType=this.types[type_id].priority_ids.map((key)=>this.priorities[key]);const defaultPriority=priority_id||this.types[type_id].default_priority_id;this.prepareSelection({field:"priority_id",data:prioritiesForType,mdi:"scrummer_icon",iconColor:"scrummer_icon_color",selectedValue:defaultPriority});this.$("form [name=priority_id]").valid();},populateFieldValues(){this.$("input[name=name]").val(this.edit.name.trim());this.$("input[name=story_points]").val(this.edit.story_points);this.formated_time=helpers.time.format(this.edit.planned_hours);this.$("input[name=planned_hours]").val(this.formated_time);this.$("input[name=date_deadline]").val(this.edit.date_deadline);this.$(".modal-submit").text("Update");},populateMaterialNote(){this.$(".materialnote").code(this.edit.description);},setEditingState(){if(this.edit){if(this.edit._is_dataservice){this.editingPromise=$.Deferred();this.edit._edit(this.editingPromise);}
if(this.edit.parent_id){DataServiceFactory.get("project.task").getRecord(this.edit.parent_id[0]).then((record)=>{this.parentRecord=record;this.parentEditingPromise=$.Deferred();this.parentRecord._edit(this.parentEditingPromise);});}}},setDefaultState(){if(this.edit){if(this.edit._is_dataservice){this.editingPromise.resolve();}
if(this.edit.parent_id){this.parentEditingPromise.resolve();}}},});const TaskStageConfirmationModal=ModalWidget.extend({template:"scrummer.widget.modal.task_stage_confirmation",focus:"name",init(parent,options){this._super(parent,options);this._require_prop("taskId");this._require_prop("stageId");this._require_prop("stageName");this._require_prop("userName");},willStart(){return $.when(this._super(),scrummer_data.cache.get("current_user").then((user)=>scrummer_data.cache.get("team_members",{teamId:user.team_id[0]})).then((members)=>{this.members=members;}));},renderElement(){this._super(arguments);this.resolutionMany2one=new Many2One(this,{label:_t("Resolution"),model:"project.task.resolution",field_name:"resolution_id",});this.resolutionMany2one.insertAfter(this.$("input[name='stage_id']").closest(".input-field"));},loadData(confirmation){confirmation.log_message=Boolean(confirmation.log_message);confirmation.message=this.$(".materialnote").code();},submit(confirmation,form){const taskId=form.find("#task_id").val();confirmation.stageName=this.stageName;const payload={"values":{stage_id:confirmation.stage_id,resolution_id:confirmation.resolution_id},"message":confirmation.message,"log_message":confirmation.log_message,};return scrummer_data.session.rpc(`/scrummer/web/data/task/${taskId}/confirm_stage_change`,payload);},start(){this.$("#task_id").val(this.taskId);this.$("#stage_id").val(this.stageId);this.$("#stage_name").val(this.stageName);this.$("#user_name").val(this.userName);return this._super();}});const WorkLogModal=ModalWidget.extend({_name:"WorkLogModal",template:"scrummer.widget.modal.work_log",focus:"unit_amount",init(parent,options){this._super(parent,options);this._require_obj("task");if(!this.task._is_dataservice){throw new Error("task option must be instance of dataservice!");}
this._require_prop("userId");},setEditingState(){if(this.task&&this.task._is_dataservice){this.editingPromise=$.Deferred();this.task._edit(this.editingPromise);}},setDefaultState(){if(this.task&&this.task._is_dataservice){this.editingPromise.resolve();}},loadData(worklog){worklog.user_id=this.edit?this.edit.user_id[0]:this.userId;worklog.task_id=this.task.id;const unit_amount_raw=this.$("#work_log_modal_unit_amount").val();try{if(unit_amount_raw){worklog.unit_amount=helpers.time.parse(unit_amount_raw);}}catch(e){console.error(e);return;}},submit(worklog){const aal_dataset=scrummer_data.getDataSet('account.analytic.line');worklog.is_timesheet=true;worklog.project_id=this.task.project_id[0];if(this.edit){return aal_dataset.write(this.edit.id,worklog).then(()=>{const aal_service=DataServiceFactory.get("account.analytic.line");return aal_service.updateRecord([this.edit.id]).then(()=>aal_service.getRecord(this.edit.id));});}
return aal_dataset.create(worklog);},renderElement(){this._super();this.$('#work_log_modal_task_name').val(this.task.name);if(!this.edit){this.$('#work_log_modal_date').val(moment().format("YYYY-MM-DD"));}},start(){this.$('.datepicker').pickadate({format:'yyyy-mm-dd',selectMonths:true,selectYears:1});return this._super();},addedToDOM(){this._super();this.$(".unit_amount_help").tooltip({tooltip:"Combine: w-weeks, d-days, h-hours, m-minutes. (1 day means 8 hours) Separate with space.",position:"left",});},populateFieldValues(){this.$('#work_log_modal_date').val(this.edit.date);this.formated_time=helpers.time.format(this.edit.unit_amount);this.$('#work_log_modal_unit_amount').val(this.formated_time);this.$('#work_log_modal_name').val(this.edit.name);this.$('.modal-submit').text("Update");},populateMaterialNote(){return;},getValidateOptions(){return{...this._super(),...{rules:{name:{required:true,minlength:15},unit_amount:{required:true,"scrummer.time":true},}}};},});const LinkItemModal=ModalWidget.extend({_name:"LinkItemModal",template:"scrummer.widget.modal.link_item",focus:"relation_id",init(parent,options){this._super(parent,options);this._require_obj("task");if(!this.task._is_dataservice){throw new Error("task option must be instance of dataservice!");}},setEditingState(){if(this.task&&this.task._is_dataservice){this.editingPromise=$.Deferred();this.task._edit(this.editingPromise);}},setDefaultState(){if(this.task&&this.task._is_dataservice){this.editingPromise.resolve();}},willStart(){return $.when(this._super(),DataServiceFactory.get("project.task.link.relation").getAllRecords().then((relations)=>{Object.assign(this,{relations});}));},loadData(link){link.comment=this.$(".materialnote").code();link.task_left_id=this.task.id;},submit(link){return scrummer_data.session.rpc('/scrummer/web/data/task/create_link',{link});},start(){this.prepareSelection({field:"relation_id",data:this.relations});this.taskRight=new Many2One(this,{label:_t("With item"),model:"project.task",field_name:"task_right_id",domain:this.task_ids?[["id","in",this.task_ids]]:scrummer_data.cache.get("current_user").then((user)=>[["id","!=",this.task_id],["project_id","in",user.team_ids[user.team_id[0]].project_ids]])});this.taskRight.insertAfter(this.$("#task_right_anchor"));return this._super();},getValidateOptions(){return{...this._super(),...{rules:{relation_id:"required",task_right_id:"required",},}};},});const CommentItemModal=ModalWidget.extend({_name:"CommentItemModal",template:"scrummer.widget.modal.comment_item",init(parent,options){this._super(parent,options);this._require_obj("task");if(!this.task._is_dataservice){throw new Error("task option must be instance of dataservice!");}},setEditingState(){if(this.task&&this.task._is_dataservice){this.editingPromise=$.Deferred();this.task._edit(this.editingPromise);}},setDefaultState(){if(this.task&&this.task._is_dataservice){this.editingPromise.resolve();}},willStart(){return $.when(this._super(),scrummer_data.xmlidToResId("mail.mt_comment").then((id)=>{this.commentSubtypeId=id;}));},renderElement(){this._super();if(this.edit){this.$(".modal-submit").text("Update");this.$(".modal-content h4").html("<i class='mdi mdi-comment-account'/> Update comment");}
this.attachmentsWidget=new Attachments.AttachmentsWidget(this,{attachments:[],res_id:this.task.id,res_model:"project.task"});this.attachmentsWidget.appendTo(this.$(".attachment"));},loadData(comment){comment.log_message=Boolean(comment.log_message);comment.body=this.$(".materialnote").code();comment.attachment_ids=this.attachmentsWidget.getIds();},submit(comment){if(!this.edit){return scrummer_data.session.rpc(`/scrummer/web/data/task/${this.task.id}/add_comment`,{comment});}
return scrummer_data.session.rpc(`/scrummer/web/data/task/${this.task.id}/update_comment/${this.edit.id}`,{comment});},populateFieldValues(){if(this.edit.subtype_id[0]===this.commentSubtypeId){this.$("input[name='log_message']").prop('checked',true);}},populateMaterialNote(){this.$(".materialnote").code(this.edit.body);}});return{ModalWidget,NewItemModal,TaskStageConfirmationModal,WorkLogModal,LinkItemModal,CommentItemModal,};});;

/* /scrummer/static/src/js/widgets/subheader.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.subheader',['scrummer.BaseWidgets'],function(require){"use strict";const AgileBaseWidgets=require('scrummer.BaseWidgets');const SubheaderWidget=AgileBaseWidgets.AgileBaseWidget.extend({_name:"SubheaderWidget",template:"scrummer.subheader",setTitle(title){if(typeof title==="string"){this.$(".view-title").html(`<div class="text-only">${title}</div>`);}else if(title instanceof jQuery){this.$(".view-title").empty().append(title);}}});return{SubheaderWidget};});;

/* /scrummer/static/src/js/widgets/many2one.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.widget.many2one',(require)=>{"use strict";const data=require('scrummer.data');const BaseWidgets=require('scrummer.BaseWidgets');const Materialize=window.Materialize;const Many2One=BaseWidgets.AgileBaseWidget.extend({template:"scrummer.widget.many2one",limit:8,init(parent,options){Object.assign(this,options);this._super(parent,options);this._require_prop("model");this.selectionIndex=0;this.isDirty=false;},renderElement(){this._super();if(this.default){$.when(this.default).then((def)=>{if(def){if(!def.name||!def.id){throw new Error("If default value is passed it has to contain 'id' and 'name' properties.");}
this.$("input.name").val(def.name);this.$("input.id").val(def.id);}});}
this.$("input.id").attr("data-error",".err-"+this.field_name);$('<div class="err-'+this.field_name+'"></div>').insertAfter(this.$(".m2o-wrapper"));this.setReadonly(this.readonly);},addedToDOM(){Materialize.updateTextFields();},start(){if(typeof this.changeHandler==="function"){this.$("input.id").change(this.changeHandler.bind(this));}
this.$("input.name").on('keyup',(e)=>{if(e.which===13){this.$el.find(`li:nth-child(${this.selectionIndex})`).click();return;}
if(e.which===38){this.selectSuggestion(-1);return;}
if(e.which===40){this.selectSuggestion(1);return;}
this.$(".many2one-content").empty();this.isDirty=true;this.searchSuggestions();}).on('focusin',()=>{this.searchSuggestions();}).on('focusout',(e)=>{if(e.relatedTarget&&this.$el.has(e.relatedTarget).length===0){this.$(".many2one-content").empty();}});},selectSuggestion(positionOffset){if(positionOffset){this.selectionIndex=((this.selectionIndex-1+positionOffset+this.suggestions.length)%this.suggestions.length)+1;}else{this.selectionIndex=0;}
this.$el.find('li').removeClass("selected");this.$el.find(`li:nth-child(${this.selectionIndex})`).addClass("selected");},searchSuggestions(){const val=this.isDirty?this.$("input.name").val():"";data.getDataSet(this.model).name_search(val,this.domain,this.operator,this.limit).then((values)=>{const suggestions=values.map((e)=>({id:e[0],name:e[1]}));this.renderSuggestions(suggestions);});},renderSuggestions(suggestions){if(suggestions){this.suggestions=suggestions;}
const root=this.$(".many2one-content");root.empty();for(const suggestion of this.suggestions){const suggestionNode=this.renderSuggestion(suggestion);suggestionNode.click(this.suggestionClickHandler.bind(this));this.suggestions=root.append(suggestionNode);}},renderSuggestion(suggestion){return $(`<li data-id="${suggestion.id}"><span>${suggestion.name}</span></li>`);},suggestionClickHandler(e){const itemNode=$(e.target);this.$("input.name").val(itemNode.text().trim());this.$("input.id").val(itemNode.getDataFromAncestor("id"));this.$("input").trigger('change');this.$(".many2one-content").empty();if(this.$el.getDataFromAncestor("validator")){this.$("input.id").valid();}},setReadonly(state){this.$("input").attr("readonly",Boolean(state));}});return{Many2One};});;

/* /scrummer/static/src/js/widgets/many2many_tags.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.widget.many2many_tags',(require)=>{"use strict";const data=require('scrummer.data');const BaseWidgets=require('scrummer.BaseWidgets');const Many2ManyTags=BaseWidgets.AgileBaseWidget.extend({className:"chips chips-autocomplete input-field m2m-tags",limit:5,init(parent,options){Object.assign(this,options);this._super(parent,options);if(this.res_id){this._require_prop("model");if(!Array.isArray(this.res_ids)){this._require_prop("field_name","Since res_ids is not specified, field_name must be set in order to be fetched");}}
this._require_prop("comodel");this.tags={};},willStart(){return this._super().then(()=>{if(Array.isArray(this.res_ids)){if(this.res_ids.length===0){return;}
return this.fetchTags();}
if(!this.res_id){return;}
return data.getDataSet(this.model).read_ids([this.res_id],[this.field_name]).then((result)=>{this.res_ids=result[0][this.field_name];return this.fetchTags();});});},fetchTags(){return data.getDataSet(this.comodel).read_ids(this.res_ids,["name"]).then((result)=>{this.tags={};result.forEach((tag)=>{this.tags[tag.id]=tag;});return this.tags;});},val(){return this._getIds();},_getIds(){return Object.keys(this.tags);},beforeAddHook(elem){if(!elem.id){delete elem.id;return data.getDataSet(this.comodel).create(elem).then((id)=>{elem.id=id;return elem;});}
return $.when();},tagAdded(e,chip){this.tags[chip.id]=chip;},beforeDeleteHook(elem){return $.when();},tagDeleted(e,chip){return delete this.tags[chip.id];},addedToDOM(){const materialChipOptions={data:this.tags,placeholder:'Enter a tag',secondaryPlaceholder:'+Tag',beforeDeleteHook:this.beforeDeleteHook.bind(this),beforeAddHook:this.beforeAddHook.bind(this),autocompleteOptions:{customData:(val)=>data.getDataSet(this.comodel).name_search(val,[["id","not in",this._getIds()]],null,this.limit).then((result)=>{this.suggested_tags={};result.forEach((el)=>{this.suggested_tags[el[0]]={id:el[0],name:el[1]};});return this.suggested_tags;})}};this.$el.new_material_chip(materialChipOptions);this.$el.on('chip.add',this.tagAdded.bind(this));this.$el.on('chip.delete',this.tagDeleted.bind(this));},});return{Many2ManyTags};});;

/* /scrummer/static/src/js/widgets/activity_stream.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.activity_stream',function(require){"use strict";const data=require('scrummer.data');const AgileBaseWidget=require('scrummer.BaseWidgets').AgileBaseWidget;const DataServiceFactory=require('scrummer.data_service_factory');const AgileModals=require('scrummer.widget.modal');const core=require("web.core");const dialog=require('scrummer.dialog');const mixins=require("scrummer.mixins");const hash_service=require('scrummer.hash_service');const _t=core._t;const qweb=core.qweb;const ActivityStreamItem=AgileBaseWidget.extend(mixins.MenuItemsMixin,{template:"scrummer.activity.item",timeFormat:{sameDay:'[Today at] HH:MM',lastDay:'[Yesterday at] HH:MM',lastWeek:'dddd [at] HH:MM',sameElse:'DD/MM/YYYY [at] HH:MM'},menuItemsContainer:".activity-actions",menuItems:[{class:"edit-activity",icon:"mdi-pencil",hidden:"hideEditing",callback:"_onEditActivityClick",},{class:"remove-activity",icon:"mdi-delete",hidden:"hideEditing",callback:"_onRemoveActivityClick",}],init(parent,options){this._super.apply(this,arguments);Object.assign(this,options);mixins.MenuItemsMixin.init.call(this);},start(){mixins.MenuItemsMixin.start.call(this);return this._super();},willStart(){return $.when(this._super(),DataServiceFactory.get(this.message.model).getRecord(this.message.res_id).then((record)=>{this.record=record;}));},canEdit(){return this.message.message_type==="comment"&&this.user.partner_id[0]===this.message.author_id[0];},hideEditing(){return!this.canEdit();},formatTime(time){return moment(time).calendar(null,this.timeFormat);},setWriteDate(){this.$(".activity-item-write-date").remove();const tooltipString=this.message.author_id[1]+_t(" at ")+this.message.write_date;const writeDateNode=$('<span class="activity-item-write-date tooltipped" data-position="bottom" data-delay="50" data-tooltip="'+tooltipString+'"/>');writeDateNode.insertAfter(this.$(".activity-item-date"));writeDateNode.tooltip();},_onEditActivityClick(){const modal=new AgileModals.CommentItemModal(this,{task:this.record,edit:this.message,afterHook:(comment)=>{Object.assign(this.message,comment);this.$(".activity-body").html(comment.body);this.setWriteDate();}});modal.appendTo($("body"));},_onRemoveActivityClick(e){const id=$(e.currentTarget).getDataFromAncestor("object-id");dialog.confirm(_t("Are you sure?"),_t("You are about to delete the message!"),_t("Yes, delete"),_t("Cancel")).done(()=>{data.getDataSet("mail.message").unlink([id]).then(()=>{this.trigger_up("activity_deleted",{id});this.destroy();});});}});const ActivityStream=AgileBaseWidget.extend({Item:{Item:ActivityStreamItem},_name:"ActivityStream",template:"scrummer.activity.stream",limit:8,loadMoreStep:8,emptyPlaceholder:$("<div>"+_t("There are no activities.")+"</div>"),showMessageName:false,groupWeekDayFormat:{sameDay:'[Today]',lastDay:'[Yesterday]',lastWeek:'dddd',sameElse:'[Older]'},events:{"click .load-more-btn":"_onLoadMoreClick","click .activity-object":"_onActivityObjectClick",},custom_events:{"activity_deleted":"_onActivityDeleted"},init(parent,options){this._super(parent,options);Object.assign(this,options);this.itemWidgets=[];window.as=this;},willStart(){return $.when(this._super(),data.cache.get("current_user").then((user)=>{this.user=user;}),data.getMessageSubtypes("project.task").then((subtypes)=>{this.subtypes=subtypes;this.subtype_ids=subtypes.map((e)=>e.id);}));},loadData(){return data.session.rpc("/scrummer/activity-stream",{subtype_ids:this.subtype_ids,task_ids:this.task_ids,limit:this.limit,}).then((messages)=>{if(messages.length===0){this.$el.addClass("empty");}
this.prepareMessages(messages);this.itemWidgets.forEach((item)=>{item.destroy();});this.itemWidgets=[];this.$(".activity").empty();this.renderItems();});},prepareMessages(messages){this.messages=messages;this.groupWeekDays=new Map();this.lastMessage={};this.messages.forEach((m)=>{const weekday=this.formatGroupWeekDay(m.date);this.groupWeekDays.has(weekday)?this._isSameAuthor(m,this.lastMessage)?this.lastGroup.push(m):this.groupWeekDays.get(weekday).push(this.lastGroup=[m]):this.groupWeekDays.set(weekday,[this.lastGroup=[m]]);this.lastMessage=m;});},renderItems(){this.$(".list-preloader").hide();if(this.groupWeekDays.size){this.$el.removeClass("empty");}
if(this.messages.length>0&&this.limit<=this.messages.length){this.$(".load-more-btn").show();}else{this.$(".load-more-btn").hide();}
for(const[weekdayGroup,activityGroups]of this.groupWeekDays.entries()){this.$(".activity").append($(`<div class="activity-date">${weekdayGroup}</div>`));for(const activityGroup of activityGroups){const author=this.getAuthor(activityGroup[0]);const groupNode=$(qweb.render("scrummer.activity.group",{author}));this.$(".activity").append(groupNode);const groupContentNode=groupNode.find(".activity-group-content");for(const message of activityGroup){const itemWidget=new this.Item.Item(this,{message,user:this.user,showMessageName:this.showMessageName,});itemWidget.appendTo(groupContentNode);this.itemWidgets.push(itemWidget);}}}},renderElement(){this._super();this.$(".load-more-btn").hide();if(this.emptyPlaceholder){this.emptyPlaceholder.addClass("empty-placeholder");this.$el.append(this.emptyPlaceholder);}
this.loadData();},start(){this.$(".message-body").expander({slicePoint:140,expandEffect:"fadeIn",collapseEffect:"fadeOut"});},getAuthor(message){return{name:message.author_id[1],image:data.getImage("res.partner",message.author_id[0])};},formatGroupWeekDay(time){return moment(time).calendar(null,this.groupWeekDayFormat);},getActivityType(message){const isCommit=message.subtype_id&&message.subtype_id[1]==="Code committed";const isComment=message.message_type==="comment";return{subtype:message.subtype_id&&{id:message.subtype_id[0],name:message.subtype_id[1]},isCommit,message:isCommit?"Code pushed":isComment?"commented":message.subtype_id?message.subtype_id[1]:"commented"};},_isSameAuthor(m1,m2){if(m1.author_id[0]===0&&m2.author_id[0]===0){return m1.author_id[1]===m2.author_id[1];}
return m1.author_id[0]===m2.author_id[0];},_onLoadMoreClick(){this.$(".list-preloader").show();this.limit+=this.loadMoreStep;this.loadData();},_onActivityDeleted(evt){},_onActivityObjectClick(e){const model=$(e.currentTarget).getDataFromAncestor("object-model");const res_id=$(e.currentTarget).getDataFromAncestor("object-res-id");if(model==="project.task"){hash_service.setHash("task",res_id);hash_service.setHash("view","task");hash_service.setHash("page","board");}}});return{ActivityStream,ActivityStreamItem,};});;

/* /web_syncer/static/src/js/syncer.js defined in bundle 'scrummer.assets' */
odoo.define('web.syncer',function(require){"use strict";const bus=require('bus.bus');const session=require('web.session');class Callback{constructor(syncer,channel,callback){this.syncer=syncer;this.channel=channel;this.callback=callback;}
unsubscribe(){const callbackList=this.syncer.subscriptions.get(this.channel);callbackList.splice(callbackList.indexOf(this),1);}}
class Syncer{constructor(){this.subscriptions=new Map();}
subscribe(channel,callback,parent={}){if(typeof callback!=="function"){throw new Error("Syncer subscription needs to have callback of type function");}
bus.bus.add_channel(channel);const callbackObj=new Callback(this,channel,callback.bind(parent));if(this.subscriptions.has(channel)){this.subscriptions.get(channel).push(callbackObj);}else{this.subscriptions.set(channel,[callbackObj]);}
if(bus.bus.channels.length===1){this.setupListener();}
return callbackObj;}
setupListener(parent){bus.bus.on('notification',parent,(notifications)=>{notifications.forEach((notification)=>{if(this.subscriptions.has(notification[0])){this._notify(notification[0],notification[1]);}});});bus.bus.start_polling();}
sendMessage(channel,message){session.rpc("/longpolling/send",{channel,message});}
_notify(channel,message){if(this.subscriptions.has(channel)){const callbacks=this.subscriptions.get(channel);callbacks.forEach((callback)=>callback.callback(message));}}}
return{Callback,Syncer};});;

/* /scrummer_scrum/static/src/js/views/backlog.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer_scrum.view.backlog',function(require){"use strict";const BacklogView=require('scrummer.view.backlog');const data=require('scrummer.data');const DataServiceFactory=require('scrummer.data_service_factory');const dialog=require('scrummer.dialog');const DataWidget=require('scrummer.BaseWidgets').DataWidget;const hash_service=require('scrummer.hash_service');const pluralize=require('pluralize');const web_core=require('web.core');const _t=web_core._t;const core=require('scrummer.core');const field_utils=require('web.field_utils');const AgileToast=require('scrummer.toast');const ViewManager=require('scrummer.view_manager');const sprint_service=DataServiceFactory.get("project.agile.scrum.sprint",false);const SprintList=BacklogView.NonBacklogList.extend({_name:"SprintList",getAllTaskIds(){if(!this.generalFilteredTaskIds){this.generalFilteredTaskIds=this.sprintData.task_ids.filter((id)=>this.allFilteredTaskIds.includes(id));return this.generalFilteredTaskIds;}
return this.sprintData.task_ids.filter((id)=>this.generalFilteredTaskIds.includes(id));},addItem(){const modelItem=this._super.apply(this,arguments);!this.generalFilteredTaskIds.includes(modelItem.id)&&this.generalFilteredTaskIds.push(modelItem.id);return modelItem;}});const SprintDataWidget=DataWidget.extend({template:"scrummer.scrum.sprint",_name:"SprintDataWidget",custom_events:{add_item:function(evt){const itemData=evt.data.itemData;this.count[itemData.wkf_state_type]+=itemData.story_points;const wkf_state_class=".wkf_state_"+itemData.wkf_state_type;this.$(wkf_state_class).text(this.count[itemData.wkf_state_type]);this.$(".task-count").text((this.taskList.list.size||0)+" "+pluralize("issue",this.taskList.list.size));},remove_item:function(evt){const itemData=evt.data.itemData;const wkf_state_class=".wkf_state_"+itemData.wkf_state_type;this.count[itemData.wkf_state_type]-=itemData.story_points;this.$(wkf_state_class).text(this.count[itemData.wkf_state_type]);this.$(".task-count").text((this.taskList.list.size||0)+" "+pluralize("issue",this.taskList.list.size));},},init(parent,options){this._super(parent,options);this._require_prop("taskWidgetItemCache","JavaScript Map object where key is id, and value is cached widget item.");this._require_prop("allFilteredTaskIds","This is the array of ids that will be used for general filtering of tasks in list.");this.pluralize=pluralize;this.count={todo:0,in_progress:0,done:0,};},start_date_f(){return moment(moment.utc(this._model.start_date,"YYYY-MM-DD HH:mm:SS").toDate()).format("LLL");},end_date_f(){return moment(moment.utc(this._model.end_date,"YYYY-MM-DD HH:mm:SS").toDate()).format("LLL")},renderElement(){this._super();this.taskList=new SprintList(this,{template:"scrummer.backlog.task_list",model:"project.task",_getNewListWidget:this._getNewListWidget,taskWidgetItemCache:this.taskWidgetItemCache,allFilteredTaskIds:this.allFilteredTaskIds,ModelItem:this.TaskItemClass,id:this._model.id,name:this._model.name,attributes:{"data-id":this.id},sortable:{group:"backlog"},sprintData:this._model,});this.taskList.appendTo(this.$(".collapsible-body"));},addTask(task){this.taskList.addItem(task);},start(){this.$("#btn_delete").click(()=>{this.trigger_up("delete_sprint",{id:this.id});});this.$("#btn_up").click(()=>{this.trigger_up("move_sprint_up",{sprint:this});});this.$("#btn_down").click(()=>{this.trigger_up("move_sprint_down",{sprint:this});});this.$("#btn_start").click(()=>{this.trigger_up("start_sprint",{sprint:this});});this.$("#btn_end").click(()=>{this.trigger_up("end_sprint",{sprint:this});});return this._super();},addedToDOM(){this._super();this.$('.task-list-title, .context-menu').click((evt)=>{evt.stopPropagation();});$('.collapsible').collapsible();},});const BacklogTaskItem=BacklogView.SimpleBacklogTaskItem.extend({init(parent,options){this._super(parent,options);this.sprintId=this.record.sprint_id?this.record.sprint_id[0]:false;},setSprint(sprint_id){this.record.sprint_id=sprint_id;},set_list(listWidget,order){this.record.write({sprint_id:listWidget.id,[this.order_field]:order});}});BacklogTaskItem.sort_by="agile_order";const ScrumBacklogView=BacklogView.AbstractBacklogView.extend({custom_events:Object.assign({},BacklogView.AbstractBacklogView.prototype.custom_events||{},{delete_sprint:'_onDeleteSprint',move_sprint_up:'_onMoveSprintUp',move_sprint_down:'_onMoveSprintDown',start_sprint:'_onStartSprint',end_sprint:'_onEndSprint',}),menuItems:BacklogView.AbstractBacklogView.prototype.menuItems.concat([{class:"add-sprint",icon:"mdi-rotate-3d",text:_("Add new sprint"),callback:'_onAddNewSprintClick'},]),loadDependencies(){return this._super().then(()=>{this.sprint_ids=this.user.team_ids[this.user.team_id[0]].sprint_ids;});},willStart(){return this._super().then(()=>sprint_service.dataset.id_search("",this.getSprintDomain()).then((sprint_ids)=>sprint_service.getRecords(sprint_ids)).then((sprints)=>{this.sprintMap=new Map();this.ordered_sprint_ids=[];for(const sprint of sprints.sort((a,b)=>a.order-b.order).sort((a,b)=>{if(a.state<b.state){return-1;}
if(a.state>b.state){return 1;}
return 0;})){this.ordered_sprint_ids.push(sprint.id);this.sprintMap.set(sprint.id,sprint);}}));},sprintBacklogStatesFilterExists(){return this.board.scrum_backlog_state_ids&&this.board.scrum_backlog_state_ids.length>0;},getBacklogTaskDomain(){return this._super().then((domain)=>{domain.push(["sprint_id","=",false]);if(this.sprintBacklogStatesFilterExists()){domain.push(["wkf_state_id","in",this.board.scrum_backlog_state_ids]);}
return domain;});},getSprintDomain(){return[["state","!=","completed"],["id","in",this.sprint_ids]];},getApplyFilterDomain(){return this._super().then((domain)=>{Array.prototype.push.apply(domain,["|",["sprint_state","in",["draft","active"]],["sprint_id","=",false],"|",["sprint_id","in",this.sprint_ids],"&",["sprint_id","=",false],["wkf_state_type","!=","done"],]);if(this.sprintBacklogStatesFilterExists()){const states_domain=["wkf_state_id","in",this.board.scrum_backlog_state_ids];domain.splice(domain.length-6,0,"&");domain.splice(domain.length-5,0,states_domain);domain.splice(domain.length-1,0,"&");domain.splice(domain.length,0,states_domain);}
return domain;});},sprintTaskIds(){const result=[];for(const sprint of this.sprintWidgetsMap.values()){Array.prototype.push.apply(result,sprint._model.task_ids);}
return result;},handleFilter(task_ids){for(const sprintWidget of this.sprintWidgetsMap.values()){sprintWidget.taskList.applyFilter(task_ids);}
this._super(task_ids);},allTaskIds(){const taskIds=[];Array.prototype.push.apply(taskIds,this._super());Array.prototype.push.apply(taskIds,this.sprintTaskIds());return taskIds;},renderElement(){this._super();this.lastest_sprint_order=0;this.sprintWidgetsMap=new Map();for(const sprint_id of this.ordered_sprint_ids){const sprint=this.sprintMap.get(sprint_id);const sprintWidget=this.addSprint(sprint);if(sprint.state==="active"){this.active_sprint=sprintWidget;}}
this.renderSprintState();},_getNewListWidget(sprint_id){if(sprint_id&&this.sprintWidgetsMap.has(sprint_id)){return this.sprintWidgetsMap.get(sprint_id).taskList;}
return this.backlogTaskList;},getTaskListOfTaskWidget(taskWidget){return this._getNewListWidget(taskWidget.sprintId);},isTaskInBacklog(task){return!task.sprint_id;},isTaskWidgetInBacklog(taskWidget){const state=taskWidget.record._previous||taskWidget.record;return this.isTaskInBacklog(state);},_getTaskItemClass(){return BacklogTaskItem;},prepareShortcuts(list_id){const listId=list_id||false;const shortcuts=[...this.sprintWidgetsMap.values()].sort((a,b)=>a._model.order>b._model.order).map((a)=>({id:a._model.id,name:a._model.name.trim()}));shortcuts.push({id:false,name:_("Backlog"),});const current=shortcuts.find((a)=>a.id===listId);current.positioner=true;return shortcuts;},addTaskToNonBacklogList(task){const sprint_id=task.sprint_id[0];const sprintWidget=this.sprintWidgetsMap.get(sprint_id);if(!sprintWidget){return;}
return sprintWidget.taskList.addItem(task);},bindEventListeners(){this._super();core.bus.on("project.agile.scrum.sprint:write",this,this._onProjectAgileScrumSprintWrite);core.bus.on("project.agile.scrum.sprint:create",this,this._onProjectAgileScrumSprintCreate);core.bus.on("project.agile.scrum.sprint:unlink",this,this._onProjectAgileScrumSprintUnlink);},setNewTaskOrder(task){const destinationTaskList=this.sprintWidgetsMap.get(task.sprint_id)?this.sprintWidgetsMap.get(task.sprint_id).taskList:this.backlogTaskList;task.agile_order=destinationTaskList.getNewOrder(null,destinationTaskList.list.size,task.sprint_id);},swapSprints(sprintWillGoUp,sprintWillGoDown,store=true){sprintWillGoUp.$el.insertBefore(sprintWillGoDown.$el);if(store){const tmpOrder=sprintWillGoUp._model.order;sprintWillGoUp._model.order=sprintWillGoDown._model.order;sprintWillGoDown._model.order=tmpOrder;}
const goUpIndex=this.__parentedChildren.findIndex((e)=>e.id===sprintWillGoUp.id);const goDownIndex=this.__parentedChildren.findIndex((e)=>e.id===sprintWillGoDown.id);this.__parentedChildren[goUpIndex]=sprintWillGoDown;this.__parentedChildren[goDownIndex]=sprintWillGoUp;this.renderSprintState();},addSprint(sprint,highlight){const team=this.user.team_ids[this.user.team_id[0]];if(!team.sprint_ids.includes(sprint.id)){team.sprint_ids.push(sprint.id);}
if(this.sprintWidgetsMap.has(sprint.id)){return;}
this.sprintMap.set(sprint.id,sprint);const sprintDataWidget=new SprintDataWidget(this,{id:sprint.id,taskWidgetItemCache:this.taskWidgetItemMap,TaskItemClass:this._getTaskItemClass(),data:sprint,data_service:sprint_service,allFilteredTaskIds:this.allFilteredTaskIds,_getNewListWidget:this._getNewListWidget.bind(this),});sprintDataWidget.appendTo(this.$("ul.non-backlog-list"));sprintDataWidget._is_rendered.then(()=>{this.renderSprintState();});this.sprintWidgetsMap.set(sprint.id,sprintDataWidget);if(highlight){sprintDataWidget._is_added_to_DOM.then(()=>{$("#backlog-view").scrollToElement(sprintDataWidget.$el);sprintDataWidget.$el.highlight();});}
const c=this.__parentedChildren;if(this.backlogTaskList&&c[c.length-2]===this.backlogTaskList){const tmp=c[c.length-1];c[c.length-1]=c[c.length-2];c[c.length-2]=tmp;}
this.lastest_sprint_order=this.lastest_sprint_order>sprint.order?this.lastest_sprint_order:sprint.order;return sprintDataWidget;},renderSprintState(){const sprintWidgets=this.__parentedChildren.filter((e)=>e.dataset&&e.dataset.model==="project.agile.scrum.sprint");if(sprintWidgets.length<1){return;}
let hasActive=null;let firstNonActive=null;if(sprintWidgets[0]._model.state==="active"){hasActive=true;firstNonActive=false;sprintWidgets[0].$el.addClass("sprint-active");}else{sprintWidgets[0].$el.removeClass("sprint-active");hasActive=false;firstNonActive=true;}
for(const sprint of sprintWidgets){sprint.$("#btn_start").hide();sprint.$("#btn_end").hide();sprint.$("#btn_up").hide();sprint.$("#btn_down").hide();if(sprint._model.state==="active"){sprint.$("#btn_end").show();sprint.$("#btn_delete").hide();sprint.$("#start-end-date").text(`${sprint.start_date_f()}-${sprint.end_date_f()}`);firstNonActive=true;}else if(firstNonActive){if(!hasActive){sprint.$("#btn_start").show();}
sprint.$("#btn_down").show();firstNonActive=false;}else{sprint.$("#btn_up").show();sprint.$("#btn_down").show();}}
sprintWidgets[sprintWidgets.length-1].$("#btn_down").hide();},_onProjectTaskWrite(id,vals,payload,task){this._super(id,vals,payload,task);const user=payload.user_id;if(vals.sprint_id&&!this.sprintWidgetsMap.has(vals.sprint_id[0])&&user.id!==data.session.uid&&payload.indirect===false){if(!this.project_ids.includes(task.project_id[0])){return;}
const toastContent=$('<div class="toast-content"><p><span class="toast-user-name">'+this.user.name+'</span> moved '+task.priority_id[1]+' '+task.type_id[1]+' <span class="toast-task-name">'+task.key+' - '+task.name+'</span> to his/her team\'s sprint</p></div>');AgileToast.toast(toastContent,data.getImage("res.users",this.user.id,this.user.__last_update),{text:"open",callback:()=>{hash_service.set("task",task.id);hash_service.set("view","task");hash_service.set("page","board");}});}},_onProjectAgileScrumSprintWrite(id,vals){if(vals.order){const sprintWidgets=this.__parentedChildren.filter((w)=>w._model&&w._model.order===vals.order);if(sprintWidgets.length===2){this.swapSprints(sprintWidgets[1],sprintWidgets[0],false);}}
if(vals.state){if(vals.state==="completed"){const sprintWidget=this.sprintWidgetsMap.get(id);if(sprintWidget){sprintWidget.destroy();this.sprintWidgetsMap.delete(id);}else{console.error("Trying to delete already deleted sprint...");}}
this.renderSprintState();}},_onProjectAgileScrumSprintCreate(id){sprint_service.getRecord(id).then((sprint)=>{this.addSprint(sprint,true);});},_onProjectAgileScrumSprintUnlink(id){this.trigger("delete_sprint",{data:{id,external:true}});},_onDeleteSprint(evt){const sprint=this.sprintWidgetsMap.get(evt.data.id);if(!sprint){return;}
if(evt.data.external){sprint.destroy();this.sprintWidgetsMap.delete(sprint.id);this.sprintMap.delete(sprint.id);this.renderSprintState();return;}
dialog.confirm(_t("Delete sprint"),_t("Are you sure you want to delete this sprint?"),_t("yes")).done(()=>{sprint.unlink().done(function(){data.getDataSet("project.task").call('write',[this.sprintWidgetsMap.get(sprint.id)._model.task_ids,{sprint_id:false}]);}.bind(this));});},_onMoveSprintUp(evt){const sprint=evt.data.sprint;const indexOfPrevious=this.__parentedChildren.findIndex((e)=>e.id===sprint.id)-1;const previousSprint=this.__parentedChildren[indexOfPrevious];this.swapSprints(sprint,previousSprint);},_onMoveSprintDown(evt){const sprint=evt.data.sprint;const indexOfNext=this.__parentedChildren.findIndex((e)=>e.id===sprint.id)+1;const nextSprint=this.__parentedChildren[indexOfNext];this.swapSprints(nextSprint,sprint);},_onStartSprint(evt){const sprint=evt.data.sprint;dialog.confirm(_t("Start sprint"),_t("Are you sure you want to start this sprint?"),_t("yes")).done(()=>{let start_date=moment().hours(9).minutes(0).seconds(0);const sprint_length=this.user.team_ids[this.user.team_id[0]].default_sprint_length;let end_date=start_date.clone().add(sprint_length,'week');start_date=field_utils.parse.datetime(start_date);end_date=field_utils.parse.datetime(end_date);data.session.rpc(`/scrummer/web/data/sprint/${sprint.id}/start`,{start_date:start_date,end_date:end_date});});},_onEndSprint(evt){const sprint=evt.data.sprint;dialog.confirm(_t("End sprint"),_t("Are you sure you want to end this sprint?"),_t("yes")).done(()=>{data.session.rpc(`/scrummer/web/data/sprint/${sprint.id}/stop`);});},_onAddNewSprintClick(){const sprintData={'order':++this.lastest_sprint_order,};data.session.rpc(`/scrummer/web/data/sprint/create/`,{'sprint':sprintData}).then((sprint)=>{this.addSprint(sprint,true);}).fail((e)=>{console.error(e);});},});ViewManager.include({build_view_registry(){this._super();this.view_registry.set("scrum",ScrumBacklogView);},});return{ScrumBacklogView,BacklogTaskItem,SprintList,SprintDataWidget};});;

/* /scrummer_scrum/static/src/js/views/active_sprint.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer_scrum.view.active_sprint',function(require){"use strict";const KanbanTable=require('scrummer.view.kanban_table');const ViewManager=require('scrummer.view_manager');const hash_service=require('scrummer.hash_service');const ScrummerData=require('scrummer.data');const core=require('web.core');const _t=core._t;const AgileToast=require('scrummer.toast');const SprintTaskTable=KanbanTable.TaskTable.extend({shouldCardBeAdded(task,checkForSprint=true){if(checkForSprint&&(!task.sprint_id||Object.keys(this.data.active_sprints)[0]!==task.sprint_id[0])){return false;}
return this._super(task);}});const ActiveSprintView=KanbanTable.TaskKanbanTableView.extend({KanbanTable:{KanbanTable:SprintTaskTable},emptyTitle:_t("There is no active sprint currently"),emptyTemplate:"scrummer.view.sprint.empty",init(parent,options){this._super(parent,options);this.boardId=parseInt(hash_service.get("board"),10);this.projectId=parseInt(hash_service.get("project"),10);window.as=this;},willStart(){const options={};if(this.projectId){options.project_id=this.projectId;}
return $.when(this._super(),ScrummerData.session.rpc(`/scrummer/web/data/active_sprints/${this.boardId}`,options)).then((dummy,r)=>{this.data=r;if(this.isEmpty()){this.template=this.emptyTemplate;}});},isEmpty(){return!Object.keys(this.data.active_sprints).length;},getTitle(){return this.data.active_sprints[Object.keys(this.data.active_sprints)[0]].name;},generateKanbanTableOptions(){return Object.assign(this._super(),{kanbanTableOptionsID:"active_sprint",});},_onProjectTaskWrite(id,delta,payload,task){this._super(id,delta,payload,task);if(!this.kanbanTable){return;}
if(delta.sprint_id===false){if(!this.kanbanTable.shouldCardBeAdded(task,false)){return;}
if(task._previous&&task._previous.sprint_id&&Object.keys(this.data.active_sprints)[0]===task._previous.sprint_id[0]){const toastContent=$('<div class="toast-content"><p><span class="toast-user-name">'+this.user.name+'</span> removed '+task.priority_id[1]+' '+task.type_id[1]+' <span class="toast-task-name">'+task.key+' - '+task.name+'</span> from active sprint</p></div>');AgileToast.toast(toastContent,ScrummerData.getImage("res.users",this.user.id,this.user.__last_update),{text:"open",callback:()=>{hash_service.set("task",task.id);hash_service.set("view","task");hash_service.set("page","board");}});}}},});ViewManager.include({build_view_registry(){this._super();this.view_registry.set("sprint",ActiveSprintView);},});return{ActiveSprintView,SprintTaskTable};});;

/* /scrummer_scrum/static/src/js/widgets/menu.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer_scrum.menu_extension',function(require){"use strict";const AgileMenu=require('scrummer.menu');const web_core=require('web.core');const _t=web_core._t;AgileMenu.AgileViewMenu.include({build_widget_list(){this._super();if(this.boardType==="scrum"){this.add_widget({id:'active_sprint',widget:AgileMenu.AgileVerticalMenuItem,append:"ul#nav-mobile",'args':{id:"active_sprint",view:"sprint",icon:"clock",name:_t("Active sprint"),sequence:1,}});this.add_widget({id:'scrum',widget:AgileMenu.AgileVerticalMenuItem,append:"ul#nav-mobile",'args':{id:"scrum",view:"scrum",icon:"view-list",name:_t("Backlog"),sequence:2,}});}}});});;

/* /scrummer_scrum/static/src/js/widgets/task_widget.js defined in bundle 'scrummer.assets' */
odoo.define('scrummer.widget.task.scrum_extension',function(require){"use strict";const TaskWidget=require('scrummer.widget.task').TaskWidget;const DataServiceFactory=require('scrummer.data_service_factory');TaskWidget.include({renderElement(){this._super();if(this._model.sprint_ids.length>1){DataServiceFactory.get("project.agile.scrum.sprint").getRecords(this._model.sprint_ids).then((sprints)=>{const sprintContainer=this.$("[data-field='sprint_ids']");for(const sprint of sprints){sprintContainer.append($(`<span class="agile-tag">${sprint.name}</span>`));}
this.$("[data-field-name='sprint_ids']").show();});}}});});