
/* /survey_attachment/static/src/js/survey_attachment.js defined in bundle 'survey_attachment.survey_attachment_assets' */
odoo.define('survey_attachment.survey',function(require){'use strict';require('web.dom_ready');var the_form=$('.js_surveyform');var submit_controller=the_form.attr("data-submit");if(!the_form.length){return $.Deferred().reject("DOM doesn't contain '.js_surveyform'");}
console.debug("[survey] Survey Attachment JS is loading...");the_form.ajaxForm({url:submit_controller,type:'POST',dataType:'json',beforeSubmit:function(formData,$form,options){$.blockUI();var date_fields=$form.find('div.date > input.form-control');for(var i=0;i<date_fields.length;i++){var el=date_fields[i];var moment_date=el.value!==''?field_utils.parse.date(el.value):'';if(moment_date){moment_date.toJSON=function(){return this.clone().locale('en').format('YYYY-MM-DD');};}
var field_obj=_.findWhere(formData,{'name':el.name});field_obj.value=JSON.parse(JSON.stringify(moment_date));}
$('.js_errzone').html("").hide();},success:function(response,status,xhr,wfe){$.unblockUI();if(_.has(response,'errors')){_.each(_.keys(response.errors),function(key){$("#"+key+'>.js_errzone').append('<p>'+response.errors[key]+'</p>').show();});return false;}
else if(_.has(response,'redirect')){window.location.replace(response.redirect);return true;}
else{console.error("Incorrect answer sent by server");return false;}},timeout:15000,error:function(jqXHR,textStatus,errorThrown){framework.unblockUI();$('#AJAXErrorModal').modal('show');}});console.debug("[survey] Survey Attachment JS is loaded");});